import{am as $}from"./index-Eg-wPV6N.js";function W(){const t=e=>{try{const n=new URL(e);return n.hostname==="cdn.7tv.app"&&n.protocol==="https:"||n.pathname.includes("/api/7tv")&&n.protocol==="https:"?"".concat($()).concat(n.pathname).concat(n.search).concat(n.hash):(console.warn("URL изображения отклонен:",{url:e,hostname:n.hostname,protocol:n.protocol,reason:n.hostname!=="cdn.7tv.app"?"неразрешенный домен":"неразрешенный протокол"}),!1)}catch(n){return console.warn("Недопустимый URL изображения:",e,"Ошибка:",n.message),!1}},i=e=>{const n=document.createElement("div");return n.textContent=e,n.innerHTML},m=e=>{if(!e)return"";let n=e;return n=n.replace(/\[spoiler\]\s*\[\/spoiler\]/g,""),n=n.replace(/\[img\]\s*\[\/img\]/g,""),n=n.replace(/\[link=[^\]]+\]\s*\[\/link\]/g,""),n=n.replace(/\[img\](.*?)\[\/img\]/g,(l,u)=>{const c=u.trim(),r=t(c);if(r&&r!==!1){const s=i(r);return'<img src="'.concat(s,'" alt="7TV emote" class="inline-emoji" loading="lazy" />')}return"[недопустимое изображение: ".concat(i(c),"]")}),n=n.replace(new RegExp("\\[spoiler\\](.*?)\\[\\/spoiler\\]","gs"),(l,u,c,r)=>{const s=i(u.trim());if(!s)return"";const a=c>0?r[c-1]:" ",o=c+l.length<r.length?r[c+l.length]:" ",f=a&&a!==" "&&a!=="\n"&&a!=="	",p=o&&o!==" "&&o!=="\n"&&o!=="	",g=f?" ":"",h=p?" ":"";return"".concat(g,'<span class="spoiler-text" onclick="this.classList.toggle(\'revealed\')" title="Нажмите, чтобы показать спойлер">').concat(s,"</span>").concat(h)}),n=n.replace(/\[link=([^\]]+)\](.*?)\[\/link\]/g,(l,u,c)=>{const r=u.trim(),s=c.trim();if(!s)return"";if(/^https?:\/\/.+/.test(r)&&s){const o=i(r),f=i(s);return'<a href="'.concat(o,'" target="_blank" rel="noopener noreferrer" class="comment-link">').concat(f,"</a>")}return i(s||r)}),n};return{formatContent:m,formatContentWithTruncation:e=>e?m(e):"",isValidImageUrl:t,escapeHtml:i}}const v=t=>{if(!t)return"";const i=t.substring(0,4),m=t.substring(4,6),d=t.substring(6,8),e=t.substring(9,11),n=t.substring(11,13),l=t.substring(13,15);return new Date(Date.UTC(parseInt(i),parseInt(m)-1,parseInt(d),parseInt(e),parseInt(n),parseInt(l))).toLocaleDateString("ru-RU",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone})},L=t=>{if(!t)return"";const i=t.substring(0,4),m=t.substring(4,6),d=t.substring(6,8),e=t.substring(9,11),n=t.substring(11,13),l=t.substring(13,15),u=new Date(Date.UTC(parseInt(i),parseInt(m)-1,parseInt(d),parseInt(e),parseInt(n),parseInt(l))),r=Math.floor((new Date-u)/1e3);if(r<60)return"только что";const s=Math.floor(r/60);if(s<60)return"".concat(s," ").concat(I(s)," назад");const a=Math.floor(s/60);if(a<24)return"".concat(a," ").concat(U(a)," назад");const o=Math.floor(a/24);if(o<7)return"".concat(o," ").concat(b(o)," назад");const f=Math.floor(o/7);if(f<4)return"".concat(f," ").concat(D(f)," назад");const p=Math.floor(o/30);if(p<12)return"".concat(p," ").concat(C(p)," назад");const g=Math.floor(o/365);return"".concat(g," ").concat(M(g)," назад")},I=t=>t%10===1&&t%100!==11?"минуту":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"минуты":"минут",U=t=>t%10===1&&t%100!==11?"час":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"часа":"часов",b=t=>t%10===1&&t%100!==11?"день":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"дня":"дней",D=t=>t%10===1&&t%100!==11?"неделю":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"недели":"недель",C=t=>t%10===1&&t%100!==11?"месяц":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"месяца":"месяцев",M=t=>t%10===1&&t%100!==11?"год":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"года":"лет";export{v as a,L as f,W as u};
