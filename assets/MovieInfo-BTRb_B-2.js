import{_ as _e,r as g,c as U,b as r,d as a,e,s as W,t as c,K as G,g as k,L as le,n as A,q as je,u as Oe,i as Xe,N as no,z as Ke,l as $e,o as Ae,O as Qe,x as be,E as so,f as ie,P as Ge,m as O,Q as z,y as V,U as B,R as ho,D as Ze,S as pe,V as bo,W as io,X as _o,Y as Gt,Z as Co,$ as Ie,a0 as wo,v as lo,a1 as Eo,a2 as Mo,a3 as Io,a4 as $o,a5 as Zt,a6 as Ro,a7 as Ao,a as To,a8 as Xt,a9 as Qt,aa as So,ab as Po,ac as Lo}from"./index-DdLu8r-A.js";import{S as ao,_ as xo,a as Jt,b as eo,M as to}from"./MovieList-C3Vbx7oJ.js";import{N as qe}from"./ToastMessage-B5ilmuL8.js";import{u as No,S as jo,a as Uo}from"./trailer-CifrQWZc.js";const Re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVR4nO2ZQUoDMRSGR7eewHoFsVS0HkUUXNXqASqK2EURBPFIVRe6c+UN1CvUXWvbT4KvMAwzNnnJdCrmg1BKad7/v7y0b5IkiUQiCwGoAx3gQjEugZ0qxTeAIX6MKjMBnBOGS62AVWAPOHVYdlMu9YArYOhphLeBT+ALmOKGEd2QubaAK+B2zngFxt4GgDXgGZjgR8ch5oEkCi8DkvlnRcYLV0Apfqw10M7JvPkV6AN3FmVwK+WyZRnvMEe8ef/ibECyb2o+zRuwnpQAxeLNivQ0BvYyE46qEJ/8fK4ycJKp/X4V4n0MdDNfukkqEO9jwP1LDgD7BeKPgmgp04CL+KUz4Cp+qQxoxC+NAdsNm4c0hWkukkUa8BGfegiadbFDq3/2UAZ8xc+QVvzMtqcKYkBaZ5/MN5xEl2DgLGDZ1KswsC09FPJqXTZoNm5oA6kyMGI2FxqfkluJ0uMTDfhBXAHiHvCCWEL8/RLqlv1MPCf+TSZ+13WC7KnEfWlqcwAeU7GNjnbiQsG5UC1ZAEAt1UMhOpquk6zknMy9l20C2AA+MnEHRo9msuOCs9EH4Fp5TVQ0rqVs0plH4re02Qh1Oq1lCjypsp+5H3gKcD/gykTirqnFZ/ZDy+OGxpapzD+QePrM/2KkKfcGPcv7AdvRkz23G1x4JPIP+AY3r/ywUk/2JAAAAABJRU5ErkJggg==",Do="/reyohoho/assets/icon-shikimori-DGvXK9Jc.svg",Ye=l=>{const o=document.createElement("div");o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.backgroundColor="rgba(0, 0, 0, 0.8)",o.style.color="white",o.style.display="flex",o.style.justifyContent="center",o.style.alignItems="center",o.style.fontSize="2rem",o.style.zIndex="99000",o.textContent=l,document.body.appendChild(o),setTimeout(()=>{document.body.removeChild(o)},2e3)},Ho={key:0},Bo={key:1},Oo={class:"players-list"},Ko=["onClick"],qo={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},Fo={key:0},zo={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},Vo={key:1},Wo={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},Yo=["onClick"],Go={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},Zo={__name:"PlayerModal",props:{players:{type:Array,required:!0},selectedPlayer:{type:Object,default:null}},emits:["close","select"],setup(l,{emit:o}){const v=l,s=o,_=g(null),w=U(()=>v.players.filter(h=>!E(h)&&!t(h))),p=U(()=>v.players.some(h=>E(h))),R=U(()=>v.players.some(h=>t(h))),E=h=>h.key.toUpperCase().includes("HDREZKA"),t=h=>h.key.toUpperCase().includes("KODIK"),f=h=>h.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"").trim(),x=h=>{s("select",h),s("close")},K=h=>v.selectedPlayer&&v.selectedPlayer.key===h.key,P=h=>v.selectedPlayer?h==="hdrezka"&&E(v.selectedPlayer)||h==="kodik"&&t(v.selectedPlayer):!1,D=h=>{_.value=h},F=()=>{_.value=null},S=h=>{let $=v.players.filter(M=>h==="hdrezka"&&E(M)||h==="kodik"&&t(M));return h==="kodik"?$.sort((M,H)=>f(M.translate).localeCompare(f(H.translate))):$},T=h=>S(h).some($=>$.warning);return(h,$)=>(a(),r("div",{class:"modal",onClick:$[4]||($[4]=je(M=>h.$emit("close"),["self"]))},[e("div",{class:"modal-content",onClick:$[3]||($[3]=je(()=>{},["stop"]))},[e("button",{class:"close",onClick:$[0]||($[0]=M=>h.$emit("close"))},"√ó"),_.value?(a(),r("h2",Bo,[e("button",{class:"back-btn",onClick:F},"‚Üê –ù–∞–∑–∞–¥"),W(" "+c(_.value==="hdrezka"?"ReYohoho - HDrezka":"Kodik"),1)])):(a(),r("h2",Ho,"–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–µ–µ—Ä")),e("ul",Oo,[_.value?(a(!0),r(G,{key:1},le(S(_.value),M=>(a(),r("li",{key:M.key},[e("button",{class:A(["player-item",{active:K(M)}]),onClick:H=>x(M)},[W(c(f(M.translate))+" ",1),M.warning?(a(),r("span",Go,"warning")):k("",!0)],10,Yo)]))),128)):(a(),r(G,{key:0},[(a(!0),r(G,null,le(w.value,M=>(a(),r("li",{key:M.key},[e("button",{class:A(["player-item",{active:K(M)}]),onClick:H=>x(M)},[W(c(f(M.translate))+" ",1),M.warning?(a(),r("span",qo,"warning")):k("",!0)],10,Ko)]))),128)),p.value?(a(),r("li",Fo,[e("button",{class:A(["group-item",{active:P("hdrezka")}]),onClick:$[1]||($[1]=M=>D("hdrezka"))},[$[5]||($[5]=e("span",{class:"material-icons group-icon"},"folder",-1)),$[6]||($[6]=W(" ReYohoho - HDrezka ")),T("hdrezka")?(a(),r("span",zo,"warning")):k("",!0)],2)])):k("",!0),R.value?(a(),r("li",Vo,[e("button",{class:A(["group-item",{active:P("kodik")}]),onClick:$[2]||($[2]=M=>D("kodik"))},[$[7]||($[7]=e("span",{class:"material-icons group-icon"},"folder",-1)),$[8]||($[8]=W(" Kodik ")),T("kodik")?(a(),r("span",Wo,"warning")):k("",!0)],2)])):k("",!0)],64))])])]))}},Xo=_e(Zo,[["__scopeId","data-v-460326ba"]]),Qo={class:"players-list"},Jo=["src"],en={key:1,class:"controls"},tn={class:"main-controls"},on={class:"material-icons"},nn={class:"list-button-item"},sn={class:"material-icons"},ln={class:"list-button-item"},an={class:"material-icons"},rn={class:"list-button-item"},un={class:"list-button-item"},dn={class:"material-icons"},cn={class:"list-button-item"},vn={class:"material-icons"},mn={class:"tooltip-container","data-tooltip-container":"dimming"},fn={class:"material-icons"},yn={class:"tooltip-container","data-tooltip-container":"blur"},kn={class:"tooltip-container","data-tooltip-container":"compressor"},gn={class:"tooltip-container","data-tooltip-container":"mirror"},pn={class:"tooltip-container","data-tooltip-container":"theater"},hn={class:"material-symbols-outlined"},bn={class:"custom-tooltip","data-tooltip":"theater"},_n={class:"tooltip-container","data-tooltip-container":"aspect_ratio"},Cn={class:"current-ratio"},wn=["onClick"],En={key:0,class:"tooltip-container","data-tooltip-container":"app_link"},Mn={class:"custom-tooltip","data-tooltip":"app_link"},In={key:1,class:"tooltip-container","data-tooltip-container":"copy_link"},$n={class:"custom-tooltip","data-tooltip":"copy_link"},Rn={key:0,class:"desktop-list-buttons"},An={class:"tooltip-container"},Tn={class:"material-icons"},Sn={class:"custom-tooltip"},Pn={class:"tooltip-container"},Ln={class:"material-icons"},xn={class:"custom-tooltip"},Nn={class:"tooltip-container"},jn={class:"custom-tooltip"},Un={class:"tooltip-container"},Dn={class:"material-icons"},Hn={class:"custom-tooltip"},Bn={class:"tooltip-container"},On={class:"material-icons"},Kn={class:"custom-tooltip"},qn={key:1,class:"mobile-list-buttons"},Fn={class:"tooltip-container"},zn={class:"material-icons"},Vn={class:"custom-tooltip"},Wn={class:"tooltip-container"},Yn={class:"material-icons"},Gn={class:"custom-tooltip"},Zn={class:"tooltip-container"},Xn={class:"custom-tooltip"},Qn={class:"tooltip-container"},Jn={class:"material-icons"},es={class:"custom-tooltip"},ts={class:"tooltip-container"},os={class:"material-icons"},ns={class:"custom-tooltip"},ss={__name:"PlayerComponent",props:{kpId:String,movieInfo:{type:Object,default:()=>({})}},emits:["update:selectedPlayer","update:movieInfo"],setup(l,{emit:o}){const v=Oe(),s=No(),_=Xe(),w=no(),p=Ke(),R=g(w.params.kp_id),E=l,t=o,f=g([]),x=g(null),K=g(!0),P=g(!1),D=g(!1),F=g(null),S=g(null),T=g(!1),h=g(""),$=g(null),M=g(window.innerHeight*.9),H=U(()=>"".concat(M.value,"px")),N=U(()=>v.isMobile),q=U(()=>!!window.electronAPI),m=g(null),ue=g(!1);let me=null;const Z=g(null),X=g(null),de=g(null),fe=b=>{const n=document.querySelector('[data-tooltip-container="'.concat(b,'"]')),L=document.querySelector('[data-tooltip="'.concat(b,'"]'));if(!n||!L)return;const se=n.getBoundingClientRect(),ke=L.getBoundingClientRect(),ge=window.innerHeight;se.bottom+ke.height>ge?(L.style.top="auto",L.style.bottom="100%",L.style.marginTop="0",L.style.marginBottom="12px",L.style.transform="translateX(-50%)"):(L.style.top="100%",L.style.bottom="auto",L.style.marginTop="12px",L.style.marginBottom="0",L.style.transform="translateX(-50%)")},j=b=>{m.value=b,ue.value=!1,clearTimeout(me),pe(()=>{fe(b)})},te=()=>{ue.value||(me=setTimeout(()=>{m.value=null},300))},ye=()=>{ue.value=!0,clearTimeout(me)},ce=()=>{ue.value=!1,m.value=null},J=U({get:()=>s.aspectRatio,set:b=>s.updateAspectRatio(b)}),ve=U({get:()=>s.isCentered,set:b=>s.updateCentering(b)}),oe=U(()=>{var b,n,L,se,ke,ge,Ce,we,Ee,Me;return((n=(b=E.movieInfo)==null?void 0:b.lists)==null?void 0:n.isFavorite)||((se=(L=E.movieInfo)==null?void 0:L.lists)==null?void 0:se.isWatching)||((ge=(ke=E.movieInfo)==null?void 0:ke.lists)==null?void 0:ge.isLater)||((we=(Ce=E.movieInfo)==null?void 0:Ce.lists)==null?void 0:we.isCompleted)||((Me=(Ee=E.movieInfo)==null?void 0:Ee.lists)==null?void 0:Me.isAbandoned)}),I=U(()=>s.preferredPlayer),u=g(0),i=b=>b.toUpperCase(),d=()=>{if(P.value||!S.value)return;const[b,n]=J.value.split(":").map(Number);M.value=window.innerHeight*.9,u.value=Math.min(S.value.clientWidth*(n/b),M.value)},y=U(()=>{if(P.value)return{};const[b,n]=J.value.split(":").map(Number),L=M.value*(b/n);return{width:"100%",maxWidth:"".concat(L,"px"),maxHeight:H.value,margin:"0 auto",overflow:"hidden"}}),Y=U(()=>{const[b,n]=J.value.split(":").map(Number);return{position:"relative",width:"100%",paddingTop:"".concat(n/b*100,"%")}}),ee=()=>{S.value&&setTimeout(()=>{pe(()=>{S.value.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},500)},ne=async()=>{try{h.value="",$.value=null;const b=await ho(E.kpId);if(f.value=Object.entries(b).map(([n,L])=>({key:n.toUpperCase(),...L})),f.value.length>0){if(I.value){const n=i(I.value),L=f.value.find(se=>i(se.key)===n);x.value=L||f.value[0]}else x.value=f.value[0];t("update:selectedPlayer",x.value)}}catch(b){const{message:n,code:L}=Ze(b);h.value=n,$.value=L,console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–ª–µ–µ—Ä–æ–≤:",b)}},he=()=>{T.value=!0},ae=()=>{T.value=!1},re=b=>{var n;if(((n=x.value)==null?void 0:n.key)===b.key){ae();return}x.value=b,K.value=!0,s.updatePreferredPlayer(i(b.key)),t("update:selectedPlayer",b)},Ue=()=>{q.value?window.electronAPI.sendHotKey("F2"):(Ye("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},Te=()=>{q.value?window.electronAPI.sendHotKey("F3"):(Ye("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},Fe=()=>{q.value?window.electronAPI.sendHotKey("F4"):(Ye("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},De=()=>{P.value=!P.value,P.value?(window.addEventListener("mousemove",ze),document.addEventListener("keydown",Ve),document.body.classList.add("no-scroll")):(window.removeEventListener("mousemove",ze),document.removeEventListener("keydown",Ve),document.body.classList.remove("no-scroll")),D.value=P.value,pe(()=>ee())},et=g(null),ze=()=>{et.value=setTimeout(()=>{clearTimeout(et.value),D.value=!1},4e3),D.value=!0},He=U(()=>v.dimmingEnabled),ro=()=>{P.value||v.toggleDimming()},Ve=b=>{(b.key==="Escape"&&P.value||b.altKey&&b.keyCode===84)&&De()},tt=b=>{J.value=b,setTimeout(()=>{ve.value&&ee()},310)},uo=()=>{const b="reyohoho://#".concat(R.value);try{window.location.href=b}catch(n){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Å—ã–ª–∫–∏:",n)}},co=()=>{const b=window.location.href;navigator.clipboard.writeText(b).then(()=>{}),Z.value.showNotification("–°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∏–ª—å–º —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞")},vo=()=>{K.value=!1};function mo(b){return b.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"HDRezka - ").replace(/KODIK>/,"Kodik - ").trim()}const fo=U(()=>{var b,n;return q.value?!1:!((n=(b=x.value)==null?void 0:b.key)!=null&&n.toUpperCase().includes("TORRENTS"))});$e(x,b=>{if(b)if(K.value=!0,s.updatePreferredPlayer(i(b.key)),t("update:selectedPlayer",b),b.key.toUpperCase().includes("TORRENTS")){const n=document.querySelector(".rocketme_fon");n&&(n.style.display="none");const L=document.querySelector(".pm_preloader");L&&(L.style.display="none")}else{const n=document.querySelector(".rocketme_fon");n&&(n.style.display="");const L=document.querySelector(".pm_preloader");L&&(L.style.display="")}}),$e(()=>w.params.kp_id,async b=>{b&&b!==R.value&&(R.value=b,ve.value&&ee())},{immediate:!0});const Be=["16:9","12:5","4:3"],yo=()=>{const n=(Be.indexOf(J.value)+1)%Be.length;tt(Be[n])},ko=b=>{var L,se,ke,ge,Ce,we,Ee,Me,Se,Pe,Le,xe,Ne;return(Ne={[B.FAVORITE]:((se=(L=E.movieInfo)==null?void 0:L.lists)==null?void 0:se.isFavorite)||!1,[B.HISTORY]:((ge=(ke=E.movieInfo)==null?void 0:ke.lists)==null?void 0:ge.isHistory)||!1,[B.LATER]:((we=(Ce=E.movieInfo)==null?void 0:Ce.lists)==null?void 0:we.isLater)||!1,[B.COMPLETED]:((Me=(Ee=E.movieInfo)==null?void 0:Ee.lists)==null?void 0:Me.isCompleted)||!1,[B.ABANDONED]:((Pe=(Se=E.movieInfo)==null?void 0:Se.lists)==null?void 0:Pe.isAbandoned)||!1,[B.WATCHING]:((xe=(Le=E.movieInfo)==null?void 0:Le.lists)==null?void 0:xe.isWatching)||!1}[b])!=null?Ne:!1},Q=async b=>{if(!_.token){Z.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:go});return}try{const n={[B.FAVORITE]:"–∏–∑–±—Ä–∞–Ω–Ω–æ–µ",[B.HISTORY]:"–∏—Å—Ç–æ—Ä–∏—é",[B.LATER]:'—Å–ø–∏—Å–æ–∫ "–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ"',[B.COMPLETED]:'—Å–ø–∏—Å–æ–∫ "–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"',[B.ABANDONED]:'—Å–ø–∏—Å–æ–∫ "–ë—Ä–æ—à–µ–Ω–æ"',[B.WATCHING]:'—Å–ø–∏—Å–æ–∫ "–°–º–æ—Ç—Ä—é"'};ko(b)?(await bo(R.value,b),Z.value.showNotification("–£–¥–∞–ª–µ–Ω–æ –∏–∑ ".concat(n[b]))):(await io(R.value,b),Z.value.showNotification("–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ ".concat(n[b])))}catch(n){const{message:L,code:se}=Ze(n);Z.value.showNotification("".concat(L," ").concat(se))}t("update:movieInfo")},go=()=>{p.push("/login")},We=U(()=>s.showFavoriteTooltip),po=()=>{p.push("/settings"),ce()};return Ae(()=>{K.value=!0,ne(),N.value&&(J.value="4:3"),d(),window.addEventListener("resize",d),window.addEventListener("resize",fe),ve.value&&ee()}),Qe(()=>{window.removeEventListener("resize",d),window.removeEventListener("resize",fe),window.removeEventListener("mousemove",ze),document.removeEventListener("keydown",Ve),document.body.classList.remove("no-scroll")}),(b,n)=>{var L,se,ke,ge,Ce,we,Ee,Me,Se,Pe,Le,xe,Ne,ot,nt,st,it,lt,at,rt,ut,dt,ct,vt,mt,ft,yt,kt,gt,pt,ht,bt,_t,Ct,wt,Et,Mt,It,$t,Rt,At,Tt,St,Pt,Lt,xt,Nt,jt,Ut,Dt,Ht,Bt,Ot,Kt,qt,Ft,zt,Vt,Wt,Yt;return h.value?(a(),be(so,{key:0,message:h.value,code:$.value},null,8,["message","code"])):(a(),r(G,{key:1},[e("div",Qo,[n[54]||(n[54]=e("span",null,"–ü–ª–µ–µ—Ä:",-1)),e("button",{class:"player-btn",onClick:he},c(x.value?mo(x.value.translate).toUpperCase():"–ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–µ–µ—Ä–æ–≤..."),1)]),T.value?(a(),be(Xo,{key:0,players:f.value,"selected-player":x.value,onClose:ae,onSelect:re},null,8,["players","selected-player"])):k("",!0),e("div",{ref_key:"containerRef",ref:S,class:A(["player-container",{"theater-mode":P.value}]),style:Ge(P.value?{}:y.value)},[e("div",{class:A(["iframe-wrapper",{pm_video:fo.value}]),style:Ge(P.value?{}:Y.value)},[O(e("iframe",{ref_key:"playerIframe",ref:F,src:(L=x.value)==null?void 0:L.iframe,frameborder:"0",allowfullscreen:"",webkitallowfullscreen:"",class:A(["responsive-iframe",{"theater-mode-unlock":D.value,"theater-mode-lock":P.value,dimmed:He.value}]),onLoad:vo},null,42,Jo),[[z,!K.value&&((se=x.value)==null?void 0:se.iframe)]]),K.value?(a(),be(ao,{key:0})):k("",!0)],6),P.value?(a(),r("button",{key:0,class:A(["close-theater-btn",{visible:D.value}]),onClick:De}," ‚úñ ",2)):k("",!0)],6),P.value?k("",!0):(a(),r("div",en,[e("div",tn,[N.value?k("",!0):(a(),r("div",{key:0,ref_key:"tooltipContainer",ref:X,class:"tooltip-container list-buttons-container","data-tooltip-container":"favorite"},[We.value?(a(),r("button",{key:0,class:A(["favorite-btn",{active:(ge=(ke=l.movieInfo)==null?void 0:ke.lists)==null?void 0:ge.isFavorite}]),onMouseenter:n[0]||(n[0]=C=>j("favorite")),onMouseleave:te,onClick:n[1]||(n[1]=C=>Q(V(B).FAVORITE))},[e("span",on,c((we=(Ce=l.movieInfo)==null?void 0:Ce.lists)!=null&&we.isFavorite?"favorite":"favorite_border"),1),e("span",{class:A(["material-icons dropdown-arrow",{highlighted:oe.value}])},"expand_more",2)],34)):k("",!0),O(e("div",{ref_key:"tooltip",ref:de,class:"custom-tooltip advanced-tooltip list-buttons-dropdown","data-tooltip":"favorite",onMouseenter:ye,onMouseleave:ce},[e("div",nn,[e("button",{class:A(["favorite-btn",{active:(Me=(Ee=l.movieInfo)==null?void 0:Ee.lists)==null?void 0:Me.isFavorite}]),onClick:n[2]||(n[2]=C=>Q(V(B).FAVORITE))},[e("span",sn,c((Pe=(Se=l.movieInfo)==null?void 0:Se.lists)!=null&&Pe.isFavorite?"favorite":"favorite_border"),1),n[55]||(n[55]=e("span",{class:"button-label"},"–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ",-1))],2)]),e("div",ln,[e("button",{class:A(["watching-btn",{active:(xe=(Le=l.movieInfo)==null?void 0:Le.lists)==null?void 0:xe.isWatching}]),onClick:n[3]||(n[3]=C=>Q(V(B).WATCHING))},[e("span",an,c((ot=(Ne=l.movieInfo)==null?void 0:Ne.lists)!=null&&ot.isWatching?"visibility_off":"visibility"),1),n[56]||(n[56]=e("span",{class:"button-label"},"–°–º–æ—Ç—Ä—é",-1))],2)]),e("div",rn,[e("button",{class:A(["later-btn",{active:(st=(nt=l.movieInfo)==null?void 0:nt.lists)==null?void 0:st.isLater}]),onClick:n[4]||(n[4]=C=>Q(V(B).LATER))},n[57]||(n[57]=[e("span",{class:"material-icons"},"watch_later",-1),e("span",{class:"button-label"},"–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ",-1)]),2)]),e("div",un,[e("button",{class:A(["completed-btn",{active:(lt=(it=l.movieInfo)==null?void 0:it.lists)==null?void 0:lt.isCompleted}]),onClick:n[5]||(n[5]=C=>Q(V(B).COMPLETED))},[e("span",dn,c((rt=(at=l.movieInfo)==null?void 0:at.lists)!=null&&rt.isCompleted?"check_circle":"check_circle_outline"),1),n[58]||(n[58]=e("span",{class:"button-label"},"–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ",-1))],2)]),e("div",cn,[e("button",{class:A(["abandoned-btn",{active:(dt=(ut=l.movieInfo)==null?void 0:ut.lists)==null?void 0:dt.isAbandoned}]),onClick:n[6]||(n[6]=C=>Q(V(B).ABANDONED))},[e("span",vn,c(((vt=(ct=l.movieInfo)==null?void 0:ct.lists)!=null&&vt.isAbandoned,"not_interested")),1),n[59]||(n[59]=e("span",{class:"button-label"},"–ë—Ä–æ—à–µ–Ω–æ",-1))],2)]),e("div",{class:"tooltip-hint"},[n[61]||(n[61]=e("span",{class:"material-icons"},"settings",-1)),e("span",null,[n[60]||(n[60]=W("–°—Ç–∏–ª—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ ")),e("a",{class:"settings-link",onClick:po},"–Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö")])])],544),[[z,m.value==="favorite"&&We.value]])],512)),N.value?k("",!0):(a(),r(G,{key:1},[e("div",mn,[e("button",{class:A(["dimming-btn",{active:He.value}]),onMouseenter:n[7]||(n[7]=C=>j("dimming")),onMouseleave:n[8]||(n[8]=C=>m.value=null),onClick:ro},[e("span",fn,c(He.value?"light_mode":"dark_mode"),1)],34),O(e("div",{class:"custom-tooltip","data-tooltip":"dimming"},c(He.value?"–û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ":"–í–∫–ª—é—á–∏—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ"),513),[[z,m.value==="dimming"]])]),e("div",yn,[e("button",{class:A(["blur-btn",{"electron-only":!q.value}]),onMouseenter:n[9]||(n[9]=C=>j("blur")),onMouseleave:n[10]||(n[10]=C=>m.value=null),onClick:Ue},n[62]||(n[62]=[e("span",{class:"material-icons"},"blur_on",-1)]),34),O(e("div",{class:"custom-tooltip","data-tooltip":"blur"},c(q.value?"–ë–ª—é—Ä":"–ë–ª—é—Ä, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[z,m.value==="blur"]])]),e("div",kn,[e("button",{class:A(["material-symbols-outlined",{"electron-only":!q.value}]),onMouseenter:n[11]||(n[11]=C=>j("compressor")),onMouseleave:n[12]||(n[12]=C=>m.value=null),onClick:Te},n[63]||(n[63]=[e("span",{class:"material-icons"},"graphic_eq",-1)]),34),O(e("div",{class:"custom-tooltip","data-tooltip":"compressor"},c(q.value?"–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä":"–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[z,m.value==="compressor"]])]),e("div",gn,[e("button",{class:A(["mirror-btn",{"electron-only":!q.value}]),onMouseenter:n[13]||(n[13]=C=>j("mirror")),onMouseleave:n[14]||(n[14]=C=>m.value=null),onClick:Fe},n[64]||(n[64]=[e("span",{class:"material-icons"},"flip",-1)]),34),O(e("div",{class:"custom-tooltip","data-tooltip":"mirror"},c(q.value?"–ó–µ—Ä–∫–∞–ª–æ":"–ó–µ—Ä–∫–∞–ª–æ, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[z,m.value==="mirror"]])]),e("div",pn,[e("button",{class:"theater-mode-btn",onMouseenter:n[15]||(n[15]=C=>j("theater")),onMouseleave:n[16]||(n[16]=C=>m.value=null),onClick:De},[e("span",hn,c(P.value?"fullscreen_exit":"aspect_ratio"),1)],32),O(e("div",bn,[W(c(P.value?"–í—ã–π—Ç–∏ –∏–∑ —Ç–µ–∞—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞":"–¢–µ–∞—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º")+" ",1),n[65]||(n[65]=e("span",{class:"shortcut-hint"},"Alt+T",-1))],512),[[z,m.value==="theater"]])]),e("div",_n,[e("button",{class:"aspect-ratio-dropdown-btn",onMouseenter:n[17]||(n[17]=C=>j("aspect_ratio")),onMouseleave:te,onClick:yo},[e("span",Cn,c(J.value),1)],32),O(e("div",{class:"custom-tooltip advanced-tooltip aspect-ratio-dropdown","data-tooltip":"aspect_ratio",onMouseenter:ye,onMouseleave:ce},[(a(),r(G,null,le(Be,C=>e("div",{key:C,class:A(["aspect-ratio-option",{active:J.value===C}]),onClick:na=>tt(C)},c(C),11,wn)),64))],544),[[z,m.value==="aspect_ratio"]])]),e("div",{class:"tooltip-container","data-tooltip-container":"centering",onMouseenter:n[19]||(n[19]=C=>j("centering")),onMouseleave:te},[e("button",{class:"center-btn",onClick:ee},n[66]||(n[66]=[e("span",{class:"material-icons"},"center_focus_strong",-1)])),O(e("div",{class:"custom-tooltip advanced-tooltip","data-tooltip":"centering",onMouseenter:ye,onMouseleave:ce},[n[67]||(n[67]=W(" –û—Ç—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–ª–µ–µ—Ä ")),ie(jo,{modelValue:ve.value,"onUpdate:modelValue":n[18]||(n[18]=C=>ve.value=C),title:"–ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞"},null,8,["modelValue"]),n[68]||(n[68]=e("span",{class:"tooltip-title"},"–ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞",-1))],544),[[z,m.value==="centering"]])],32),q.value?k("",!0):(a(),r("div",En,[e("button",{class:"app-link-btn",onMouseenter:n[20]||(n[20]=C=>j("app_link")),onMouseleave:n[21]||(n[21]=C=>m.value=null),onClick:uo},n[69]||(n[69]=[e("span",{class:"material-icons"},"open_in_new",-1)]),32),O(e("div",Mn," –û—Ç–∫—Ä—ã—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ",512),[[z,m.value==="app_link"]])])),q.value?(a(),r("div",In,[e("button",{class:"copy-link-btn",onMouseenter:n[22]||(n[22]=C=>j("copy_link")),onMouseleave:n[23]||(n[23]=C=>m.value=null),onClick:co},n[70]||(n[70]=[e("span",{class:"material-icons"},"content_copy",-1)]),32),O(e("div",$n," –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É ",512),[[z,m.value==="copy_link"]])])):k("",!0)],64))]),!N.value&&!We.value?(a(),r("div",Rn,[e("div",An,[e("button",{class:A(["favorite-btn",{active:(ft=(mt=l.movieInfo)==null?void 0:mt.lists)==null?void 0:ft.isFavorite}]),onMouseenter:n[24]||(n[24]=C=>j("favorite")),onMouseleave:n[25]||(n[25]=C=>m.value=null),onClick:n[26]||(n[26]=C=>Q(V(B).FAVORITE))},[e("span",Tn,c((kt=(yt=l.movieInfo)==null?void 0:yt.lists)!=null&&kt.isFavorite?"favorite":"favorite_border"),1)],34),O(e("div",Sn,c("–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ"),512),[[z,m.value==="favorite"]])]),e("div",Pn,[e("button",{class:A(["watching-btn",{active:(pt=(gt=l.movieInfo)==null?void 0:gt.lists)==null?void 0:pt.isWatching}]),onMouseenter:n[27]||(n[27]=C=>j("watching")),onMouseleave:n[28]||(n[28]=C=>m.value=null),onClick:n[29]||(n[29]=C=>Q(V(B).WATCHING))},[e("span",Ln,c((bt=(ht=l.movieInfo)==null?void 0:ht.lists)!=null&&bt.isWatching?"visibility_off":"visibility"),1)],34),O(e("div",xn,c("–°–º–æ—Ç—Ä—é"),512),[[z,m.value==="watching"]])]),e("div",Nn,[e("button",{class:A(["later-btn",{active:(Ct=(_t=l.movieInfo)==null?void 0:_t.lists)==null?void 0:Ct.isLater}]),onMouseenter:n[30]||(n[30]=C=>j("later")),onMouseleave:n[31]||(n[31]=C=>m.value=null),onClick:n[32]||(n[32]=C=>Q(V(B).LATER))},n[71]||(n[71]=[e("span",{class:"material-icons"},"watch_later",-1)]),34),O(e("div",jn,c("–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ"),512),[[z,m.value==="later"]])]),e("div",Un,[e("button",{class:A(["completed-btn",{active:(Et=(wt=l.movieInfo)==null?void 0:wt.lists)==null?void 0:Et.isCompleted}]),onMouseenter:n[33]||(n[33]=C=>j("completed")),onMouseleave:n[34]||(n[34]=C=>m.value=null),onClick:n[35]||(n[35]=C=>Q(V(B).COMPLETED))},[e("span",Dn,c((It=(Mt=l.movieInfo)==null?void 0:Mt.lists)!=null&&It.isCompleted?"check_circle":"check_circle_outline"),1)],34),O(e("div",Hn,c("–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"),512),[[z,m.value==="completed"]])]),e("div",Bn,[e("button",{class:A(["abandoned-btn",{active:(Rt=($t=l.movieInfo)==null?void 0:$t.lists)==null?void 0:Rt.isAbandoned}]),onMouseenter:n[36]||(n[36]=C=>j("abandoned")),onMouseleave:n[37]||(n[37]=C=>m.value=null),onClick:n[38]||(n[38]=C=>Q(V(B).ABANDONED))},[e("span",On,c(((Tt=(At=l.movieInfo)==null?void 0:At.lists)!=null&&Tt.isAbandoned,"not_interested")),1)],34),O(e("div",Kn,c("–ë—Ä–æ—à–µ–Ω–æ"),512),[[z,m.value==="abandoned"]])])])):N.value?(a(),r("div",qn,[e("div",Fn,[e("button",{class:A(["favorite-btn",{active:(Pt=(St=l.movieInfo)==null?void 0:St.lists)==null?void 0:Pt.isFavorite}]),onMouseenter:n[39]||(n[39]=C=>j("favorite")),onMouseleave:n[40]||(n[40]=C=>m.value=null),onClick:n[41]||(n[41]=C=>Q(V(B).FAVORITE))},[e("span",zn,c((xt=(Lt=l.movieInfo)==null?void 0:Lt.lists)!=null&&xt.isFavorite?"favorite":"favorite_border"),1)],34),O(e("div",Vn,c("–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ"),512),[[z,m.value==="favorite"]])]),e("div",Wn,[e("button",{class:A(["watching-btn",{active:(jt=(Nt=l.movieInfo)==null?void 0:Nt.lists)==null?void 0:jt.isWatching}]),onMouseenter:n[42]||(n[42]=C=>j("watching")),onMouseleave:n[43]||(n[43]=C=>m.value=null),onClick:n[44]||(n[44]=C=>Q(V(B).WATCHING))},[e("span",Yn,c((Dt=(Ut=l.movieInfo)==null?void 0:Ut.lists)!=null&&Dt.isWatching?"visibility_off":"visibility"),1)],34),O(e("div",Gn,c("–°–º–æ—Ç—Ä—é"),512),[[z,m.value==="watching"]])]),e("div",Zn,[e("button",{class:A(["later-btn",{active:(Bt=(Ht=l.movieInfo)==null?void 0:Ht.lists)==null?void 0:Bt.isLater}]),onMouseenter:n[45]||(n[45]=C=>j("later")),onMouseleave:n[46]||(n[46]=C=>m.value=null),onClick:n[47]||(n[47]=C=>Q(V(B).LATER))},n[72]||(n[72]=[e("span",{class:"material-icons"},"watch_later",-1)]),34),O(e("div",Xn,c("–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ"),512),[[z,m.value==="later"]])]),e("div",Qn,[e("button",{class:A(["completed-btn",{active:(Kt=(Ot=l.movieInfo)==null?void 0:Ot.lists)==null?void 0:Kt.isCompleted}]),onMouseenter:n[48]||(n[48]=C=>j("completed")),onMouseleave:n[49]||(n[49]=C=>m.value=null),onClick:n[50]||(n[50]=C=>Q(V(B).COMPLETED))},[e("span",Jn,c((Ft=(qt=l.movieInfo)==null?void 0:qt.lists)!=null&&Ft.isCompleted?"check_circle":"check_circle_outline"),1)],34),O(e("div",es,c("–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"),512),[[z,m.value==="completed"]])]),e("div",ts,[e("button",{class:A(["abandoned-btn",{active:(Vt=(zt=l.movieInfo)==null?void 0:zt.lists)==null?void 0:Vt.isAbandoned}]),onMouseenter:n[51]||(n[51]=C=>j("abandoned")),onMouseleave:n[52]||(n[52]=C=>m.value=null),onClick:n[53]||(n[53]=C=>Q(V(B).ABANDONED))},[e("span",os,c(((Yt=(Wt=l.movieInfo)==null?void 0:Wt.lists)!=null&&Yt.isAbandoned,"not_interested")),1)],34),O(e("div",ns,c("–ë—Ä–æ—à–µ–Ω–æ"),512),[[z,m.value==="abandoned"]])])])):k("",!0)])),ie(qe,{ref_key:"notificationRef",ref:Z},null,512)],64))}}},oo=_e(ss,[["__scopeId","data-v-2037cb5b"]]),is={key:0,class:"carousel-container"},ls={class:"carousel-wrapper"},as=["onClick"],rs=["src","alt"],us={class:"video-name"},ds={key:0,class:"video-player"},cs=["src"],vs={__name:"TrailerCarousel",props:{videos:{type:Array,required:!0},activeVideoIndex:{type:Number,default:null}},emits:["select"],setup(l,{emit:o}){const v=Oe(),s=U(()=>v.isMobile),_=l,w=o,p=g(_.activeVideoIndex),R=g(null),E=g(!1),t=g(!1),f=()=>{if(!R.value)return;const{scrollLeft:S,scrollWidth:T,clientWidth:h}=R.value;E.value=S>0,t.value=S<T-h-1},x=S=>{if(!R.value)return;const T=R.value.querySelector(".carousel-item");if(!T)return;const h=T.clientWidth+16;R.value.scrollBy({left:h*S,behavior:"smooth"})},K=S=>{p.value=S,w("select",_.videos[S])},P=()=>f(),D=g([]),F=async S=>{try{return(await fetch("https://img.youtube.com/vi/".concat(S,"/0.jpg"))).ok}catch(T){return!1}};return Ae(async()=>{const S=_.videos.map(async h=>await F(h.videoId)?h:null),T=await Promise.all(S);D.value=T.filter(Boolean),f(),window.addEventListener("resize",P)}),$e(()=>_.videos,async S=>{const T=S.map(async $=>await F($.videoId)?$:null),h=await Promise.all(T);D.value=h.filter(Boolean)}),$e(()=>_.activeVideoIndex,S=>{p.value=S}),Qe(()=>{window.removeEventListener("resize",P)}),(S,T)=>D.value.length?(a(),r("div",is,[T[4]||(T[4]=e("h2",null,"–¢—Ä–µ–π–ª–µ—Ä—ã (YouTube)",-1)),e("div",ls,[O(e("button",{class:"scroll-button left",onClick:T[0]||(T[0]=h=>x(-1))},T[2]||(T[2]=[e("span",{class:"material-symbols-outlined"},"arrow_back_ios",-1)]),512),[[z,!s.value&&E.value]]),e("div",{ref_key:"carousel",ref:R,class:"carousel",onScroll:f},[(a(!0),r(G,null,le(D.value,(h,$)=>(a(),r("div",{key:$,class:"carousel-item",onClick:M=>K($)},[e("img",{src:"https://img.youtube.com/vi/".concat(h.videoId,"/0.jpg"),alt:h.name},null,8,rs),e("div",us,c(h.name),1)],8,as))),128))],544),O(e("button",{class:"scroll-button right",onClick:T[1]||(T[1]=h=>x(1))},T[3]||(T[3]=[e("span",{class:"material-symbols-outlined"},"arrow_forward_ios",-1)]),512),[[z,!s.value&&t.value]])]),p.value!==null?(a(),r("div",ds,[e("iframe",{src:l.videos[p.value].iframeUrl,frameborder:"0",allowfullscreen:""},null,8,cs)])):k("",!0)])):k("",!0)}},ms=_e(vs,[["__scopeId","data-v-e60b5c29"]]),fs={class:"rating-container"},ys={class:"rating-display"},ks={class:"average-rating"},gs={class:"rating-numbers"},ps=["onClick","onMouseenter"],hs={key:0,class:"tooltip-footer"},bs={class:"rating-numbers mobile-rating-numbers"},_s=["onClick"],Cs={key:0,class:"mobile-modal-footer"},ws={__name:"MovieRating",props:{kpId:{type:String,required:!0},showDash:{type:Boolean,default:!1}},setup(l){const o=Oe(),v=Ke(),s=l,_=g(null),w=g(null),p=g(null),R=g(null),E=g(0),t=g(!1),f=g(!1);let x=null;const K=M=>M?M.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "):"0",P=()=>{x=setTimeout(()=>{t.value=!1,o.isMobile||(f.value=!1)},100)},D=()=>{x&&(clearTimeout(x),x=null),t.value=!0},F=()=>{o.isMobile&&(f.value=!f.value)},S=()=>{v.push("/login")},T=async()=>{try{const M=await _o(s.kpId);w.value=M.user_rating,p.value=M.average_rating,R.value=K(M.vote_count)}catch(M){console.error("Error loading rating:",M)}},h=async M=>{var H;try{M===w.value?(await Gt(s.kpId,null),w.value=null,_.value.showNotification("–û—Ü–µ–Ω–∫–∞ —É–¥–∞–ª–µ–Ω–∞")):(await Gt(s.kpId,M),w.value=M,_.value.showNotification("–û—Ü–µ–Ω–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞")),o.isMobile&&(f.value=!1),T()}catch(N){console.error("Error setting rating:",N),((H=N.response)==null?void 0:H.status)===401?_.value.showNotification('–î–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:S}):_.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ—Ü–µ–Ω–∫–∏"),o.isMobile&&(f.value=!1)}},$=()=>{f.value=!1};return Ae(()=>{T()}),(M,H)=>(a(),r("div",fs,[e("div",ys,[e("a",{href:"#",class:A(["rating-link",{"has-rating":w.value}]),onMouseenter:H[0]||(H[0]=N=>t.value=!0),onMouseleave:P,onClick:je(F,["prevent"])},[H[3]||(H[3]=e("img",{src:xo,alt:"ReYohoho",class:"rating-logo"},null,-1)),e("span",ks,c(p.value?p.value.toFixed(1).replace(/\.0$/,""):"‚Äî"),1)],34),O(e("div",{class:"rating-tooltip",onMouseenter:D,onMouseleave:P},[e("div",gs,[(a(),r(G,null,le(10,N=>e("button",{key:N,class:A(["number-btn",{active:N===w.value,hover:N===E.value,"average-highlight":p.value&&N<=Math.round(p.value)}]),onClick:q=>h(N),onMouseenter:q=>E.value=N,onMouseleave:H[1]||(H[1]=q=>E.value=0)},c(N),43,ps)),64))]),R.value?(a(),r("div",hs,"–û—Ü–µ–Ω–æ–∫: "+c(R.value),1)):k("",!0)],544),[[z,(t.value||f.value)&&!V(o).isMobile]])]),ie(qe,{ref_key:"notificationRef",ref:_},null,512),V(o).isMobile&&f.value?(a(),r("div",{key:0,class:"mobile-modal-overlay",onClick:$},[e("div",{class:"mobile-modal",onClick:H[2]||(H[2]=je(()=>{},["stop"]))},[e("div",{class:"mobile-modal-header"},[H[4]||(H[4]=e("h3",null,"–û—Ü–µ–Ω–∏—Ç—å —Ñ–∏–ª—å–º",-1)),e("button",{class:"close-button",onClick:$},"√ó")]),e("div",bs,[(a(),r(G,null,le(10,N=>e("button",{key:N,class:A(["number-btn",{active:N===w.value,"average-highlight":p.value&&N<=Math.round(p.value)}]),onClick:q=>h(N)},c(N),11,_s)),64))]),R.value?(a(),r("div",Cs,"–û—Ü–µ–Ω–æ–∫: "+c(R.value),1)):k("",!0)])])):k("",!0)]))}},Es=_e(ws,[["__scopeId","data-v-4ab3d1d2"]]),Ms={name:"EmojiPicker",props:{isVisible:{type:Boolean,default:!1}},emits:["emoji-selected","mouse-enter","mouse-leave","close"],data(){return{activeCategory:"smileys",categories:[{name:"smileys",icon:"üòÄ",emojis:["üòÄ","üòÉ","üòÑ","üòÅ","üòÜ","üòÖ","üòÇ","ü§£","üòä","üòá","üôÇ","üôÉ","üòâ","üòå","üòç","ü•∞","üòò","üòó","üòô","üòö","üòã","üòõ","üòù","üòú","ü§™","ü§®","üßê","ü§ì","üòé","ü§©","ü•≥"]},{name:"emotions",icon:"üò¢",emojis:["üò•","üò¢","üò≠","üò§","üò†","üò°","ü§¨","ü§Ø","üò≥","ü•µ","ü•∂","üò±","üò®","üò∞","üò•","üòì","ü§ó","ü§î","ü§≠","ü§´","ü§•","üò∂","üòê","üòë","üò¨","üôÑ","üòØ","üò¶","üòß","üòÆ","üò≤"]},{name:"gestures",icon:"üëç",emojis:["üëç","üëé","üëå","ü§å","ü§è","‚úåÔ∏è","ü§û","ü§ü","ü§ò","ü§ô","üëà","üëâ","üëÜ","üñï","üëá","‚òùÔ∏è","üëè","üôå","üëê","ü§≤","ü§ù","üôè","‚úçÔ∏è","üí™","ü¶æ","ü¶ø","ü¶µ","ü¶∂","üëÇ","ü¶ª","üëÉ"]},{name:"hearts",icon:"‚ù§Ô∏è",emojis:["‚ù§Ô∏è","üß°","üíõ","üíö","üíô","üíú","ü§é","üñ§","ü§ç","üíî","‚ù£Ô∏è","üíï","üíû","üíì","üíó","üíñ","üíò","üíù","üíü","‚ô•Ô∏è","üíØ","üí¢","üí•","üí´","üí¶","üí®","üï≥Ô∏è","üí£","üí¨","üëÅÔ∏è‚Äçüó®Ô∏è","üó®Ô∏è"]},{name:"objects",icon:"üéâ",emojis:["üéâ","üéä","üéà","üéÅ","üéÄ","üéÇ","üç∞","üßÅ","üç≠","üç¨","üç´","üç©","üç™","üçï","üçî","üçü","üå≠","ü•™","üåÆ","üåØ","ü•ô","ü•ö","üç≥","ü•ò","üç≤","ü•ó","üçø","üßà","üßÄ","ü•®","ü•Ø"]}]}},computed:{currentEmojis(){const l=this.categories.find(o=>o.name===this.activeCategory);return l?l.emojis:[]}},methods:{selectEmoji(l){this.$emit("emoji-selected",l)}}},Is={class:"emoji-categories"},$s=["onClick"],Rs={class:"emoji-grid"},As=["onClick"];function Ts(l,o,v,s,_,w){return v.isVisible?(a(),r("div",{key:0,class:"emoji-picker",onMouseenter:o[1]||(o[1]=p=>l.$emit("mouse-enter")),onMouseleave:o[2]||(o[2]=p=>l.$emit("mouse-leave"))},[e("button",{class:"close-btn mobile-only",onClick:o[0]||(o[0]=p=>l.$emit("close"))},o[3]||(o[3]=[e("i",{class:"fas fa-times"},null,-1)])),e("div",Is,[(a(!0),r(G,null,le(_.categories,p=>(a(),r("button",{key:p.name,onClick:R=>_.activeCategory=p.name,class:A([{active:_.activeCategory===p.name},"category-btn"]),type:"button"},c(p.icon),11,$s))),128))]),e("div",Rs,[(a(!0),r(G,null,le(w.currentEmojis,p=>(a(),r("button",{key:p,onClick:R=>w.selectEmoji(p),class:"emoji-btn",type:"button"},c(p),9,As))),128))])],32)):k("",!0)}const Je=_e(Ms,[["render",Ts],["__scopeId","data-v-5f18a3b7"]]),Ss={name:"CommentItem",components:{EmojiPicker:Je},props:{comment:{type:Object,required:!0,default:()=>({username:"–ê–Ω–æ–Ω–∏–º",user_avatar:null,content:"",created_at:new Date().toISOString(),rating:0,replies:[]})},currentUser:{type:Object,required:!0,default:()=>({})},editingCommentId:{type:Number,default:null}},emits:["reply","start-edit","cancel-edit","edit","delete","rate"],setup(l,{emit:o}){var I,u;const v=Ke(),s=U(()=>{var i;return l.editingCommentId===((i=l.comment)==null?void 0:i.id)}),_=g(((I=l.comment)==null?void 0:I.content)||""),w=g(((u=l.comment)==null?void 0:u.user_rating)||0),p=g(null),R=g(null),E=g(!1),t=g(!1),f=g(!1),x=i=>{if(!i)return"?";const d=i.split(" ");return d.length===1?i.slice(0,2).toUpperCase():(d[0][0]+d[d.length-1][0]).toUpperCase()},K=i=>{if(!i)return"";const d=i.substring(0,4),y=i.substring(4,6),Y=i.substring(6,8),ee=i.substring(9,11),ne=i.substring(11,13),he=i.substring(13,15);return new Date(Date.UTC(parseInt(d),parseInt(y)-1,parseInt(Y),parseInt(ee),parseInt(ne),parseInt(he))).toLocaleDateString("ru-RU",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone})};Ae(async()=>{var i;if((i=l.comment)!=null&&i.user_avatar){const d=await Co();p.value="".concat(d).concat(l.comment.user_avatar)}});const P=U(()=>{var i;return l.currentUser&&((i=l.comment)==null?void 0:i.user_id)===l.currentUser.id}),D=U(()=>{var i;return l.currentUser&&((i=l.comment)==null?void 0:i.user_id)===l.currentUser.id||l.currentUser&&l.currentUser.is_admin===1}),F=U(()=>{var i,d,y;return((i=l.comment)==null?void 0:i.updated_at)&&((d=l.comment)==null?void 0:d.updated_at)!==((y=l.comment)==null?void 0:y.created_at)}),S=U(()=>{var i,d;return(i=l.comment)!=null&&i.is_deleted?!1:(((d=l.comment)==null?void 0:d.rating)||0)<=-3}),T=U(()=>S.value),h=g(!1),$=U(()=>{var i,d;return(i=l.comment)!=null&&i.is_deleted?null:(((d=l.comment)==null?void 0:d.rating)||0)<=-3?"lowRating":null}),M=()=>{var i,d;o("start-edit",(i=l.comment)==null?void 0:i.id),_.value=((d=l.comment)==null?void 0:d.content)||"",pe(()=>{R.value&&(R.value.focus(),j({target:R.value}))})},H=()=>{var i;o("cancel-edit"),_.value=((i=l.comment)==null?void 0:i.content)||""},N=()=>{var i;_.value.trim()&&o("edit",(i=l.comment)==null?void 0:i.id,_.value.trim())},q=()=>{var i;confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π?")&&o("delete",(i=l.comment)==null?void 0:i.id)},m=i=>{var d,y;w.value===i?(w.value=0,o("rate",(d=l.comment)==null?void 0:d.id,i)):(w.value=i,o("rate",(y=l.comment)==null?void 0:y.id,i))},ue=()=>{var i;v.push("/lists/".concat((i=l.comment)==null?void 0:i.user_id))},me=i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),N())},Z=U(()=>{var i,d;return((d=(i=l.comment)==null?void 0:i.content)==null?void 0:d.length)>300}),X=g(!1),de=U(()=>{var i,d,y;return Z.value&&!X.value?((d=(i=l.comment)==null?void 0:i.content)==null?void 0:d.slice(0,300))+"...":((y=l.comment)==null?void 0:y.content)||""}),fe=()=>{X.value=!X.value},j=i=>{const d=i.target;d&&(d.style.height="auto",d.style.height="".concat(Math.min(d.scrollHeight,200),"px"))},te=i=>{const d=R.value;if(d){const y=d.selectionStart,Y=d.selectionEnd,ee=_.value.substring(0,y),ne=_.value.substring(Y);_.value=ee+i+ne,pe(()=>{d.focus(),d.setSelectionRange(y+i.length,y+i.length),j({target:d})})}else _.value+=i},ye=()=>{f.value=!0},ce=()=>{f.value=!1,setTimeout(()=>{!f.value&&!t.value&&(E.value=!1)},300)},J=()=>{E.value=!1},ve=()=>{t.value=!0,E.value=!0},oe=()=>{t.value=!1,setTimeout(()=>{!f.value&&!t.value&&(E.value=!1)},300)};return $e(_,()=>{s.value&&R.value&&pe(()=>{j({target:R.value})})}),{isEditing:s,editContent:_,userRating:w,isCommentOwner:P,canDeleteComment:D,isCommentEdited:F,formatDate:K,startEdit:M,cancelEdit:H,saveEdit:N,confirmDelete:q,rateComment:m,avatarUrl:p,getInitials:x,goToUserLists:ue,handleEditKeydown:me,isCommentHidden:T,showHiddenComment:h,hiddenCommentReason:$,isLongComment:Z,isExpanded:X,displayedText:de,toggleExpanded:fe,autoResizeEdit:j,editTextarea:R,showEmojiPicker:E,insertEmojiEdit:te,handleEmojiMouseEnter:ye,handleEmojiMouseLeave:ce,closeEmojiPicker:J,handleButtonMouseEnter:ve,handleButtonMouseLeave:oe}}},Ps=["data-comment-id"],Ls={class:"comment-header"},xs={class:"user-info"},Ns=["href"],js={class:"user-avatar"},Us=["alt"],Ds={key:1,class:"avatar-placeholder"},Hs=["href"],Bs={class:"date"},Os={key:0,class:"edited-indicator"},Ks={class:"comment-content"},qs={key:0,class:"hidden-comment-warning"},Fs={key:1},zs={key:0,class:"deleted-comment"},Vs={key:1},Ws={key:0,class:"edit-form"},Ys={class:"edit-textarea-container"},Gs={class:"edit-footer"},Zs={class:"edit-actions"},Xs=["disabled"],Qs={class:"character-counter-container"},Js={key:1,class:"comment-text-container"},ei={class:"comment-footer"},ti={class:"comment-actions"},oi={class:"rating-buttons"},ni={class:"action-buttons"};function si(l,o,v,s,_,w){var E,t,f,x,K,P,D,F,S,T,h,$,M,H,N,q;const p=Ie("EmojiPicker"),R=wo("lazy");return a(),r("div",{class:"comment-item","data-comment-id":(E=v.comment)==null?void 0:E.id},[e("div",Ls,[e("div",xs,[e("a",{href:"/lists/".concat((t=v.comment)==null?void 0:t.user_id),target:"_blank",rel:"noopener noreferrer",class:"user-avatar-link"},[e("div",js,[s.avatarUrl?O((a(),r("img",{key:0,alt:((f=v.comment)==null?void 0:f.username)||"–ê–Ω–æ–Ω–∏–º"},null,8,Us)),[[R,s.avatarUrl]]):(a(),r("div",Ds,c(s.getInitials(((x=v.comment)==null?void 0:x.username)||"–ê–Ω–æ–Ω–∏–º")),1))])],8,Ns),e("div",null,[e("a",{href:"/lists/".concat((K=v.comment)==null?void 0:K.user_id),target:"_blank",rel:"noopener noreferrer",class:"username-link"},c(((P=v.comment)==null?void 0:P.username)||"–ê–Ω–æ–Ω–∏–º"),9,Hs),e("span",Bs,[W(c(s.formatDate((D=v.comment)==null?void 0:D.created_at))+" ",1),s.isCommentEdited?(a(),r("span",Os," (–∏–∑–º–µ–Ω–µ–Ω–æ "+c(s.formatDate((F=v.comment)==null?void 0:F.updated_at))+") ",1)):k("",!0)])])])]),e("div",Ks,[!((S=v.comment)!=null&&S.is_deleted)&&s.isCommentHidden&&!s.showHiddenComment?(a(),r("div",qs,[s.hiddenCommentReason==="lowRating"?(a(),r("p",{key:0,class:"warning-text",onClick:o[0]||(o[0]=m=>s.showHiddenComment=!0)},o[14]||(o[14]=[e("i",{class:"fas fa-eye-slash"},null,-1),W(" –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–∫—Ä—ã—Ç –∏–∑-–∑–∞ –Ω–∏–∑–∫–æ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞. –ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å. ")]))):k("",!0)])):(a(),r("div",Fs,[(T=v.comment)!=null&&T.is_deleted?(a(),r("div",zs,o[15]||(o[15]=[e("p",{class:"deleted-message"},[e("i",{class:"fas fa-trash"}),W(" –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É–¥–∞–ª—ë–Ω ")],-1)]))):(a(),r("div",Vs,[s.isEditing?(a(),r("div",Ws,[e("div",Ys,[O(e("textarea",{ref:"editTextarea","onUpdate:modelValue":o[1]||(o[1]=m=>s.editContent=m),class:"edit-textarea",rows:"3",maxlength:"1500",onKeydown:o[2]||(o[2]=(...m)=>s.handleEditKeydown&&s.handleEditKeydown(...m)),onInput:o[3]||(o[3]=(...m)=>s.autoResizeEdit&&s.autoResizeEdit(...m))},null,544),[[lo,s.editContent]])]),e("div",Gs,[e("div",Zs,[e("button",{onClick:o[4]||(o[4]=(...m)=>s.cancelEdit&&s.cancelEdit(...m)),class:"cancel-button"},"–û—Ç–º–µ–Ω–∞"),e("button",{onClick:o[5]||(o[5]=(...m)=>s.saveEdit&&s.saveEdit(...m)),class:"save-button",disabled:!s.editContent.trim()||s.editContent.length>1500}," –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ",8,Xs)]),e("div",Qs,[e("div",{class:A(["character-counter-inline",{"near-limit":s.editContent.length>1400,"at-limit":s.editContent.length>=1500}])},c(s.editContent.length)+"/1500 ",3),e("button",{type:"button",class:A(["emoji-button-inline",{active:s.showEmojiPicker}]),onMouseenter:o[6]||(o[6]=(...m)=>s.handleButtonMouseEnter&&s.handleButtonMouseEnter(...m)),onMouseleave:o[7]||(o[7]=(...m)=>s.handleButtonMouseLeave&&s.handleButtonMouseLeave(...m))}," üòä ",34),ie(p,{"is-visible":s.showEmojiPicker,onEmojiSelected:s.insertEmojiEdit,onMouseEnter:s.handleEmojiMouseEnter,onMouseLeave:s.handleEmojiMouseLeave,onClose:s.closeEmojiPicker},null,8,["is-visible","onEmojiSelected","onMouseEnter","onMouseLeave","onClose"])])])])):(a(),r("div",Js,[e("p",{class:A(["comment-text",{truncated:s.isLongComment&&!s.isExpanded}])},c(s.displayedText),3),s.isLongComment?(a(),r("button",{key:0,onClick:o[8]||(o[8]=(...m)=>s.toggleExpanded&&s.toggleExpanded(...m)),class:"expand-button"},c(s.isExpanded?"–°–≤–µ—Ä–Ω—É—Ç—å":"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å"),1)):k("",!0)]))]))]))]),e("div",ei,[e("div",ti,[e("div",oi,[!s.isCommentOwner&&!((h=v.comment)!=null&&h.is_deleted)?(a(),r("button",{key:0,onClick:o[9]||(o[9]=m=>s.rateComment(1)),class:A(["rating-button",{"rated-up":s.userRating===1}])},o[16]||(o[16]=[e("i",{class:"fas fa-thumbs-up"},null,-1)]),2)):k("",!0),e("span",{class:A(["rating-count",{"rating-positive":s.userRating===1,"rating-negative":s.userRating===-1}])},c((($=v.comment)==null?void 0:$.rating)||0),3),!s.isCommentOwner&&!((M=v.comment)!=null&&M.is_deleted)?(a(),r("button",{key:1,onClick:o[10]||(o[10]=m=>s.rateComment(-1)),class:A(["rating-button",{"rated-down":s.userRating===-1}])},o[17]||(o[17]=[e("i",{class:"fas fa-thumbs-down"},null,-1)]),2)):k("",!0)]),e("div",ni,[!v.currentUser||v.currentUser.allow_comments===1?(a(),r("button",{key:0,onClick:o[11]||(o[11]=m=>l.$emit("reply",v.comment)),class:"action-button reply-button"},o[18]||(o[18]=[e("i",{class:"fas fa-reply"},null,-1)]))):k("",!0),s.isCommentOwner&&!((H=v.comment)!=null&&H.is_deleted)&&!s.isEditing&&((N=v.currentUser)==null?void 0:N.allow_comments)===1?(a(),r("button",{key:1,onClick:o[12]||(o[12]=(...m)=>s.startEdit&&s.startEdit(...m)),class:"action-button edit-button"},o[19]||(o[19]=[e("i",{class:"fas fa-edit"},null,-1)]))):k("",!0),s.canDeleteComment&&!((q=v.comment)!=null&&q.is_deleted)?(a(),r("button",{key:2,onClick:o[13]||(o[13]=(...m)=>s.confirmDelete&&s.confirmDelete(...m)),class:"action-button delete-button"},o[20]||(o[20]=[e("i",{class:"fas fa-trash"},null,-1)]))):k("",!0)])])])],8,Ps)}const ii=_e(Ss,[["render",si],["__scopeId","data-v-4280e7b7"]]),li={name:"CommentThread",components:{CommentItem:ii,EmojiPicker:Je},props:{comment:{type:Object,required:!0},currentUser:{type:Object,required:!0},replyTo:{type:Object,default:null},replyContent:{type:String,default:""},editingCommentId:{type:Number,default:null}},emits:["reply","start-edit","cancel-edit","edit","delete","rate","submit-reply","cancel-reply","update-reply-content","reply-keydown"],data(){return{isCollapsed:!0,showEmojiPicker:!1,isButtonHovered:!1,isEmojiHovered:!1}},computed:{canReply(){return this.currentUser?this.currentUser.allow_comments===1:!0},getReplyPlaceholder(){return this.currentUser?this.currentUser.allow_comments!==1?"–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤":"–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç...":"–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç..."}},watch:{replyTo:{handler(l){l&&l.id===this.comment.id&&this.$nextTick(()=>{this.$refs.replyTextarea&&this.$refs.replyTextarea.focus()})},immediate:!0},"comment.replies":{handler(l,o){l&&o&&l.length>o.length&&(this.isCollapsed=!1)},deep:!0}},methods:{toggleCollapsed(){this.isCollapsed=!this.isCollapsed},handleReplyInput(l){this.$emit("update-reply-content",l.target.value);const o=l.target;o&&(o.style.height="auto",o.style.height="".concat(Math.min(o.scrollHeight,200),"px"))},insertEmoji(l){const o=this.$refs.replyTextarea;if(o){const v=o.selectionStart,s=o.selectionEnd,_=o.value,w=_.substring(0,v),p=_.substring(s);o.value=w+l+p,this.$emit("update-reply-content",o.value),this.$nextTick(()=>{o.focus(),o.setSelectionRange(v+l.length,v+l.length),this.handleReplyInput({target:o})})}},handleEmojiMouseEnter(){this.isEmojiHovered=!0},handleEmojiMouseLeave(){this.isEmojiHovered=!1,setTimeout(()=>{!this.isEmojiHovered&&!this.isButtonHovered&&(this.showEmojiPicker=!1)},300)},handleButtonMouseEnter(){this.isButtonHovered=!0,this.showEmojiPicker=!0},handleButtonMouseLeave(){this.isButtonHovered=!1,setTimeout(()=>{!this.isEmojiHovered&&!this.isButtonHovered&&(this.showEmojiPicker=!1)},300)},closeEmojiPicker(){this.showEmojiPicker=!1}},mounted(){},beforeUnmount(){}},ai={class:"comment-thread"},ri={key:0,class:"reply-form"},ui={class:"textarea-container"},di=["value","placeholder","disabled"],ci={class:"reply-footer"},vi={class:"reply-actions"},mi=["disabled"],fi={class:"character-counter-container"},yi=["disabled"],ki={key:1,class:"replies-container"},gi=["title"],pi={class:"replies-count"},hi=["title"],bi={key:0,class:"replies-content"};function _i(l,o,v,s,_,w){const p=Ie("CommentItem"),R=Ie("EmojiPicker"),E=Ie("CommentThread",!0);return a(),r("div",ai,[ie(p,{comment:v.comment,"current-user":v.currentUser,"editing-comment-id":v.editingCommentId,onReply:o[0]||(o[0]=t=>l.$emit("reply",t)),onStartEdit:o[1]||(o[1]=t=>l.$emit("start-edit",t)),onCancelEdit:o[2]||(o[2]=t=>l.$emit("cancel-edit")),onEdit:o[3]||(o[3]=(t,f)=>l.$emit("edit",t,f)),onDelete:o[4]||(o[4]=t=>l.$emit("delete",t)),onRate:o[5]||(o[5]=(t,f)=>l.$emit("rate",t,f))},null,8,["comment","current-user","editing-comment-id"]),v.replyTo&&v.replyTo.id===v.comment.id?(a(),r("div",ri,[e("div",ui,[e("textarea",{ref:"replyTextarea",class:"comment-textarea",value:v.replyContent,onInput:o[6]||(o[6]=(...t)=>w.handleReplyInput&&w.handleReplyInput(...t)),placeholder:w.getReplyPlaceholder,disabled:v.currentUser&&v.currentUser.allow_comments!==1,rows:"3",maxlength:"1500",onKeydown:o[7]||(o[7]=t=>l.$emit("reply-keydown",t))},null,40,di)]),e("div",ci,[e("div",vi,[e("button",{class:"cancel-reply",onClick:o[8]||(o[8]=t=>l.$emit("cancel-reply"))},"–û—Ç–º–µ–Ω–∞"),e("button",{class:"submit-button",disabled:!v.replyContent.trim()||v.replyContent.length>1500||v.currentUser&&v.currentUser.allow_comments!==1,onClick:o[9]||(o[9]=t=>l.$emit("submit-reply"))}," –û—Ç–≤–µ—Ç–∏—Ç—å ",8,mi)]),e("div",fi,[e("div",{class:A(["character-counter-inline",{"near-limit":v.replyContent.length>1400,"at-limit":v.replyContent.length>=1500}])},c(v.replyContent.length)+"/1500 ",3),e("button",{type:"button",class:A(["emoji-button-inline",{active:_.showEmojiPicker}]),onMouseenter:o[10]||(o[10]=(...t)=>w.handleButtonMouseEnter&&w.handleButtonMouseEnter(...t)),onMouseleave:o[11]||(o[11]=(...t)=>w.handleButtonMouseLeave&&w.handleButtonMouseLeave(...t)),disabled:v.currentUser&&v.currentUser.allow_comments!==1}," üòä ",42,yi),ie(R,{"is-visible":_.showEmojiPicker&&w.canReply,onEmojiSelected:w.insertEmoji,onMouseEnter:w.handleEmojiMouseEnter,onMouseLeave:w.handleEmojiMouseLeave,onClose:w.closeEmojiPicker},null,8,["is-visible","onEmojiSelected","onMouseEnter","onMouseLeave","onClose"])])])])):k("",!0),v.comment.replies&&v.comment.replies.length>0?(a(),r("div",ki,[e("button",{class:"collapse-toggle",onClick:o[12]||(o[12]=(...t)=>w.toggleCollapsed&&w.toggleCollapsed(...t)),title:_.isCollapsed?"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç—ã":"–°–≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç—ã"},[e("span",{class:A(["collapse-icon",{expanded:!_.isCollapsed}])},o[24]||(o[24]=[e("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor"},[e("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})],-1)]),2),e("span",pi,c(v.comment.replies.length)+" "+c(v.comment.replies.length===1?"–æ—Ç–≤–µ—Ç":"–æ—Ç–≤–µ—Ç–æ–≤"),1)],8,gi),e("div",{class:"vertical-line-clickable",onClick:o[13]||(o[13]=(...t)=>w.toggleCollapsed&&w.toggleCollapsed(...t)),title:_.isCollapsed?"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç—ã":"–°–≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç—ã"},[e("div",{class:A(["vertical-line-visual",{collapsed:_.isCollapsed}])},null,2)],8,hi),_.isCollapsed?k("",!0):(a(),r("div",bi,[(a(!0),r(G,null,le(v.comment.replies,t=>(a(),be(E,{key:t.id,comment:t,"current-user":v.currentUser,"reply-to":v.replyTo,"reply-content":v.replyContent,"editing-comment-id":v.editingCommentId,onReply:o[14]||(o[14]=f=>l.$emit("reply",f)),onStartEdit:o[15]||(o[15]=f=>l.$emit("start-edit",f)),onCancelEdit:o[16]||(o[16]=f=>l.$emit("cancel-edit")),onEdit:o[17]||(o[17]=(f,x)=>l.$emit("edit",f,x)),onDelete:o[18]||(o[18]=f=>l.$emit("delete",f)),onRate:o[19]||(o[19]=(f,x)=>l.$emit("rate",f,x)),onSubmitReply:o[20]||(o[20]=f=>l.$emit("submit-reply")),onCancelReply:o[21]||(o[21]=f=>l.$emit("cancel-reply")),onUpdateReplyContent:o[22]||(o[22]=f=>l.$emit("update-reply-content",f)),onReplyKeydown:o[23]||(o[23]=f=>l.$emit("reply-keydown",f))},null,8,["comment","current-user","reply-to","reply-content","editing-comment-id"]))),128))]))])):k("",!0)])}const Ci=_e(li,[["render",_i],["__scopeId","data-v-679a760a"]]),wi={name:"Comments",components:{CommentThread:Ci,Notification:qe,EmojiPicker:Je},props:{movieId:{type:[String,Number],required:!0}},setup(l){const o=Xe(),v=Ke(),s=g([]),_=g(""),w=g(null),p=g(""),R=g(null),E=g(o.user),t=g(null),f=g(null),x=g(!1),K=g(!1),P=g(!1),D=g(!1),F=g(!1),S=U(()=>{const i=(d=null)=>s.value.filter(y=>y.parent_id===d).sort((y,Y)=>y.id-Y.id).map(y=>({...y,replies:i(y.id)}));return i()}),T=U(()=>{const i=d=>d.reduce((y,Y)=>y+1+i(Y.replies||[]),0);return i(S.value)}),h=i=>i===1?"–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π":i>=2&&i<=4?"–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è":"–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤",$=async()=>{try{const i=await Eo(l.movieId);s.value=i}catch(i){console.error("Failed to load comments:",i),t.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.")}},M=async()=>{if(!F.value){if(!o.token){t.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:X});return}if(E.value&&E.value.allow_comments!==1){t.value.showNotification("–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤");return}if(_.value.trim()){if(_.value.length>1500){t.value.showNotification("–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π. –ú–∞–∫—Å–∏–º—É–º 1500 —Å–∏–º–≤–æ–ª–æ–≤.");return}try{await Zt(l.movieId,_.value.trim()),_.value="",await $(),x.value=!0,pe(()=>{f.value&&(f.value.focus(),f.value.style.height="auto"),setTimeout(()=>{const i=document.querySelectorAll(".comment-item[data-comment-id]");if(i.length>0){const d=Array.from(i).map(y=>parseInt(y.getAttribute("data-comment-id"))).filter(y=>!isNaN(y));if(d.length>0){const y=Math.max(...d),Y=document.querySelector('[data-comment-id="'.concat(y,'"]'));Y&&Y.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}}},300)})}catch(i){console.error("Failed to create comment:",i),t.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")}}}},H=i=>{if(!o.token){t.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:X});return}R.value=null,w.value=i,p.value="",pe(()=>{const d=document.querySelector(".reply-form");d&&d.scrollIntoView({behavior:"smooth",block:"center"})})},N=async()=>{if(!o.token){t.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:X});return}if(E.value&&E.value.allow_comments!==1){t.value.showNotification("–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤");return}if(!(!p.value.trim()||!w.value)){if(p.value.length>1500){t.value.showNotification("–û—Ç–≤–µ—Ç —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π. –ú–∞–∫—Å–∏–º—É–º 1500 —Å–∏–º–≤–æ–ª–æ–≤.");return}try{await Zt(l.movieId,p.value.trim(),w.value.id);const i=w.value.id;await $(),p.value="",w.value=null,pe(()=>{setTimeout(()=>{const d=document.querySelector('[data-comment-id="'.concat(i,'"]'));if(d){const y=d.querySelector(".replies-content");if(y){const Y=y.querySelectorAll(".comment-item[data-comment-id]");if(Y.length>0){const ee=Array.from(Y).map(ne=>parseInt(ne.getAttribute("data-comment-id"))).filter(ne=>!isNaN(ne));if(ee.length>0){const ne=Math.max(...ee),he=document.querySelector('[data-comment-id="'.concat(ne,'"]'));he&&he.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}}}}},300)})}catch(i){console.error("Error submitting reply:",i),t.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ—Ç–≤–µ—Ç–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")}}},q=async(i,d)=>{if(!o.token){t.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:X});return}if(E.value&&E.value.allow_comments!==1){t.value.showNotification("–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤");return}if(d.length>1500){t.value.showNotification("–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π. –ú–∞–∫—Å–∏–º—É–º 1500 —Å–∏–º–≤–æ–ª–æ–≤.");return}try{await $o(i,d.trim()),await $(),R.value=null}catch(y){console.error("Failed to update comment:",y),t.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")}},m=async i=>{if(!o.token){t.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:X});return}try{await Io(i),await $()}catch(d){console.error("Failed to delete comment:",d),t.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")}},ue=async(i,d)=>{if(!o.token){t.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:X});return}try{await Mo(i,d),await $()}catch(y){console.error("Failed to rate comment:",y),t.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ü–µ–Ω–∫–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")}},me=i=>{F.value||K.value||i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),M())},Z=i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),N())},X=()=>{v.push("/login")},de=i=>{const d=(i==null?void 0:i.target)||f.value;d&&(d.style.height="auto",d.style.height="".concat(Math.min(d.scrollHeight,200),"px"))},fe=i=>{if(F.value=!0,f.value){const d=f.value.selectionStart,y=f.value.selectionEnd;_.value=_.value.slice(0,d)+i+_.value.slice(y),pe(()=>{f.value.focus(),f.value.setSelectionRange(d+i.length,d+i.length),de(),setTimeout(()=>{F.value=!1},100)})}else F.value=!1},j=()=>{P.value=!0},te=()=>{P.value=!1,setTimeout(()=>{!P.value&&!D.value&&(K.value=!1)},300)},ye=()=>{K.value=!1},ce=()=>{D.value=!1,setTimeout(()=>{!P.value&&!D.value&&(K.value=!1)},300)},J=()=>{D.value=!0,K.value=!0},ve=U(()=>E.value?E.value.allow_comments!==1?"–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤":"–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π...":"–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."),oe=U(()=>E.value?E.value.allow_comments===1:!0),I=i=>{w.value=null,p.value="",R.value=i},u=()=>{R.value=null};return Ae(()=>{$()}),Qe(()=>{}),{comments:s,groupedComments:S,newComment:_,replyTo:w,replyContent:p,editingCommentId:R,currentUser:E,notificationRef:t,commentTextarea:f,showComments:x,submitComment:M,handleReply:H,submitReply:N,handleEdit:q,handleDelete:m,handleRate:ue,handleCommentKeydown:me,handleReplyKeydown:Z,autoResize:de,totalCommentsCount:T,getCommentWordForm:h,showEmojiPicker:K,insertEmoji:fe,handleEmojiMouseEnter:j,handleEmojiMouseLeave:te,closeEmojiPicker:ye,handleButtonMouseLeave:ce,handleButtonMouseEnter:J,getCommentPlaceholder:ve,canComment:oe,handleStartEdit:I,handleCancelEdit:u}}},Ei={class:"comments-section"},Mi={class:"textarea-container"},Ii=["placeholder","disabled"],$i={class:"comment-footer"},Ri={class:"comment-actions"},Ai=["disabled"],Ti={class:"character-counter-container"},Si=["disabled"],Pi={key:0},Li={class:"spoiler-content"},xi={class:"comments-count"},Ni={key:1,class:"comments-container"},ji={class:"comments-header"},Ui={class:"comments-list"};function Di(l,o,v,s,_,w){const p=Ie("EmojiPicker"),R=Ie("CommentThread"),E=Ie("Notification");return a(),r("div",Ei,[o[15]||(o[15]=e("h2",{class:"comments-title"},"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏",-1)),e("form",{class:"comment-form",onSubmit:o[5]||(o[5]=je((...t)=>s.submitComment&&s.submitComment(...t),["prevent"]))},[e("div",Mi,[O(e("textarea",{ref:"commentTextarea","onUpdate:modelValue":o[0]||(o[0]=t=>s.newComment=t),class:"comment-textarea",placeholder:s.getCommentPlaceholder,disabled:s.currentUser&&s.currentUser.allow_comments!==1,rows:"3",maxlength:"1500",onInput:o[1]||(o[1]=(...t)=>s.autoResize&&s.autoResize(...t)),onKeydown:o[2]||(o[2]=(...t)=>s.handleCommentKeydown&&s.handleCommentKeydown(...t))},null,40,Ii),[[lo,s.newComment]])]),e("div",$i,[e("div",Ri,[e("button",{class:"submit-button",type:"submit",disabled:!s.newComment.trim()||s.newComment.length>1500||s.currentUser&&s.currentUser.allow_comments!==1}," –û—Ç–ø—Ä–∞–≤–∏—Ç—å ",8,Ai)]),e("div",Ti,[e("div",{class:A(["character-counter-inline",{"near-limit":s.newComment.length>1400,"at-limit":s.newComment.length>=1500}])},c(s.newComment.length)+"/1500 ",3),e("button",{type:"button",class:A(["emoji-button-inline",{active:s.showEmojiPicker}]),disabled:s.currentUser&&s.currentUser.allow_comments!==1,onMouseenter:o[3]||(o[3]=(...t)=>s.handleButtonMouseEnter&&s.handleButtonMouseEnter(...t)),onMouseleave:o[4]||(o[4]=(...t)=>s.handleButtonMouseLeave&&s.handleButtonMouseLeave(...t))}," üòä ",42,Si),ie(p,{"is-visible":s.showEmojiPicker&&s.canComment,onEmojiSelected:s.insertEmoji,onMouseEnter:s.handleEmojiMouseEnter,onMouseLeave:s.handleEmojiMouseLeave,onClose:s.closeEmojiPicker},null,8,["is-visible","onEmojiSelected","onMouseEnter","onMouseLeave","onClose"])])])],32),s.groupedComments.length>0?(a(),r("div",Pi,[s.showComments?(a(),r("div",Ni,[e("div",ji,[o[14]||(o[14]=e("h3",null,"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏",-1)),e("button",{class:"hide-comments-btn",onClick:o[7]||(o[7]=t=>s.showComments=!1)},o[13]||(o[13]=[e("i",{class:"fas fa-eye-slash"},null,-1),W(" –°–∫—Ä—ã—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ")]))]),e("div",Ui,[(a(!0),r(G,null,le(s.groupedComments,t=>(a(),be(R,{key:t.id,comment:t,"current-user":s.currentUser,"reply-to":s.replyTo,"reply-content":s.replyContent,"editing-comment-id":s.editingCommentId,"is-first-comment":!1,onReply:s.handleReply,onStartEdit:s.handleStartEdit,onCancelEdit:s.handleCancelEdit,onEdit:s.handleEdit,onDelete:s.handleDelete,onRate:s.handleRate,onSubmitReply:s.submitReply,onCancelReply:o[8]||(o[8]=f=>s.replyTo=null),onUpdateReplyContent:o[9]||(o[9]=f=>s.replyContent=f),onReplyKeydown:s.handleReplyKeydown},null,8,["comment","current-user","reply-to","reply-content","editing-comment-id","onReply","onStartEdit","onCancelEdit","onEdit","onDelete","onRate","onSubmitReply","onReplyKeydown"]))),128))])])):(a(),r("div",{key:0,class:"spoiler-warning",onClick:o[6]||(o[6]=t=>s.showComments=!0)},[e("div",Li,[o[10]||(o[10]=e("i",{class:"fas fa-eye-slash"},null,-1)),o[11]||(o[11]=e("h3",null,"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å–∫—Ä—ã—Ç—ã",-1)),o[12]||(o[12]=e("p",null,"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–æ–π–ª–µ—Ä—ã. –ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å.",-1)),e("div",xi,c(s.totalCommentsCount)+" "+c(s.getCommentWordForm(s.totalCommentsCount)),1)])]))])):k("",!0),ie(E,{ref:"notificationRef"},null,512)])}const Hi=_e(wi,[["render",Di],["__scopeId","data-v-821cd9e5"]]),Bi={class:"movie-info"},Oi={class:"content"},Ki={key:0,class:"content-card"},qi={class:"movie-skeleton"},Fi={class:"movie-skeleton__player"},zi={key:2,class:"content-card"},Vi={key:3,class:"content-card"},Wi={class:"content-header"},Yi=["src"],Gi={class:"content-title"},Zi={key:0,class:"ratings-links"},Xi={key:1},Qi=["href","title"],Ji={key:2},el=["href","title"],tl={key:3},ol=["href","title"],nl={key:4},sl=["href","title"],il={key:5},ll=["href"],al={key:6,class:"rating-links-group"},rl=["href"],ul=["title"],dl={key:0,class:"fa-regular fa-face-grin-wink"},cl={key:1,class:"fas fa-spinner fa-spin"},vl={key:2,class:"nudity-info-popup"},ml={class:"nudity-info-content"},fl=["content"],yl=["content"],kl={class:"additional-info"},gl={class:"info-content"},pl={class:"details-container"},hl={class:"info-list"},bl={key:0},_l={key:1},Cl={key:2},wl={key:3},El={key:4},Ml={key:5},Il={key:6},$l={key:7},Rl={key:8},Al={class:"content-info"},Tl={key:0,class:"content-description-text"},Sl={key:2,class:"comments-section"},Pl={key:3,class:"staff-section"},Ll={class:"staff-categories"},xl={key:0,class:"staff-category"},Nl={class:"staff-list"},jl=["href","title"],Ul=["src","alt"],Dl={class:"staff-name"},Hl={key:0,class:"staff-role"},Bl=["href","title"],Ol={key:1,class:"staff-category"},Kl={class:"staff-names-container"},ql={class:"staff-names-list"},Fl=["href"],zl=["href"],Vl={key:2,class:"staff-category"},Wl={class:"staff-names-container"},Yl={class:"staff-names-list"},Gl=["href"],Zl=["href"],Xl={key:4,class:"yt-video-container"},Ql={key:5,class:"related-movies"},Jl=["title"],ea={key:6,class:"related-movies"},ta=["title"],oa={__name:"MovieInfo",setup(l){const o=g(!0),v=Oe(),s=Xe(),_=Ro(),w=no(),p=g(w.params.kp_id),R=g(""),E=g(null),t=g(null),f=Ao(),K=Uo().areTrailersActive,P=g(null),D=g(!1),F=g(!1),S=g(6),T=g(null),h=g(!1),$=U(()=>v.isCommentsEnabled),M=()=>{if(t.value){const I=t.value.name_ru||t.value.name_en||t.value.name_original||"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∏–ª—å–º–µ";document.title=I}},H=I=>I?I.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "):"0",N=I=>(I||[]).map(u=>({kp_id:u.film_id,poster:u.poster_url_preview||u.poster_url,title:u.name_ru||u.name_en||u.name_original})),q=I=>{if(typeof I!="number")return;const u=Math.floor(I/60),i=I%60;return"".concat(u," —á. ").concat(i," –º–∏–Ω.")},m=g(!1),ue=g({top:"0px",left:"0px"}),me=I=>{m.value=!0,ue.value={top:"".concat(I.pageY+10,"px"),left:"".concat(I.pageX-70,"px")}},Z=g(null),X=async()=>{try{const I=[t.value.name_ru||t.value.name_en||t.value.name_original,...t.value.year?[t.value.year]:[],...t.value.film_length?[q(t.value.film_length)]:[]];await navigator.clipboard.writeText(I.join(", ")),Z.value.showNotification("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ")}catch(I){console.error("–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:",I)}},de=async(I=!0)=>{var u,i,d,y,Y,ee,ne,he;try{let ae;if(p.value.startsWith("shiki")?ae=await So(p.value):ae=await Po(p.value,s.token),Array.isArray(ae)&&ae.length===0)throw new Error("–î–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–∏—Å–∫.");t.value=ae,p.value.startsWith("shiki")?t.value={...t.value,title:t.value.name_ru||t.value.name_en,name_original:t.value.name_en,short_description:t.value.slogan}:t.value={...t.value,title:t.value.name_ru||t.value.name_en||t.value.name_original,kinopoisk_id:p.value},f.setHeaderContent({text:t.value.title,imageUrl:t.value.logo_url}),M();const re={kp_id:p.value,title:((u=t.value)==null?void 0:u.name_ru)||((i=t.value)==null?void 0:i.name_en)||((d=t.value)==null?void 0:d.name_original),poster:((y=t.value)==null?void 0:y.poster_url)||((Y=t.value)==null?void 0:Y.cover_url)||((ee=t.value)==null?void 0:ee.screenshots[0]),year:(ne=t.value)==null?void 0:ne.year,type:(he=t.value)==null?void 0:he.type};if(p.value.startsWith("shiki"))if(t.value.screenshots&&t.value.screenshots.length>0){const Te=Math.floor(Math.random()*t.value.screenshots.length),Fe=t.value.screenshots[Te];_.updateMoviePoster(Fe)}else re.poster&&_.updateMoviePoster(re.poster);else re.poster&&_.updateMoviePoster(re.poster);if(U(()=>v.isHistoryAllowed).value&&re.kp_id&&re.title&&I)if(s.token)try{await io(re.kp_id,B.HISTORY)}catch(Te){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∏—Å—Ç–æ—Ä–∏—é:",Te)}else v.addToHistory({...re})}catch(ae){const{message:re,code:Ue}=Ze(ae);R.value=re,E.value=Ue,console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∏–ª—å–º–∞—Ö:",ae)}},fe=U(()=>{var I,u;return console.log("–¢—Ä–µ–π–ª–µ—Ä—ã:",(I=t.value)==null?void 0:I.videos),(u=t.value)==null?void 0:u.videos}),j=U(()=>{var I;return N((I=t.value)==null?void 0:I.sequels_and_prequels)}),te=U(()=>{var I;return N((I=t.value)==null?void 0:I.similars)}),ye=()=>{var d;const I=((d=document.querySelector(".related-movies"))==null?void 0:d.clientWidth)||0,i=Math.floor(I/260)||6;S.value=Math.max(1,i)},ce=()=>{ye()},J=I=>{if(I.altKey&&I.keyCode===84&&document.querySelector(".player-container")){const i=document.querySelector(".theater-mode-btn");i&&i.click()}},ve=async()=>{var I;if(!s.token){Z.value.showNotification('–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:()=>f.openLogin()});return}if((I=t.value)!=null&&I.imdb_id){if(T.value){T.value=null;return}h.value=!0;try{const u=await Lo(t.value.imdb_id);T.value=u.nudity_info}catch(u){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ü–µ–Ω–∞—Ö:",u),Z.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ü–µ–Ω–∞—Ö")}finally{h.value=!1}}};Ae(async()=>{await de(),o.value=!1,document.addEventListener("keydown",J),window.addEventListener("resize",ce),setTimeout(ye,100)}),To(async()=>{f.clearHeaderContent(),document.removeEventListener("keydown",J),window.removeEventListener("resize",ce)}),$e(()=>w.params.kp_id,async I=>{I&&I!==p.value&&(f.clearHeaderContent(),p.value=I,P.value=null,await de(),o.value=!1)},{immediate:!0}),$e(t,()=>{M()},{deep:!0});const oe=I=>{var u,i;return((i=(u=t.value)==null?void 0:u.staff)==null?void 0:i.filter(d=>d.profession_key===I))||[]};return(I,u)=>{var i,d;return a(),r(G,null,[e("div",Bi,[e("div",Oi,[(o.value||!t.value)&&!R.value?(a(),r("div",Ki,[e("div",qi,[u[4]||(u[4]=Xt('<div class="movie-skeleton__header" data-v-25c75e76><div class="movie-skeleton__title" data-v-25c75e76></div></div><div class="movie-skeleton__ratings" data-v-25c75e76><div class="movie-skeleton__rating-item" data-v-25c75e76></div><div class="movie-skeleton__rating-item" data-v-25c75e76></div><div class="movie-skeleton__rating-item" data-v-25c75e76></div></div>',2)),e("div",Fi,[ie(ao)]),u[5]||(u[5]=Xt('<div class="movie-skeleton__additional-info" data-v-25c75e76><div class="movie-skeleton__section-title" data-v-25c75e76></div><div class="movie-skeleton__info-list" data-v-25c75e76><div class="movie-skeleton__info-item" data-v-25c75e76></div><div class="movie-skeleton__info-item" data-v-25c75e76></div><div class="movie-skeleton__info-item" data-v-25c75e76></div><div class="movie-skeleton__info-item" data-v-25c75e76></div><div class="movie-skeleton__info-item" data-v-25c75e76></div></div></div><div class="movie-skeleton__description" data-v-25c75e76><div class="movie-skeleton__description-line" data-v-25c75e76></div><div class="movie-skeleton__description-line" data-v-25c75e76></div><div class="movie-skeleton__description-line" data-v-25c75e76></div><div class="movie-skeleton__description-line" data-v-25c75e76></div></div>',2))])])):k("",!0),R.value?(a(),be(so,{key:1,message:R.value,code:E.value},null,8,["message","code"])):k("",!0),R.value?(a(),r("div",zi,[(a(),be(oo,{key:p.value,"kp-id":p.value,"movie-info":t.value,"onUpdate:movieInfo":de},null,8,["kp-id","movie-info"]))])):k("",!0),t.value&&!o.value?(a(),r("div",Vi,[e("div",Wi,[t.value.logo_url?(a(),r("div",{key:0,class:"content-logo",onMousemove:me,onMouseleave:u[0]||(u[0]=y=>m.value=!1),onClick:X},[e("img",{src:t.value.logo_url,alt:"–õ–æ–≥–æ—Ç–∏–ø —Ñ–∏–ª—å–º–∞",class:"content-logo"},null,8,Yi)],32)):(a(),r("div",{key:1,onMousemove:me,onMouseleave:u[1]||(u[1]=y=>m.value=!1),onClick:X},[e("h1",Gi,c(t.value.title),1)],32)),O(e("div",{class:"title-copy-tooltip",style:Ge(ue.value)}," –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å ",4),[[z,m.value]])]),t.value.kinopoisk_id||t.value.title||t.value.imdb_id||t.value.rating_imdb||t.value.shikimori_id?(a(),r("div",Zi,[t.value.kinopoisk_id?(a(),be(Es,{key:0,"kp-id":t.value.kinopoisk_id,"show-dash":!0},null,8,["kp-id"])):k("",!0),t.value.kinopoisk_id?(a(),r("div",Xi,[e("a",{href:"https://www.kinopoisk.ru/film/".concat(t.value.kinopoisk_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:t.value.rating_kinopoisk_vote_count?"–û—Ü–µ–Ω–æ–∫: ".concat(H(t.value.rating_kinopoisk_vote_count)):"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –≥–æ–ª–æ—Å–æ–≤"},[u[6]||(u[6]=e("img",{src:Jt,alt:"–ö–ü",class:"rating-logo"},null,-1)),e("span",null,c(t.value.rating_kinopoisk?t.value.rating_kinopoisk:"‚Äî"),1),u[7]||(u[7]=e("img",{src:Re,alt:"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",class:"external-link-icon"},null,-1))],8,Qi)])):k("",!0),!t.value.kinopoisk_id&&t.value.title?(a(),r("div",Ji,[e("a",{href:"https://www.kinopoisk.ru/index.php?kp_query=".concat(encodeURIComponent(t.value.title+(t.value.year?" "+t.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:t.value.rating_kinopoisk_vote_count?"–û—Ü–µ–Ω–æ–∫: ".concat(H(t.value.rating_kinopoisk_vote_count)):"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –≥–æ–ª–æ—Å–æ–≤"},[u[8]||(u[8]=e("img",{src:Jt,alt:"–ö–ü",class:"rating-logo"},null,-1)),e("span",null,c(t.value.rating_kinopoisk?t.value.rating_kinopoisk:"‚Äî"),1),u[9]||(u[9]=e("img",{src:Re,alt:"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",class:"external-link-icon"},null,-1))],8,el)])):k("",!0),t.value.imdb_id?(a(),r("div",tl,[e("a",{href:"https://www.imdb.com/title/".concat(t.value.imdb_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:t.value.rating_imdb_vote_count?"–û—Ü–µ–Ω–æ–∫: ".concat(H(t.value.rating_imdb_vote_count)):"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –≥–æ–ª–æ—Å–æ–≤"},[u[10]||(u[10]=e("img",{src:eo,alt:"IMDb",class:"rating-logo"},null,-1)),e("span",null,c(t.value.rating_imdb?t.value.rating_imdb:"‚Äî"),1),u[11]||(u[11]=e("img",{src:Re,alt:"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",class:"external-link-icon"},null,-1))],8,ol)])):k("",!0),!t.value.imdb_id&&t.value.title?(a(),r("div",nl,[e("a",{href:"https://www.imdb.com/find/?q=".concat(encodeURIComponent(t.value.title+(t.value.year?" "+t.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:t.value.rating_imdb_vote_count?"–û—Ü–µ–Ω–æ–∫: ".concat(H(t.value.rating_imdb_vote_count)):"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –≥–æ–ª–æ—Å–æ–≤"},[u[12]||(u[12]=e("img",{src:eo,alt:"IMDb",class:"rating-logo"},null,-1)),e("span",null,c(t.value.rating_imdb?t.value.rating_imdb:"‚Äî"),1),u[13]||(u[13]=e("img",{src:Re,alt:"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",class:"external-link-icon"},null,-1))],8,sl)])):k("",!0),t.value.shikimori_id?(a(),r("div",il,[e("a",{href:"https://shikimori.one/animes/".concat(t.value.shikimori_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},u[14]||(u[14]=[e("img",{src:Do,alt:"Shiki",class:"rating-logo"},null,-1),e("img",{src:Re,alt:"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",class:"external-link-icon"},null,-1)]),8,ll)])):k("",!0),t.value.imdb_id?(a(),r("div",al,[e("a",{href:"https://www.imdb.com/title/".concat(t.value.imdb_id,"/parentalguide"),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},u[15]||(u[15]=[e("span",null,"Parents Guide",-1),e("img",{src:Re,alt:"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",class:"external-link-icon"},null,-1)]),8,rl),e("button",{class:"rating-link nudity-info-btn",onClick:ve,title:T.value?"–°–∫—Ä—ã—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é":"–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ü–µ–Ω–∞—Ö(Sex & Nudity)"},[h.value?(a(),r("i",cl)):(a(),r("i",dl)),T.value?(a(),r("div",vl,[e("div",ml,c(T.value),1)])):k("",!0)],8,ul)])):k("",!0)])):k("",!0),(a(),be(oo,{key:p.value,"kp-id":p.value,"movie-info":t.value,"onUpdate:movieInfo":de},null,8,["kp-id","movie-info"])),e("meta",{name:"title-and-year",content:t.value.type==="FILM"&&t.value.year?"".concat(t.value.title," (").concat(t.value.year,")"):t.value.title},null,8,fl),t.value.name_original?(a(),r("meta",{key:1,name:"original-title",content:t.value.name_original},null,8,yl)):k("",!0),e("div",kl,[u[25]||(u[25]=e("h2",{class:"additional-info-title"},"–ü–æ–¥—Ä–æ–±–Ω–µ–µ",-1)),e("div",gl,[e("div",pl,[e("ul",hl,[t.value.type&&V(Qt)[t.value.type]?(a(),r("li",bl,[u[16]||(u[16]=e("strong",null,"–¢–∏–ø:",-1)),W(" "+c(V(Qt)[t.value.type]),1)])):k("",!0),t.value.year?(a(),r("li",_l,[u[17]||(u[17]=e("strong",null,"–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞:",-1)),W(" "+c(t.value.year),1)])):k("",!0),t.value.title?(a(),r("li",Cl,[u[18]||(u[18]=e("strong",null,"–ù–∞–∑–≤–∞–Ω–∏–µ:",-1)),W(" "+c(t.value.title),1)])):k("",!0),t.value.name_original?(a(),r("li",wl,[u[19]||(u[19]=e("strong",null,"–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:",-1)),W(" "+c(t.value.name_original),1)])):k("",!0),t.value.slogan?(a(),r("li",El,[u[20]||(u[20]=e("strong",null,"–°–ª–æ–≥–∞–Ω:",-1)),W(" "+c(t.value.slogan),1)])):k("",!0),t.value.production_companies?(a(),r("li",Ml,[u[21]||(u[21]=e("strong",null,"–ü—Ä–æ–¥–∞–∫—à–Ω:",-1)),W(" "+c(t.value.production_companies),1)])):k("",!0),(i=t.value.countries)!=null&&i.length?(a(),r("li",Il,[u[22]||(u[22]=e("strong",null,"–°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞:",-1)),W(" "+c(t.value.countries.map(y=>y.country).join(", ")),1)])):k("",!0),(d=t.value.genres)!=null&&d.length?(a(),r("li",$l,[u[23]||(u[23]=e("strong",null,"–ñ–∞–Ω—Ä—ã:",-1)),W(" "+c(t.value.genres.map(y=>y.genre).join(", ")),1)])):k("",!0),t.value.film_length?(a(),r("li",Rl,[u[24]||(u[24]=e("strong",null,"–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:",-1)),W(" "+c(q(t.value.film_length)),1)])):k("",!0)])])])]),e("div",Al,[t.value.description?(a(),r("p",Tl,c(t.value.description),1)):k("",!0)]),$.value?(a(),r("div",Sl,[ie(Hi,{"movie-id":p.value},null,8,["movie-id"])])):k("",!0),t.value.staff?(a(),r("div",Pl,[e("div",Ll,[oe("ACTOR").length?(a(),r("div",xl,[u[26]||(u[26]=e("h3",{class:"additional-info-title"},"–ê–∫—Ç—ë—Ä—ã",-1)),e("div",Nl,[(a(!0),r(G,null,le(oe("ACTOR").slice(0,12),y=>(a(),r("div",{key:y.staff_id,class:"staff-item"},[e("a",{href:"https://www.kinopoisk.ru/name/".concat(y.staff_id,"/"),target:"_blank",rel:"noopener noreferrer",class:"staff-link",title:y.description||""},[e("img",{src:y.poster_url,alt:y.name_ru,class:"staff-photo"},null,8,Ul),e("span",Dl,c(y.name_ru||y.name_en),1),y.description?(a(),r("span",Hl,c(y.description),1)):k("",!0)],8,jl)]))),128)),e("a",{class:"expand-actors-circle-button",href:"https://www.kinopoisk.ru/film/".concat(p.value,"/cast/"),target:"_blank",rel:"noopener noreferrer",title:"–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ—Ö ".concat(oe("ACTOR").length," –∞–∫—Ç–µ—Ä–æ–≤")}," +"+c(oe("ACTOR").length-12),9,Bl)])])):k("",!0),oe("DIRECTOR").length?(a(),r("div",Ol,[u[27]||(u[27]=e("h3",{class:"additional-info-title"},"–†–µ–∂–∏—Å—Å—ë—Ä—ã",-1)),e("div",Kl,[e("div",ql,[(a(!0),r(G,null,le(oe("DIRECTOR"),y=>(a(),r("a",{key:y.staff_id,href:"https://www.kinopoisk.ru/name/".concat(y.staff_id,"/"),target:"_blank",rel:"noopener noreferrer",class:"staff-name-link"},c(y.name_ru||y.name_en),9,Fl))),128))]),e("a",{class:"show-all-staff-link",href:"https://www.kinopoisk.ru/film/".concat(p.value,"/cast/"),target:"_blank",rel:"noopener noreferrer"}," + ",8,zl)])])):k("",!0),oe("PRODUCER").length?(a(),r("div",Vl,[u[28]||(u[28]=e("h3",{class:"additional-info-title"},"–ü—Ä–æ–¥—é—Å–µ—Ä—ã",-1)),e("div",Wl,[e("div",Yl,[(a(!0),r(G,null,le(oe("PRODUCER"),y=>(a(),r("a",{key:y.staff_id,href:"https://www.kinopoisk.ru/name/".concat(y.staff_id,"/"),target:"_blank",rel:"noopener noreferrer",class:"staff-name-link"},c(y.name_ru||y.name_en),9,Gl))),128))]),e("a",{class:"show-all-staff-link",href:"https://www.kinopoisk.ru/film/".concat(p.value,"/cast/"),target:"_blank",rel:"noopener noreferrer"}," + ",8,Zl)])])):k("",!0)])])):k("",!0),fe.value.length&&V(K)?(a(),r("div",Xl,[ie(ms,{videos:fe.value,"active-video-index":P.value,onSelect:I.playTrailer},null,8,["videos","active-video-index","onSelect"])])):k("",!0),j.value.length?(a(),r("div",Ql,[u[29]||(u[29]=e("h2",null,"–°–∏–∫–≤–µ–ª—ã –∏ –ø—Ä–∏–∫–≤–µ–ª—ã",-1)),ie(V(to),{"movies-list":D.value?j.value:j.value.slice(0,S.value),loading:!1,"is-history":!1},null,8,["movies-list"]),j.value.length>S.value?(a(),r("a",{key:0,class:"expand-circle-button",onClick:u[2]||(u[2]=y=>D.value=!D.value),title:"".concat(D.value?"–°–∫—Ä—ã—Ç—å":"–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ"," (").concat(j.value.length,")")},c(D.value?"‚àí":"+".concat(j.value.length-S.value)),9,Jl)):k("",!0)])):k("",!0),te.value.length?(a(),r("div",ea,[u[30]||(u[30]=e("h2",null,"–ü–æ—Ö–æ–∂–∏–µ",-1)),ie(V(to),{"movies-list":F.value?te.value:te.value.slice(0,S.value),loading:!1,"is-history":!1},null,8,["movies-list"]),te.value.length>S.value?(a(),r("a",{key:0,class:"expand-circle-button",onClick:u[3]||(u[3]=y=>F.value=!F.value),title:"".concat(F.value?"–°–∫—Ä—ã—Ç—å":"–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ"," (").concat(te.value.length,")")},c(F.value?"‚àí":"+".concat(te.value.length-S.value)),9,ta)):k("",!0)])):k("",!0)])):k("",!0)])]),ie(qe,{ref_key:"notificationRef",ref:Z},null,512)],64)}}},ra=_e(oa,[["__scopeId","data-v-25c75e76"]]);export{ra as default};
