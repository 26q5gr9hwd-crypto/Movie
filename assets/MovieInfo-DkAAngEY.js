import{_ as Me,r as p,c as R,b as i,d as l,e,s as L,t as d,K as J,g as u,L as Ce,n as C,q as Vt,u as Le,i as wt,N as $t,l as ue,o as De,O as ht,x as re,E as At,f as se,P as Se,m as M,Q as I,y as x,U as w,R as zt,D as xe,S as Re,V as qt,W as Ct,X as Wt,Y as Yt,a as Ft,Z as pt,$ as ft,a0 as Gt,a1 as kt,a2 as Xt,a3 as Zt}from"./index-D37kNqbj.js";import{S as Mt,_ as yt,a as gt,M as _t}from"./MovieList-C6r5KQVW.js";import{N as It}from"./ToastMessage-cESuhp5K.js";import{u as jt,S as Qt,a as Jt}from"./trailer-BZn0pZln.js";const ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVR4nO2ZQUoDMRSGR7eewHoFsVS0HkUUXNXqASqK2EURBPFIVRe6c+UN1CvUXWvbT4KvMAwzNnnJdCrmg1BKad7/v7y0b5IkiUQiCwGoAx3gQjEugZ0qxTeAIX6MKjMBnBOGS62AVWAPOHVYdlMu9YArYOhphLeBT+ALmOKGEd2QubaAK+B2zngFxt4GgDXgGZjgR8ch5oEkCi8DkvlnRcYLV0Apfqw10M7JvPkV6AN3FmVwK+WyZRnvMEe8ef/ibECyb2o+zRuwnpQAxeLNivQ0BvYyE46qEJ/8fK4ycJKp/X4V4n0MdDNfukkqEO9jwP1LDgD7BeKPgmgp04CL+KUz4Cp+qQxoxC+NAdsNm4c0hWkukkUa8BGfegiadbFDq3/2UAZ8xc+QVvzMtqcKYkBaZ5/MN5xEl2DgLGDZ1KswsC09FPJqXTZoNm5oA6kyMGI2FxqfkluJ0uMTDfhBXAHiHvCCWEL8/RLqlv1MPCf+TSZ+13WC7KnEfWlqcwAeU7GNjnbiQsG5UC1ZAEAt1UMhOpquk6zknMy9l20C2AA+MnEHRo9msuOCs9EH4Fp5TVQ0rqVs0plH4re02Qh1Oq1lCjypsp+5H3gKcD/gykTirqnFZ/ZDy+OGxpapzD+QePrM/2KkKfcGPcv7AdvRkz23G1x4JPIP+AY3r/ywUk/2JAAAAABJRU5ErkJggg==",eo="/reyohoho/assets/icon-shikimori-DGvXK9Jc.svg",Pe=k=>{const _=document.createElement("div");_.style.position="fixed",_.style.top="0",_.style.left="0",_.style.width="100%",_.style.height="100%",_.style.backgroundColor="rgba(0, 0, 0, 0.8)",_.style.color="white",_.style.display="flex",_.style.justifyContent="center",_.style.alignItems="center",_.style.fontSize="2rem",_.style.zIndex="99000",_.textContent=k,document.body.appendChild(_),setTimeout(()=>{document.body.removeChild(_)},2e3)},to={class:"modal-content"},oo={key:0},so={key:1},lo={class:"players-list"},no=["onClick"],io={key:0,class:"warning-icon material-icons",title:"Внимание!"},ao={key:0},ro={key:0,class:"warning-icon material-icons",title:"Внимание!"},uo={key:1},vo={key:0,class:"warning-icon material-icons",title:"Внимание!"},co=["onClick"],mo={key:0,class:"warning-icon material-icons",title:"Внимание!"},po={__name:"PlayerModal",props:{players:{type:Array,required:!0},selectedPlayer:{type:Object,default:null}},emits:["close","select"],setup(k,{emit:_}){const D=k,P=_,E=p(null),G=R(()=>D.players.filter(n=>!H(n)&&!o(n))),y=R(()=>D.players.some(n=>H(n))),h=R(()=>D.players.some(n=>o(n))),H=n=>n.key.toUpperCase().includes("HDREZKA"),o=n=>n.key.toUpperCase().includes("KODIK"),b=n=>n.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"").trim(),K=n=>{P("select",n),P("close")},$=n=>D.selectedPlayer&&D.selectedPlayer.key===n.key,N=n=>{E.value=n},z=()=>{E.value=null},O=n=>{let v=D.players.filter(m=>n==="hdrezka"&&H(m)||n==="kodik"&&o(m));return n==="kodik"?v.sort((m,F)=>b(m.translate).localeCompare(b(F.translate))):v},g=n=>O(n).some(v=>v.warning);return(n,v)=>(l(),i("div",{class:"modal",onClick:v[3]||(v[3]=Vt(m=>n.$emit("close"),["self"]))},[e("div",to,[e("button",{class:"close",onClick:v[0]||(v[0]=m=>n.$emit("close"))},"×"),E.value?(l(),i("h2",so,[e("button",{class:"back-btn",onClick:z},"← Назад"),L(" "+d(E.value==="hdrezka"?"ReYohoho - HDrezka":"Kodik"),1)])):(l(),i("h2",oo,"Выберите плеер")),e("ul",lo,[E.value?(l(!0),i(J,{key:1},Ce(O(E.value),m=>(l(),i("li",{key:m.key},[e("button",{class:C(["player-item",{active:$(m)}]),onClick:F=>K(m)},[L(d(b(m.translate))+" ",1),m.warning?(l(),i("span",mo,"warning")):u("",!0)],10,co)]))),128)):(l(),i(J,{key:0},[(l(!0),i(J,null,Ce(G.value,m=>(l(),i("li",{key:m.key},[e("button",{class:C(["player-item",{active:$(m)}]),onClick:F=>K(m)},[L(d(b(m.translate))+" ",1),m.warning?(l(),i("span",io,"warning")):u("",!0)],10,no)]))),128)),y.value?(l(),i("li",ao,[e("button",{class:"group-item",onClick:v[1]||(v[1]=m=>N("hdrezka"))},[v[4]||(v[4]=e("span",{class:"material-icons group-icon"},"folder",-1)),v[5]||(v[5]=L(" ReYohoho - HDrezka ")),g("hdrezka")?(l(),i("span",ro,"warning")):u("",!0)])])):u("",!0),h.value?(l(),i("li",uo,[e("button",{class:"group-item",onClick:v[2]||(v[2]=m=>N("kodik"))},[v[6]||(v[6]=e("span",{class:"material-icons group-icon"},"folder",-1)),v[7]||(v[7]=L(" Kodik ")),g("kodik")?(l(),i("span",vo,"warning")):u("",!0)])])):u("",!0)],64))])])]))}},fo=Me(po,[["__scopeId","data-v-7e4f2528"]]),ko={class:"players-list"},yo=["src"],go={key:1,class:"controls"},_o={class:"material-icons"},bo={class:"list-button-item"},wo={class:"material-icons"},$o={class:"list-button-item"},ho={class:"material-icons"},Ao={class:"list-button-item"},Co={class:"list-button-item"},Mo={class:"material-icons"},Io={class:"list-button-item"},Eo={class:"material-icons"},To={key:1,class:"mobile-list-buttons"},Ro={class:"tooltip-container"},Po={class:"material-icons"},So={class:"custom-tooltip"},xo={class:"tooltip-container"},Lo={class:"material-icons"},Do={class:"custom-tooltip"},Ho={class:"tooltip-container"},No={class:"custom-tooltip"},Oo={class:"tooltip-container"},Ko={class:"material-icons"},Bo={class:"custom-tooltip"},Uo={class:"tooltip-container"},Vo={class:"material-icons"},zo={class:"custom-tooltip"},qo={class:"tooltip-container"},Wo={class:"material-icons"},Yo={class:"tooltip-container"},Fo={class:"tooltip-container"},Go={class:"tooltip-container"},Xo={class:"tooltip-container"},Zo={class:"material-symbols-outlined"},jo={class:"custom-tooltip"},Qo={class:"tooltip-container"},Jo={class:"current-ratio"},es=["onClick"],ts={key:0,class:"tooltip-container"},os={class:"custom-tooltip"},ss={key:1,class:"tooltip-container"},ls={class:"custom-tooltip"},ns={__name:"PlayerComponent",props:{kpId:String,movieInfo:{type:Object,default:()=>({})}},emits:["update:selectedPlayer","update:movieInfo"],setup(k,{emit:_}){const D=Le(),P=jt(),E=wt(),G=$t(),y=p(G.params.kp_id),h=k,H=_,o=p([]),b=p(null),K=p(!0),$=p(!1),N=p(!1),z=p(null),O=p(null),g=p(!1),n=p(""),v=p(null),m=p(window.innerHeight*.9),F=R(()=>"".concat(m.value,"px")),le=R(()=>D.isMobile),S=R(()=>!!window.electronAPI),f=p(null),ee=p(!1);let ne=null;const X=p(null),c=p(null),s=p(null),B=()=>{if(!c.value||!s.value)return;const a=c.value.getBoundingClientRect(),t=s.value.getBoundingClientRect(),T=window.innerHeight;a.bottom+t.height>T?(s.value.style.top="auto",s.value.style.bottom="100%",s.value.style.marginTop="0",s.value.style.marginBottom="12px",s.value.style.transform="translateX(-50%)"):(s.value.style.top="100%",s.value.style.bottom="auto",s.value.style.marginTop="12px",s.value.style.marginBottom="0",s.value.style.transform="translateX(-50%)")},A=a=>{f.value=a,ee.value=!1,clearTimeout(ne),Re(()=>{B()})},Z=()=>{ee.value||(ne=setTimeout(()=>{f.value=null},300))},U=()=>{ee.value=!0,clearTimeout(ne)},ie=()=>{ee.value=!1,f.value=null},q=R({get:()=>P.aspectRatio,set:a=>P.updateAspectRatio(a)}),Q=R({get:()=>P.isCentered,set:a=>P.updateCentering(a)}),W=R(()=>P.preferredPlayer),V=p(0),te=a=>a.toUpperCase(),oe=()=>{if($.value||!O.value)return;const[a,t]=q.value.split(":").map(Number);m.value=window.innerHeight*.9,V.value=Math.min(O.value.clientWidth*(t/a),m.value)},Ie=R(()=>{if($.value)return{};const[a,t]=q.value.split(":").map(Number),T=m.value*(a/t);return{width:"100%",maxWidth:"".concat(T,"px"),maxHeight:F.value,margin:"0 auto",overflow:"hidden"}}),Et=R(()=>{const[a,t]=q.value.split(":").map(Number);return{position:"relative",width:"100%",paddingTop:"".concat(t/a*100,"%")}}),ve=()=>{O.value&&setTimeout(()=>{Re(()=>{O.value.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},500)},Tt=async()=>{try{n.value="",v.value=null;const a=await zt(h.kpId);if(o.value=Object.entries(a).map(([t,T])=>({key:t.toUpperCase(),...T})),o.value.length>0){if(W.value){const t=te(W.value),T=o.value.find(j=>te(j.key)===t);b.value=T||o.value[0]}else b.value=o.value[0];H("update:selectedPlayer",b.value)}}catch(a){const{message:t,code:T}=xe(a);n.value=t,v.value=T,console.error("Ошибка при загрузке плееров:",a)}},Rt=()=>{g.value=!0},He=()=>{g.value=!1},Pt=a=>{var t;if(((t=b.value)==null?void 0:t.key)===a.key){He();return}b.value=a,K.value=!0,P.updatePreferredPlayer(te(a.key)),H("update:selectedPlayer",a)},St=()=>{S.value?window.electronAPI.sendHotKey("F2"):(Pe("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},xt=()=>{S.value?window.electronAPI.sendHotKey("F3"):(Pe("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},Lt=()=>{S.value?window.electronAPI.sendHotKey("F4"):(Pe("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},$e=()=>{$.value=!$.value,$.value?(window.addEventListener("mousemove",Ee),document.addEventListener("keydown",Te),document.body.classList.add("no-scroll")):(window.removeEventListener("mousemove",Ee),document.removeEventListener("keydown",Te),document.body.classList.remove("no-scroll")),N.value=$.value,Re(()=>ve())},Ne=p(null),Ee=()=>{Ne.value=setTimeout(()=>{clearTimeout(Ne.value),N.value=!1},4e3),N.value=!0},he=R(()=>D.dimmingEnabled),Dt=()=>{$.value||D.toggleDimming()},Te=a=>{(a.key==="Escape"&&$.value||a.altKey&&a.keyCode===84)&&$e()},Oe=a=>{q.value=a,setTimeout(()=>{Q.value&&ve()},310)},Ht=()=>{const a="reyohoho://#".concat(y.value);try{window.location.href=a}catch(t){console.error("Ошибка при открытии ссылки:",t)}},Nt=()=>{const a=window.location.href;navigator.clipboard.writeText(a).then(()=>{}),X.value.showNotification("Ссылка на фильм скопирована")},Ot=()=>{K.value=!1};function Kt(a){return a.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"KODIK - ").trim()}ue(b,a=>{a&&(K.value=!0,P.updatePreferredPlayer(te(a.key)),H("update:selectedPlayer",a))}),ue(()=>G.params.kp_id,async a=>{a&&a!==y.value&&(y.value=a,Q.value&&ve())},{immediate:!0});const Ae=["16:9","12:5","4:3"],Bt=()=>{const t=(Ae.indexOf(q.value)+1)%Ae.length;Oe(Ae[t])},Ut=a=>{var T,j,de,ce,me,pe,fe,ke,ye,ge,_e,be,we;return(we={[w.FAVORITE]:((j=(T=h.movieInfo)==null?void 0:T.lists)==null?void 0:j.isFavorite)||!1,[w.HISTORY]:((ce=(de=h.movieInfo)==null?void 0:de.lists)==null?void 0:ce.isHistory)||!1,[w.LATER]:((pe=(me=h.movieInfo)==null?void 0:me.lists)==null?void 0:pe.isLater)||!1,[w.COMPLETED]:((ke=(fe=h.movieInfo)==null?void 0:fe.lists)==null?void 0:ke.isCompleted)||!1,[w.ABANDONED]:((ge=(ye=h.movieInfo)==null?void 0:ye.lists)==null?void 0:ge.isAbandoned)||!1,[w.WATCHING]:((be=(_e=h.movieInfo)==null?void 0:_e.lists)==null?void 0:be.isWatching)||!1}[a])!=null?we:!1},Y=async a=>{if(!E.token){X.value.showNotification("Необходимо авторизоваться",5e3);return}try{const t={[w.FAVORITE]:"избранное",[w.HISTORY]:"историю",[w.LATER]:'список "Смотреть позже"',[w.COMPLETED]:'список "Просмотрено"',[w.ABANDONED]:'список "Брошено"',[w.WATCHING]:'список "Смотрю"'};Ut(a)?(await qt(y.value,a),X.value.showNotification("Удалено из ".concat(t[a]))):(await Ct(y.value,a),X.value.showNotification("Добавлено в ".concat(t[a])))}catch(t){const{message:T,code:j}=xe(t);X.value.showNotification("".concat(T," ").concat(j))}H("update:movieInfo")};return De(()=>{K.value=!0,Tt(),le.value&&(q.value="4:3"),oe(),window.addEventListener("resize",oe),window.addEventListener("resize",B),Q.value&&ve()}),ht(()=>{window.removeEventListener("resize",oe),window.removeEventListener("resize",B),window.removeEventListener("mousemove",Ee),document.removeEventListener("keydown",Te),document.body.classList.remove("no-scroll")}),(a,t)=>{var T,j,de,ce,me,pe,fe,ke,ye,ge,_e,be,we,Ke,Be,Ue,Ve,ze,qe,We,Ye,Fe,Ge,Xe,Ze,je,Qe,Je,et,tt,ot,st,lt,nt,it,at,rt,ut,vt,dt,ct,mt;return n.value?(l(),re(At,{key:0,message:n.value,code:v.value},null,8,["message","code"])):(l(),i(J,{key:1},[e("div",ko,[t[39]||(t[39]=e("span",null,"Плеер:",-1)),e("button",{class:"player-btn",onClick:Rt},d(b.value?Kt(b.value.translate).toUpperCase():"Загрузка плееров..."),1)]),g.value?(l(),re(fo,{key:0,players:o.value,"selected-player":b.value,onClose:He,onSelect:Pt},null,8,["players","selected-player"])):u("",!0),e("div",{ref_key:"containerRef",ref:O,class:C(["player-container",{"theater-mode":$.value}]),style:Se($.value?{}:Ie.value)},[e("div",{class:"iframe-wrapper",style:Se($.value?{}:Et.value)},[M(e("iframe",{ref_key:"playerIframe",ref:z,src:(T=b.value)==null?void 0:T.iframe,frameborder:"0",allowfullscreen:"",webkitallowfullscreen:"",class:C(["responsive-iframe",{"theater-mode-unlock":N.value,"theater-mode-lock":$.value,dimmed:he.value}]),onLoad:Ot},null,42,yo),[[I,!K.value&&((j=b.value)==null?void 0:j.iframe)]]),K.value?(l(),re(Mt,{key:0})):u("",!0)],4),$.value?(l(),i("button",{key:0,class:C(["close-theater-btn",{visible:N.value}]),onClick:$e}," ✖ ",2)):u("",!0)],6),$.value?u("",!0):(l(),i("div",go,[le.value?(l(),i("div",To,[e("div",Ro,[e("button",{class:C(["favorite-btn",{active:(je=(Ze=k.movieInfo)==null?void 0:Ze.lists)==null?void 0:je.isFavorite}]),onMouseenter:t[7]||(t[7]=r=>A("favorite")),onMouseleave:t[8]||(t[8]=r=>f.value=null),onClick:t[9]||(t[9]=r=>Y(x(w).FAVORITE))},[e("span",Po,d((Je=(Qe=k.movieInfo)==null?void 0:Qe.lists)!=null&&Je.isFavorite?"favorite":"favorite_border"),1)],34),M(e("div",So,d("В избранное"),512),[[I,f.value==="favorite"]])]),e("div",xo,[e("button",{class:C(["watching-btn",{active:(tt=(et=k.movieInfo)==null?void 0:et.lists)==null?void 0:tt.isWatching}]),onMouseenter:t[10]||(t[10]=r=>A("watching")),onMouseleave:t[11]||(t[11]=r=>f.value=null),onClick:t[12]||(t[12]=r=>Y(x(w).WATCHING))},[e("span",Lo,d((st=(ot=k.movieInfo)==null?void 0:ot.lists)!=null&&st.isWatching?"visibility":"visibility_off"),1)],34),M(e("div",Do,d("Смотрю"),512),[[I,f.value==="watching"]])]),e("div",Ho,[e("button",{class:C(["later-btn",{active:(nt=(lt=k.movieInfo)==null?void 0:lt.lists)==null?void 0:nt.isLater}]),onMouseenter:t[13]||(t[13]=r=>A("later")),onMouseleave:t[14]||(t[14]=r=>f.value=null),onClick:t[15]||(t[15]=r=>Y(x(w).LATER))},t[45]||(t[45]=[e("span",{class:"material-icons"},"watch_later",-1)]),34),M(e("div",No,d("Смотреть позже"),512),[[I,f.value==="later"]])]),e("div",Oo,[e("button",{class:C(["completed-btn",{active:(at=(it=k.movieInfo)==null?void 0:it.lists)==null?void 0:at.isCompleted}]),onMouseenter:t[16]||(t[16]=r=>A("completed")),onMouseleave:t[17]||(t[17]=r=>f.value=null),onClick:t[18]||(t[18]=r=>Y(x(w).COMPLETED))},[e("span",Ko,d((ut=(rt=k.movieInfo)==null?void 0:rt.lists)!=null&&ut.isCompleted?"check_circle":"check_circle_outline"),1)],34),M(e("div",Bo,d("Просмотрено"),512),[[I,f.value==="completed"]])]),e("div",Uo,[e("button",{class:C(["abandoned-btn",{active:(dt=(vt=k.movieInfo)==null?void 0:vt.lists)==null?void 0:dt.isAbandoned}]),onMouseenter:t[19]||(t[19]=r=>A("abandoned")),onMouseleave:t[20]||(t[20]=r=>f.value=null),onClick:t[21]||(t[21]=r=>Y(x(w).ABANDONED))},[e("span",Vo,d(((mt=(ct=k.movieInfo)==null?void 0:ct.lists)!=null&&mt.isAbandoned,"not_interested")),1)],34),M(e("div",zo,d("Брошено"),512),[[I,f.value==="abandoned"]])])])):(l(),i("div",{key:0,class:"tooltip-container list-buttons-container",ref_key:"tooltipContainer",ref:c},[e("button",{class:C(["favorite-btn",{active:(ce=(de=k.movieInfo)==null?void 0:de.lists)==null?void 0:ce.isFavorite}]),onMouseenter:t[0]||(t[0]=r=>A("favorite")),onMouseleave:Z,onClick:t[1]||(t[1]=r=>Y(x(w).FAVORITE))},[e("span",_o,d((pe=(me=k.movieInfo)==null?void 0:me.lists)!=null&&pe.isFavorite?"favorite":"favorite_border"),1)],34),M(e("div",{class:"custom-tooltip advanced-tooltip list-buttons-dropdown",ref_key:"tooltip",ref:s,onMouseenter:U,onMouseleave:ie},[e("div",bo,[e("button",{class:C(["favorite-btn",{active:(ke=(fe=k.movieInfo)==null?void 0:fe.lists)==null?void 0:ke.isFavorite}]),onClick:t[2]||(t[2]=r=>Y(x(w).FAVORITE))},[e("span",wo,d((ge=(ye=k.movieInfo)==null?void 0:ye.lists)!=null&&ge.isFavorite?"favorite":"favorite_border"),1),t[40]||(t[40]=e("span",{class:"button-label"},"В избранное",-1))],2)]),e("div",$o,[e("button",{class:C(["watching-btn",{active:(be=(_e=k.movieInfo)==null?void 0:_e.lists)==null?void 0:be.isWatching}]),onClick:t[3]||(t[3]=r=>Y(x(w).WATCHING))},[e("span",ho,d((Ke=(we=k.movieInfo)==null?void 0:we.lists)!=null&&Ke.isWatching?"visibility":"visibility_off"),1),t[41]||(t[41]=e("span",{class:"button-label"},"Смотрю",-1))],2)]),e("div",Ao,[e("button",{class:C(["later-btn",{active:(Ue=(Be=k.movieInfo)==null?void 0:Be.lists)==null?void 0:Ue.isLater}]),onClick:t[4]||(t[4]=r=>Y(x(w).LATER))},t[42]||(t[42]=[e("span",{class:"material-icons"},"watch_later",-1),e("span",{class:"button-label"},"Смотреть позже",-1)]),2)]),e("div",Co,[e("button",{class:C(["completed-btn",{active:(ze=(Ve=k.movieInfo)==null?void 0:Ve.lists)==null?void 0:ze.isCompleted}]),onClick:t[5]||(t[5]=r=>Y(x(w).COMPLETED))},[e("span",Mo,d((We=(qe=k.movieInfo)==null?void 0:qe.lists)!=null&&We.isCompleted?"check_circle":"check_circle_outline"),1),t[43]||(t[43]=e("span",{class:"button-label"},"Просмотрено",-1))],2)]),e("div",Io,[e("button",{class:C(["abandoned-btn",{active:(Fe=(Ye=k.movieInfo)==null?void 0:Ye.lists)==null?void 0:Fe.isAbandoned}]),onClick:t[6]||(t[6]=r=>Y(x(w).ABANDONED))},[e("span",Eo,d(((Xe=(Ge=k.movieInfo)==null?void 0:Ge.lists)!=null&&Xe.isAbandoned,"not_interested")),1),t[44]||(t[44]=e("span",{class:"button-label"},"Брошено",-1))],2)])],544),[[I,f.value==="favorite"]])],512)),le.value?u("",!0):(l(),i(J,{key:2},[e("div",qo,[e("button",{class:C(["dimming-btn",{active:he.value}]),onMouseenter:t[22]||(t[22]=r=>A("dimming")),onMouseleave:t[23]||(t[23]=r=>f.value=null),onClick:Dt},[e("span",Wo,d(he.value?"light_mode":"dark_mode"),1)],34),M(e("div",{class:"custom-tooltip"},d(he.value?"Отключить затемнение":"Включить затемнение"),513),[[I,f.value==="dimming"]])]),e("div",Yo,[e("button",{class:C(["blur-btn",{"electron-only":!S.value}]),onMouseenter:t[24]||(t[24]=r=>A("blur")),onMouseleave:t[25]||(t[25]=r=>f.value=null),onClick:St},t[46]||(t[46]=[e("span",{class:"material-icons"},"blur_on",-1)]),34),M(e("div",{class:"custom-tooltip"},d(S.value?"Блюр":"Блюр, функция доступна в приложении"),513),[[I,f.value==="blur"]])]),e("div",Fo,[e("button",{class:C(["material-symbols-outlined",{"electron-only":!S.value}]),onMouseenter:t[26]||(t[26]=r=>A("compressor")),onMouseleave:t[27]||(t[27]=r=>f.value=null),onClick:xt},t[47]||(t[47]=[e("span",{class:"material-icons"},"graphic_eq",-1)]),34),M(e("div",{class:"custom-tooltip"},d(S.value?"Компрессор":"Компрессор, функция доступна в приложении"),513),[[I,f.value==="compressor"]])]),e("div",Go,[e("button",{class:C(["mirror-btn",{"electron-only":!S.value}]),onMouseenter:t[28]||(t[28]=r=>A("mirror")),onMouseleave:t[29]||(t[29]=r=>f.value=null),onClick:Lt},t[48]||(t[48]=[e("span",{class:"material-icons"},"flip",-1)]),34),M(e("div",{class:"custom-tooltip"},d(S.value?"Зеркало":"Зеркало, функция доступна в приложении"),513),[[I,f.value==="mirror"]])]),e("div",Xo,[e("button",{class:"theater-mode-btn",onMouseenter:t[30]||(t[30]=r=>A("theater")),onMouseleave:t[31]||(t[31]=r=>f.value=null),onClick:$e},[e("span",Zo,d($.value?"fullscreen_exit":"aspect_ratio"),1)],32),M(e("div",jo,[L(d($.value?"Выйти из театрального режима":"Театральный режим")+" ",1),t[49]||(t[49]=e("span",{class:"shortcut-hint"},"Alt+T",-1))],512),[[I,f.value==="theater"]])]),e("div",Qo,[e("button",{class:"aspect-ratio-dropdown-btn",onMouseenter:t[32]||(t[32]=r=>A("aspect_ratio")),onMouseleave:Z,onClick:Bt},[e("span",Jo,d(q.value),1)],32),M(e("div",{class:"custom-tooltip advanced-tooltip aspect-ratio-dropdown",onMouseenter:U,onMouseleave:ie},[(l(),i(J,null,Ce(Ae,r=>e("div",{key:r,class:C(["aspect-ratio-option",{active:q.value===r}]),onClick:rl=>Oe(r)},d(r),11,es)),64))],544),[[I,f.value==="aspect_ratio"]])]),e("div",{class:"tooltip-container",onMouseenter:t[34]||(t[34]=r=>A("centering")),onMouseleave:Z},[e("button",{class:"center-btn",onClick:ve},t[50]||(t[50]=[e("span",{class:"material-icons"},"center_focus_strong",-1)])),M(e("div",{class:"custom-tooltip advanced-tooltip",onMouseenter:U,onMouseleave:ie},[t[51]||(t[51]=L(" Отцентрировать плеер ")),se(Qt,{modelValue:Q.value,"onUpdate:modelValue":t[33]||(t[33]=r=>Q.value=r),title:"Автоцентрирование плеера"},null,8,["modelValue"]),t[52]||(t[52]=e("span",{class:"tooltip-title"},"Автоцентрирование плеера",-1))],544),[[I,f.value==="centering"]])],32),S.value?u("",!0):(l(),i("div",ts,[e("button",{class:"app-link-btn",onMouseenter:t[35]||(t[35]=r=>A("app_link")),onMouseleave:t[36]||(t[36]=r=>f.value=null),onClick:Ht},t[53]||(t[53]=[e("span",{class:"material-icons"},"open_in_new",-1)]),32),M(e("div",os," Открыть в приложении ",512),[[I,f.value==="app_link"]])])),S.value?(l(),i("div",ss,[e("button",{class:"copy-link-btn",onMouseenter:t[37]||(t[37]=r=>A("copy_link")),onMouseleave:t[38]||(t[38]=r=>f.value=null),onClick:Nt},t[54]||(t[54]=[e("span",{class:"material-icons"},"content_copy",-1)]),32),M(e("div",ls," Скопировать ссылку ",512),[[I,f.value==="copy_link"]])])):u("",!0)],64))])),se(It,{ref_key:"notificationRef",ref:X},null,512)],64))}}},bt=Me(ns,[["__scopeId","data-v-c8dc11e4"]]),is={key:0,class:"carousel-container"},as={class:"carousel-wrapper"},rs=["onClick"],us=["src","alt"],vs={class:"video-name"},ds={key:0,class:"video-player"},cs=["src"],ms={__name:"TrailerCarousel",props:{videos:{type:Array,required:!0},activeVideoIndex:{type:Number,default:null}},emits:["select"],setup(k,{emit:_}){const D=Le(),P=R(()=>D.isMobile),E=k,G=_,y=p(E.activeVideoIndex),h=p(null),H=p(!1),o=p(!1),b=()=>{if(!h.value)return;const{scrollLeft:g,scrollWidth:n,clientWidth:v}=h.value;H.value=g>0,o.value=g<n-v-1},K=g=>{if(!h.value)return;const n=h.value.querySelector(".carousel-item");if(!n)return;const v=n.clientWidth+16;h.value.scrollBy({left:v*g,behavior:"smooth"})},$=g=>{y.value=g,G("select",E.videos[g])},N=()=>b(),z=p([]),O=async g=>{try{return(await fetch("https://img.youtube.com/vi/".concat(g,"/0.jpg"))).ok}catch(n){return!1}};return De(async()=>{const g=E.videos.map(async v=>await O(v.videoId)?v:null),n=await Promise.all(g);z.value=n.filter(Boolean),b(),window.addEventListener("resize",N)}),ue(()=>E.videos,async g=>{const n=g.map(async m=>await O(m.videoId)?m:null),v=await Promise.all(n);z.value=v.filter(Boolean)}),ue(()=>E.activeVideoIndex,g=>{y.value=g}),ht(()=>{window.removeEventListener("resize",N)}),(g,n)=>z.value.length?(l(),i("div",is,[n[4]||(n[4]=e("h2",null,"Трейлеры (YouTube)",-1)),e("div",as,[M(e("button",{class:"scroll-button left",onClick:n[0]||(n[0]=v=>K(-1))},n[2]||(n[2]=[e("span",{class:"material-symbols-outlined"},"arrow_back_ios",-1)]),512),[[I,!P.value&&H.value]]),e("div",{ref_key:"carousel",ref:h,class:"carousel",onScroll:b},[(l(!0),i(J,null,Ce(z.value,(v,m)=>(l(),i("div",{key:m,class:"carousel-item",onClick:F=>$(m)},[e("img",{src:"https://img.youtube.com/vi/".concat(v.videoId,"/0.jpg"),alt:v.name},null,8,us),e("div",vs,d(v.name),1)],8,rs))),128))],544),M(e("button",{class:"scroll-button right",onClick:n[1]||(n[1]=v=>K(1))},n[3]||(n[3]=[e("span",{class:"material-symbols-outlined"},"arrow_forward_ios",-1)]),512),[[I,!P.value&&o.value]])]),y.value!==null?(l(),i("div",ds,[e("iframe",{src:k.videos[y.value].iframeUrl,frameborder:"0",allowfullscreen:""},null,8,cs)])):u("",!0)])):u("",!0)}},ps=Me(ms,[["__scopeId","data-v-5d54158b"]]),fs={class:"movie-info"},ks={class:"content"},ys={key:0,class:"content-card"},gs={class:"movie-skeleton"},_s={class:"movie-skeleton__player"},bs={key:2,class:"content-card"},ws={key:3,class:"content-card"},$s={class:"content-header"},hs={class:"content-title"},As={key:0,class:"ratings-links"},Cs={key:0},Ms=["href"],Is={key:0},Es={key:1},Ts=["href"],Rs={key:0},Ps={key:2},Ss=["href"],xs={key:0},Ls={key:3},Ds=["href"],Hs={key:0},Ns={key:4},Os=["href"],Ks={key:5},Bs=["href"],Us=["content"],Vs=["content"],zs={class:"additional-info"},qs={class:"info-content"},Ws={class:"details-container"},Ys={class:"info-list"},Fs={key:0},Gs={key:1},Xs={key:2},Zs={key:3},js={key:4},Qs={key:5},Js={key:6},el={key:7},tl={key:8},ol={class:"content-info"},sl={key:0,class:"content-description-text"},ll={key:2,class:"yt-video-container"},nl={key:3,class:"related-movies"},il={key:4,class:"related-movies"},al={__name:"MovieInfo",setup(k){const _=p(!0),D=Le(),P=wt(),E=Wt(),G=$t(),y=p(G.params.kp_id),h=p(""),H=p(null),o=p(null),b=Yt(),$=Jt().areTrailersActive,N=p(null),z=()=>{if(o.value){const c=o.value.name_ru||o.value.name_en||o.value.name_original||"Информация о фильме";document.title=c}},O=c=>(c||[]).map(s=>({kp_id:s.film_id,poster:s.poster_url_preview||s.poster_url,title:s.name_ru||s.name_en||s.name_original})),g=c=>{if(typeof c!="number")return;const s=Math.floor(c/60),B=c%60;return"".concat(s," ч. ").concat(B," мин.")},n=p(!1),v=p({top:"0px",left:"0px"}),m=c=>{n.value=!0,v.value={top:"".concat(c.pageY+10,"px"),left:"".concat(c.pageX-70,"px")}},F=p(null),le=async()=>{try{const c=[o.value.name_ru||o.value.name_en||o.value.name_original,...o.value.year?[o.value.year]:[],...o.value.film_length?[g(o.value.film_length)]:[]];await navigator.clipboard.writeText(c.join(", ")),F.value.showNotification("Скопировано")}catch(c){console.error("Ошибка копирования:",c)}},S=async(c=!0)=>{var s,B,A,Z,U,ie,q,Q;try{let W;if(y.value.startsWith("shiki")?W=await Xt(y.value):W=await Zt(y.value,P.token),Array.isArray(W)&&W.length===0)throw new Error("Данные не найдены. Пожалуйста, повторите поиск.");o.value=W,y.value.startsWith("shiki")?o.value={...o.value,title:o.value.name_ru||o.value.name_en,name_original:o.value.name_en,short_description:o.value.slogan}:o.value={...o.value,title:o.value.name_ru||o.value.name_en||o.value.name_original,kinopoisk_id:y.value},b.setHeaderContent({text:o.value.title,imageUrl:o.value.logo_url}),z();const V={kp_id:y.value,title:((s=o.value)==null?void 0:s.name_ru)||((B=o.value)==null?void 0:B.name_en)||((A=o.value)==null?void 0:A.name_original),poster:((Z=o.value)==null?void 0:Z.poster_url)||((U=o.value)==null?void 0:U.cover_url)||((ie=o.value)==null?void 0:ie.screenshots[0]),year:(q=o.value)==null?void 0:q.year,type:(Q=o.value)==null?void 0:Q.type};if(y.value.startsWith("shiki"))if(o.value.screenshots&&o.value.screenshots.length>0){const oe=Math.floor(Math.random()*o.value.screenshots.length),Ie=o.value.screenshots[oe];E.updateMoviePoster(Ie)}else V.poster&&E.updateMoviePoster(V.poster);else V.poster&&E.updateMoviePoster(V.poster);if(R(()=>D.isHistoryAllowed).value&&V.kp_id&&V.title&&c)if(P.token)try{await Ct(V.kp_id,w.HISTORY)}catch(oe){console.error("Ошибка при добавлении в историю:",oe)}else D.addToHistory({...V})}catch(W){const{message:V,code:te}=xe(W);h.value=V,H.value=te,console.error("Ошибка при загрузке информации о фильмах:",W)}},f=R(()=>{var c,s;return console.log("Трейлеры:",(c=o.value)==null?void 0:c.videos),(s=o.value)==null?void 0:s.videos}),ee=R(()=>{var c;return O((c=o.value)==null?void 0:c.sequels_and_prequels)}),ne=R(()=>{var c;return O((c=o.value)==null?void 0:c.similars)}),X=c=>{if(c.altKey&&c.keyCode===84&&document.querySelector(".player-container")){const B=document.querySelector(".theater-mode-btn");B&&B.click()}};return De(async()=>{await S(),_.value=!1,document.addEventListener("keydown",X)}),Ft(async()=>{b.clearHeaderContent(),document.removeEventListener("keydown",X)}),ue(()=>G.params.kp_id,async c=>{c&&c!==y.value&&(b.clearHeaderContent(),y.value=c,N.value=null,await S(),_.value=!1)},{immediate:!0}),ue(o,()=>{z()},{deep:!0}),(c,s)=>{var A,Z;const B=Gt("lazy");return l(),i(J,null,[e("div",fs,[e("div",ks,[_.value?(l(),i("div",ys,[e("div",gs,[s[3]||(s[3]=pt('<div class="movie-skeleton__header" data-v-e216f608><div class="movie-skeleton__title" data-v-e216f608></div></div><div class="movie-skeleton__ratings" data-v-e216f608><div class="movie-skeleton__rating-item" data-v-e216f608></div><div class="movie-skeleton__rating-item" data-v-e216f608></div><div class="movie-skeleton__rating-item" data-v-e216f608></div></div>',2)),e("div",_s,[se(Mt)]),s[4]||(s[4]=pt('<div class="movie-skeleton__controls" data-v-e216f608><div class="movie-skeleton__control-btn" data-v-e216f608></div><div class="movie-skeleton__control-btn" data-v-e216f608></div><div class="movie-skeleton__control-btn" data-v-e216f608></div><div class="movie-skeleton__control-btn" data-v-e216f608></div><div class="movie-skeleton__control-btn" data-v-e216f608></div></div><div class="movie-skeleton__additional-info" data-v-e216f608><div class="movie-skeleton__section-title" data-v-e216f608></div><div class="movie-skeleton__info-list" data-v-e216f608><div class="movie-skeleton__info-item" data-v-e216f608></div><div class="movie-skeleton__info-item" data-v-e216f608></div><div class="movie-skeleton__info-item" data-v-e216f608></div><div class="movie-skeleton__info-item" data-v-e216f608></div><div class="movie-skeleton__info-item" data-v-e216f608></div></div></div><div class="movie-skeleton__description" data-v-e216f608><div class="movie-skeleton__description-line" data-v-e216f608></div><div class="movie-skeleton__description-line" data-v-e216f608></div><div class="movie-skeleton__description-line" data-v-e216f608></div><div class="movie-skeleton__description-line" data-v-e216f608></div></div>',3))])])):u("",!0),h.value?(l(),re(At,{key:1,message:h.value,code:H.value},null,8,["message","code"])):u("",!0),h.value?(l(),i("div",bs,[(l(),re(bt,{key:y.value,"kp-id":y.value,"movie-info":o.value,"onUpdate:movieInfo":S},null,8,["kp-id","movie-info"]))])):u("",!0),o.value?(l(),i("div",ws,[e("div",$s,[o.value.logo_url?(l(),i("div",{key:0,class:"content-logo",onMousemove:m,onMouseleave:s[1]||(s[1]=U=>n.value=!1),onClick:le},[s[0]||(ft(-1,!0),(s[0]=M(e("img",{alt:"Логотип фильма",class:"content-logo"},null,512),[[B,o.value.logo_url]])).cacheIndex=0,ft(1),s[0])],32)):(l(),i("div",{key:1,onMousemove:m,onMouseleave:s[2]||(s[2]=U=>n.value=!1),onClick:le},[e("h1",hs,d(o.value.title),1)],32)),M(e("div",{class:"title-copy-tooltip",style:Se(v.value)}," Скопировать ",4),[[I,n.value]])]),o.value.kinopoisk_id||o.value.title||o.value.imdb_id||o.value.rating_imdb||o.value.shikimori_id?(l(),i("div",As,[o.value.kinopoisk_id?(l(),i("div",Cs,[e("a",{href:"https://www.kinopoisk.ru/film/".concat(o.value.kinopoisk_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[s[5]||(s[5]=e("img",{src:yt,alt:"КП",class:"rating-logo"},null,-1)),o.value.rating_kinopoisk?(l(),i("span",Is,d(o.value.rating_kinopoisk)+"/10",1)):u("",!0),s[6]||(s[6]=e("img",{src:ae,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Ms)])):u("",!0),!o.value.kinopoisk_id&&o.value.title?(l(),i("div",Es,[e("a",{href:"https://www.kinopoisk.ru/index.php?kp_query=".concat(encodeURIComponent(o.value.title+(o.value.year?" "+o.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[s[7]||(s[7]=e("img",{src:yt,alt:"КП",class:"rating-logo"},null,-1)),o.value.rating_kinopoisk?(l(),i("span",Rs,d(o.value.rating_kinopoisk)+"/10",1)):u("",!0),s[8]||(s[8]=e("img",{src:ae,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Ts)])):u("",!0),o.value.imdb_id?(l(),i("div",Ps,[e("a",{href:"https://www.imdb.com/title/".concat(o.value.imdb_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[s[9]||(s[9]=e("img",{src:gt,alt:"IMDb",class:"rating-logo"},null,-1)),o.value.rating_imdb?(l(),i("span",xs,d(o.value.rating_imdb)+"/10",1)):u("",!0),s[10]||(s[10]=e("img",{src:ae,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Ss)])):u("",!0),!o.value.imdb_id&&o.value.title?(l(),i("div",Ls,[e("a",{href:"https://www.imdb.com/find/?q=".concat(encodeURIComponent(o.value.title+(o.value.year?" "+o.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[s[11]||(s[11]=e("img",{src:gt,alt:"IMDb",class:"rating-logo"},null,-1)),o.value.rating_imdb?(l(),i("span",Hs,d(o.value.rating_imdb)+"/10",1)):u("",!0),s[12]||(s[12]=e("img",{src:ae,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Ds)])):u("",!0),o.value.shikimori_id?(l(),i("div",Ns,[e("a",{href:"https://shikimori.one/animes/".concat(o.value.shikimori_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},s[13]||(s[13]=[e("img",{src:eo,alt:"Shiki",class:"rating-logo"},null,-1),e("img",{src:ae,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)]),8,Os)])):u("",!0),o.value.imdb_id?(l(),i("div",Ks,[e("a",{href:"https://www.imdb.com/title/".concat(o.value.imdb_id,"/parentalguide"),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},s[14]||(s[14]=[e("span",null,"Parents Guide",-1),e("img",{src:ae,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)]),8,Bs)])):u("",!0)])):u("",!0),(l(),re(bt,{key:y.value,"kp-id":y.value,"movie-info":o.value,"onUpdate:movieInfo":S},null,8,["kp-id","movie-info"])),e("meta",{name:"title-and-year",content:o.value.type==="FILM"&&o.value.year?"".concat(o.value.title," (").concat(o.value.year,")"):o.value.title},null,8,Us),o.value.name_original?(l(),i("meta",{key:1,name:"original-title",content:o.value.name_original},null,8,Vs)):u("",!0),e("div",zs,[s[24]||(s[24]=e("h2",{class:"additional-info-title"},"Подробнее",-1)),e("div",qs,[e("div",Ws,[e("ul",Ys,[o.value.type&&x(kt)[o.value.type]?(l(),i("li",Fs,[s[15]||(s[15]=e("strong",null,"Тип:",-1)),L(" "+d(x(kt)[o.value.type]),1)])):u("",!0),o.value.year?(l(),i("li",Gs,[s[16]||(s[16]=e("strong",null,"Год выпуска:",-1)),L(" "+d(o.value.year),1)])):u("",!0),o.value.title?(l(),i("li",Xs,[s[17]||(s[17]=e("strong",null,"Название:",-1)),L(" "+d(o.value.title),1)])):u("",!0),o.value.name_original?(l(),i("li",Zs,[s[18]||(s[18]=e("strong",null,"Оригинальное название:",-1)),L(" "+d(o.value.name_original),1)])):u("",!0),o.value.slogan?(l(),i("li",js,[s[19]||(s[19]=e("strong",null,"Слоган:",-1)),L(" "+d(o.value.slogan),1)])):u("",!0),o.value.production_companies?(l(),i("li",Qs,[s[20]||(s[20]=e("strong",null,"Продакшн:",-1)),L(" "+d(o.value.production_companies),1)])):u("",!0),(A=o.value.countries)!=null&&A.length?(l(),i("li",Js,[s[21]||(s[21]=e("strong",null,"Страна производства:",-1)),L(" "+d(o.value.countries.map(U=>U.country).join(", ")),1)])):u("",!0),(Z=o.value.genres)!=null&&Z.length?(l(),i("li",el,[s[22]||(s[22]=e("strong",null,"Жанры:",-1)),L(" "+d(o.value.genres.map(U=>U.genre).join(", ")),1)])):u("",!0),o.value.film_length?(l(),i("li",tl,[s[23]||(s[23]=e("strong",null,"Продолжительность:",-1)),L(" "+d(g(o.value.film_length)),1)])):u("",!0)])])])]),e("div",ol,[o.value.description?(l(),i("p",sl,d(o.value.description),1)):u("",!0)]),f.value.length&&x($)?(l(),i("div",ll,[se(ps,{videos:f.value,"active-video-index":N.value,onSelect:c.playTrailer},null,8,["videos","active-video-index","onSelect"])])):u("",!0),ee.value.length?(l(),i("div",nl,[s[25]||(s[25]=e("h2",null,"Сиквелы и приквелы",-1)),se(x(_t),{"movies-list":ee.value,loading:!1,"is-history":!1},null,8,["movies-list"])])):u("",!0),ne.value.length?(l(),i("div",il,[s[26]||(s[26]=e("h2",null,"Похожие",-1)),se(x(_t),{"movies-list":ne.value,loading:!1,"is-history":!1},null,8,["movies-list"])])):u("",!0)])):u("",!0)])]),se(It,{ref_key:"notificationRef",ref:F},null,512)],64)}}},ml=Me(al,[["__scopeId","data-v-e216f608"]]);export{ml as default};
//# sourceMappingURL=MovieInfo-DkAAngEY.js.map
