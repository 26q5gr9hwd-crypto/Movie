import{_ as Me,r as p,c as R,b as i,d as l,e,s as x,t as d,K as Q,g as v,L as Ce,n as C,q as Ut,u as xe,i as bt,N as wt,l as ue,o as De,O as $t,x as re,E as ht,f as oe,P as Se,m as M,Q as I,y as L,U as w,R as Vt,D as Le,S as Re,V as qt,W as At,X as Wt,Y as zt,a as Yt,Z as pt,$ as kt,a0 as Ft,a1 as Gt}from"./index-NfEEl-AX.js";import{S as Ct,_ as ft,a as yt,M as gt}from"./MovieList-xk3dVv8K.js";import{N as Mt}from"./ToastMessage-BoX3CSBK.js";import{u as Xt,S as Zt,a as jt}from"./trailer-DJL0-XQ-.js";const ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVR4nO2ZQUoDMRSGR7eewHoFsVS0HkUUXNXqASqK2EURBPFIVRe6c+UN1CvUXWvbT4KvMAwzNnnJdCrmg1BKad7/v7y0b5IkiUQiCwGoAx3gQjEugZ0qxTeAIX6MKjMBnBOGS62AVWAPOHVYdlMu9YArYOhphLeBT+ALmOKGEd2QubaAK+B2zngFxt4GgDXgGZjgR8ch5oEkCi8DkvlnRcYLV0Apfqw10M7JvPkV6AN3FmVwK+WyZRnvMEe8ef/ibECyb2o+zRuwnpQAxeLNivQ0BvYyE46qEJ/8fK4ycJKp/X4V4n0MdDNfukkqEO9jwP1LDgD7BeKPgmgp04CL+KUz4Cp+qQxoxC+NAdsNm4c0hWkukkUa8BGfegiadbFDq3/2UAZ8xc+QVvzMtqcKYkBaZ5/MN5xEl2DgLGDZ1KswsC09FPJqXTZoNm5oA6kyMGI2FxqfkluJ0uMTDfhBXAHiHvCCWEL8/RLqlv1MPCf+TSZ+13WC7KnEfWlqcwAeU7GNjnbiQsG5UC1ZAEAt1UMhOpquk6zknMy9l20C2AA+MnEHRo9msuOCs9EH4Fp5TVQ0rqVs0plH4re02Qh1Oq1lCjypsp+5H3gKcD/gykTirqnFZ/ZDy+OGxpapzD+QePrM/2KkKfcGPcv7AdvRkz23G1x4JPIP+AY3r/ywUk/2JAAAAABJRU5ErkJggg==",Qt="/reyohoho/assets/icon-shikimori-DGvXK9Jc.svg",Pe=f=>{const _=document.createElement("div");_.style.position="fixed",_.style.top="0",_.style.left="0",_.style.width="100%",_.style.height="100%",_.style.backgroundColor="rgba(0, 0, 0, 0.8)",_.style.color="white",_.style.display="flex",_.style.justifyContent="center",_.style.alignItems="center",_.style.fontSize="2rem",_.style.zIndex="99000",_.textContent=f,document.body.appendChild(_),setTimeout(()=>{document.body.removeChild(_)},2e3)},Jt={class:"modal-content"},eo={key:0},to={key:1},oo={class:"players-list"},so=["onClick"],lo={key:0,class:"warning-icon material-icons",title:"Внимание!"},no={key:0},io={key:0,class:"warning-icon material-icons",title:"Внимание!"},ao={key:1},ro={key:0,class:"warning-icon material-icons",title:"Внимание!"},uo=["onClick"],vo={key:0,class:"warning-icon material-icons",title:"Внимание!"},co={__name:"PlayerModal",props:{players:{type:Array,required:!0},selectedPlayer:{type:Object,default:null}},emits:["close","select"],setup(f,{emit:_}){const D=f,P=_,E=p(null),G=R(()=>D.players.filter(n=>!H(n)&&!o(n))),y=R(()=>D.players.some(n=>H(n))),h=R(()=>D.players.some(n=>o(n))),H=n=>n.key.toUpperCase().includes("HDREZKA"),o=n=>n.key.toUpperCase().includes("KODIK"),b=n=>n.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"").trim(),B=n=>{P("select",n),P("close")},$=n=>D.selectedPlayer&&D.selectedPlayer.key===n.key,N=n=>{E.value=n},q=()=>{E.value=null},O=n=>{let u=D.players.filter(m=>n==="hdrezka"&&H(m)||n==="kodik"&&o(m));return n==="kodik"?u.sort((m,F)=>b(m.translate).localeCompare(b(F.translate))):u},g=n=>O(n).some(u=>u.warning);return(n,u)=>(l(),i("div",{class:"modal",onClick:u[3]||(u[3]=Ut(m=>n.$emit("close"),["self"]))},[e("div",Jt,[e("button",{class:"close",onClick:u[0]||(u[0]=m=>n.$emit("close"))},"×"),E.value?(l(),i("h2",to,[e("button",{class:"back-btn",onClick:q},"← Назад"),x(" "+d(E.value==="hdrezka"?"ReYohoho - HDrezka":"Kodik"),1)])):(l(),i("h2",eo,"Выберите плеер")),e("ul",oo,[E.value?(l(!0),i(Q,{key:1},Ce(O(E.value),m=>(l(),i("li",{key:m.key},[e("button",{class:C(["player-item",{active:$(m)}]),onClick:F=>B(m)},[x(d(b(m.translate))+" ",1),m.warning?(l(),i("span",vo,"warning")):v("",!0)],10,uo)]))),128)):(l(),i(Q,{key:0},[(l(!0),i(Q,null,Ce(G.value,m=>(l(),i("li",{key:m.key},[e("button",{class:C(["player-item",{active:$(m)}]),onClick:F=>B(m)},[x(d(b(m.translate))+" ",1),m.warning?(l(),i("span",lo,"warning")):v("",!0)],10,so)]))),128)),y.value?(l(),i("li",no,[e("button",{class:"group-item",onClick:u[1]||(u[1]=m=>N("hdrezka"))},[u[4]||(u[4]=e("span",{class:"material-icons group-icon"},"folder",-1)),u[5]||(u[5]=x(" ReYohoho - HDrezka ")),g("hdrezka")?(l(),i("span",io,"warning")):v("",!0)])])):v("",!0),h.value?(l(),i("li",ao,[e("button",{class:"group-item",onClick:u[2]||(u[2]=m=>N("kodik"))},[u[6]||(u[6]=e("span",{class:"material-icons group-icon"},"folder",-1)),u[7]||(u[7]=x(" Kodik ")),g("kodik")?(l(),i("span",ro,"warning")):v("",!0)])])):v("",!0)],64))])])]))}},mo=Me(co,[["__scopeId","data-v-7e4f2528"]]),po={class:"players-list"},ko=["src"],fo={class:"controls"},yo={class:"material-icons"},go={class:"list-button-item"},_o={class:"material-icons"},bo={class:"list-button-item"},wo={class:"material-icons"},$o={class:"list-button-item"},ho={class:"list-button-item"},Ao={class:"material-icons"},Co={class:"list-button-item"},Mo={class:"material-icons"},Io={key:1,class:"mobile-list-buttons"},Eo={class:"tooltip-container"},To={class:"material-icons"},Ro={class:"custom-tooltip"},Po={class:"tooltip-container"},So={class:"material-icons"},Lo={class:"custom-tooltip"},xo={class:"tooltip-container"},Do={class:"custom-tooltip"},Ho={class:"tooltip-container"},No={class:"material-icons"},Oo={class:"custom-tooltip"},Ko={class:"tooltip-container"},Bo={class:"material-icons"},Uo={class:"custom-tooltip"},Vo={class:"tooltip-container"},qo={class:"material-icons"},Wo={class:"tooltip-container"},zo={class:"tooltip-container"},Yo={class:"tooltip-container"},Fo={class:"tooltip-container"},Go={class:"material-symbols-outlined"},Xo={class:"custom-tooltip"},Zo={class:"tooltip-container"},jo={class:"current-ratio"},Qo=["onClick"],Jo={key:0,class:"tooltip-container"},es={class:"custom-tooltip"},ts={key:1,class:"tooltip-container"},os={class:"custom-tooltip"},ss={__name:"PlayerComponent",props:{kpId:String,movieInfo:{type:Object,default:()=>({})}},emits:["update:selectedPlayer","update:movieInfo"],setup(f,{emit:_}){const D=xe(),P=Xt(),E=bt(),G=wt(),y=p(G.params.kp_id),h=f,H=_,o=p([]),b=p(null),B=p(!0),$=p(!1),N=p(!1),q=p(null),O=p(null),g=p(!1),n=p(""),u=p(null),m=p(window.innerHeight*.9),F=R(()=>"".concat(m.value,"px")),se=R(()=>D.isMobile),S=R(()=>!!window.electronAPI),k=p(null),J=p(!1);let le=null;const X=p(null),c=p(null),s=p(null),K=()=>{if(!c.value||!s.value)return;const a=c.value.getBoundingClientRect(),t=s.value.getBoundingClientRect(),T=window.innerHeight;a.bottom+t.height>T?(s.value.style.top="auto",s.value.style.bottom="100%",s.value.style.marginTop="0",s.value.style.marginBottom="12px",s.value.style.transform="translateX(-50%)"):(s.value.style.top="100%",s.value.style.bottom="auto",s.value.style.marginTop="12px",s.value.style.marginBottom="0",s.value.style.transform="translateX(-50%)")},A=a=>{k.value=a,J.value=!1,clearTimeout(le),Re(()=>{K()})},U=()=>{J.value||(le=setTimeout(()=>{k.value=null},300))},ne=()=>{J.value=!0,clearTimeout(le)},ie=()=>{J.value=!1,k.value=null},W=R({get:()=>P.aspectRatio,set:a=>P.updateAspectRatio(a)}),j=R({get:()=>P.isCentered,set:a=>P.updateCentering(a)}),z=R(()=>P.preferredPlayer),V=p(0),ee=a=>a.toUpperCase(),te=()=>{if($.value||!O.value)return;const[a,t]=W.value.split(":").map(Number);m.value=window.innerHeight*.9,V.value=Math.min(O.value.clientWidth*(t/a),m.value)},Ie=R(()=>{if($.value)return{};const[a,t]=W.value.split(":").map(Number),T=m.value*(a/t);return{width:"100%",maxWidth:"".concat(T,"px"),maxHeight:F.value,margin:"0 auto",overflow:"hidden"}}),It=R(()=>{const[a,t]=W.value.split(":").map(Number);return{position:"relative",width:"100%",paddingTop:"".concat(t/a*100,"%")}}),ve=()=>{O.value&&setTimeout(()=>{Re(()=>{O.value.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},500)},Et=async()=>{try{n.value="",u.value=null;const a=await Vt(h.kpId);if(o.value=Object.entries(a).map(([t,T])=>({key:t.toUpperCase(),...T})),o.value.length>0){if(z.value){const t=ee(z.value),T=o.value.find(Z=>ee(Z.key)===t);b.value=T||o.value[0]}else b.value=o.value[0];H("update:selectedPlayer",b.value)}}catch(a){const{message:t,code:T}=Le(a);n.value=t,u.value=T,console.error("Ошибка при загрузке плееров:",a)}},Tt=()=>{g.value=!0},He=()=>{g.value=!1},Rt=a=>{var t;if(((t=b.value)==null?void 0:t.key)===a.key){He();return}b.value=a,B.value=!0,P.updatePreferredPlayer(ee(a.key)),H("update:selectedPlayer",a)},Pt=()=>{S.value?window.electronAPI.sendHotKey("F2"):(Pe("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},St=()=>{S.value?window.electronAPI.sendHotKey("F3"):(Pe("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},Lt=()=>{S.value?window.electronAPI.sendHotKey("F4"):(Pe("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},$e=()=>{$.value=!$.value,$.value?(window.addEventListener("mousemove",Ee),document.addEventListener("keydown",Te),document.body.classList.add("no-scroll")):(window.removeEventListener("mousemove",Ee),document.removeEventListener("keydown",Te),document.body.classList.remove("no-scroll")),N.value=$.value,Re(()=>ve())},Ne=p(null),Ee=()=>{Ne.value=setTimeout(()=>{clearTimeout(Ne.value),N.value=!1},4e3),N.value=!0},he=R(()=>D.dimmingEnabled),xt=()=>{$.value||D.toggleDimming()},Te=a=>{(a.key==="Escape"&&$.value||a.altKey&&a.keyCode===84)&&$e()},Oe=a=>{W.value=a,setTimeout(()=>{j.value&&ve()},310)},Dt=()=>{const a="reyohoho://#".concat(y.value);try{window.location.href=a}catch(t){console.error("Ошибка при открытии ссылки:",t)}},Ht=()=>{const a=window.location.href;navigator.clipboard.writeText(a).then(()=>{}),X.value.showNotification("Ссылка на фильм скопирована")},Nt=()=>{B.value=!1};function Ot(a){return a.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"KODIK - ").trim()}ue(b,a=>{a&&(B.value=!0,P.updatePreferredPlayer(ee(a.key)),H("update:selectedPlayer",a))}),ue(()=>G.params.kp_id,async a=>{a&&a!==y.value&&(y.value=a,j.value&&ve())},{immediate:!0});const Ae=["16:9","12:5","4:3"],Kt=()=>{const t=(Ae.indexOf(W.value)+1)%Ae.length;Oe(Ae[t])},Bt=a=>{var T,Z,de,ce,me,pe,ke,fe,ye,ge,_e,be,we;return(we={[w.FAVORITE]:((Z=(T=h.movieInfo)==null?void 0:T.lists)==null?void 0:Z.isFavorite)||!1,[w.HISTORY]:((ce=(de=h.movieInfo)==null?void 0:de.lists)==null?void 0:ce.isHistory)||!1,[w.LATER]:((pe=(me=h.movieInfo)==null?void 0:me.lists)==null?void 0:pe.isLater)||!1,[w.COMPLETED]:((fe=(ke=h.movieInfo)==null?void 0:ke.lists)==null?void 0:fe.isCompleted)||!1,[w.ABANDONED]:((ge=(ye=h.movieInfo)==null?void 0:ye.lists)==null?void 0:ge.isAbandoned)||!1,[w.WATCHING]:((be=(_e=h.movieInfo)==null?void 0:_e.lists)==null?void 0:be.isWatching)||!1}[a])!=null?we:!1},Y=async a=>{if(!E.token){X.value.showNotification("Необходимо авторизоваться",5e3);return}try{const t={[w.FAVORITE]:"избранное",[w.HISTORY]:"историю",[w.LATER]:'список "Смотреть позже"',[w.COMPLETED]:'список "Просмотрено"',[w.ABANDONED]:'список "Брошено"',[w.WATCHING]:'список "Смотрю"'};Bt(a)?(await qt(y.value,a),X.value.showNotification("Удалено из ".concat(t[a]))):(await At(y.value,a),X.value.showNotification("Добавлено в ".concat(t[a])))}catch(t){const{message:T,code:Z}=Le(t);X.value.showNotification("".concat(T," ").concat(Z))}H("update:movieInfo")};return De(()=>{B.value=!0,Et(),se.value&&(W.value="4:3"),te(),window.addEventListener("resize",te),window.addEventListener("resize",K),j.value&&ve()}),$t(()=>{window.removeEventListener("resize",te),window.removeEventListener("resize",K),window.removeEventListener("mousemove",Ee),document.removeEventListener("keydown",Te),document.body.classList.remove("no-scroll")}),(a,t)=>{var T,Z,de,ce,me,pe,ke,fe,ye,ge,_e,be,we,Ke,Be,Ue,Ve,qe,We,ze,Ye,Fe,Ge,Xe,Ze,je,Qe,Je,et,tt,ot,st,lt,nt,it,at,rt,ut,vt,dt,ct,mt;return n.value?(l(),re(ht,{key:0,message:n.value,code:u.value},null,8,["message","code"])):(l(),i(Q,{key:1},[e("div",po,[t[39]||(t[39]=e("span",null,"Плеер:",-1)),e("button",{class:"player-btn",onClick:Tt},d(b.value?Ot(b.value.translate).toUpperCase():"Загрузка плееров..."),1)]),g.value?(l(),re(mo,{key:0,players:o.value,"selected-player":b.value,onClose:He,onSelect:Rt},null,8,["players","selected-player"])):v("",!0),e("div",{ref_key:"containerRef",ref:O,class:C(["player-container",{"theater-mode":$.value}]),style:Se($.value?{}:Ie.value)},[e("div",{class:"iframe-wrapper",style:Se($.value?{}:It.value)},[M(e("iframe",{ref_key:"playerIframe",ref:q,src:(T=b.value)==null?void 0:T.iframe,frameborder:"0",allowfullscreen:"",webkitallowfullscreen:"",class:C(["responsive-iframe",{"theater-mode-unlock":N.value,"theater-mode-lock":$.value,dimmed:he.value}]),onLoad:Nt},null,42,ko),[[I,!B.value&&((Z=b.value)==null?void 0:Z.iframe)]]),B.value?(l(),re(Ct,{key:0})):v("",!0)],4),$.value?(l(),i("button",{key:0,class:C(["close-theater-btn",{visible:N.value}]),onClick:$e}," ✖ ",2)):v("",!0)],6),e("div",fo,[se.value?(l(),i("div",Io,[e("div",Eo,[e("button",{class:C(["favorite-btn",{active:(je=(Ze=f.movieInfo)==null?void 0:Ze.lists)==null?void 0:je.isFavorite}]),onMouseenter:t[7]||(t[7]=r=>A("favorite")),onMouseleave:t[8]||(t[8]=r=>k.value=null),onClick:t[9]||(t[9]=r=>Y(L(w).FAVORITE))},[e("span",To,d((Je=(Qe=f.movieInfo)==null?void 0:Qe.lists)!=null&&Je.isFavorite?"favorite":"favorite_border"),1)],34),M(e("div",Ro,d("В избранное"),512),[[I,k.value==="favorite"]])]),e("div",Po,[e("button",{class:C(["watching-btn",{active:(tt=(et=f.movieInfo)==null?void 0:et.lists)==null?void 0:tt.isWatching}]),onMouseenter:t[10]||(t[10]=r=>A("watching")),onMouseleave:t[11]||(t[11]=r=>k.value=null),onClick:t[12]||(t[12]=r=>Y(L(w).WATCHING))},[e("span",So,d((st=(ot=f.movieInfo)==null?void 0:ot.lists)!=null&&st.isWatching?"visibility":"visibility_off"),1)],34),M(e("div",Lo,d("Смотрю"),512),[[I,k.value==="watching"]])]),e("div",xo,[e("button",{class:C(["later-btn",{active:(nt=(lt=f.movieInfo)==null?void 0:lt.lists)==null?void 0:nt.isLater}]),onMouseenter:t[13]||(t[13]=r=>A("later")),onMouseleave:t[14]||(t[14]=r=>k.value=null),onClick:t[15]||(t[15]=r=>Y(L(w).LATER))},t[45]||(t[45]=[e("span",{class:"material-icons"},"watch_later",-1)]),34),M(e("div",Do,d("Смотреть позже"),512),[[I,k.value==="later"]])]),e("div",Ho,[e("button",{class:C(["completed-btn",{active:(at=(it=f.movieInfo)==null?void 0:it.lists)==null?void 0:at.isCompleted}]),onMouseenter:t[16]||(t[16]=r=>A("completed")),onMouseleave:t[17]||(t[17]=r=>k.value=null),onClick:t[18]||(t[18]=r=>Y(L(w).COMPLETED))},[e("span",No,d((ut=(rt=f.movieInfo)==null?void 0:rt.lists)!=null&&ut.isCompleted?"check_circle":"check_circle_outline"),1)],34),M(e("div",Oo,d("Просмотрено"),512),[[I,k.value==="completed"]])]),e("div",Ko,[e("button",{class:C(["abandoned-btn",{active:(dt=(vt=f.movieInfo)==null?void 0:vt.lists)==null?void 0:dt.isAbandoned}]),onMouseenter:t[19]||(t[19]=r=>A("abandoned")),onMouseleave:t[20]||(t[20]=r=>k.value=null),onClick:t[21]||(t[21]=r=>Y(L(w).ABANDONED))},[e("span",Bo,d(((mt=(ct=f.movieInfo)==null?void 0:ct.lists)!=null&&mt.isAbandoned,"not_interested")),1)],34),M(e("div",Uo,d("Брошено"),512),[[I,k.value==="abandoned"]])])])):(l(),i("div",{key:0,class:"tooltip-container list-buttons-container",ref_key:"tooltipContainer",ref:c},[e("button",{class:C(["favorite-btn",{active:(ce=(de=f.movieInfo)==null?void 0:de.lists)==null?void 0:ce.isFavorite}]),onMouseenter:t[0]||(t[0]=r=>A("favorite")),onMouseleave:U,onClick:t[1]||(t[1]=r=>Y(L(w).FAVORITE))},[e("span",yo,d((pe=(me=f.movieInfo)==null?void 0:me.lists)!=null&&pe.isFavorite?"favorite":"favorite_border"),1)],34),M(e("div",{class:"custom-tooltip advanced-tooltip list-buttons-dropdown",ref_key:"tooltip",ref:s,onMouseenter:ne,onMouseleave:ie},[e("div",go,[e("button",{class:C(["favorite-btn",{active:(fe=(ke=f.movieInfo)==null?void 0:ke.lists)==null?void 0:fe.isFavorite}]),onClick:t[2]||(t[2]=r=>Y(L(w).FAVORITE))},[e("span",_o,d((ge=(ye=f.movieInfo)==null?void 0:ye.lists)!=null&&ge.isFavorite?"favorite":"favorite_border"),1),t[40]||(t[40]=e("span",{class:"button-label"},"В избранное",-1))],2)]),e("div",bo,[e("button",{class:C(["watching-btn",{active:(be=(_e=f.movieInfo)==null?void 0:_e.lists)==null?void 0:be.isWatching}]),onClick:t[3]||(t[3]=r=>Y(L(w).WATCHING))},[e("span",wo,d((Ke=(we=f.movieInfo)==null?void 0:we.lists)!=null&&Ke.isWatching?"visibility":"visibility_off"),1),t[41]||(t[41]=e("span",{class:"button-label"},"Смотрю",-1))],2)]),e("div",$o,[e("button",{class:C(["later-btn",{active:(Ue=(Be=f.movieInfo)==null?void 0:Be.lists)==null?void 0:Ue.isLater}]),onClick:t[4]||(t[4]=r=>Y(L(w).LATER))},t[42]||(t[42]=[e("span",{class:"material-icons"},"watch_later",-1),e("span",{class:"button-label"},"Смотреть позже",-1)]),2)]),e("div",ho,[e("button",{class:C(["completed-btn",{active:(qe=(Ve=f.movieInfo)==null?void 0:Ve.lists)==null?void 0:qe.isCompleted}]),onClick:t[5]||(t[5]=r=>Y(L(w).COMPLETED))},[e("span",Ao,d((ze=(We=f.movieInfo)==null?void 0:We.lists)!=null&&ze.isCompleted?"check_circle":"check_circle_outline"),1),t[43]||(t[43]=e("span",{class:"button-label"},"Просмотрено",-1))],2)]),e("div",Co,[e("button",{class:C(["abandoned-btn",{active:(Fe=(Ye=f.movieInfo)==null?void 0:Ye.lists)==null?void 0:Fe.isAbandoned}]),onClick:t[6]||(t[6]=r=>Y(L(w).ABANDONED))},[e("span",Mo,d(((Xe=(Ge=f.movieInfo)==null?void 0:Ge.lists)!=null&&Xe.isAbandoned,"not_interested")),1),t[44]||(t[44]=e("span",{class:"button-label"},"Брошено",-1))],2)])],544),[[I,k.value==="favorite"]])],512)),se.value?v("",!0):(l(),i(Q,{key:2},[e("div",Vo,[e("button",{class:C(["dimming-btn",{active:he.value}]),onMouseenter:t[22]||(t[22]=r=>A("dimming")),onMouseleave:t[23]||(t[23]=r=>k.value=null),onClick:xt},[e("span",qo,d(he.value?"light_mode":"dark_mode"),1)],34),M(e("div",{class:"custom-tooltip"},d(he.value?"Отключить затемнение":"Включить затемнение"),513),[[I,k.value==="dimming"]])]),e("div",Wo,[e("button",{class:C(["blur-btn",{"electron-only":!S.value}]),onMouseenter:t[24]||(t[24]=r=>A("blur")),onMouseleave:t[25]||(t[25]=r=>k.value=null),onClick:Pt},t[46]||(t[46]=[e("span",{class:"material-icons"},"blur_on",-1)]),34),M(e("div",{class:"custom-tooltip"},d(S.value?"Блюр":"Блюр, функция доступна в приложении"),513),[[I,k.value==="blur"]])]),e("div",zo,[e("button",{class:C(["material-symbols-outlined",{"electron-only":!S.value}]),onMouseenter:t[26]||(t[26]=r=>A("compressor")),onMouseleave:t[27]||(t[27]=r=>k.value=null),onClick:St},t[47]||(t[47]=[e("span",{class:"material-icons"},"graphic_eq",-1)]),34),M(e("div",{class:"custom-tooltip"},d(S.value?"Компрессор":"Компрессор, функция доступна в приложении"),513),[[I,k.value==="compressor"]])]),e("div",Yo,[e("button",{class:C(["mirror-btn",{"electron-only":!S.value}]),onMouseenter:t[28]||(t[28]=r=>A("mirror")),onMouseleave:t[29]||(t[29]=r=>k.value=null),onClick:Lt},t[48]||(t[48]=[e("span",{class:"material-icons"},"flip",-1)]),34),M(e("div",{class:"custom-tooltip"},d(S.value?"Зеркало":"Зеркало, функция доступна в приложении"),513),[[I,k.value==="mirror"]])]),e("div",Fo,[e("button",{class:"theater-mode-btn",onMouseenter:t[30]||(t[30]=r=>A("theater")),onMouseleave:t[31]||(t[31]=r=>k.value=null),onClick:$e},[e("span",Go,d($.value?"fullscreen_exit":"aspect_ratio"),1)],32),M(e("div",Xo,[x(d($.value?"Выйти из театрального режима":"Театральный режим")+" ",1),t[49]||(t[49]=e("span",{class:"shortcut-hint"},"Alt+T",-1))],512),[[I,k.value==="theater"]])]),e("div",Zo,[e("button",{class:"aspect-ratio-dropdown-btn",onMouseenter:t[32]||(t[32]=r=>A("aspect_ratio")),onMouseleave:U,onClick:Kt},[e("span",jo,d(W.value),1)],32),M(e("div",{class:"custom-tooltip advanced-tooltip aspect-ratio-dropdown",onMouseenter:ne,onMouseleave:ie},[(l(),i(Q,null,Ce(Ae,r=>e("div",{key:r,class:C(["aspect-ratio-option",{active:W.value===r}]),onClick:al=>Oe(r)},d(r),11,Qo)),64))],544),[[I,k.value==="aspect_ratio"]])]),e("div",{class:"tooltip-container",onMouseenter:t[34]||(t[34]=r=>A("centering")),onMouseleave:U},[e("button",{class:"center-btn",onClick:ve},t[50]||(t[50]=[e("span",{class:"material-icons"},"center_focus_strong",-1)])),M(e("div",{class:"custom-tooltip advanced-tooltip",onMouseenter:ne,onMouseleave:ie},[t[51]||(t[51]=x(" Отцентрировать плеер ")),oe(Zt,{modelValue:j.value,"onUpdate:modelValue":t[33]||(t[33]=r=>j.value=r),title:"Автоцентрирование плеера"},null,8,["modelValue"]),t[52]||(t[52]=e("span",{class:"tooltip-title"},"Автоцентрирование плеера",-1))],544),[[I,k.value==="centering"]])],32),S.value?v("",!0):(l(),i("div",Jo,[e("button",{class:"app-link-btn",onMouseenter:t[35]||(t[35]=r=>A("app_link")),onMouseleave:t[36]||(t[36]=r=>k.value=null),onClick:Dt},t[53]||(t[53]=[e("span",{class:"material-icons"},"open_in_new",-1)]),32),M(e("div",es," Открыть в приложении ",512),[[I,k.value==="app_link"]])])),S.value?(l(),i("div",ts,[e("button",{class:"copy-link-btn",onMouseenter:t[37]||(t[37]=r=>A("copy_link")),onMouseleave:t[38]||(t[38]=r=>k.value=null),onClick:Ht},t[54]||(t[54]=[e("span",{class:"material-icons"},"content_copy",-1)]),32),M(e("div",os," Скопировать ссылку ",512),[[I,k.value==="copy_link"]])])):v("",!0)],64))]),oe(Mt,{ref_key:"notificationRef",ref:X},null,512)],64))}}},_t=Me(ss,[["__scopeId","data-v-442571cc"]]),ls={key:0,class:"carousel-container"},ns={class:"carousel-wrapper"},is=["onClick"],as=["src","alt"],rs={class:"video-name"},us={key:0,class:"video-player"},vs=["src"],ds={__name:"TrailerCarousel",props:{videos:{type:Array,required:!0},activeVideoIndex:{type:Number,default:null}},emits:["select"],setup(f,{emit:_}){const D=xe(),P=R(()=>D.isMobile),E=f,G=_,y=p(E.activeVideoIndex),h=p(null),H=p(!1),o=p(!1),b=()=>{if(!h.value)return;const{scrollLeft:g,scrollWidth:n,clientWidth:u}=h.value;H.value=g>0,o.value=g<n-u-1},B=g=>{if(!h.value)return;const n=h.value.querySelector(".carousel-item");if(!n)return;const u=n.clientWidth+16;h.value.scrollBy({left:u*g,behavior:"smooth"})},$=g=>{y.value=g,G("select",E.videos[g])},N=()=>b(),q=p([]),O=async g=>{try{return(await fetch("https://img.youtube.com/vi/".concat(g,"/0.jpg"))).ok}catch(n){return!1}};return De(async()=>{const g=E.videos.map(async u=>await O(u.videoId)?u:null),n=await Promise.all(g);q.value=n.filter(Boolean),b(),window.addEventListener("resize",N)}),ue(()=>E.videos,async g=>{const n=g.map(async m=>await O(m.videoId)?m:null),u=await Promise.all(n);q.value=u.filter(Boolean)}),ue(()=>E.activeVideoIndex,g=>{y.value=g}),$t(()=>{window.removeEventListener("resize",N)}),(g,n)=>q.value.length?(l(),i("div",ls,[n[4]||(n[4]=e("h2",null,"Трейлеры (YouTube)",-1)),e("div",ns,[M(e("button",{class:"scroll-button left",onClick:n[0]||(n[0]=u=>B(-1))},n[2]||(n[2]=[e("span",{class:"material-symbols-outlined"},"arrow_back_ios",-1)]),512),[[I,!P.value&&H.value]]),e("div",{ref_key:"carousel",ref:h,class:"carousel",onScroll:b},[(l(!0),i(Q,null,Ce(q.value,(u,m)=>(l(),i("div",{key:m,class:"carousel-item",onClick:F=>$(m)},[e("img",{src:"https://img.youtube.com/vi/".concat(u.videoId,"/0.jpg"),alt:u.name},null,8,as),e("div",rs,d(u.name),1)],8,is))),128))],544),M(e("button",{class:"scroll-button right",onClick:n[1]||(n[1]=u=>B(1))},n[3]||(n[3]=[e("span",{class:"material-symbols-outlined"},"arrow_forward_ios",-1)]),512),[[I,!P.value&&o.value]])]),y.value!==null?(l(),i("div",us,[e("iframe",{src:f.videos[y.value].iframeUrl,frameborder:"0",allowfullscreen:""},null,8,vs)])):v("",!0)])):v("",!0)}},cs=Me(ds,[["__scopeId","data-v-5d54158b"]]),ms={class:"movie-info"},ps={class:"content"},ks={key:0,class:"content-card"},fs={class:"movie-skeleton"},ys={class:"movie-skeleton__player"},gs={key:2,class:"content-card"},_s={key:3,class:"content-card"},bs={class:"content-header"},ws=["src"],$s={class:"content-title"},hs={key:0,class:"ratings-links"},As={key:0},Cs=["href"],Ms={key:0},Is={key:1},Es=["href"],Ts={key:0},Rs={key:2},Ps=["href"],Ss={key:0},Ls={key:3},xs=["href"],Ds={key:0},Hs={key:4},Ns=["href"],Os={key:5},Ks=["href"],Bs=["content"],Us=["content"],Vs={class:"additional-info"},qs={class:"info-content"},Ws={class:"details-container"},zs={class:"info-list"},Ys={key:0},Fs={key:1},Gs={key:2},Xs={key:3},Zs={key:4},js={key:5},Qs={key:6},Js={key:7},el={key:8},tl={class:"content-info"},ol={key:0,class:"content-description-text"},sl={key:2,class:"yt-video-container"},ll={key:3,class:"related-movies"},nl={key:4,class:"related-movies"},il={__name:"MovieInfo",setup(f){const _=p(!0),D=xe(),P=bt(),E=Wt(),G=wt(),y=p(G.params.kp_id),h=p(""),H=p(null),o=p(null),b=zt(),$=jt().areTrailersActive,N=p(null),q=()=>{if(o.value){const c=o.value.name_ru||o.value.name_en||o.value.name_original||"Информация о фильме";document.title=c}},O=c=>(c||[]).map(s=>({kp_id:s.film_id,poster:s.poster_url_preview||s.poster_url,title:s.name_ru||s.name_en||s.name_original})),g=c=>{if(typeof c!="number")return;const s=Math.floor(c/60),K=c%60;return"".concat(s," ч. ").concat(K," мин.")},n=p(!1),u=p({top:"0px",left:"0px"}),m=c=>{n.value=!0,u.value={top:"".concat(c.pageY+10,"px"),left:"".concat(c.pageX-70,"px")}},F=p(null),se=async()=>{try{const c=[o.value.name_ru||o.value.name_en||o.value.name_original,...o.value.year?[o.value.year]:[],...o.value.film_length?[g(o.value.film_length)]:[]];await navigator.clipboard.writeText(c.join(", ")),F.value.showNotification("Скопировано")}catch(c){console.error("Ошибка копирования:",c)}},S=async(c=!0)=>{var s,K,A,U,ne,ie,W,j;try{let z;if(y.value.startsWith("shiki")?z=await Ft(y.value):z=await Gt(y.value,P.token),Array.isArray(z)&&z.length===0)throw new Error("Данные не найдены. Пожалуйста, повторите поиск.");o.value=z,y.value.startsWith("shiki")?o.value={...o.value,title:o.value.name_ru||o.value.name_en,name_original:o.value.name_en,short_description:o.value.slogan}:o.value={...o.value,title:o.value.name_ru||o.value.name_en||o.value.name_original,kinopoisk_id:y.value},b.setHeaderContent({text:o.value.title,imageUrl:o.value.logo_url}),q();const V={kp_id:y.value,title:((s=o.value)==null?void 0:s.name_ru)||((K=o.value)==null?void 0:K.name_en)||((A=o.value)==null?void 0:A.name_original),poster:((U=o.value)==null?void 0:U.poster_url)||((ne=o.value)==null?void 0:ne.cover_url)||((ie=o.value)==null?void 0:ie.screenshots[0]),year:(W=o.value)==null?void 0:W.year,type:(j=o.value)==null?void 0:j.type};if(y.value.startsWith("shiki"))if(o.value.screenshots&&o.value.screenshots.length>0){const te=Math.floor(Math.random()*o.value.screenshots.length),Ie=o.value.screenshots[te];E.updateMoviePoster(Ie)}else V.poster&&E.updateMoviePoster(V.poster);else V.poster&&E.updateMoviePoster(V.poster);if(R(()=>D.isHistoryAllowed).value&&V.kp_id&&V.title&&c)if(P.token)try{await At(V.kp_id,w.HISTORY)}catch(te){console.error("Ошибка при добавлении в историю:",te)}else D.addToHistory({...V})}catch(z){const{message:V,code:ee}=Le(z);h.value=V,H.value=ee,console.error("Ошибка при загрузке информации о фильмах:",z)}},k=R(()=>{var c,s;return console.log("Трейлеры:",(c=o.value)==null?void 0:c.videos),(s=o.value)==null?void 0:s.videos}),J=R(()=>{var c;return O((c=o.value)==null?void 0:c.sequels_and_prequels)}),le=R(()=>{var c;return O((c=o.value)==null?void 0:c.similars)}),X=c=>{if(c.altKey&&c.keyCode===84&&document.querySelector(".player-container")){const K=document.querySelector(".theater-mode-btn");K&&K.click()}};return De(async()=>{await S(),_.value=!1,document.addEventListener("keydown",X)}),Yt(async()=>{b.clearHeaderContent(),document.removeEventListener("keydown",X)}),ue(()=>G.params.kp_id,async c=>{c&&c!==y.value&&(b.clearHeaderContent(),y.value=c,N.value=null,await S(),_.value=!1)},{immediate:!0}),ue(o,()=>{q()},{deep:!0}),(c,s)=>{var K,A;return l(),i(Q,null,[e("div",ms,[e("div",ps,[_.value?(l(),i("div",ks,[e("div",fs,[s[2]||(s[2]=pt('<div class="movie-skeleton__header" data-v-25a5565d><div class="movie-skeleton__title" data-v-25a5565d></div></div><div class="movie-skeleton__ratings" data-v-25a5565d><div class="movie-skeleton__rating-item" data-v-25a5565d></div><div class="movie-skeleton__rating-item" data-v-25a5565d></div><div class="movie-skeleton__rating-item" data-v-25a5565d></div></div>',2)),e("div",ys,[oe(Ct)]),s[3]||(s[3]=pt('<div class="movie-skeleton__controls" data-v-25a5565d><div class="movie-skeleton__control-btn" data-v-25a5565d></div><div class="movie-skeleton__control-btn" data-v-25a5565d></div><div class="movie-skeleton__control-btn" data-v-25a5565d></div><div class="movie-skeleton__control-btn" data-v-25a5565d></div><div class="movie-skeleton__control-btn" data-v-25a5565d></div></div><div class="movie-skeleton__additional-info" data-v-25a5565d><div class="movie-skeleton__section-title" data-v-25a5565d></div><div class="movie-skeleton__info-list" data-v-25a5565d><div class="movie-skeleton__info-item" data-v-25a5565d></div><div class="movie-skeleton__info-item" data-v-25a5565d></div><div class="movie-skeleton__info-item" data-v-25a5565d></div><div class="movie-skeleton__info-item" data-v-25a5565d></div><div class="movie-skeleton__info-item" data-v-25a5565d></div></div></div><div class="movie-skeleton__description" data-v-25a5565d><div class="movie-skeleton__description-line" data-v-25a5565d></div><div class="movie-skeleton__description-line" data-v-25a5565d></div><div class="movie-skeleton__description-line" data-v-25a5565d></div><div class="movie-skeleton__description-line" data-v-25a5565d></div></div>',3))])])):v("",!0),h.value?(l(),re(ht,{key:1,message:h.value,code:H.value},null,8,["message","code"])):v("",!0),h.value?(l(),i("div",gs,[(l(),re(_t,{key:y.value,"kp-id":y.value,"movie-info":o.value,"onUpdate:movieInfo":S},null,8,["kp-id","movie-info"]))])):v("",!0),o.value?(l(),i("div",_s,[e("div",bs,[o.value.logo_url?(l(),i("div",{key:0,class:"content-logo",onMousemove:m,onMouseleave:s[0]||(s[0]=U=>n.value=!1),onClick:se},[e("img",{src:o.value.logo_url,alt:"Логотип фильма",class:"content-logo"},null,8,ws)],32)):(l(),i("div",{key:1,onMousemove:m,onMouseleave:s[1]||(s[1]=U=>n.value=!1),onClick:se},[e("h1",$s,d(o.value.title),1)],32)),M(e("div",{class:"title-copy-tooltip",style:Se(u.value)}," Скопировать ",4),[[I,n.value]])]),o.value.kinopoisk_id||o.value.title||o.value.imdb_id||o.value.rating_imdb||o.value.shikimori_id?(l(),i("div",hs,[o.value.kinopoisk_id?(l(),i("div",As,[e("a",{href:"https://www.kinopoisk.ru/film/".concat(o.value.kinopoisk_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[s[4]||(s[4]=e("img",{src:ft,alt:"КП",class:"rating-logo"},null,-1)),o.value.rating_kinopoisk?(l(),i("span",Ms,d(o.value.rating_kinopoisk)+"/10",1)):v("",!0),s[5]||(s[5]=e("img",{src:ae,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Cs)])):v("",!0),!o.value.kinopoisk_id&&o.value.title?(l(),i("div",Is,[e("a",{href:"https://www.kinopoisk.ru/index.php?kp_query=".concat(encodeURIComponent(o.value.title+(o.value.year?" "+o.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[s[6]||(s[6]=e("img",{src:ft,alt:"КП",class:"rating-logo"},null,-1)),o.value.rating_kinopoisk?(l(),i("span",Ts,d(o.value.rating_kinopoisk)+"/10",1)):v("",!0),s[7]||(s[7]=e("img",{src:ae,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Es)])):v("",!0),o.value.imdb_id?(l(),i("div",Rs,[e("a",{href:"https://www.imdb.com/title/".concat(o.value.imdb_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[s[8]||(s[8]=e("img",{src:yt,alt:"IMDb",class:"rating-logo"},null,-1)),o.value.rating_imdb?(l(),i("span",Ss,d(o.value.rating_imdb)+"/10",1)):v("",!0),s[9]||(s[9]=e("img",{src:ae,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Ps)])):v("",!0),!o.value.imdb_id&&o.value.title?(l(),i("div",Ls,[e("a",{href:"https://www.imdb.com/find/?q=".concat(encodeURIComponent(o.value.title+(o.value.year?" "+o.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[s[10]||(s[10]=e("img",{src:yt,alt:"IMDb",class:"rating-logo"},null,-1)),o.value.rating_imdb?(l(),i("span",Ds,d(o.value.rating_imdb)+"/10",1)):v("",!0),s[11]||(s[11]=e("img",{src:ae,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,xs)])):v("",!0),o.value.shikimori_id?(l(),i("div",Hs,[e("a",{href:"https://shikimori.one/animes/".concat(o.value.shikimori_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},s[12]||(s[12]=[e("img",{src:Qt,alt:"Shiki",class:"rating-logo"},null,-1),e("img",{src:ae,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)]),8,Ns)])):v("",!0),o.value.imdb_id?(l(),i("div",Os,[e("a",{href:"https://www.imdb.com/title/".concat(o.value.imdb_id,"/parentalguide"),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},s[13]||(s[13]=[e("span",null,"Parents Guide",-1),e("img",{src:ae,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)]),8,Ks)])):v("",!0)])):v("",!0),(l(),re(_t,{key:y.value,"kp-id":y.value,"movie-info":o.value,"onUpdate:movieInfo":S},null,8,["kp-id","movie-info"])),e("meta",{name:"title-and-year",content:o.value.type==="FILM"&&o.value.year?"".concat(o.value.title," (").concat(o.value.year,")"):o.value.title},null,8,Bs),o.value.name_original?(l(),i("meta",{key:1,name:"original-title",content:o.value.name_original},null,8,Us)):v("",!0),e("div",Vs,[s[23]||(s[23]=e("h2",{class:"additional-info-title"},"Подробнее",-1)),e("div",qs,[e("div",Ws,[e("ul",zs,[o.value.type&&L(kt)[o.value.type]?(l(),i("li",Ys,[s[14]||(s[14]=e("strong",null,"Тип:",-1)),x(" "+d(L(kt)[o.value.type]),1)])):v("",!0),o.value.year?(l(),i("li",Fs,[s[15]||(s[15]=e("strong",null,"Год выпуска:",-1)),x(" "+d(o.value.year),1)])):v("",!0),o.value.title?(l(),i("li",Gs,[s[16]||(s[16]=e("strong",null,"Название:",-1)),x(" "+d(o.value.title),1)])):v("",!0),o.value.name_original?(l(),i("li",Xs,[s[17]||(s[17]=e("strong",null,"Оригинальное название:",-1)),x(" "+d(o.value.name_original),1)])):v("",!0),o.value.slogan?(l(),i("li",Zs,[s[18]||(s[18]=e("strong",null,"Слоган:",-1)),x(" "+d(o.value.slogan),1)])):v("",!0),o.value.production_companies?(l(),i("li",js,[s[19]||(s[19]=e("strong",null,"Продакшн:",-1)),x(" "+d(o.value.production_companies),1)])):v("",!0),(K=o.value.countries)!=null&&K.length?(l(),i("li",Qs,[s[20]||(s[20]=e("strong",null,"Страна производства:",-1)),x(" "+d(o.value.countries.map(U=>U.country).join(", ")),1)])):v("",!0),(A=o.value.genres)!=null&&A.length?(l(),i("li",Js,[s[21]||(s[21]=e("strong",null,"Жанры:",-1)),x(" "+d(o.value.genres.map(U=>U.genre).join(", ")),1)])):v("",!0),o.value.film_length?(l(),i("li",el,[s[22]||(s[22]=e("strong",null,"Продолжительность:",-1)),x(" "+d(g(o.value.film_length)),1)])):v("",!0)])])])]),e("div",tl,[o.value.description?(l(),i("p",ol,d(o.value.description),1)):v("",!0)]),k.value.length&&L($)?(l(),i("div",sl,[oe(cs,{videos:k.value,"active-video-index":N.value,onSelect:c.playTrailer},null,8,["videos","active-video-index","onSelect"])])):v("",!0),J.value.length?(l(),i("div",ll,[s[24]||(s[24]=e("h2",null,"Сиквелы и приквелы",-1)),oe(L(gt),{"movies-list":J.value,loading:!1,"is-history":!1},null,8,["movies-list"])])):v("",!0),le.value.length?(l(),i("div",nl,[s[25]||(s[25]=e("h2",null,"Похожие",-1)),oe(L(gt),{"movies-list":le.value,loading:!1,"is-history":!1},null,8,["movies-list"])])):v("",!0)])):v("",!0)])]),oe(Mt,{ref_key:"notificationRef",ref:F},null,512)],64)}}},cl=Me(il,[["__scopeId","data-v-25a5565d"]]);export{cl as default};
//# sourceMappingURL=MovieInfo-CyjMTimu.js.map
