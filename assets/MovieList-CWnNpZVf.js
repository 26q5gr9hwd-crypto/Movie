import{_ as L,b as l,i as a,d,e as T,j as w,t as S,F as N,f as X,aR as I,v as Z,c as y,q as te,u as V,m as x,s as ae,n as D,D as B,ac as z,l as A,ad as Y,a9 as J,aS as Q,o as p,p as se,w as _,aT as ie,r as M,Y as F,aG as q,k as oe,$ as W,x as le,G as ne,S as re,A as ue,a as ve,aj as de,U as ce,K as me}from"./index-DlZlNxKr.js";import{S as he}from"./SpinnerLoading-D0qeAUMs.js";import{_ as fe,a as we,b as ge}from"./icon-imdb-logo-5qtstUwS.js";const ye={},be={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 50 59",class:"bin"};function ke(e,h){return a(),l("svg",be,h[0]||(h[0]=[d("path",{fill:"#B5BAC1",d:"M0 7.5C0 5.01472 2.01472 3 4.5 3H45.5C47.9853 3 50 5.01472 50 7.5V7.5C50 8.32843 49.3284 9 48.5 9H1.5C0.671571 9 0 8.32843 0 7.5V7.5Z"},null,-1),d("path",{fill:"#B5BAC1",d:"M17 3C17 1.34315 18.3431 0 20 0H29.3125C30.9694 0 32.3125 1.34315 32.3125 3V3H17V3Z"},null,-1),d("path",{fill:"#B5BAC1",d:"M2.18565 18.0974C2.08466 15.821 3.903 13.9202 6.18172 13.9202H43.8189C46.0976 13.9202 47.916 15.821 47.815 18.0975L46.1699 55.1775C46.0751 57.3155 44.314 59.0002 42.1739 59.0002H7.8268C5.68661 59.0002 3.92559 57.3155 3.83073 55.1775L2.18565 18.0974ZM18.0003 49.5402C16.6196 49.5402 15.5003 48.4209 15.5003 47.0402V24.9602C15.5003 23.5795 16.6196 22.4602 18.0003 22.4602C19.381 22.4602 20.5003 23.5795 20.5003 24.9602V47.0402C20.5003 48.4209 19.381 49.5402 18.0003 49.5402ZM29.5003 47.0402C29.5003 48.4209 30.6196 49.5402 32.0003 49.5402C33.381 49.5402 34.5003 48.4209 34.5003 47.0402V24.9602C34.5003 23.5795 33.381 22.4602 32.0003 22.4602C30.6196 22.4602 29.5003 23.5795 29.5003 24.9602V47.0402Z","clip-rule":"evenodd","fill-rule":"evenodd"},null,-1),d("path",{fill:"#B5BAC1",d:"M2 13H48L47.6742 21.28H2.32031L2 13Z"},null,-1)]))}const ee=L(ye,[["render",ke]]),Se={class:"deleteButton"},Ce={__name:"DeleteButton",setup(e){return(h,r)=>(a(),l("button",Se,[T(ee),r[0]||(r[0]=d("span",{class:"tooltip"},"Delete",-1))]))}},Me=L(Ce,[["__scopeId","data-v-cd7aaf9f"]]),Be={class:"movie-details"},De={class:"movie-header"},Le={key:0,class:"original-title"},$e={key:1,class:"meta"},He={class:"year"},xe={key:2,class:"genres"},Te={key:0,class:"genre-count"},Ee={__name:"CardMovieDetails",props:{movie:Object,isHistory:Boolean},setup(e){const h=r=>r&&r.replace(/\(\d{4}\)$/,"").trim();return(r,u)=>{var m,c,s,n;return a(),l("div",Be,[d("div",De,[d("h3",null,S(h(e.movie.title)),1)]),(m=e.movie.raw_data)!=null&&m.name_en||(c=e.movie.raw_data)!=null&&c.Name_original?(a(),l("div",Le,S(e.movie.raw_data.name_en||e.movie.raw_data.Name_original),1)):w("",!0),e.movie.year?(a(),l("div",$e,[d("span",He,S(e.movie.year),1)])):w("",!0),(n=(s=e.movie.raw_data)==null?void 0:s.genres)!=null&&n.length?(a(),l("div",xe,[(a(!0),l(N,null,X(e.movie.raw_data.genres.slice(0,2),t=>(a(),l("span",{key:t.genre,class:"genre-tag"},S(t.genre),1))),128)),e.movie.raw_data.genres.length>2?(a(),l("span",Te," +"+S(e.movie.raw_data.genres.length-2),1)):w("",!0)])):w("",!0)])}}},Re=L(Ee,[["__scopeId","data-v-95d5b656"]]),Ve={key:0},Ie={class:"movie-poster"},Ue={key:1,class:"ratings-overlay"},ze={key:2,class:"poster-type"},Ae={key:3,class:"poster-type"},Ye={__name:"CardsMovieMainContent",props:I({movie:Object,isMobile:Boolean,isHistory:Boolean,isUserList:Boolean,showDelete:Boolean,showStar:Boolean},{isMobile:!1,isHistory:!1,isUserList:!1,showDelete:!0,showStar:!1}),emits:["remove:from-history"],setup(e,{emit:h}){const r=Z(),u=y(()=>r.cardSize),m=h;return(c,s)=>{var t;const n=te("lazy");return a(),l("div",{class:D(["movie-poster-container","card-size-".concat(u.value)])},[e.movie.poster||e.movie.cover?(a(),l("div",Ve,[V(d("img",Ie,null,512),[[n,e.movie.poster||e.movie.cover]]),!e.isMobile&&(e.isHistory||e.isUserList)&&e.showDelete?(a(),x(Me,{key:0,class:"delete-button","data-test-id":"delete-button",onClick:s[0]||(s[0]=ae(C=>m("remove:from-history",e.movie.kp_id),["stop","prevent"]))})):w("",!0),e.movie.rating_kp||e.movie.rating_imdb||e.movie.average_rating?(a(),l("div",Ue,[e.movie.rating||e.movie.average_rating?(a(),l("span",{key:0,class:D(["rating-our",{"with-star":e.showStar,[B(z)(e.movie.rating||e.movie.average_rating)]:!0}])},[s[1]||(s[1]=d("img",{src:fe,alt:"ReYohoho",class:"rating-logo"},null,-1)),A(" "+S("".concat((e.movie.rating||e.movie.average_rating).toFixed(1).replace(/\.0$/,""))),1)],2)):w("",!0),e.movie.rating_kp?(a(),l("span",{key:1,class:D(["rating-kp",B(z)(e.movie.rating_kp)])},[s[2]||(s[2]=d("img",{src:we,alt:"ÐšÐŸ",class:"rating-logo"},null,-1)),A(" "+S(e.movie.rating_kp),1)],2)):w("",!0),e.movie.rating_imdb?(a(),l("span",{key:2,class:D(["rating-imdb",B(z)(e.movie.rating_imdb)])},[s[3]||(s[3]=d("img",{src:ge,alt:"IMDb",class:"rating-logo"},null,-1)),A(" "+S(e.movie.rating_imdb),1)],2)):w("",!0)])):w("",!0),e.movie.type&&B(Y)[e.movie.type]?(a(),l("div",ze,S((t=B(Y)[e.movie.type])!=null?t:""),1)):w("",!0),e.movie.type&&!B(Y)[e.movie.type]?(a(),l("div",Ae,S(e.movie.type.replace("ðŸŽ¬","")),1)):w("",!0)])):w("",!0)],2)}}},Ne=L(Ye,[["__scopeId","data-v-3eb53f23"]]),Xe={__name:"CardMovie",props:I({movie:Object,isHistory:Boolean,isMobile:Boolean,isCardBorder:Boolean,isUserList:Boolean,index:Number,activeMovieIndex:[Number,null],showDelete:Boolean,showStar:Boolean},{isHistory:!1,isCardBorder:!1,isMobile:!1,isUserList:!1,activeMovieIndex:null,index:0,showDelete:!0,showStar:!1}),emits:["remove:from-history","save:element"],setup(e,{emit:h}){const r=J(),u=Z(),m=y(()=>r.isCardHoverDisabled),c=y(()=>u.cardSize),s=h,n=Q("element");return p(()=>{n.value&&n.value.$el&&s("save:element",n.value.$el)}),(t,C)=>{const g=se("RouterLink");return a(),x(g,{ref_key:"element",ref:n,class:D(["movie-card",{active:e.activeMovieIndex===e.index,"has-border":e.isCardBorder,"hover-disabled":m.value,"card-border":e.isCardBorder,["card-size-".concat(c.value)]:!0}]),to:{name:"movie-info",params:{kp_id:e.movie.kp_id}},"data-test-id":"movie-card-".concat(e.movie.kp_id),tabindex:"0"},{default:_(()=>[T(Ne,{movie:e.movie,"is-history":e.isHistory,"is-mobile":e.isMobile,"is-user-list":e.isUserList,"show-delete":e.showDelete,"show-star":e.showStar,"onRemove:fromHistory":C[0]||(C[0]=b=>s("remove:from-history",b))},null,8,["movie","is-history","is-mobile","is-user-list","show-delete","show-star"]),T(Re,{movie:e.movie,"is-history":e.isHistory},null,8,["movie","is-history"])]),_:1},8,["class","to","data-test-id"])}}},G=L(Xe,[["__scopeId","data-v-16d92669"]]),Fe={class:"icon-container"},Ze={__name:"CardMovieSwipeWrapper",props:I({thresholdPercent:Number,disabled:Boolean,backgroundSwipeColor:String,showDelete:Boolean},{thresholdPercent:55,disabled:!1,backgroundSwipeColor:"#e53935",showDelete:!0}),emits:["slide"],setup(e,{emit:h}){ie(o=>({"383316c0":e.backgroundSwipeColor}));const r=h,u=Q("swipeElement"),m=M(0),c=M(0),s=M(0),n=M(0),t=M(!1),C=M(0),g=M(!1),b=y(()=>c.value-m.value),$=y(()=>n.value-s.value),U=y(()=>t.value?b.value:0),E=y(()=>C.value*e.thresholdPercent/100);function H(o){var v,f;e.disabled||!e.showDelete||(C.value=(f=(v=u.value)==null?void 0:v.offsetWidth)!=null?f:0,m.value=o.touches[0].clientX,s.value=o.touches[0].clientY,c.value=m.value,n.value=s.value,t.value=!1,g.value=!1)}function R(o){if(e.disabled||g.value||!e.showDelete)return;c.value=o.touches[0].clientX,n.value=o.touches[0].clientY;const v=Math.abs(b.value),f=Math.abs($.value);!t.value&&!g.value&&(f>v?(g.value=!0,t.value=!1):v>f&&v>10&&(t.value=!0)),t.value&&o.preventDefault()}function i(){if(e.disabled||!t.value||!e.showDelete){k();return}if(b.value<-E.value){t.value=!1,W(()=>{u.value.style.transform="translateX(-100%)",u.value.style.opacity="0"}),setTimeout(()=>{r("slide"),k()},300);return}if(b.value>E.value){t.value=!1,W(()=>{u.value.style.transform="translateX(100%)",u.value.style.opacity="0"}),setTimeout(()=>{r("slide"),k()},300);return}k()}function k(){m.value=0,c.value=0,s.value=0,n.value=0,t.value=!1,g.value=!1,u.value&&(u.value.style.transform="",u.value.style.opacity="")}return(o,v)=>(a(),l("div",{class:"swipe-container",onTouchstart:H,onTouchmove:R,onTouchend:i},[V(d("div",{class:D(["swipe-background",{"swipe-left":b.value>0,"swipe-right":b.value<0}])},[V(d("div",Fe,[q(o.$slots,"swipe-icon",{},()=>[T(ee)])],512),[[F,m.value]])],2),[[F,!e.disabled&&!g.value]]),d("div",{ref_key:"swipeElement",ref:u,"data-test-id":"swipe-ref-element",class:D(["swipe-wrapper",{swiping:t.value}]),style:oe({transform:"translateX(".concat(U.value,"px)"),transition:t.value?"none":"transform 0.3s ease, opacity 0.3s ease"})},[q(o.$slots,"default",{},void 0)],6)],32))}},je=L(Ze,[["__scopeId","data-v-0467ed6e"]]),Pe={__name:"MovieList",props:I({moviesList:Array,isHistory:Boolean,loading:Boolean,showDelete:Boolean,showStar:Boolean},{isHistory:!1,loading:!0,showDelete:!0,showStar:!1}),emits:["item-deleted"],setup(e,{emit:h}){const r=Z(),u=le(),m=J(),c=ne(),s=re(),n=M([]),t=M(null),C=y(()=>m.isCardBorder),g=y(()=>r.isMobile),b=y(()=>r.cardSize),$=y(()=>{var i;return s.name==="lists"&&(!s.params.user_id||String(s.params.user_id)===String((i=u.user)==null?void 0:i.id))}),U=i=>c.resolve({name:"movie-info",params:{kp_id:i.kp_id}}).href,E=h,H=async i=>{if(u.token)try{await de(i,ce.HISTORY),E("item-deleted",i)}catch(k){const{code:o}=me(k);console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸:",k),o===401&&(u.logout(),await c.push("/login"),c.go(0))}else r.removeFromHistory(i)},R=i=>{var f,j,P,K;if(!((f=e.moviesList)!=null&&f.length)||!((P=(j=i.target)==null?void 0:j.classList)!=null&&P.contains("movie-card")))return;const k=document.querySelector(".grid"),v=window.getComputedStyle(k).gridTemplateColumns.split(" ").length;switch(i.key){case"ArrowRight":t.value=(t.value+1)%e.moviesList.length;break;case"ArrowLeft":t.value=(t.value-1+e.moviesList.length)%e.moviesList.length;break;case"ArrowUp":if(i.preventDefault(),t.value<=0){const O=document.querySelector(".search-input");O&&O.focus()}else t.value=Math.max(t.value-v,0);break;case"ArrowDown":i.preventDefault(),t.value=Math.min(t.value+v,e.moviesList.length-1);break;case"Home":t.value=0;break;case"End":t.value=e.moviesList.length-1;break;case"Enter":i.ctrlKey||i.metaKey?(i.preventDefault(),window.open(U(e.moviesList[t.value]),"_blank")):c.push({name:"movie-info",params:{kp_id:(K=e.moviesList[t.value])==null?void 0:K.kp_id}});break}};return ue(t,i=>{n.value[i]&&(n.value[i].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),n.value[i].focus())}),p(()=>{document.addEventListener("keydown",R)}),ve(()=>{document.removeEventListener("keydown",R)}),(i,k)=>(a(),l("div",null,[V(d("div",{class:D(["grid","card-size-".concat(b.value)])},[(e.isHistory||$.value)&&g.value?(a(!0),l(N,{key:0},X(e.moviesList,(o,v)=>(a(),x(B(je),{key:o.kp_id,"data-test-id":"movie-card-swipe-wrapper-".concat(o.kp_id),"show-delete":e.showDelete,onSlide:f=>H(o.kp_id)},{default:_(()=>[T(B(G),{movie:o,"is-history":e.isHistory,"is-mobile":g.value,"is-user-list":$.value,index:v,"is-card-border":C.value,"active-movie-index":t.value,"show-delete":e.showDelete,"show-star":e.showStar,"onRemove:fromHistory":H,"onSave:element":f=>n.value[v]=f},null,8,["movie","is-history","is-mobile","is-user-list","index","is-card-border","active-movie-index","show-delete","show-star","onSave:element"])]),_:2},1032,["data-test-id","show-delete","onSlide"]))),128)):(a(!0),l(N,{key:1},X(e.moviesList,(o,v)=>(a(),x(B(G),{key:o.kp_id,movie:o,"is-history":e.isHistory,"is-mobile":g.value,"is-user-list":$.value,index:v,"is-card-border":C.value,"active-movie-index":t.value,"show-delete":e.showDelete,"show-star":e.showStar,"onRemove:fromHistory":H,"onSave:element":f=>n.value[v]=f},null,8,["movie","is-history","is-mobile","is-user-list","index","is-card-border","active-movie-index","show-delete","show-star","onSave:element"]))),128))],2),[[F,!e.loading]]),e.loading?(a(),x(he,{key:0})):w("",!0)]))}},We=L(Pe,[["__scopeId","data-v-8e95405f"]]);export{Me as D,We as M};
