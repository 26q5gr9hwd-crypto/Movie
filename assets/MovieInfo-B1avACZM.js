import{_ as ke,r as c,c as P,b as a,d as l,e as t,q as H,t as d,G as te,g as u,H as me,n as B,J as We,u as $e,K as xe,l as ie,o as Ae,L as Ie,x as ee,E as De,f as le,M as he,m as $,N as A,O as Ge,C as we,P as Ee,i as Fe,Q as Ze,R as je,a as Qe,s as F,U as O,S as Pe,V as Xe,W as Je,X as Te,Y as et}from"./index-BPK0FRjp.js";import{S as Ne,_ as Se,a as Re,M as Le}from"./MovieList-CT8uxjzY.js";import{N as Ke}from"./ToastMessage-wrFJfZ0K.js";import{u as tt,S as ot,a as st}from"./trailer-JN0gZpjh.js";const se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVR4nO2ZQUoDMRSGR7eewHoFsVS0HkUUXNXqASqK2EURBPFIVRe6c+UN1CvUXWvbT4KvMAwzNnnJdCrmg1BKad7/v7y0b5IkiUQiCwGoAx3gQjEugZ0qxTeAIX6MKjMBnBOGS62AVWAPOHVYdlMu9YArYOhphLeBT+ALmOKGEd2QubaAK+B2zngFxt4GgDXgGZjgR8ch5oEkCi8DkvlnRcYLV0Apfqw10M7JvPkV6AN3FmVwK+WyZRnvMEe8ef/ibECyb2o+zRuwnpQAxeLNivQ0BvYyE46qEJ/8fK4ycJKp/X4V4n0MdDNfukkqEO9jwP1LDgD7BeKPgmgp04CL+KUz4Cp+qQxoxC+NAdsNm4c0hWkukkUa8BGfegiadbFDq3/2UAZ8xc+QVvzMtqcKYkBaZ5/MN5xEl2DgLGDZ1KswsC09FPJqXTZoNm5oA6kyMGI2FxqfkluJ0uMTDfhBXAHiHvCCWEL8/RLqlv1MPCf+TSZ+13WC7KnEfWlqcwAeU7GNjnbiQsG5UC1ZAEAt1UMhOpquk6zknMy9l20C2AA+MnEHRo9msuOCs9EH4Fp5TVQ0rqVs0plH4re02Qh1Oq1lCjypsp+5H3gKcD/gykTirqnFZ/ZDy+OGxpapzD+QePrM/2KkKfcGPcv7AdvRkz23G1x4JPIP+AY3r/ywUk/2JAAAAABJRU5ErkJggg==",lt="/reyohoho/assets/icon-shikimori-DGvXK9Jc.svg",be=Z=>{const y=document.createElement("div");y.style.position="fixed",y.style.top="0",y.style.left="0",y.style.width="100%",y.style.height="100%",y.style.backgroundColor="rgba(0, 0, 0, 0.8)",y.style.color="white",y.style.display="flex",y.style.justifyContent="center",y.style.alignItems="center",y.style.fontSize="2rem",y.style.zIndex="99000",y.textContent=Z,document.body.appendChild(y),setTimeout(()=>{document.body.removeChild(y)},2e3)},nt={class:"modal-content"},at={key:0},it={key:1},rt={class:"players-list"},ut=["onClick"],vt={key:0,class:"warning-icon material-icons",title:"Внимание!"},dt={key:0},ct={key:0,class:"warning-icon material-icons",title:"Внимание!"},pt={key:1},mt={key:0,class:"warning-icon material-icons",title:"Внимание!"},kt=["onClick"],yt={key:0,class:"warning-icon material-icons",title:"Внимание!"},ft={__name:"PlayerModal",props:{players:{type:Array,required:!0},selectedPlayer:{type:Object,default:null}},emits:["close","select"],setup(Z,{emit:y}){const S=Z,M=y,C=c(null),W=P(()=>S.players.filter(n=>!T(n)&&!e(n))),g=P(()=>S.players.some(n=>T(n))),E=P(()=>S.players.some(n=>e(n))),T=n=>n.key.toUpperCase().includes("HDREZKA"),e=n=>n.key.toUpperCase().includes("KODIK"),h=n=>n.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"").trim(),b=n=>{M("select",n),M("close")},N=n=>S.selectedPlayer&&S.selectedPlayer.key===n.key,w=n=>{C.value=n},x=()=>{C.value=null},V=n=>{let r=S.players.filter(p=>n==="hdrezka"&&T(p)||n==="kodik"&&e(p));return n==="kodik"?r.sort((p,I)=>h(p.translate).localeCompare(h(I.translate))):r},k=n=>V(n).some(r=>r.warning);return(n,r)=>(l(),a("div",{class:"modal",onClick:r[3]||(r[3]=We(p=>n.$emit("close"),["self"]))},[t("div",nt,[t("button",{class:"close",onClick:r[0]||(r[0]=p=>n.$emit("close"))},"×"),C.value?(l(),a("h2",it,[t("button",{class:"back-btn",onClick:x},"← Назад"),H(" "+d(C.value==="hdrezka"?"ReYohoho - HDrezka":"Kodik"),1)])):(l(),a("h2",at,"Выберите плеер")),t("ul",rt,[C.value?(l(!0),a(te,{key:1},me(V(C.value),p=>(l(),a("li",{key:p.key},[t("button",{class:B(["player-item",{active:N(p)}]),onClick:I=>b(p)},[H(d(h(p.translate))+" ",1),p.warning?(l(),a("span",yt,"warning")):u("",!0)],10,kt)]))),128)):(l(),a(te,{key:0},[(l(!0),a(te,null,me(W.value,p=>(l(),a("li",{key:p.key},[t("button",{class:B(["player-item",{active:N(p)}]),onClick:I=>b(p)},[H(d(h(p.translate))+" ",1),p.warning?(l(),a("span",vt,"warning")):u("",!0)],10,ut)]))),128)),g.value?(l(),a("li",dt,[t("button",{class:"group-item",onClick:r[1]||(r[1]=p=>w("hdrezka"))},[r[4]||(r[4]=t("span",{class:"material-icons group-icon"},"folder",-1)),r[5]||(r[5]=H(" ReYohoho - HDrezka ")),k("hdrezka")?(l(),a("span",ct,"warning")):u("",!0)])])):u("",!0),E.value?(l(),a("li",pt,[t("button",{class:"group-item",onClick:r[2]||(r[2]=p=>w("kodik"))},[r[6]||(r[6]=t("span",{class:"material-icons group-icon"},"folder",-1)),r[7]||(r[7]=H(" Kodik ")),k("kodik")?(l(),a("span",mt,"warning")):u("",!0)])])):u("",!0)],64))])])]))}},gt=ke(ft,[["__scopeId","data-v-7e4f2528"]]),_t={class:"players-list"},bt=["src"],ht={key:1,class:"controls"},wt={class:"tooltip-container"},$t={class:"material-icons"},At={class:"tooltip-container"},Mt={class:"tooltip-container"},Ct={class:"tooltip-container"},Et={class:"tooltip-container"},Pt={class:"material-symbols-outlined"},Tt=["onMouseenter","onClick"],St={key:0,class:"tooltip-container"},Rt={class:"custom-tooltip"},Lt={key:1,class:"tooltip-container"},Ht={class:"custom-tooltip"},xt={__name:"PlayerComponent",props:{kpId:String},emits:["update:selectedPlayer"],setup(Z,{emit:y}){const S=$e(),M=tt(),C=xe(),W=c(C.params.kp_id),g=Z,E=y,T=c([]),e=c(null),h=c(!0),b=c(!1),N=c(!1),w=c(null),x=c(null),V=c(!1),k=c(""),n=c(null),r=c(window.innerHeight*.9),p=P(()=>"".concat(r.value,"px")),I=P(()=>S.isMobile),q=P(()=>!!window.electronAPI),_=c(null),Y=c(!1);let oe=null;const re=c(null),R=v=>{_.value=v,Y.value=!1,clearTimeout(oe)},ne=()=>{Y.value||(oe=setTimeout(()=>{_.value=null},300))},ue=()=>{Y.value=!0,clearTimeout(oe)},ve=()=>{Y.value=!1,_.value=null},j=P({get:()=>M.aspectRatio,set:v=>M.updateAspectRatio(v)}),i=P({get:()=>M.isCentered,set:v=>M.updateCentering(v)}),o=P(()=>M.preferredPlayer),K=c(0),L=v=>v.toUpperCase(),m=()=>{if(b.value||!x.value)return;const[v,s]=j.value.split(":").map(Number);r.value=window.innerHeight*.9,K.value=Math.min(x.value.clientWidth*(s/v),r.value)},Q=P(()=>{if(b.value)return{};const[v,s]=j.value.split(":").map(Number),G=r.value*(v/s);return{width:"100%",maxWidth:"".concat(G,"px"),maxHeight:p.value,margin:"0 auto",overflow:"hidden"}}),X=P(()=>{const[v,s]=j.value.split(":").map(Number);return{position:"relative",width:"100%",paddingTop:"".concat(s/v*100,"%")}}),z=()=>{x.value&&Ee(()=>{x.value.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},J=async()=>{try{k.value="",n.value=null;const v=await Ge(g.kpId);if(T.value=Object.entries(v).map(([s,G])=>({key:s.toUpperCase(),...G})),T.value.length>0){if(o.value){const s=L(o.value),G=T.value.find(pe=>L(pe.key)===s);e.value=G||T.value[0]}else e.value=T.value[0];E("update:selectedPlayer",e.value)}}catch(v){const{message:s,code:G}=we(v);k.value=s,n.value=G,console.error("Ошибка при загрузке плееров:",v)}},D=()=>{V.value=!0},U=()=>{V.value=!1},de=v=>{e.value=v,h.value=!0,M.updatePreferredPlayer(L(v.key)),E("update:selectedPlayer",v)},ae=()=>{q.value?window.electronAPI.sendHotKey("F2"):(be("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},ye=()=>{q.value?window.electronAPI.sendHotKey("F3"):(be("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},Ue=()=>{q.value?window.electronAPI.sendHotKey("F4"):(be("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},fe=()=>{b.value=!b.value,b.value?(window.addEventListener("mousemove",ge),document.addEventListener("keydown",_e),document.body.classList.add("no-scroll")):(window.removeEventListener("mousemove",ge),document.removeEventListener("keydown",_e),document.body.classList.remove("no-scroll")),N.value=b.value,Ee(()=>z())},Me=c(null),ge=()=>{Me.value=setTimeout(()=>{clearTimeout(Me.value),N.value=!1},4e3),N.value=!0},ce=P(()=>S.dimmingEnabled),Oe=()=>{b.value||S.toggleDimming()},_e=v=>{v.key==="Escape"&&b.value&&fe()},Be=v=>{j.value=v,setTimeout(()=>{i.value&&z()},310)},Ve=()=>{const v="reyohoho://#".concat(W.value);try{window.location.href=v}catch(s){console.error("Ошибка при открытии ссылки:",s)}},qe=()=>{const v=window.location.href;navigator.clipboard.writeText(v).then(()=>{}),re.value.showNotification("Ссылка на фильм скопирована")},Ye=()=>{h.value=!1};function ze(v){return v.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"KODIK - ").trim()}return ie(e,v=>{v&&(h.value=!0,M.updatePreferredPlayer(L(v.key)),E("update:selectedPlayer",v))}),ie(()=>C.params.kp_id,async v=>{v&&v!==W.value&&(W.value=v,i.value&&z())},{immediate:!0}),Ae(()=>{h.value=!0,J(),I.value&&(j.value="4:3"),m(),window.addEventListener("resize",m),i.value&&z()}),Ie(()=>{window.removeEventListener("resize",m),window.removeEventListener("mousemove",ge),document.removeEventListener("keydown",_e),document.body.classList.remove("no-scroll")}),(v,s)=>{var G,pe;return k.value?(l(),ee(De,{key:0,message:k.value,code:n.value},null,8,["message","code"])):(l(),a(te,{key:1},[t("div",_t,[s[17]||(s[17]=t("span",null,"Плеер:",-1)),t("button",{class:"player-btn",onClick:D},d(e.value?ze(e.value.translate).toUpperCase():"Загрузка плееров..."),1)]),V.value?(l(),ee(gt,{key:0,players:T.value,"selected-player":e.value,onClose:U,onSelect:de},null,8,["players","selected-player"])):u("",!0),t("div",{ref_key:"containerRef",ref:x,class:B(["player-container",{"theater-mode":b.value}]),style:he(b.value?{}:Q.value)},[t("div",{class:"iframe-wrapper",style:he(b.value?{}:X.value)},[$(t("iframe",{ref_key:"playerIframe",ref:w,src:(G=e.value)==null?void 0:G.iframe,frameborder:"0",allowfullscreen:"",webkitallowfullscreen:"",class:B(["responsive-iframe",{"theater-mode-unlock":N.value,"theater-mode-lock":b.value,dimmed:ce.value}]),onLoad:Ye},null,42,bt),[[A,!h.value&&((pe=e.value)==null?void 0:pe.iframe)]]),h.value?(l(),ee(Ne,{key:0})):u("",!0)],4),b.value?(l(),a("button",{key:0,class:B(["close-theater-btn",{visible:N.value}]),onClick:fe}," ✖ ",2)):u("",!0)],6),I.value?u("",!0):(l(),a("div",ht,[t("div",wt,[t("button",{class:B(["dimming-btn",{active:ce.value}]),onMouseenter:s[0]||(s[0]=f=>R("dimming")),onMouseleave:s[1]||(s[1]=f=>_.value=null),onClick:Oe},[t("span",$t,d(ce.value?"light_mode":"dark_mode"),1)],34),$(t("div",{class:"custom-tooltip"},d(ce.value?"Отключить затемнение":"Включить затемнение"),513),[[A,_.value==="dimming"]])]),t("div",At,[t("button",{class:"blur-btn",onMouseenter:s[2]||(s[2]=f=>R("blur")),onMouseleave:s[3]||(s[3]=f=>_.value=null),onClick:ae},s[18]||(s[18]=[t("span",{class:"material-icons"},"blur_on",-1)]),32),$(t("div",{class:"custom-tooltip"},d(q.value?"Блюр":"Блюр, функция доступна в приложении"),513),[[A,_.value==="blur"]])]),t("div",Mt,[t("button",{class:"material-symbols-outlined",onMouseenter:s[4]||(s[4]=f=>R("compressor")),onMouseleave:s[5]||(s[5]=f=>_.value=null),onClick:ye},s[19]||(s[19]=[t("span",{class:"material-icons"},"graphic_eq",-1)]),32),$(t("div",{class:"custom-tooltip"},d(q.value?"Компрессор":"Компрессор, функция доступна в приложении"),513),[[A,_.value==="compressor"]])]),t("div",Ct,[t("button",{class:"mirror-btn",onMouseenter:s[6]||(s[6]=f=>R("mirror")),onMouseleave:s[7]||(s[7]=f=>_.value=null),onClick:Ue},s[20]||(s[20]=[t("span",{class:"material-icons"},"flip",-1)]),32),$(t("div",{class:"custom-tooltip"},d(q.value?"Зеркало":"Зеркало, функция доступна в приложении"),513),[[A,_.value==="mirror"]])]),t("div",Et,[t("button",{class:"theater-mode-btn",onMouseenter:s[8]||(s[8]=f=>R("theater")),onMouseleave:s[9]||(s[9]=f=>_.value=null),onClick:fe},[t("span",Pt,d(b.value?"fullscreen_exit":"aspect_ratio"),1)],32),$(t("div",{class:"custom-tooltip"},d(b.value?"Выйти из театрального режима":"Театральный режим"),513),[[A,_.value==="theater"]])]),(l(),a(te,null,me(["16:9","12:5","4:3"],f=>t("div",{key:f,class:"tooltip-container"},[t("button",{class:B(["aspect-ratio-btn",{active:j.value===f}]),onMouseenter:Ce=>R(f),onMouseleave:s[10]||(s[10]=Ce=>_.value=null),onClick:Ce=>Be(f)},d(f),43,Tt),$(t("div",{class:"custom-tooltip"}," Установить соотношение "+d(f),513),[[A,_.value===f]])])),64)),t("div",{class:"tooltip-container",onMouseenter:s[12]||(s[12]=f=>R("centering")),onMouseleave:ne},[t("button",{class:"center-btn",onClick:z},s[21]||(s[21]=[t("span",{class:"material-icons"},"center_focus_strong",-1)])),$(t("div",{class:"custom-tooltip advanced-tooltip",onMouseenter:ue,onMouseleave:ve},[s[22]||(s[22]=H(" Отцентрировать плеер ")),le(ot,{modelValue:i.value,"onUpdate:modelValue":s[11]||(s[11]=f=>i.value=f),title:"Автоцентрирование плеера"},null,8,["modelValue"]),s[23]||(s[23]=t("span",{class:"tooltip-title"},"Автоцентрирование плеера",-1))],544),[[A,_.value==="centering"]])],32),q.value?u("",!0):(l(),a("div",St,[t("button",{class:"app-link-btn",onMouseenter:s[13]||(s[13]=f=>R("app_link")),onMouseleave:s[14]||(s[14]=f=>_.value=null),onClick:Ve},s[24]||(s[24]=[t("span",{class:"material-icons"},"open_in_new",-1)]),32),$(t("div",Rt,"Открыть в приложении",512),[[A,_.value==="app_link"]])])),q.value?(l(),a("div",Lt,[t("button",{class:"copy-link-btn",onMouseenter:s[15]||(s[15]=f=>R("copy_link")),onMouseleave:s[16]||(s[16]=f=>_.value=null),onClick:qe},s[25]||(s[25]=[t("span",{class:"material-icons"},"content_copy",-1)]),32),$(t("div",Ht,"Скопировать ссылку",512),[[A,_.value==="copy_link"]])])):u("",!0)])),le(Ke,{ref_key:"notificationRef",ref:re},null,512)],64))}}},He=ke(xt,[["__scopeId","data-v-b5dd4c4a"]]),It={key:0,class:"carousel-container"},Dt={class:"carousel-wrapper"},Nt=["onClick"],Kt=["src","alt"],Ut={class:"video-name"},Ot={key:0,class:"video-player"},Bt=["src"],Vt={__name:"TrailerCarousel",props:{videos:{type:Array,required:!0}},emits:["select"],setup(Z,{emit:y}){const S=$e(),M=P(()=>S.isMobile),C=Z,W=y,g=c(null),E=c(null),T=c(!1),e=c(!1),h=()=>{if(!E.value)return;const{scrollLeft:k,scrollWidth:n,clientWidth:r}=E.value;T.value=k>0,e.value=k<n-r-1},b=k=>{if(!E.value)return;const n=E.value.querySelector(".carousel-item");if(!n)return;const r=n.clientWidth+16;E.value.scrollBy({left:r*k,behavior:"smooth"})},N=k=>{g.value=k,W("select",C.videos[k])},w=()=>h(),x=c([]),V=async k=>{try{return(await fetch("https://img.youtube.com/vi/".concat(k,"/0.jpg"))).ok}catch(n){return!1}};return Ae(async()=>{const k=C.videos.map(async r=>await V(r.videoId)?r:null),n=await Promise.all(k);x.value=n.filter(Boolean),h(),window.addEventListener("resize",w)}),ie(()=>C.videos,async k=>{const n=k.map(async p=>await V(p.videoId)?p:null),r=await Promise.all(n);x.value=r.filter(Boolean)}),Ie(()=>{window.removeEventListener("resize",w)}),(k,n)=>x.value.length?(l(),a("div",It,[n[4]||(n[4]=t("h2",null,"Трейлеры (YouTube)",-1)),t("div",Dt,[$(t("button",{class:"scroll-button left",onClick:n[0]||(n[0]=r=>b(-1))},n[2]||(n[2]=[t("span",{class:"material-symbols-outlined"},"arrow_back_ios",-1)]),512),[[A,!M.value&&T.value]]),t("div",{ref_key:"carousel",ref:E,class:"carousel",onScroll:h},[(l(!0),a(te,null,me(x.value,(r,p)=>(l(),a("div",{key:p,class:"carousel-item",onClick:I=>N(p)},[t("img",{src:"https://img.youtube.com/vi/".concat(r.videoId,"/0.jpg"),alt:r.name},null,8,Kt),t("div",Ut,d(r.name),1)],8,Nt))),128))],544),$(t("button",{class:"scroll-button right",onClick:n[1]||(n[1]=r=>b(1))},n[3]||(n[3]=[t("span",{class:"material-symbols-outlined"},"arrow_forward_ios",-1)]),512),[[A,!M.value&&e.value]])]),g.value!==null?(l(),a("div",Ot,[t("iframe",{src:Z.videos[g.value].iframeUrl,frameborder:"0",allowfullscreen:""},null,8,Bt)])):u("",!0)])):u("",!0)}},qt=ke(Vt,[["__scopeId","data-v-13bee798"]]),Yt={class:"movie-info"},zt={class:"content"},Wt={key:2,class:"content-card"},Gt={key:3,class:"content-card"},Ft={class:"content-header"},Zt=["src"],jt={class:"content-title"},Qt={key:0,class:"ratings-links"},Xt={key:0},Jt=["href"],eo={key:0},to={key:1},oo=["href"],so={key:0},lo={key:2},no=["href"],ao={key:0},io={key:3},ro=["href"],uo={key:0},vo={key:4},co=["href"],po={key:5},mo=["href"],ko=["content"],yo=["content"],fo={class:"additional-info"},go={class:"controls"},_o={class:"tooltip-container"},bo={class:"material-icons"},ho={class:"custom-tooltip"},wo={class:"tooltip-container"},$o={class:"material-icons"},Ao={class:"custom-tooltip"},Mo={class:"tooltip-container"},Co={class:"custom-tooltip"},Eo={class:"tooltip-container"},Po={class:"material-icons"},To={class:"custom-tooltip"},So={class:"tooltip-container"},Ro={class:"material-icons"},Lo={class:"custom-tooltip"},Ho={class:"info-content"},xo={class:"details-container"},Io={class:"info-list"},Do={key:0},No={key:1},Ko={key:2},Uo={key:3},Oo={key:4},Bo={key:5},Vo={key:6},qo={key:7},Yo={key:8},zo={class:"content-info"},Wo={key:0,class:"content-description-text"},Go={key:2,class:"yt-video-container"},Fo={key:3,class:"related-movies"},Zo={key:4,class:"related-movies"},jo={__name:"MovieInfo",setup(Z){const y=c(!0),S=$e(),M=Fe(),C=Ze(),W=xe(),g=c(W.params.kp_id),E=c(""),T=c(null),e=c(null),h=je(),N=st().areTrailersActive,w=c(null),x=c(!1);let V=null;const k=i=>{w.value=i,x.value=!1,clearTimeout(V)},n=()=>{if(e.value){const i=e.value.name_ru||e.value.name_en||e.value.name_original||"Информация о фильме";document.title=i}},r=i=>(i||[]).map(o=>({kp_id:o.film_id,poster:o.poster_url_preview||o.poster_url,title:o.name_ru||o.name_en||o.name_original})),p=i=>{if(typeof i!="number")return;const o=Math.floor(i/60),K=i%60;return"".concat(o," ч. ").concat(K," мин.")},I=c(!1),q=c({top:"0px",left:"0px"}),_=i=>{I.value=!0,q.value={top:"".concat(i.pageY+10,"px"),left:"".concat(i.pageX-70,"px")}},Y=c(null),oe=async()=>{try{const i=[e.value.name_ru||e.value.name_en||e.value.name_original,...e.value.year?[e.value.year]:[],...e.value.film_length?[p(e.value.film_length)]:[]];await navigator.clipboard.writeText(i.join(", ")),Y.value.showNotification("Скопировано")}catch(i){console.error("Ошибка копирования:",i)}},re=(i,o)=>{var L,m,Q,X,z,J,D;return(D={[O.FAVORITE]:((L=i.lists)==null?void 0:L.isFavorite)||!1,[O.HISTORY]:((m=i.lists)==null?void 0:m.isHistory)||!1,[O.LATER]:((Q=i.lists)==null?void 0:Q.isLater)||!1,[O.COMPLETED]:((X=i.lists)==null?void 0:X.isCompleted)||!1,[O.ABANDONED]:((z=i.lists)==null?void 0:z.isAbandoned)||!1,[O.WATCHING]:((J=i.lists)==null?void 0:J.isWatching)||!1}[o])!=null?D:!1},R=async i=>{if(!M.token){Y.value.showNotification("Необходимо авторизоваться",5e3);return}try{re(e.value,i)?(await et(g.value,i),Y.value.showNotification("Удалено")):(await Te(g.value,i),Y.value.showNotification("Добавлено"))}catch(o){const{message:K,code:L}=we(o);Y.value.showNotification("".concat(K," ").concat(L))}await ne(!1)},ne=async(i=!0)=>{var o,K,L,m,Q,X,z,J;try{let D;if(g.value.startsWith("shiki")?D=await Xe(g.value):D=await Je(g.value,M.token),Array.isArray(D)&&D.length===0)throw new Error("Данные не найдены. Пожалуйста, повторите поиск.");e.value=D,g.value.startsWith("shiki")?e.value={...e.value,title:e.value.name_ru||e.value.name_en,name_original:e.value.name_en,short_description:e.value.slogan}:e.value={...e.value,title:e.value.name_ru||e.value.name_en||e.value.name_original,kinopoisk_id:g.value},h.setHeaderContent({text:e.value.title,imageUrl:e.value.logo_url}),n();const U={kp_id:g.value,title:((o=e.value)==null?void 0:o.name_ru)||((K=e.value)==null?void 0:K.name_en)||((L=e.value)==null?void 0:L.name_original),poster:((m=e.value)==null?void 0:m.poster_url)||((Q=e.value)==null?void 0:Q.cover_url)||((X=e.value)==null?void 0:X.screenshots[0]),year:(z=e.value)==null?void 0:z.year,type:(J=e.value)==null?void 0:J.type};if(g.value.startsWith("shiki"))if(e.value.screenshots&&e.value.screenshots.length>0){const ae=Math.floor(Math.random()*e.value.screenshots.length),ye=e.value.screenshots[ae];C.updateMoviePoster(ye)}else U.poster&&C.updateMoviePoster(U.poster);else U.poster&&C.updateMoviePoster(U.poster);if(P(()=>S.isHistoryAllowed).value&&U.kp_id&&U.title&&i)if(M.token)try{await Te(U.kp_id,O.HISTORY)}catch(ae){console.error("Ошибка при добавлении в историю:",ae)}else S.addToHistory({...U})}catch(D){const{message:U,code:de}=we(D);E.value=U,T.value=de,console.error("Ошибка при загрузке информации о фильмах:",D)}},ue=P(()=>{var i,o;return console.log("Трейлеры:",(i=e.value)==null?void 0:i.videos),(o=e.value)==null?void 0:o.videos}),ve=P(()=>{var i;return r((i=e.value)==null?void 0:i.sequels_and_prequels)}),j=P(()=>{var i;return r((i=e.value)==null?void 0:i.similars)});return Ae(async()=>{await ne(),y.value=!1}),Qe(async()=>{h.clearHeaderContent()}),ie(()=>W.params.kp_id,async i=>{i&&i!==g.value&&(h.clearHeaderContent(),g.value=i,await ne(),y.value=!1)},{immediate:!0}),ie(e,()=>{n()},{deep:!0}),(i,o)=>{var K,L;return l(),a(te,null,[t("div",Yt,[t("div",zt,[y.value?(l(),ee(Ne,{key:0})):u("",!0),E.value?(l(),ee(De,{key:1,message:E.value,code:T.value},null,8,["message","code"])):u("",!0),E.value?(l(),a("div",Wt,[(l(),ee(He,{key:g.value,"kp-id":g.value},null,8,["kp-id"]))])):u("",!0),e.value?(l(),a("div",Gt,[t("div",Ft,[e.value.logo_url?(l(),a("div",{key:0,class:"content-logo",onMousemove:_,onMouseleave:o[0]||(o[0]=m=>I.value=!1),onClick:oe},[t("img",{src:e.value.logo_url,alt:"Логотип фильма",class:"content-logo"},null,8,Zt)],32)):(l(),a("div",{key:1,onMousemove:_,onMouseleave:o[1]||(o[1]=m=>I.value=!1),onClick:oe},[t("h1",jt,d(e.value.title),1)],32)),$(t("div",{class:"title-copy-tooltip",style:he(q.value)}," Скопировать ",4),[[A,I.value]])]),e.value.kinopoisk_id||e.value.title||e.value.imdb_id||e.value.rating_imdb||e.value.shikimori_id?(l(),a("div",Qt,[e.value.kinopoisk_id?(l(),a("div",Xt,[t("a",{href:"https://www.kinopoisk.ru/film/".concat(e.value.kinopoisk_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[o[17]||(o[17]=t("img",{src:Se,alt:"КП",class:"rating-logo"},null,-1)),e.value.rating_kinopoisk?(l(),a("span",eo,d(e.value.rating_kinopoisk)+"/10",1)):u("",!0),o[18]||(o[18]=t("img",{src:se,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Jt)])):u("",!0),!e.value.kinopoisk_id&&e.value.title?(l(),a("div",to,[t("a",{href:"https://www.kinopoisk.ru/index.php?kp_query=".concat(encodeURIComponent(e.value.title+(e.value.year?" "+e.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[o[19]||(o[19]=t("img",{src:Se,alt:"КП",class:"rating-logo"},null,-1)),e.value.rating_kinopoisk?(l(),a("span",so,d(e.value.rating_kinopoisk)+"/10",1)):u("",!0),o[20]||(o[20]=t("img",{src:se,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,oo)])):u("",!0),e.value.imdb_id?(l(),a("div",lo,[t("a",{href:"https://www.imdb.com/title/".concat(e.value.imdb_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[o[21]||(o[21]=t("img",{src:Re,alt:"IMDb",class:"rating-logo"},null,-1)),e.value.rating_imdb?(l(),a("span",ao,d(e.value.rating_imdb)+"/10",1)):u("",!0),o[22]||(o[22]=t("img",{src:se,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,no)])):u("",!0),!e.value.imdb_id&&e.value.title?(l(),a("div",io,[t("a",{href:"https://www.imdb.com/find/?q=".concat(encodeURIComponent(e.value.title+(e.value.year?" "+e.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[o[23]||(o[23]=t("img",{src:Re,alt:"IMDb",class:"rating-logo"},null,-1)),e.value.rating_imdb?(l(),a("span",uo,d(e.value.rating_imdb)+"/10",1)):u("",!0),o[24]||(o[24]=t("img",{src:se,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,ro)])):u("",!0),e.value.shikimori_id?(l(),a("div",vo,[t("a",{href:"https://shikimori.one/animes/".concat(e.value.shikimori_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},o[25]||(o[25]=[t("img",{src:lt,alt:"Shiki",class:"rating-logo"},null,-1),t("img",{src:se,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)]),8,co)])):u("",!0),e.value.imdb_id?(l(),a("div",po,[t("a",{href:"https://www.imdb.com/title/".concat(e.value.imdb_id,"/parentalguide"),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},o[26]||(o[26]=[t("span",null,"Parents Guide",-1),t("img",{src:se,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)]),8,mo)])):u("",!0)])):u("",!0),(l(),ee(He,{key:g.value,"kp-id":g.value},null,8,["kp-id"])),t("meta",{name:"title-and-year",content:e.value.type==="FILM"&&e.value.year?"".concat(e.value.title," (").concat(e.value.year,")"):e.value.title},null,8,ko),e.value.name_original?(l(),a("meta",{key:1,name:"original-title",content:e.value.name_original},null,8,yo)):u("",!0),t("div",fo,[t("div",go,[t("div",_o,[t("button",{class:B(["favorite-btn",{active:e.value.lists.isFavorite}]),onMouseenter:o[2]||(o[2]=m=>k("favorite")),onMouseleave:o[3]||(o[3]=m=>w.value=null),onClick:o[4]||(o[4]=m=>R(F(O).FAVORITE))},[t("span",bo,d(e.value.lists.isFavorite?"favorite":"favorite_border"),1)],34),$(t("div",ho,d("В избранное"),512),[[A,w.value==="favorite"]])]),t("div",wo,[t("button",{class:B(["watching-btn",{active:e.value.lists.isWatching}]),onMouseenter:o[5]||(o[5]=m=>k("watching")),onMouseleave:o[6]||(o[6]=m=>w.value=null),onClick:o[7]||(o[7]=m=>R(F(O).WATCHING))},[t("span",$o,d(e.value.lists.isWatching?"visibility":"visibility_off"),1)],34),$(t("div",Ao,d("Смотрю"),512),[[A,w.value==="watching"]])]),t("div",Mo,[t("button",{class:B(["later-btn",{active:e.value.lists.isLater}]),onMouseenter:o[8]||(o[8]=m=>k("later")),onMouseleave:o[9]||(o[9]=m=>w.value=null),onClick:o[10]||(o[10]=m=>R(F(O).LATER))},o[27]||(o[27]=[t("span",{class:"material-icons"},d("watch_later"),-1)]),34),$(t("div",Co,d("Смотреть позже"),512),[[A,w.value==="later"]])]),t("div",Eo,[t("button",{class:B(["completed-btn",{active:e.value.lists.isCompleted}]),onMouseenter:o[11]||(o[11]=m=>k("completed")),onMouseleave:o[12]||(o[12]=m=>w.value=null),onClick:o[13]||(o[13]=m=>R(F(O).COMPLETED))},[t("span",Po,d(e.value.lists.isCompleted?"check_circle":"check_circle_outline"),1)],34),$(t("div",To,d("Просмотрено"),512),[[A,w.value==="completed"]])]),t("div",So,[t("button",{class:B(["abandoned-btn",{active:e.value.lists.isAbandoned}]),onMouseenter:o[14]||(o[14]=m=>k("abandoned")),onMouseleave:o[15]||(o[15]=m=>w.value=null),onClick:o[16]||(o[16]=m=>R(F(O).ABANDONED))},[t("span",Ro,d((e.value.lists.isAbandoned,"not_interested")),1)],34),$(t("div",Lo,d("Брошено"),512),[[A,w.value==="abandoned"]])])]),o[37]||(o[37]=t("h2",{class:"additional-info-title"},"Подробнее",-1)),t("div",Ho,[t("div",xo,[t("ul",Io,[e.value.type&&F(Pe)[e.value.type]?(l(),a("li",Do,[o[28]||(o[28]=t("strong",null,"Тип:",-1)),H(" "+d(F(Pe)[e.value.type]),1)])):u("",!0),e.value.year?(l(),a("li",No,[o[29]||(o[29]=t("strong",null,"Год выпуска:",-1)),H(" "+d(e.value.year),1)])):u("",!0),e.value.title?(l(),a("li",Ko,[o[30]||(o[30]=t("strong",null,"Название:",-1)),H(" "+d(e.value.title),1)])):u("",!0),e.value.name_original?(l(),a("li",Uo,[o[31]||(o[31]=t("strong",null,"Оригинальное название:",-1)),H(" "+d(e.value.name_original),1)])):u("",!0),e.value.slogan?(l(),a("li",Oo,[o[32]||(o[32]=t("strong",null,"Слоган:",-1)),H(" "+d(e.value.slogan),1)])):u("",!0),e.value.production_companies?(l(),a("li",Bo,[o[33]||(o[33]=t("strong",null,"Продакшн:",-1)),H(" "+d(e.value.production_companies),1)])):u("",!0),(K=e.value.countries)!=null&&K.length?(l(),a("li",Vo,[o[34]||(o[34]=t("strong",null,"Страна производства:",-1)),H(" "+d(e.value.countries.map(m=>m.country).join(", ")),1)])):u("",!0),(L=e.value.genres)!=null&&L.length?(l(),a("li",qo,[o[35]||(o[35]=t("strong",null,"Жанры:",-1)),H(" "+d(e.value.genres.map(m=>m.genre).join(", ")),1)])):u("",!0),e.value.film_length?(l(),a("li",Yo,[o[36]||(o[36]=t("strong",null,"Продолжительность:",-1)),H(" "+d(p(e.value.film_length)),1)])):u("",!0)])])])]),t("div",zo,[e.value.description?(l(),a("p",Wo,d(e.value.description),1)):u("",!0)]),ue.value.length&&F(N)?(l(),a("div",Go,[le(qt,{videos:ue.value,onSelect:i.playTrailer},null,8,["videos","onSelect"])])):u("",!0),ve.value.length?(l(),a("div",Fo,[o[38]||(o[38]=t("h2",null,"Сиквелы и приквелы",-1)),le(F(Le),{"movies-list":ve.value,loading:!1,"is-history":!1},null,8,["movies-list"])])):u("",!0),j.value.length?(l(),a("div",Zo,[o[39]||(o[39]=t("h2",null,"Похожие",-1)),le(F(Le),{"movies-list":j.value,loading:!1,"is-history":!1},null,8,["movies-list"])])):u("",!0)])):u("",!0)])]),le(Ke,{ref_key:"notificationRef",ref:Y},null,512)],64)}}},ts=ke(jo,[["__scopeId","data-v-91580a8f"]]);export{ts as default};
//# sourceMappingURL=MovieInfo-B1avACZM.js.map
