System.register([],(function(r,e){"use strict";return{execute:function(){r("u",(function(){var r=r=>{try{var e=new URL(r),t="cdn.7tv.app"===e.hostname&&"https:"===e.protocol||e.pathname.includes("/api/7tv")&&"https:"===e.protocol;return t||console.warn("URL изображения отклонен:",{url:r,hostname:e.hostname,protocol:e.protocol,reason:"cdn.7tv.app"!==e.hostname?"неразрешенный домен":"неразрешенный протокол"}),t}catch(n){return console.warn("Недопустимый URL изображения:",r,"Ошибка:",n.message),!1}},e=r=>{var e=document.createElement("div");return e.textContent=r,e.innerHTML},t=t=>{if(!t)return"";var n=t;return n=(n=(n=(n=(n=(n=n.replace(/\[spoiler\]\s*\[\/spoiler\]/g,"")).replace(/\[img\]\s*\[\/img\]/g,"")).replace(/\[link=[^\]]+\]\s*\[\/link\]/g,"")).replace(/\[img\](.*?)\[\/img\]/g,((t,n)=>{var i=n.trim();return r(i)?`<img src="${e(i)}" alt="7TV emote" class="inline-emoji" loading="lazy" />`:`[недопустимое изображение: ${e(i)}]`}))).replace(/\[spoiler\]([^]*?)\[\/spoiler\]/g,((r,t,n,i)=>{var a=e(t.trim());if(!a)return"";var s=n>0?i[n-1]:" ",l=n+r.length<i.length?i[n+r.length]:" ";return`${s&&" "!==s&&"\n"!==s&&"\t"!==s?" ":""}<span class="spoiler-text" onclick="this.classList.toggle('revealed')" title="Нажмите, чтобы показать спойлер">${a}</span>${l&&" "!==l&&"\n"!==l&&"\t"!==l?" ":""}`}))).replace(/\[link=([^\]]+)\](.*?)\[\/link\]/g,((r,t,n)=>{var i=t.trim(),a=n.trim();return a?/^https?:\/\/.+/.test(i)&&a?`<a href="${e(i)}" target="_blank" rel="noopener noreferrer" class="comment-link">${e(a)}</a>`:e(a||i):""}))};return{formatContent:t,formatContentWithTruncation:function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!r)return"";var i=r;if(r.length>e&&!n){var a=r.slice(0,e),s=(r.match(/\[img\].*?\[\/img\]/g)||[]).length-(a.match(/\[img\].*?\[\/img\]/g)||[]).length,l=a.lastIndexOf("[img]");l>a.lastIndexOf("[/img]")&&-1!==l&&(a=r.slice(0,l)),a=a.trim();for(var o=0,u=["[img","[im","[i","["];o<u.length;o++){var c=u[o];if(a.endsWith(c)){var g=a.lastIndexOf("[");if(-1!==g){a=a.slice(0,g).trim();break}}}for(var m=0,p=["[/img","[/im","[/i","[/"];m<p.length;m++){var f=p[m];if(a.endsWith(f)){var h=a.lastIndexOf("[");if(-1!==h){a=a.slice(0,h).trim();break}}}var v="...";s>0&&(v=`... (+${s} ${1===s?"изображение":"изображений"})`),i=a+v}return t(i)},isValidImageUrl:r,escapeHtml:e}})),r("a",(r=>{if(!r)return"";var e=r.substring(0,4),t=r.substring(4,6),n=r.substring(6,8),i=r.substring(9,11),a=r.substring(11,13),s=r.substring(13,15);return new Date(Date.UTC(parseInt(e),parseInt(t)-1,parseInt(n),parseInt(i),parseInt(a),parseInt(s))).toLocaleDateString("ru-RU",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone})})),r("f",(r=>{if(!r)return"";var l=r.substring(0,4),o=r.substring(4,6),u=r.substring(6,8),c=r.substring(9,11),g=r.substring(11,13),m=r.substring(13,15),p=new Date(Date.UTC(parseInt(l),parseInt(o)-1,parseInt(u),parseInt(c),parseInt(g),parseInt(m))),f=new Date,h=Math.floor((f-p)/1e3);if(h<60)return"только что";var v=Math.floor(h/60);if(v<60)return`${v} ${e(v)} назад`;var d=Math.floor(v/60);if(d<24)return`${d} ${t(d)} назад`;var $=Math.floor(d/24);if($<7)return`${$} ${n($)} назад`;var I=Math.floor($/7);if(I<4)return`${I} ${i(I)} назад`;var b=Math.floor($/30);if(b<12)return`${b} ${a(b)} назад`;var k=Math.floor($/365);return`${k} ${s(k)} назад`}));var e=r=>r%10==1&&r%100!=11?"минуту":[2,3,4].includes(r%10)&&![12,13,14].includes(r%100)?"минуты":"минут",t=r=>r%10==1&&r%100!=11?"час":[2,3,4].includes(r%10)&&![12,13,14].includes(r%100)?"часа":"часов",n=r=>r%10==1&&r%100!=11?"день":[2,3,4].includes(r%10)&&![12,13,14].includes(r%100)?"дня":"дней",i=r=>r%10==1&&r%100!=11?"неделю":[2,3,4].includes(r%10)&&![12,13,14].includes(r%100)?"недели":"недель",a=r=>r%10==1&&r%100!=11?"месяц":[2,3,4].includes(r%10)&&![12,13,14].includes(r%100)?"месяца":"месяцев",s=r=>r%10==1&&r%100!=11?"год":[2,3,4].includes(r%10)&&![12,13,14].includes(r%100)?"года":"лет"}}}));
