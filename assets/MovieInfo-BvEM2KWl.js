import{_ as Ie,r as m,c as q,b as l,d as n,e,s as V,t as i,K as Q,g as v,L as le,n as w,q as De,u as Oe,i as Zt,N as jt,z as Qt,l as be,o as He,O as Jt,x as fe,E as eo,f as ce,P as We,m as S,Q as P,y as N,U as M,R as fo,D as ze,S as Fe,V as ko,W as to,X as yo,Y as Ft,Z as go,$ as _o,a as bo,a0 as Vt,a1 as Wt,a2 as ho,a3 as $o,a4 as wo}from"./index-DUp3DWTf.js";import{S as oo,_ as Co,a as zt,b as Yt,M as Gt}from"./MovieList-jJS22sAa.js";import{N as Ye}from"./ToastMessage-D4NzvUmY.js";import{u as Mo,S as Ao,a as Io}from"./trailer-CNnGAtFo.js";const _e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVR4nO2ZQUoDMRSGR7eewHoFsVS0HkUUXNXqASqK2EURBPFIVRe6c+UN1CvUXWvbT4KvMAwzNnnJdCrmg1BKad7/v7y0b5IkiUQiCwGoAx3gQjEugZ0qxTeAIX6MKjMBnBOGS62AVWAPOHVYdlMu9YArYOhphLeBT+ALmOKGEd2QubaAK+B2zngFxt4GgDXgGZjgR8ch5oEkCi8DkvlnRcYLV0Apfqw10M7JvPkV6AN3FmVwK+WyZRnvMEe8ef/ibECyb2o+zRuwnpQAxeLNivQ0BvYyE46qEJ/8fK4ycJKp/X4V4n0MdDNfukkqEO9jwP1LDgD7BeKPgmgp04CL+KUz4Cp+qQxoxC+NAdsNm4c0hWkukkUa8BGfegiadbFDq3/2UAZ8xc+QVvzMtqcKYkBaZ5/MN5xEl2DgLGDZ1KswsC09FPJqXTZoNm5oA6kyMGI2FxqfkluJ0uMTDfhBXAHiHvCCWEL8/RLqlv1MPCf+TSZ+13WC7KnEfWlqcwAeU7GNjnbiQsG5UC1ZAEAt1UMhOpquk6zknMy9l20C2AA+MnEHRo9msuOCs9EH4Fp5TVQ0rqVs0plH4re02Qh1Oq1lCjypsp+5H3gKcD/gykTirqnFZ/ZDy+OGxpapzD+QePrM/2KkKfcGPcv7AdvRkz23G1x4JPIP+AY3r/ywUk/2JAAAAABJRU5ErkJggg==",Ro="/reyohoho/assets/icon-shikimori-DGvXK9Jc.svg",Ve=f=>{const $=document.createElement("div");$.style.position="fixed",$.style.top="0",$.style.left="0",$.style.width="100%",$.style.height="100%",$.style.backgroundColor="rgba(0, 0, 0, 0.8)",$.style.color="white",$.style.display="flex",$.style.justifyContent="center",$.style.alignItems="center",$.style.fontSize="2rem",$.style.zIndex="99000",$.textContent=f,document.body.appendChild($),setTimeout(()=>{document.body.removeChild($)},2e3)},Eo={key:0},To={key:1},So={class:"players-list"},Po=["onClick"],Lo={key:0,class:"warning-icon material-icons",title:"Внимание!"},xo={key:0},No={key:0,class:"warning-icon material-icons",title:"Внимание!"},Do={key:1},Oo={key:0,class:"warning-icon material-icons",title:"Внимание!"},Ho=["onClick"],Bo={key:0,class:"warning-icon material-icons",title:"Внимание!"},Uo={__name:"PlayerModal",props:{players:{type:Array,required:!0},selectedPlayer:{type:Object,default:null}},emits:["close","select"],setup(f,{emit:$}){const U=f,D=$,L=m(null),K=q(()=>U.players.filter(u=>!I(u)&&!o(u))),b=q(()=>U.players.some(u=>I(u))),E=q(()=>U.players.some(u=>o(u))),I=u=>u.key.toUpperCase().includes("HDREZKA"),o=u=>u.key.toUpperCase().includes("KODIK"),C=u=>u.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"").trim(),x=u=>{D("select",u),D("close")},z=u=>U.selectedPlayer&&U.selectedPlayer.key===u.key,A=u=>U.selectedPlayer?u==="hdrezka"&&I(U.selectedPlayer)||u==="kodik"&&o(U.selectedPlayer):!1,H=u=>{L.value=u},G=()=>{L.value=null},_=u=>{let k=U.players.filter(d=>u==="hdrezka"&&I(d)||u==="kodik"&&o(d));return u==="kodik"?k.sort((d,O)=>C(d.translate).localeCompare(C(O.translate))):k},y=u=>_(u).some(k=>k.warning);return(u,k)=>(n(),l("div",{class:"modal",onClick:k[4]||(k[4]=De(d=>u.$emit("close"),["self"]))},[e("div",{class:"modal-content",onClick:k[3]||(k[3]=De(()=>{},["stop"]))},[e("button",{class:"close",onClick:k[0]||(k[0]=d=>u.$emit("close"))},"×"),L.value?(n(),l("h2",To,[e("button",{class:"back-btn",onClick:G},"← Назад"),V(" "+i(L.value==="hdrezka"?"ReYohoho - HDrezka":"Kodik"),1)])):(n(),l("h2",Eo,"Выберите плеер")),e("ul",So,[L.value?(n(!0),l(Q,{key:1},le(_(L.value),d=>(n(),l("li",{key:d.key},[e("button",{class:w(["player-item",{active:z(d)}]),onClick:O=>x(d)},[V(i(C(d.translate))+" ",1),d.warning?(n(),l("span",Bo,"warning")):v("",!0)],10,Ho)]))),128)):(n(),l(Q,{key:0},[(n(!0),l(Q,null,le(K.value,d=>(n(),l("li",{key:d.key},[e("button",{class:w(["player-item",{active:z(d)}]),onClick:O=>x(d)},[V(i(C(d.translate))+" ",1),d.warning?(n(),l("span",Lo,"warning")):v("",!0)],10,Po)]))),128)),b.value?(n(),l("li",xo,[e("button",{class:w(["group-item",{active:A("hdrezka")}]),onClick:k[1]||(k[1]=d=>H("hdrezka"))},[k[5]||(k[5]=e("span",{class:"material-icons group-icon"},"folder",-1)),k[6]||(k[6]=V(" ReYohoho - HDrezka ")),y("hdrezka")?(n(),l("span",No,"warning")):v("",!0)],2)])):v("",!0),E.value?(n(),l("li",Do,[e("button",{class:w(["group-item",{active:A("kodik")}]),onClick:k[2]||(k[2]=d=>H("kodik"))},[k[7]||(k[7]=e("span",{class:"material-icons group-icon"},"folder",-1)),k[8]||(k[8]=V(" Kodik ")),y("kodik")?(n(),l("span",Oo,"warning")):v("",!0)],2)])):v("",!0)],64))])])]))}},qo=Ie(Uo,[["__scopeId","data-v-460326ba"]]),Ko={class:"players-list"},Fo=["src"],Vo={key:1,class:"controls"},Wo={class:"main-controls"},zo={class:"material-icons"},Yo={class:"list-button-item"},Go={class:"material-icons"},Xo={class:"list-button-item"},Zo={class:"material-icons"},jo={class:"list-button-item"},Qo={class:"list-button-item"},Jo={class:"material-icons"},es={class:"list-button-item"},ts={class:"material-icons"},os={class:"tooltip-container","data-tooltip-container":"dimming"},ss={class:"material-icons"},ns={class:"tooltip-container","data-tooltip-container":"blur"},ls={class:"tooltip-container","data-tooltip-container":"compressor"},is={class:"tooltip-container","data-tooltip-container":"mirror"},as={class:"tooltip-container","data-tooltip-container":"theater"},rs={class:"material-symbols-outlined"},us={class:"custom-tooltip","data-tooltip":"theater"},vs={class:"tooltip-container","data-tooltip-container":"aspect_ratio"},ds={class:"current-ratio"},cs=["onClick"],ms={key:0,class:"tooltip-container","data-tooltip-container":"app_link"},ps={class:"custom-tooltip","data-tooltip":"app_link"},fs={key:1,class:"tooltip-container","data-tooltip-container":"copy_link"},ks={class:"custom-tooltip","data-tooltip":"copy_link"},ys={key:0,class:"desktop-list-buttons"},gs={class:"tooltip-container"},_s={class:"material-icons"},bs={class:"custom-tooltip"},hs={class:"tooltip-container"},$s={class:"material-icons"},ws={class:"custom-tooltip"},Cs={class:"tooltip-container"},Ms={class:"custom-tooltip"},As={class:"tooltip-container"},Is={class:"material-icons"},Rs={class:"custom-tooltip"},Es={class:"tooltip-container"},Ts={class:"material-icons"},Ss={class:"custom-tooltip"},Ps={key:1,class:"mobile-list-buttons"},Ls={class:"tooltip-container"},xs={class:"material-icons"},Ns={class:"custom-tooltip"},Ds={class:"tooltip-container"},Os={class:"material-icons"},Hs={class:"custom-tooltip"},Bs={class:"tooltip-container"},Us={class:"custom-tooltip"},qs={class:"tooltip-container"},Ks={class:"material-icons"},Fs={class:"custom-tooltip"},Vs={class:"tooltip-container"},Ws={class:"material-icons"},zs={class:"custom-tooltip"},Ys={__name:"PlayerComponent",props:{kpId:String,movieInfo:{type:Object,default:()=>({})}},emits:["update:selectedPlayer","update:movieInfo"],setup(f,{emit:$}){const U=Oe(),D=Mo(),L=Zt(),K=jt(),b=Qt(),E=m(K.params.kp_id),I=f,o=$,C=m([]),x=m(null),z=m(!0),A=m(!1),H=m(!1),G=m(null),_=m(null),y=m(!1),u=m(""),k=m(null),d=m(window.innerHeight*.9),O=q(()=>"".concat(d.value,"px")),T=q(()=>U.isMobile),B=q(()=>!!window.electronAPI),p=m(null),me=m(!1);let ie=null;const ne=m(null),ke=m(null),Re=m(null),J=a=>{const t=document.querySelector('[data-tooltip-container="'.concat(a,'"]')),g=document.querySelector('[data-tooltip="'.concat(a,'"]'));if(!t||!g)return;const Z=t.getBoundingClientRect(),oe=g.getBoundingClientRect(),se=window.innerHeight;Z.bottom+oe.height>se?(g.style.top="auto",g.style.bottom="100%",g.style.marginTop="0",g.style.marginBottom="12px",g.style.transform="translateX(-50%)"):(g.style.top="100%",g.style.bottom="auto",g.style.marginTop="12px",g.style.marginBottom="0",g.style.transform="translateX(-50%)")},R=a=>{p.value=a,me.value=!1,clearTimeout(ie),Fe(()=>{J(a)})},ye=()=>{me.value||(ie=setTimeout(()=>{p.value=null},300))},ge=()=>{me.value=!0,clearTimeout(ie)},pe=()=>{me.value=!1,p.value=null},ee=q({get:()=>D.aspectRatio,set:a=>D.updateAspectRatio(a)}),X=q({get:()=>D.isCentered,set:a=>D.updateCentering(a)}),c=q(()=>{var a,t,g,Z,oe,se,re,ue,ve,de;return((t=(a=I.movieInfo)==null?void 0:a.lists)==null?void 0:t.isFavorite)||((Z=(g=I.movieInfo)==null?void 0:g.lists)==null?void 0:Z.isWatching)||((se=(oe=I.movieInfo)==null?void 0:oe.lists)==null?void 0:se.isLater)||((ue=(re=I.movieInfo)==null?void 0:re.lists)==null?void 0:ue.isCompleted)||((de=(ve=I.movieInfo)==null?void 0:ve.lists)==null?void 0:de.isAbandoned)}),s=q(()=>D.preferredPlayer),F=m(0),Y=a=>a.toUpperCase(),h=()=>{if(A.value||!_.value)return;const[a,t]=ee.value.split(":").map(Number);d.value=window.innerHeight*.9,F.value=Math.min(_.value.clientWidth*(t/a),d.value)},Ee=q(()=>{if(A.value)return{};const[a,t]=ee.value.split(":").map(Number),g=d.value*(a/t);return{width:"100%",maxWidth:"".concat(g,"px"),maxHeight:O.value,margin:"0 auto",overflow:"hidden"}}),Te=q(()=>{const[a,t]=ee.value.split(":").map(Number);return{position:"relative",width:"100%",paddingTop:"".concat(t/a*100,"%")}}),ae=()=>{_.value&&setTimeout(()=>{Fe(()=>{_.value.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},500)},Se=async()=>{try{u.value="",k.value=null;const a=await fo(I.kpId);if(C.value=Object.entries(a).map(([t,g])=>({key:t.toUpperCase(),...g})),C.value.length>0){if(s.value){const t=Y(s.value),g=C.value.find(Z=>Y(Z.key)===t);x.value=g||C.value[0]}else x.value=C.value[0];o("update:selectedPlayer",x.value)}}catch(a){const{message:t,code:g}=ze(a);u.value=t,k.value=g,console.error("Ошибка при загрузке плееров:",a)}},te=()=>{y.value=!0},j=()=>{y.value=!1},Pe=a=>{var t;if(((t=x.value)==null?void 0:t.key)===a.key){j();return}x.value=a,z.value=!0,D.updatePreferredPlayer(Y(a.key)),o("update:selectedPlayer",a)},he=()=>{B.value?window.electronAPI.sendHotKey("F2"):(Ve("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},Be=()=>{B.value?window.electronAPI.sendHotKey("F3"):(Ve("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},so=()=>{B.value?window.electronAPI.sendHotKey("F4"):(Ve("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},Le=()=>{A.value=!A.value,A.value?(window.addEventListener("mousemove",Ue),document.addEventListener("keydown",qe),document.body.classList.add("no-scroll")):(window.removeEventListener("mousemove",Ue),document.removeEventListener("keydown",qe),document.body.classList.remove("no-scroll")),H.value=A.value,Fe(()=>ae())},Ge=m(null),Ue=()=>{Ge.value=setTimeout(()=>{clearTimeout(Ge.value),H.value=!1},4e3),H.value=!0},xe=q(()=>U.dimmingEnabled),no=()=>{A.value||U.toggleDimming()},qe=a=>{(a.key==="Escape"&&A.value||a.altKey&&a.keyCode===84)&&Le()},Xe=a=>{ee.value=a,setTimeout(()=>{X.value&&ae()},310)},lo=()=>{const a="reyohoho://#".concat(E.value);try{window.location.href=a}catch(t){console.error("Ошибка при открытии ссылки:",t)}},io=()=>{const a=window.location.href;navigator.clipboard.writeText(a).then(()=>{}),ne.value.showNotification("Ссылка на фильм скопирована")},ao=()=>{z.value=!1};function ro(a){return a.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"HDRezka - ").replace(/KODIK>/,"Kodik - ").trim()}const uo=q(()=>{var a,t;return B.value?!1:!((t=(a=x.value)==null?void 0:a.key)!=null&&t.toUpperCase().includes("TORRENTS"))});be(x,a=>{if(a)if(z.value=!0,D.updatePreferredPlayer(Y(a.key)),o("update:selectedPlayer",a),a.key.toUpperCase().includes("TORRENTS")){const t=document.querySelector(".rocketme_fon");t&&(t.style.display="none");const g=document.querySelector(".pm_preloader");g&&(g.style.display="none")}else{const t=document.querySelector(".rocketme_fon");t&&(t.style.display="");const g=document.querySelector(".pm_preloader");g&&(g.style.display="")}}),be(()=>K.params.kp_id,async a=>{a&&a!==E.value&&(E.value=a,X.value&&ae())},{immediate:!0});const Ne=["16:9","12:5","4:3"],vo=()=>{const t=(Ne.indexOf(ee.value)+1)%Ne.length;Xe(Ne[t])},co=a=>{var g,Z,oe,se,re,ue,ve,de,$e,we,Ce,Me,Ae;return(Ae={[M.FAVORITE]:((Z=(g=I.movieInfo)==null?void 0:g.lists)==null?void 0:Z.isFavorite)||!1,[M.HISTORY]:((se=(oe=I.movieInfo)==null?void 0:oe.lists)==null?void 0:se.isHistory)||!1,[M.LATER]:((ue=(re=I.movieInfo)==null?void 0:re.lists)==null?void 0:ue.isLater)||!1,[M.COMPLETED]:((de=(ve=I.movieInfo)==null?void 0:ve.lists)==null?void 0:de.isCompleted)||!1,[M.ABANDONED]:((we=($e=I.movieInfo)==null?void 0:$e.lists)==null?void 0:we.isAbandoned)||!1,[M.WATCHING]:((Me=(Ce=I.movieInfo)==null?void 0:Ce.lists)==null?void 0:Me.isWatching)||!1}[a])!=null?Ae:!1},W=async a=>{if(!L.token){ne.value.showNotification('Необходимо <a class="auth-link">авторизоваться</a>',5e3,{onClick:mo});return}try{const t={[M.FAVORITE]:"избранное",[M.HISTORY]:"историю",[M.LATER]:'список "Смотреть позже"',[M.COMPLETED]:'список "Просмотрено"',[M.ABANDONED]:'список "Брошено"',[M.WATCHING]:'список "Смотрю"'};co(a)?(await ko(E.value,a),ne.value.showNotification("Удалено из ".concat(t[a]))):(await to(E.value,a),ne.value.showNotification("Добавлено в ".concat(t[a])))}catch(t){const{message:g,code:Z}=ze(t);ne.value.showNotification("".concat(g," ").concat(Z))}o("update:movieInfo")},mo=()=>{b.push("/login")},Ke=q(()=>D.showFavoriteTooltip),po=()=>{b.push("/settings"),pe()};return He(()=>{z.value=!0,Se(),T.value&&(ee.value="4:3"),h(),window.addEventListener("resize",h),window.addEventListener("resize",J),X.value&&ae()}),Jt(()=>{window.removeEventListener("resize",h),window.removeEventListener("resize",J),window.removeEventListener("mousemove",Ue),document.removeEventListener("keydown",qe),document.body.classList.remove("no-scroll")}),(a,t)=>{var g,Z,oe,se,re,ue,ve,de,$e,we,Ce,Me,Ae,Ze,je,Qe,Je,et,tt,ot,st,nt,lt,it,at,rt,ut,vt,dt,ct,mt,pt,ft,kt,yt,gt,_t,bt,ht,$t,wt,Ct,Mt,At,It,Rt,Et,Tt,St,Pt,Lt,xt,Nt,Dt,Ot,Ht,Bt,Ut,qt,Kt;return u.value?(n(),fe(eo,{key:0,message:u.value,code:k.value},null,8,["message","code"])):(n(),l(Q,{key:1},[e("div",Ko,[t[54]||(t[54]=e("span",null,"Плеер:",-1)),e("button",{class:"player-btn",onClick:te},i(x.value?ro(x.value.translate).toUpperCase():"Загрузка плееров..."),1)]),y.value?(n(),fe(qo,{key:0,players:C.value,"selected-player":x.value,onClose:j,onSelect:Pe},null,8,["players","selected-player"])):v("",!0),e("div",{ref_key:"containerRef",ref:_,class:w(["player-container",{"theater-mode":A.value}]),style:We(A.value?{}:Ee.value)},[e("div",{class:w(["iframe-wrapper",{pm_video:uo.value}]),style:We(A.value?{}:Te.value)},[S(e("iframe",{ref_key:"playerIframe",ref:G,src:(g=x.value)==null?void 0:g.iframe,frameborder:"0",allowfullscreen:"",webkitallowfullscreen:"",class:w(["responsive-iframe",{"theater-mode-unlock":H.value,"theater-mode-lock":A.value,dimmed:xe.value}]),onLoad:ao},null,42,Fo),[[P,!z.value&&((Z=x.value)==null?void 0:Z.iframe)]]),z.value?(n(),fe(oo,{key:0})):v("",!0)],6),A.value?(n(),l("button",{key:0,class:w(["close-theater-btn",{visible:H.value}]),onClick:Le}," ✖ ",2)):v("",!0)],6),A.value?v("",!0):(n(),l("div",Vo,[e("div",Wo,[T.value?v("",!0):(n(),l("div",{key:0,ref_key:"tooltipContainer",ref:ke,class:"tooltip-container list-buttons-container","data-tooltip-container":"favorite"},[Ke.value?(n(),l("button",{key:0,class:w(["favorite-btn",{active:(se=(oe=f.movieInfo)==null?void 0:oe.lists)==null?void 0:se.isFavorite}]),onMouseenter:t[0]||(t[0]=r=>R("favorite")),onMouseleave:ye,onClick:t[1]||(t[1]=r=>W(N(M).FAVORITE))},[e("span",zo,i((ue=(re=f.movieInfo)==null?void 0:re.lists)!=null&&ue.isFavorite?"favorite":"favorite_border"),1),e("span",{class:w(["material-icons dropdown-arrow",{highlighted:c.value}])},"expand_more",2)],34)):v("",!0),S(e("div",{ref_key:"tooltip",ref:Re,class:"custom-tooltip advanced-tooltip list-buttons-dropdown","data-tooltip":"favorite",onMouseenter:ge,onMouseleave:pe},[e("div",Yo,[e("button",{class:w(["favorite-btn",{active:(de=(ve=f.movieInfo)==null?void 0:ve.lists)==null?void 0:de.isFavorite}]),onClick:t[2]||(t[2]=r=>W(N(M).FAVORITE))},[e("span",Go,i((we=($e=f.movieInfo)==null?void 0:$e.lists)!=null&&we.isFavorite?"favorite":"favorite_border"),1),t[55]||(t[55]=e("span",{class:"button-label"},"В избранное",-1))],2)]),e("div",Xo,[e("button",{class:w(["watching-btn",{active:(Me=(Ce=f.movieInfo)==null?void 0:Ce.lists)==null?void 0:Me.isWatching}]),onClick:t[3]||(t[3]=r=>W(N(M).WATCHING))},[e("span",Zo,i((Ze=(Ae=f.movieInfo)==null?void 0:Ae.lists)!=null&&Ze.isWatching?"visibility_off":"visibility"),1),t[56]||(t[56]=e("span",{class:"button-label"},"Смотрю",-1))],2)]),e("div",jo,[e("button",{class:w(["later-btn",{active:(Qe=(je=f.movieInfo)==null?void 0:je.lists)==null?void 0:Qe.isLater}]),onClick:t[4]||(t[4]=r=>W(N(M).LATER))},t[57]||(t[57]=[e("span",{class:"material-icons"},"watch_later",-1),e("span",{class:"button-label"},"Смотреть позже",-1)]),2)]),e("div",Qo,[e("button",{class:w(["completed-btn",{active:(et=(Je=f.movieInfo)==null?void 0:Je.lists)==null?void 0:et.isCompleted}]),onClick:t[5]||(t[5]=r=>W(N(M).COMPLETED))},[e("span",Jo,i((ot=(tt=f.movieInfo)==null?void 0:tt.lists)!=null&&ot.isCompleted?"check_circle":"check_circle_outline"),1),t[58]||(t[58]=e("span",{class:"button-label"},"Просмотрено",-1))],2)]),e("div",es,[e("button",{class:w(["abandoned-btn",{active:(nt=(st=f.movieInfo)==null?void 0:st.lists)==null?void 0:nt.isAbandoned}]),onClick:t[6]||(t[6]=r=>W(N(M).ABANDONED))},[e("span",ts,i(((it=(lt=f.movieInfo)==null?void 0:lt.lists)!=null&&it.isAbandoned,"not_interested")),1),t[59]||(t[59]=e("span",{class:"button-label"},"Брошено",-1))],2)]),e("div",{class:"tooltip-hint"},[t[61]||(t[61]=e("span",{class:"material-icons"},"settings",-1)),e("span",null,[t[60]||(t[60]=V("Стиль отображения можно изменить в ")),e("a",{class:"settings-link",onClick:po},"настройках")])])],544),[[P,p.value==="favorite"&&Ke.value]])],512)),T.value?v("",!0):(n(),l(Q,{key:1},[e("div",os,[e("button",{class:w(["dimming-btn",{active:xe.value}]),onMouseenter:t[7]||(t[7]=r=>R("dimming")),onMouseleave:t[8]||(t[8]=r=>p.value=null),onClick:no},[e("span",ss,i(xe.value?"light_mode":"dark_mode"),1)],34),S(e("div",{class:"custom-tooltip","data-tooltip":"dimming"},i(xe.value?"Отключить затемнение":"Включить затемнение"),513),[[P,p.value==="dimming"]])]),e("div",ns,[e("button",{class:w(["blur-btn",{"electron-only":!B.value}]),onMouseenter:t[9]||(t[9]=r=>R("blur")),onMouseleave:t[10]||(t[10]=r=>p.value=null),onClick:he},t[62]||(t[62]=[e("span",{class:"material-icons"},"blur_on",-1)]),34),S(e("div",{class:"custom-tooltip","data-tooltip":"blur"},i(B.value?"Блюр":"Блюр, функция доступна в приложении"),513),[[P,p.value==="blur"]])]),e("div",ls,[e("button",{class:w(["material-symbols-outlined",{"electron-only":!B.value}]),onMouseenter:t[11]||(t[11]=r=>R("compressor")),onMouseleave:t[12]||(t[12]=r=>p.value=null),onClick:Be},t[63]||(t[63]=[e("span",{class:"material-icons"},"graphic_eq",-1)]),34),S(e("div",{class:"custom-tooltip","data-tooltip":"compressor"},i(B.value?"Компрессор":"Компрессор, функция доступна в приложении"),513),[[P,p.value==="compressor"]])]),e("div",is,[e("button",{class:w(["mirror-btn",{"electron-only":!B.value}]),onMouseenter:t[13]||(t[13]=r=>R("mirror")),onMouseleave:t[14]||(t[14]=r=>p.value=null),onClick:so},t[64]||(t[64]=[e("span",{class:"material-icons"},"flip",-1)]),34),S(e("div",{class:"custom-tooltip","data-tooltip":"mirror"},i(B.value?"Зеркало":"Зеркало, функция доступна в приложении"),513),[[P,p.value==="mirror"]])]),e("div",as,[e("button",{class:"theater-mode-btn",onMouseenter:t[15]||(t[15]=r=>R("theater")),onMouseleave:t[16]||(t[16]=r=>p.value=null),onClick:Le},[e("span",rs,i(A.value?"fullscreen_exit":"aspect_ratio"),1)],32),S(e("div",us,[V(i(A.value?"Выйти из театрального режима":"Театральный режим")+" ",1),t[65]||(t[65]=e("span",{class:"shortcut-hint"},"Alt+T",-1))],512),[[P,p.value==="theater"]])]),e("div",vs,[e("button",{class:"aspect-ratio-dropdown-btn",onMouseenter:t[17]||(t[17]=r=>R("aspect_ratio")),onMouseleave:ye,onClick:vo},[e("span",ds,i(ee.value),1)],32),S(e("div",{class:"custom-tooltip advanced-tooltip aspect-ratio-dropdown","data-tooltip":"aspect_ratio",onMouseenter:ge,onMouseleave:pe},[(n(),l(Q,null,le(Ne,r=>e("div",{key:r,class:w(["aspect-ratio-option",{active:ee.value===r}]),onClick:Sl=>Xe(r)},i(r),11,cs)),64))],544),[[P,p.value==="aspect_ratio"]])]),e("div",{class:"tooltip-container","data-tooltip-container":"centering",onMouseenter:t[19]||(t[19]=r=>R("centering")),onMouseleave:ye},[e("button",{class:"center-btn",onClick:ae},t[66]||(t[66]=[e("span",{class:"material-icons"},"center_focus_strong",-1)])),S(e("div",{class:"custom-tooltip advanced-tooltip","data-tooltip":"centering",onMouseenter:ge,onMouseleave:pe},[t[67]||(t[67]=V(" Отцентрировать плеер ")),ce(Ao,{modelValue:X.value,"onUpdate:modelValue":t[18]||(t[18]=r=>X.value=r),title:"Автоцентрирование плеера"},null,8,["modelValue"]),t[68]||(t[68]=e("span",{class:"tooltip-title"},"Автоцентрирование плеера",-1))],544),[[P,p.value==="centering"]])],32),B.value?v("",!0):(n(),l("div",ms,[e("button",{class:"app-link-btn",onMouseenter:t[20]||(t[20]=r=>R("app_link")),onMouseleave:t[21]||(t[21]=r=>p.value=null),onClick:lo},t[69]||(t[69]=[e("span",{class:"material-icons"},"open_in_new",-1)]),32),S(e("div",ps," Открыть в приложении ",512),[[P,p.value==="app_link"]])])),B.value?(n(),l("div",fs,[e("button",{class:"copy-link-btn",onMouseenter:t[22]||(t[22]=r=>R("copy_link")),onMouseleave:t[23]||(t[23]=r=>p.value=null),onClick:io},t[70]||(t[70]=[e("span",{class:"material-icons"},"content_copy",-1)]),32),S(e("div",ks," Скопировать ссылку ",512),[[P,p.value==="copy_link"]])])):v("",!0)],64))]),!T.value&&!Ke.value?(n(),l("div",ys,[e("div",gs,[e("button",{class:w(["favorite-btn",{active:(rt=(at=f.movieInfo)==null?void 0:at.lists)==null?void 0:rt.isFavorite}]),onMouseenter:t[24]||(t[24]=r=>R("favorite")),onMouseleave:t[25]||(t[25]=r=>p.value=null),onClick:t[26]||(t[26]=r=>W(N(M).FAVORITE))},[e("span",_s,i((vt=(ut=f.movieInfo)==null?void 0:ut.lists)!=null&&vt.isFavorite?"favorite":"favorite_border"),1)],34),S(e("div",bs,i("В избранное"),512),[[P,p.value==="favorite"]])]),e("div",hs,[e("button",{class:w(["watching-btn",{active:(ct=(dt=f.movieInfo)==null?void 0:dt.lists)==null?void 0:ct.isWatching}]),onMouseenter:t[27]||(t[27]=r=>R("watching")),onMouseleave:t[28]||(t[28]=r=>p.value=null),onClick:t[29]||(t[29]=r=>W(N(M).WATCHING))},[e("span",$s,i((pt=(mt=f.movieInfo)==null?void 0:mt.lists)!=null&&pt.isWatching?"visibility_off":"visibility"),1)],34),S(e("div",ws,i("Смотрю"),512),[[P,p.value==="watching"]])]),e("div",Cs,[e("button",{class:w(["later-btn",{active:(kt=(ft=f.movieInfo)==null?void 0:ft.lists)==null?void 0:kt.isLater}]),onMouseenter:t[30]||(t[30]=r=>R("later")),onMouseleave:t[31]||(t[31]=r=>p.value=null),onClick:t[32]||(t[32]=r=>W(N(M).LATER))},t[71]||(t[71]=[e("span",{class:"material-icons"},"watch_later",-1)]),34),S(e("div",Ms,i("Смотреть позже"),512),[[P,p.value==="later"]])]),e("div",As,[e("button",{class:w(["completed-btn",{active:(gt=(yt=f.movieInfo)==null?void 0:yt.lists)==null?void 0:gt.isCompleted}]),onMouseenter:t[33]||(t[33]=r=>R("completed")),onMouseleave:t[34]||(t[34]=r=>p.value=null),onClick:t[35]||(t[35]=r=>W(N(M).COMPLETED))},[e("span",Is,i((bt=(_t=f.movieInfo)==null?void 0:_t.lists)!=null&&bt.isCompleted?"check_circle":"check_circle_outline"),1)],34),S(e("div",Rs,i("Просмотрено"),512),[[P,p.value==="completed"]])]),e("div",Es,[e("button",{class:w(["abandoned-btn",{active:($t=(ht=f.movieInfo)==null?void 0:ht.lists)==null?void 0:$t.isAbandoned}]),onMouseenter:t[36]||(t[36]=r=>R("abandoned")),onMouseleave:t[37]||(t[37]=r=>p.value=null),onClick:t[38]||(t[38]=r=>W(N(M).ABANDONED))},[e("span",Ts,i(((Ct=(wt=f.movieInfo)==null?void 0:wt.lists)!=null&&Ct.isAbandoned,"not_interested")),1)],34),S(e("div",Ss,i("Брошено"),512),[[P,p.value==="abandoned"]])])])):T.value?(n(),l("div",Ps,[e("div",Ls,[e("button",{class:w(["favorite-btn",{active:(At=(Mt=f.movieInfo)==null?void 0:Mt.lists)==null?void 0:At.isFavorite}]),onMouseenter:t[39]||(t[39]=r=>R("favorite")),onMouseleave:t[40]||(t[40]=r=>p.value=null),onClick:t[41]||(t[41]=r=>W(N(M).FAVORITE))},[e("span",xs,i((Rt=(It=f.movieInfo)==null?void 0:It.lists)!=null&&Rt.isFavorite?"favorite":"favorite_border"),1)],34),S(e("div",Ns,i("В избранное"),512),[[P,p.value==="favorite"]])]),e("div",Ds,[e("button",{class:w(["watching-btn",{active:(Tt=(Et=f.movieInfo)==null?void 0:Et.lists)==null?void 0:Tt.isWatching}]),onMouseenter:t[42]||(t[42]=r=>R("watching")),onMouseleave:t[43]||(t[43]=r=>p.value=null),onClick:t[44]||(t[44]=r=>W(N(M).WATCHING))},[e("span",Os,i((Pt=(St=f.movieInfo)==null?void 0:St.lists)!=null&&Pt.isWatching?"visibility_off":"visibility"),1)],34),S(e("div",Hs,i("Смотрю"),512),[[P,p.value==="watching"]])]),e("div",Bs,[e("button",{class:w(["later-btn",{active:(xt=(Lt=f.movieInfo)==null?void 0:Lt.lists)==null?void 0:xt.isLater}]),onMouseenter:t[45]||(t[45]=r=>R("later")),onMouseleave:t[46]||(t[46]=r=>p.value=null),onClick:t[47]||(t[47]=r=>W(N(M).LATER))},t[72]||(t[72]=[e("span",{class:"material-icons"},"watch_later",-1)]),34),S(e("div",Us,i("Смотреть позже"),512),[[P,p.value==="later"]])]),e("div",qs,[e("button",{class:w(["completed-btn",{active:(Dt=(Nt=f.movieInfo)==null?void 0:Nt.lists)==null?void 0:Dt.isCompleted}]),onMouseenter:t[48]||(t[48]=r=>R("completed")),onMouseleave:t[49]||(t[49]=r=>p.value=null),onClick:t[50]||(t[50]=r=>W(N(M).COMPLETED))},[e("span",Ks,i((Ht=(Ot=f.movieInfo)==null?void 0:Ot.lists)!=null&&Ht.isCompleted?"check_circle":"check_circle_outline"),1)],34),S(e("div",Fs,i("Просмотрено"),512),[[P,p.value==="completed"]])]),e("div",Vs,[e("button",{class:w(["abandoned-btn",{active:(Ut=(Bt=f.movieInfo)==null?void 0:Bt.lists)==null?void 0:Ut.isAbandoned}]),onMouseenter:t[51]||(t[51]=r=>R("abandoned")),onMouseleave:t[52]||(t[52]=r=>p.value=null),onClick:t[53]||(t[53]=r=>W(N(M).ABANDONED))},[e("span",Ws,i(((Kt=(qt=f.movieInfo)==null?void 0:qt.lists)!=null&&Kt.isAbandoned,"not_interested")),1)],34),S(e("div",zs,i("Брошено"),512),[[P,p.value==="abandoned"]])])])):v("",!0)])),ce(Ye,{ref_key:"notificationRef",ref:ne},null,512)],64))}}},Xt=Ie(Ys,[["__scopeId","data-v-2037cb5b"]]),Gs={key:0,class:"carousel-container"},Xs={class:"carousel-wrapper"},Zs=["onClick"],js=["src","alt"],Qs={class:"video-name"},Js={key:0,class:"video-player"},en=["src"],tn={__name:"TrailerCarousel",props:{videos:{type:Array,required:!0},activeVideoIndex:{type:Number,default:null}},emits:["select"],setup(f,{emit:$}){const U=Oe(),D=q(()=>U.isMobile),L=f,K=$,b=m(L.activeVideoIndex),E=m(null),I=m(!1),o=m(!1),C=()=>{if(!E.value)return;const{scrollLeft:_,scrollWidth:y,clientWidth:u}=E.value;I.value=_>0,o.value=_<y-u-1},x=_=>{if(!E.value)return;const y=E.value.querySelector(".carousel-item");if(!y)return;const u=y.clientWidth+16;E.value.scrollBy({left:u*_,behavior:"smooth"})},z=_=>{b.value=_,K("select",L.videos[_])},A=()=>C(),H=m([]),G=async _=>{try{return(await fetch("https://img.youtube.com/vi/".concat(_,"/0.jpg"))).ok}catch(y){return!1}};return He(async()=>{const _=L.videos.map(async u=>await G(u.videoId)?u:null),y=await Promise.all(_);H.value=y.filter(Boolean),C(),window.addEventListener("resize",A)}),be(()=>L.videos,async _=>{const y=_.map(async k=>await G(k.videoId)?k:null),u=await Promise.all(y);H.value=u.filter(Boolean)}),be(()=>L.activeVideoIndex,_=>{b.value=_}),Jt(()=>{window.removeEventListener("resize",A)}),(_,y)=>H.value.length?(n(),l("div",Gs,[y[4]||(y[4]=e("h2",null,"Трейлеры (YouTube)",-1)),e("div",Xs,[S(e("button",{class:"scroll-button left",onClick:y[0]||(y[0]=u=>x(-1))},y[2]||(y[2]=[e("span",{class:"material-symbols-outlined"},"arrow_back_ios",-1)]),512),[[P,!D.value&&I.value]]),e("div",{ref_key:"carousel",ref:E,class:"carousel",onScroll:C},[(n(!0),l(Q,null,le(H.value,(u,k)=>(n(),l("div",{key:k,class:"carousel-item",onClick:d=>z(k)},[e("img",{src:"https://img.youtube.com/vi/".concat(u.videoId,"/0.jpg"),alt:u.name},null,8,js),e("div",Qs,i(u.name),1)],8,Zs))),128))],544),S(e("button",{class:"scroll-button right",onClick:y[1]||(y[1]=u=>x(1))},y[3]||(y[3]=[e("span",{class:"material-symbols-outlined"},"arrow_forward_ios",-1)]),512),[[P,!D.value&&o.value]])]),b.value!==null?(n(),l("div",Js,[e("iframe",{src:f.videos[b.value].iframeUrl,frameborder:"0",allowfullscreen:""},null,8,en)])):v("",!0)])):v("",!0)}},on=Ie(tn,[["__scopeId","data-v-e60b5c29"]]),sn={class:"rating-container"},nn={class:"rating-display"},ln={class:"average-rating"},an={class:"rating-numbers"},rn=["onClick","onMouseenter"],un={key:0,class:"tooltip-footer"},vn={class:"rating-numbers mobile-rating-numbers"},dn=["onClick"],cn={key:0,class:"mobile-modal-footer"},mn={__name:"MovieRating",props:{kpId:{type:String,required:!0},showDash:{type:Boolean,default:!1}},setup(f){const $=Oe(),U=Qt(),D=f,L=m(null),K=m(null),b=m(null),E=m(null),I=m(0),o=m(!1),C=m(!1);let x=null;const z=d=>d?d.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "):"0",A=()=>{x=setTimeout(()=>{o.value=!1,$.isMobile||(C.value=!1)},100)},H=()=>{x&&(clearTimeout(x),x=null),o.value=!0},G=()=>{$.isMobile&&(C.value=!C.value)},_=()=>{U.push("/login")},y=async()=>{try{const d=await yo(D.kpId);K.value=d.user_rating,b.value=d.average_rating,E.value=z(d.vote_count)}catch(d){console.error("Error loading rating:",d)}},u=async d=>{var O;try{d===K.value?(await Ft(D.kpId,null),K.value=null,L.value.showNotification("Оценка удалена")):(await Ft(D.kpId,d),K.value=d,L.value.showNotification("Оценка сохранена")),$.isMobile&&(C.value=!1),y()}catch(T){console.error("Error setting rating:",T),((O=T.response)==null?void 0:O.status)===401?L.value.showNotification('Для оценки необходимо <a class="auth-link">авторизоваться</a>',5e3,{onClick:_}):L.value.showNotification("Ошибка при сохранении оценки"),$.isMobile&&(C.value=!1)}},k=()=>{C.value=!1};return He(()=>{y()}),(d,O)=>(n(),l("div",sn,[e("div",nn,[e("a",{href:"#",class:w(["rating-link",{"has-rating":K.value}]),onMouseenter:O[0]||(O[0]=T=>o.value=!0),onMouseleave:A,onClick:De(G,["prevent"])},[O[3]||(O[3]=e("img",{src:Co,alt:"ReYohoho",class:"rating-logo"},null,-1)),e("span",ln,i(b.value?b.value.toFixed(1).replace(/\.0$/,""):"—"),1)],34),S(e("div",{class:"rating-tooltip",onMouseenter:H,onMouseleave:A},[e("div",an,[(n(),l(Q,null,le(10,T=>e("button",{key:T,class:w(["number-btn",{active:T===K.value,hover:T===I.value,"average-highlight":b.value&&T<=Math.round(b.value)}]),onClick:B=>u(T),onMouseenter:B=>I.value=T,onMouseleave:O[1]||(O[1]=B=>I.value=0)},i(T),43,rn)),64))]),E.value?(n(),l("div",un,"Оценок: "+i(E.value),1)):v("",!0)],544),[[P,(o.value||C.value)&&!N($).isMobile]])]),ce(Ye,{ref_key:"notificationRef",ref:L},null,512),N($).isMobile&&C.value?(n(),l("div",{key:0,class:"mobile-modal-overlay",onClick:k},[e("div",{class:"mobile-modal",onClick:O[2]||(O[2]=De(()=>{},["stop"]))},[e("div",{class:"mobile-modal-header"},[O[4]||(O[4]=e("h3",null,"Оценить фильм",-1)),e("button",{class:"close-button",onClick:k},"×")]),e("div",vn,[(n(),l(Q,null,le(10,T=>e("button",{key:T,class:w(["number-btn",{active:T===K.value,"average-highlight":b.value&&T<=Math.round(b.value)}]),onClick:B=>u(T)},i(T),11,dn)),64))]),E.value?(n(),l("div",cn,"Оценок: "+i(E.value),1)):v("",!0)])])):v("",!0)]))}},pn=Ie(mn,[["__scopeId","data-v-4ab3d1d2"]]),fn={class:"movie-info"},kn={class:"content"},yn={key:0,class:"content-card"},gn={class:"movie-skeleton"},_n={class:"movie-skeleton__player"},bn={key:2,class:"content-card"},hn={key:3,class:"content-card"},$n={class:"content-header"},wn=["src"],Cn={class:"content-title"},Mn={key:0,class:"ratings-links"},An={key:1},In=["href","title"],Rn={key:2},En=["href","title"],Tn={key:3},Sn=["href","title"],Pn={key:4},Ln=["href","title"],xn={key:5},Nn=["href"],Dn={key:6,class:"rating-links-group"},On=["href"],Hn=["title"],Bn={key:0,class:"fa-regular fa-face-grin-wink"},Un={key:1,class:"fas fa-spinner fa-spin"},qn={key:2,class:"nudity-info-popup"},Kn={class:"nudity-info-content"},Fn=["content"],Vn=["content"],Wn={class:"additional-info"},zn={class:"info-content"},Yn={class:"details-container"},Gn={class:"info-list"},Xn={key:0},Zn={key:1},jn={key:2},Qn={key:3},Jn={key:4},el={key:5},tl={key:6},ol={key:7},sl={key:8},nl={class:"content-info"},ll={key:0,class:"content-description-text"},il={key:2,class:"staff-section"},al={class:"staff-categories"},rl={key:0,class:"staff-category"},ul={class:"staff-list"},vl=["href","title"],dl=["src","alt"],cl={class:"staff-name"},ml={key:0,class:"staff-role"},pl=["href","title"],fl={key:1,class:"staff-category"},kl={class:"staff-names-container"},yl={class:"staff-names-list"},gl=["href"],_l=["href"],bl={key:2,class:"staff-category"},hl={class:"staff-names-container"},$l={class:"staff-names-list"},wl=["href"],Cl=["href"],Ml={key:3,class:"yt-video-container"},Al={key:4,class:"related-movies"},Il=["title"],Rl={key:5,class:"related-movies"},El=["title"],Tl={__name:"MovieInfo",setup(f){const $=m(!0),U=Oe(),D=Zt(),L=go(),K=jt(),b=m(K.params.kp_id),E=m(""),I=m(null),o=m(null),C=_o(),z=Io().areTrailersActive,A=m(null),H=m(!1),G=m(!1),_=m(6),y=m(null),u=m(!1),k=()=>{if(o.value){const c=o.value.name_ru||o.value.name_en||o.value.name_original||"Информация о фильме";document.title=c}},d=c=>c?c.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "):"0",O=c=>(c||[]).map(s=>({kp_id:s.film_id,poster:s.poster_url_preview||s.poster_url,title:s.name_ru||s.name_en||s.name_original})),T=c=>{if(typeof c!="number")return;const s=Math.floor(c/60),F=c%60;return"".concat(s," ч. ").concat(F," мин.")},B=m(!1),p=m({top:"0px",left:"0px"}),me=c=>{B.value=!0,p.value={top:"".concat(c.pageY+10,"px"),left:"".concat(c.pageX-70,"px")}},ie=m(null),ne=async()=>{try{const c=[o.value.name_ru||o.value.name_en||o.value.name_original,...o.value.year?[o.value.year]:[],...o.value.film_length?[T(o.value.film_length)]:[]];await navigator.clipboard.writeText(c.join(", ")),ie.value.showNotification("Скопировано")}catch(c){console.error("Ошибка копирования:",c)}},ke=async(c=!0)=>{var s,F,Y,h,Ee,Te,ae,Se;try{let te;if(b.value.startsWith("shiki")?te=await ho(b.value):te=await $o(b.value,D.token),Array.isArray(te)&&te.length===0)throw new Error("Данные не найдены. Пожалуйста, повторите поиск.");o.value=te,b.value.startsWith("shiki")?o.value={...o.value,title:o.value.name_ru||o.value.name_en,name_original:o.value.name_en,short_description:o.value.slogan}:o.value={...o.value,title:o.value.name_ru||o.value.name_en||o.value.name_original,kinopoisk_id:b.value},C.setHeaderContent({text:o.value.title,imageUrl:o.value.logo_url}),k();const j={kp_id:b.value,title:((s=o.value)==null?void 0:s.name_ru)||((F=o.value)==null?void 0:F.name_en)||((Y=o.value)==null?void 0:Y.name_original),poster:((h=o.value)==null?void 0:h.poster_url)||((Ee=o.value)==null?void 0:Ee.cover_url)||((Te=o.value)==null?void 0:Te.screenshots[0]),year:(ae=o.value)==null?void 0:ae.year,type:(Se=o.value)==null?void 0:Se.type};if(b.value.startsWith("shiki"))if(o.value.screenshots&&o.value.screenshots.length>0){const he=Math.floor(Math.random()*o.value.screenshots.length),Be=o.value.screenshots[he];L.updateMoviePoster(Be)}else j.poster&&L.updateMoviePoster(j.poster);else j.poster&&L.updateMoviePoster(j.poster);if(q(()=>U.isHistoryAllowed).value&&j.kp_id&&j.title&&c)if(D.token)try{await to(j.kp_id,M.HISTORY)}catch(he){console.error("Ошибка при добавлении в историю:",he)}else U.addToHistory({...j})}catch(te){const{message:j,code:Pe}=ze(te);E.value=j,I.value=Pe,console.error("Ошибка при загрузке информации о фильмах:",te)}},Re=q(()=>{var c,s;return console.log("Трейлеры:",(c=o.value)==null?void 0:c.videos),(s=o.value)==null?void 0:s.videos}),J=q(()=>{var c;return O((c=o.value)==null?void 0:c.sequels_and_prequels)}),R=q(()=>{var c;return O((c=o.value)==null?void 0:c.similars)}),ye=()=>{var Y;const c=((Y=document.querySelector(".related-movies"))==null?void 0:Y.clientWidth)||0,F=Math.floor(c/260)||6;_.value=Math.max(1,F)},ge=()=>{ye()},pe=c=>{if(c.altKey&&c.keyCode===84&&document.querySelector(".player-container")){const F=document.querySelector(".theater-mode-btn");F&&F.click()}},ee=async()=>{var c;if(!D.token){ie.value.showNotification('Для просмотра информации необходимо <a class="auth-link">авторизоваться</a>',5e3,{onClick:()=>C.openLogin()});return}if((c=o.value)!=null&&c.imdb_id){if(y.value){y.value=null;return}u.value=!0;try{const s=await wo(o.value.imdb_id);y.value=s.nudity_info}catch(s){console.error("Ошибка при загрузке информации о сценах:",s),ie.value.showNotification("Ошибка при загрузке информации о сценах")}finally{u.value=!1}}};He(async()=>{await ke(),$.value=!1,document.addEventListener("keydown",pe),window.addEventListener("resize",ge),setTimeout(ye,100)}),bo(async()=>{C.clearHeaderContent(),document.removeEventListener("keydown",pe),window.removeEventListener("resize",ge)}),be(()=>K.params.kp_id,async c=>{c&&c!==b.value&&(C.clearHeaderContent(),b.value=c,A.value=null,await ke(),$.value=!1)},{immediate:!0}),be(o,()=>{k()},{deep:!0});const X=c=>{var s,F;return((F=(s=o.value)==null?void 0:s.staff)==null?void 0:F.filter(Y=>Y.profession_key===c))||[]};return(c,s)=>{var F,Y;return n(),l(Q,null,[e("div",fn,[e("div",kn,[($.value||!o.value)&&!E.value?(n(),l("div",yn,[e("div",gn,[s[4]||(s[4]=Vt('<div class="movie-skeleton__header" data-v-b7ca569e><div class="movie-skeleton__title" data-v-b7ca569e></div></div><div class="movie-skeleton__ratings" data-v-b7ca569e><div class="movie-skeleton__rating-item" data-v-b7ca569e></div><div class="movie-skeleton__rating-item" data-v-b7ca569e></div><div class="movie-skeleton__rating-item" data-v-b7ca569e></div></div>',2)),e("div",_n,[ce(oo)]),s[5]||(s[5]=Vt('<div class="movie-skeleton__additional-info" data-v-b7ca569e><div class="movie-skeleton__section-title" data-v-b7ca569e></div><div class="movie-skeleton__info-list" data-v-b7ca569e><div class="movie-skeleton__info-item" data-v-b7ca569e></div><div class="movie-skeleton__info-item" data-v-b7ca569e></div><div class="movie-skeleton__info-item" data-v-b7ca569e></div><div class="movie-skeleton__info-item" data-v-b7ca569e></div><div class="movie-skeleton__info-item" data-v-b7ca569e></div></div></div><div class="movie-skeleton__description" data-v-b7ca569e><div class="movie-skeleton__description-line" data-v-b7ca569e></div><div class="movie-skeleton__description-line" data-v-b7ca569e></div><div class="movie-skeleton__description-line" data-v-b7ca569e></div><div class="movie-skeleton__description-line" data-v-b7ca569e></div></div>',2))])])):v("",!0),E.value?(n(),fe(eo,{key:1,message:E.value,code:I.value},null,8,["message","code"])):v("",!0),E.value?(n(),l("div",bn,[(n(),fe(Xt,{key:b.value,"kp-id":b.value,"movie-info":o.value,"onUpdate:movieInfo":ke},null,8,["kp-id","movie-info"]))])):v("",!0),o.value&&!$.value?(n(),l("div",hn,[e("div",$n,[o.value.logo_url?(n(),l("div",{key:0,class:"content-logo",onMousemove:me,onMouseleave:s[0]||(s[0]=h=>B.value=!1),onClick:ne},[e("img",{src:o.value.logo_url,alt:"Логотип фильма",class:"content-logo"},null,8,wn)],32)):(n(),l("div",{key:1,onMousemove:me,onMouseleave:s[1]||(s[1]=h=>B.value=!1),onClick:ne},[e("h1",Cn,i(o.value.title),1)],32)),S(e("div",{class:"title-copy-tooltip",style:We(p.value)}," Скопировать ",4),[[P,B.value]])]),o.value.kinopoisk_id||o.value.title||o.value.imdb_id||o.value.rating_imdb||o.value.shikimori_id?(n(),l("div",Mn,[o.value.kinopoisk_id?(n(),fe(pn,{key:0,"kp-id":o.value.kinopoisk_id,"show-dash":!0},null,8,["kp-id"])):v("",!0),o.value.kinopoisk_id?(n(),l("div",An,[e("a",{href:"https://www.kinopoisk.ru/film/".concat(o.value.kinopoisk_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:o.value.rating_kinopoisk_vote_count?"Оценок: ".concat(d(o.value.rating_kinopoisk_vote_count)):"Нет данных о количестве голосов"},[s[6]||(s[6]=e("img",{src:zt,alt:"КП",class:"rating-logo"},null,-1)),e("span",null,i(o.value.rating_kinopoisk?o.value.rating_kinopoisk:"—"),1),s[7]||(s[7]=e("img",{src:_e,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,In)])):v("",!0),!o.value.kinopoisk_id&&o.value.title?(n(),l("div",Rn,[e("a",{href:"https://www.kinopoisk.ru/index.php?kp_query=".concat(encodeURIComponent(o.value.title+(o.value.year?" "+o.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:o.value.rating_kinopoisk_vote_count?"Оценок: ".concat(d(o.value.rating_kinopoisk_vote_count)):"Нет данных о количестве голосов"},[s[8]||(s[8]=e("img",{src:zt,alt:"КП",class:"rating-logo"},null,-1)),e("span",null,i(o.value.rating_kinopoisk?o.value.rating_kinopoisk:"—"),1),s[9]||(s[9]=e("img",{src:_e,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,En)])):v("",!0),o.value.imdb_id?(n(),l("div",Tn,[e("a",{href:"https://www.imdb.com/title/".concat(o.value.imdb_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:o.value.rating_imdb_vote_count?"Оценок: ".concat(d(o.value.rating_imdb_vote_count)):"Нет данных о количестве голосов"},[s[10]||(s[10]=e("img",{src:Yt,alt:"IMDb",class:"rating-logo"},null,-1)),e("span",null,i(o.value.rating_imdb?o.value.rating_imdb:"—"),1),s[11]||(s[11]=e("img",{src:_e,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Sn)])):v("",!0),!o.value.imdb_id&&o.value.title?(n(),l("div",Pn,[e("a",{href:"https://www.imdb.com/find/?q=".concat(encodeURIComponent(o.value.title+(o.value.year?" "+o.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:o.value.rating_imdb_vote_count?"Оценок: ".concat(d(o.value.rating_imdb_vote_count)):"Нет данных о количестве голосов"},[s[12]||(s[12]=e("img",{src:Yt,alt:"IMDb",class:"rating-logo"},null,-1)),e("span",null,i(o.value.rating_imdb?o.value.rating_imdb:"—"),1),s[13]||(s[13]=e("img",{src:_e,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Ln)])):v("",!0),o.value.shikimori_id?(n(),l("div",xn,[e("a",{href:"https://shikimori.one/animes/".concat(o.value.shikimori_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},s[14]||(s[14]=[e("img",{src:Ro,alt:"Shiki",class:"rating-logo"},null,-1),e("img",{src:_e,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)]),8,Nn)])):v("",!0),o.value.imdb_id?(n(),l("div",Dn,[e("a",{href:"https://www.imdb.com/title/".concat(o.value.imdb_id,"/parentalguide"),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},s[15]||(s[15]=[e("span",null,"Parents Guide",-1),e("img",{src:_e,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)]),8,On),e("button",{class:"rating-link nudity-info-btn",onClick:ee,title:y.value?"Скрыть информацию":"Показать информацию о сценах(Sex & Nudity)"},[u.value?(n(),l("i",Un)):(n(),l("i",Bn)),y.value?(n(),l("div",qn,[e("div",Kn,i(y.value),1)])):v("",!0)],8,Hn)])):v("",!0)])):v("",!0),(n(),fe(Xt,{key:b.value,"kp-id":b.value,"movie-info":o.value,"onUpdate:movieInfo":ke},null,8,["kp-id","movie-info"])),e("meta",{name:"title-and-year",content:o.value.type==="FILM"&&o.value.year?"".concat(o.value.title," (").concat(o.value.year,")"):o.value.title},null,8,Fn),o.value.name_original?(n(),l("meta",{key:1,name:"original-title",content:o.value.name_original},null,8,Vn)):v("",!0),e("div",Wn,[s[25]||(s[25]=e("h2",{class:"additional-info-title"},"Подробнее",-1)),e("div",zn,[e("div",Yn,[e("ul",Gn,[o.value.type&&N(Wt)[o.value.type]?(n(),l("li",Xn,[s[16]||(s[16]=e("strong",null,"Тип:",-1)),V(" "+i(N(Wt)[o.value.type]),1)])):v("",!0),o.value.year?(n(),l("li",Zn,[s[17]||(s[17]=e("strong",null,"Год выпуска:",-1)),V(" "+i(o.value.year),1)])):v("",!0),o.value.title?(n(),l("li",jn,[s[18]||(s[18]=e("strong",null,"Название:",-1)),V(" "+i(o.value.title),1)])):v("",!0),o.value.name_original?(n(),l("li",Qn,[s[19]||(s[19]=e("strong",null,"Оригинальное название:",-1)),V(" "+i(o.value.name_original),1)])):v("",!0),o.value.slogan?(n(),l("li",Jn,[s[20]||(s[20]=e("strong",null,"Слоган:",-1)),V(" "+i(o.value.slogan),1)])):v("",!0),o.value.production_companies?(n(),l("li",el,[s[21]||(s[21]=e("strong",null,"Продакшн:",-1)),V(" "+i(o.value.production_companies),1)])):v("",!0),(F=o.value.countries)!=null&&F.length?(n(),l("li",tl,[s[22]||(s[22]=e("strong",null,"Страна производства:",-1)),V(" "+i(o.value.countries.map(h=>h.country).join(", ")),1)])):v("",!0),(Y=o.value.genres)!=null&&Y.length?(n(),l("li",ol,[s[23]||(s[23]=e("strong",null,"Жанры:",-1)),V(" "+i(o.value.genres.map(h=>h.genre).join(", ")),1)])):v("",!0),o.value.film_length?(n(),l("li",sl,[s[24]||(s[24]=e("strong",null,"Продолжительность:",-1)),V(" "+i(T(o.value.film_length)),1)])):v("",!0)])])])]),e("div",nl,[o.value.description?(n(),l("p",ll,i(o.value.description),1)):v("",!0)]),o.value.staff?(n(),l("div",il,[e("div",al,[X("ACTOR").length?(n(),l("div",rl,[s[26]||(s[26]=e("h3",{class:"additional-info-title"},"Актёры",-1)),e("div",ul,[(n(!0),l(Q,null,le(X("ACTOR").slice(0,12),h=>(n(),l("div",{key:h.staff_id,class:"staff-item"},[e("a",{href:"https://www.kinopoisk.ru/name/".concat(h.staff_id,"/"),target:"_blank",rel:"noopener noreferrer",class:"staff-link",title:h.description||""},[e("img",{src:h.poster_url,alt:h.name_ru,class:"staff-photo"},null,8,dl),e("span",cl,i(h.name_ru||h.name_en),1),h.description?(n(),l("span",ml,i(h.description),1)):v("",!0)],8,vl)]))),128)),e("a",{class:"expand-actors-circle-button",href:"https://www.kinopoisk.ru/film/".concat(b.value,"/cast/"),target:"_blank",rel:"noopener noreferrer",title:"Показать всех ".concat(X("ACTOR").length," актеров")}," +"+i(X("ACTOR").length-12),9,pl)])])):v("",!0),X("DIRECTOR").length?(n(),l("div",fl,[s[27]||(s[27]=e("h3",{class:"additional-info-title"},"Режиссёры",-1)),e("div",kl,[e("div",yl,[(n(!0),l(Q,null,le(X("DIRECTOR"),h=>(n(),l("a",{key:h.staff_id,href:"https://www.kinopoisk.ru/name/".concat(h.staff_id,"/"),target:"_blank",rel:"noopener noreferrer",class:"staff-name-link"},i(h.name_ru||h.name_en),9,gl))),128))]),e("a",{class:"show-all-staff-link",href:"https://www.kinopoisk.ru/film/".concat(b.value,"/cast/"),target:"_blank",rel:"noopener noreferrer"}," + ",8,_l)])])):v("",!0),X("PRODUCER").length?(n(),l("div",bl,[s[28]||(s[28]=e("h3",{class:"additional-info-title"},"Продюсеры",-1)),e("div",hl,[e("div",$l,[(n(!0),l(Q,null,le(X("PRODUCER"),h=>(n(),l("a",{key:h.staff_id,href:"https://www.kinopoisk.ru/name/".concat(h.staff_id,"/"),target:"_blank",rel:"noopener noreferrer",class:"staff-name-link"},i(h.name_ru||h.name_en),9,wl))),128))]),e("a",{class:"show-all-staff-link",href:"https://www.kinopoisk.ru/film/".concat(b.value,"/cast/"),target:"_blank",rel:"noopener noreferrer"}," + ",8,Cl)])])):v("",!0)])])):v("",!0),Re.value.length&&N(z)?(n(),l("div",Ml,[ce(on,{videos:Re.value,"active-video-index":A.value,onSelect:c.playTrailer},null,8,["videos","active-video-index","onSelect"])])):v("",!0),J.value.length?(n(),l("div",Al,[s[29]||(s[29]=e("h2",null,"Сиквелы и приквелы",-1)),ce(N(Gt),{"movies-list":H.value?J.value:J.value.slice(0,_.value),loading:!1,"is-history":!1},null,8,["movies-list"]),J.value.length>_.value?(n(),l("a",{key:0,class:"expand-circle-button",onClick:s[2]||(s[2]=h=>H.value=!H.value),title:"".concat(H.value?"Скрыть":"Показать все"," (").concat(J.value.length,")")},i(H.value?"−":"+".concat(J.value.length-_.value)),9,Il)):v("",!0)])):v("",!0),R.value.length?(n(),l("div",Rl,[s[30]||(s[30]=e("h2",null,"Похожие",-1)),ce(N(Gt),{"movies-list":G.value?R.value:R.value.slice(0,_.value),loading:!1,"is-history":!1},null,8,["movies-list"]),R.value.length>_.value?(n(),l("a",{key:0,class:"expand-circle-button",onClick:s[3]||(s[3]=h=>G.value=!G.value),title:"".concat(G.value?"Скрыть":"Показать все"," (").concat(R.value.length,")")},i(G.value?"−":"+".concat(R.value.length-_.value)),9,El)):v("",!0)])):v("",!0)])):v("",!0)])]),ce(Ye,{ref_key:"notificationRef",ref:ie},null,512)],64)}}},Dl=Ie(Tl,[["__scopeId","data-v-b7ca569e"]]);export{Dl as default};
