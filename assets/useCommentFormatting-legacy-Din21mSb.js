System.register(["./index-legacy-CgsRtlr6.js"],(function(t,r){"use strict";var e;return{setters:[t=>{e=t.ay}],execute:function(){t({f:function(t){var r=Math.floor(t/3600),e=Math.floor(t%3600/60),n=Math.floor(t%60);return`${r.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`},p:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=[],n=t.replace(/\[[^\]]*\d+[^\]]*\]/g,""),a=[...n.matchAll(/(\d{1,2}:)?\d{1,2}:\d{2}|\d{1,2}:\d{2}/g)];if(a.length>0)for(var i=0;i<a.length;){var s=a[i][0],l=null;n.slice(a[i].index+s.length).match(/^[\s,\-–—]+/)&&a[i+1]?(l=a[i+1][0],i+=2):i+=1;var o=t=>{if(!t)return null;var r=t.split(":").map(Number);return 3===r.length?3600*r[0]+60*r[1]+r[2]:2===r.length?60*r[0]+r[1]:1===r.length?r[0]:null},u=o(s),c=o(l);if(null!==u&&null!==c){var p=r?u:Math.max(0,u-1),g=r?c:c+1;e.push([p,g])}else if(null!==u){var m=r?u:Math.max(0,u-1),h=u+5;e.push([m,h])}}return e},u:function(){var t=t=>{try{var r=new URL(t);return"cdn.7tv.app"===r.hostname&&"https:"===r.protocol||r.pathname.includes("/api/7tv")&&"https:"===r.protocol?`${e()}${r.pathname}${r.search}${r.hash}`:(console.warn("URL изображения отклонен:",{url:t,hostname:r.hostname,protocol:r.protocol,reason:"cdn.7tv.app"!==r.hostname?"неразрешенный домен":"неразрешенный протокол"}),!1)}catch(n){return console.warn("Недопустимый URL изображения:",t,"Ошибка:",n.message),!1}},r=t=>{var r=document.createElement("div");return r.textContent=t,r.innerHTML},n=e=>{if(!e)return"";var n=e;return n=(n=(n=(n=(n=(n=n.replace(/\[spoiler\]\s*\[\/spoiler\]/g,"")).replace(/\[img\]\s*\[\/img\]/g,"")).replace(/\[link=[^\]]+\]\s*\[\/link\]/g,"")).replace(/\[spoiler\]([^]*?)\[\/spoiler\]/g,((e,n,a,i)=>{var s=n.trim();if(!s)return"";var l=s.split(/(\[img\].*?\[\/img\]|\[link=.*?\[\/link\])/).filter(Boolean).map((e=>e.startsWith("[img]")?e.replace(/\[img\](.*?)\[\/img\]/g,((e,n)=>{var a=n.trim(),i=t(a);return i&&!1!==i?`<span class="spoiler-hidden-content"><img src="${r(i)}" alt="7TV emote" class="inline-emoji" loading="lazy" /></span>`:`[недопустимое изображение: ${r(a)}]`})):e.startsWith("[link=")?e.replace(/\[link=([^\]]+)\](.*?)\[\/link\]/g,((t,e,n)=>{var a=e.trim(),i=n.trim();return i?/^https?:\/\//.test(a)&&i?`<a href="${r(a)}" target="_blank" rel="noopener noreferrer" class="comment-link">${r(i)}</a>`:r(i||a):""})):r(e))).join(""),o=a>0?i[a-1]:" ",u=a+e.length<i.length?i[a+e.length]:" ";return`${o&&" "!==o&&"\n"!==o&&"\t"!==o?" ":""}<span class="spoiler-text" onclick="this.classList.toggle('revealed')" title="Нажмите, чтобы показать спойлер">${l}</span>${u&&" "!==u&&"\n"!==u&&"\t"!==u?" ":""}`}))).replace(/\[img\](.*?)\[\/img\]/g,((e,n)=>{var a=n.trim(),i=t(a);return i&&!1!==i?`<img src="${r(i)}" alt="7TV emote" class="inline-emoji" loading="lazy" />`:`[недопустимое изображение: ${r(a)}]`}))).replace(/\[link=([^\]]+)\](.*?)\[\/link\]/g,((t,e,n)=>{var a=e.trim(),i=n.trim();return i?/^https?:\/\//.test(a)&&i?`<a href="${r(a)}" target="_blank" rel="noopener noreferrer" class="comment-link">${r(i)}</a>`:r(i||a):""}))};return{formatContent:n,formatContentWithTruncation:t=>t?n(t):"",isValidImageUrl:t,escapeHtml:r}}}),t("b",(t=>{if(!t)return"";var r=t.substring(0,4),e=t.substring(4,6),n=t.substring(6,8),a=t.substring(9,11),i=t.substring(11,13),s=t.substring(13,15);return new Date(Date.UTC(parseInt(r),parseInt(e)-1,parseInt(n),parseInt(a),parseInt(i),parseInt(s))).toLocaleDateString("ru-RU",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone})})),t("a",(t=>{if(!t)return"";var e=t.substring(0,4),o=t.substring(4,6),u=t.substring(6,8),c=t.substring(9,11),p=t.substring(11,13),g=t.substring(13,15),m=new Date(Date.UTC(parseInt(e),parseInt(o)-1,parseInt(u),parseInt(c),parseInt(p),parseInt(g))),h=new Date,d=Math.floor((h-m)/1e3);if(d<60)return"только что";var f=Math.floor(d/60);if(f<60)return`${f} ${r(f)} назад`;var v=Math.floor(f/60);if(v<24)return`${v} ${n(v)} назад`;var $=Math.floor(v/24);if($<7)return`${$} ${a($)} назад`;var b=Math.floor($/7);if(b<4)return`${b} ${i(b)} назад`;var k=Math.floor($/30);if(k<12)return`${k} ${s(k)} назад`;var I=Math.floor($/365);return`${I} ${l(I)} назад`}));var r=t=>t%10==1&&t%100!=11?"минуту":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"минуты":"минут",n=t=>t%10==1&&t%100!=11?"час":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"часа":"часов",a=t=>t%10==1&&t%100!=11?"день":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"дня":"дней",i=t=>t%10==1&&t%100!=11?"неделю":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"недели":"недель",s=t=>t%10==1&&t%100!=11?"месяц":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"месяца":"месяцев",l=t=>t%10==1&&t%100!=11?"год":[2,3,4].includes(t%10)&&![12,13,14].includes(t%100)?"года":"лет"}}}));
