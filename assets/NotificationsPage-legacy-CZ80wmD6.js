!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e=function(){return r};var a,r={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,a){t[e]=a.value},c="function"==typeof Symbol?Symbol:{},l=c.iterator||"@@iterator",s=c.asyncIterator||"@@asyncIterator",f=c.toStringTag||"@@toStringTag";function d(t,e,a){return Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(a){d=function(t,e,a){return t[e]=a}}function u(t,e,a,r){var n=e&&e.prototype instanceof y?e:y,o=Object.create(n.prototype),c=new P(r||[]);return i(o,"_invoke",{value:O(t,a,c)}),o}function p(t,e,a){try{return{type:"normal",arg:t.call(e,a)}}catch(t){return{type:"throw",arg:t}}}r.wrap=u;var v="suspendedStart",h="suspendedYield",m="executing",g="completed",x={};function y(){}function b(){}function w(){}var k={};d(k,l,(function(){return this}));var _=Object.getPrototypeOf,L=_&&_(_(T([])));L&&L!==n&&o.call(L,l)&&(k=L);var E=w.prototype=y.prototype=Object.create(k);function j(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function z(e,a){function r(n,i,c,l){var s=p(e[n],e,i);if("throw"!==s.type){var f=s.arg,d=f.value;return d&&"object"==t(d)&&o.call(d,"__await")?a.resolve(d.__await).then((function(t){r("next",t,c,l)}),(function(t){r("throw",t,c,l)})):a.resolve(d).then((function(t){f.value=t,c(f)}),(function(t){return r("throw",t,c,l)}))}l(s.arg)}var n;i(this,"_invoke",{value:function(t,e){function o(){return new a((function(a,n){r(t,e,a,n)}))}return n=n?n.then(o,o):o()}})}function O(t,e,r){var n=v;return function(o,i){if(n===m)throw Error("Generator is already running");if(n===g){if("throw"===o)throw i;return{value:a,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=S(c,r);if(l){if(l===x)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===v)throw n=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=m;var s=p(t,e,r);if("normal"===s.type){if(n=r.done?g:h,s.arg===x)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n=g,r.method="throw",r.arg=s.arg)}}}function S(t,e){var r=e.method,n=t.iterator[r];if(n===a)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=a,S(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),x;var o=p(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,x;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=a),e.delegate=null,x):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,x)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=a,t.done=!0,t};return i.next=i}}throw new TypeError(t(e)+" is not iterable")}return b.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:b,configurable:!0}),b.displayName=d(w,f,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,d(t,f,"GeneratorFunction")),t.prototype=Object.create(E),t},r.awrap=function(t){return{__await:t}},j(z.prototype),d(z.prototype,s,(function(){return this})),r.AsyncIterator=z,r.async=function(t,e,a,n,o){void 0===o&&(o=Promise);var i=new z(u(t,e,a,n),o);return r.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},j(E),d(E,f,"Generator"),d(E,l,(function(){return this})),d(E,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),a=[];for(var r in e)a.push(r);return a.reverse(),function t(){for(;a.length;){var r=a.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},r.values=T,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=a,this.done=!1,this.delegate=null,this.method="next",this.arg=a,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=a)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return c.type="throw",c.arg=t,e.next=r,n&&(e.method="next",e.arg=a),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],c=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var l=o.call(i,"catchLoc"),s=o.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var n=r;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var i=n?n.completion:{};return i.type=t,i.arg=e,n?(this.method="next",this.next=n.finallyLoc,x):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),x},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),C(a),x}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.tryLoc===t){var r=a.completion;if("throw"===r.type){var n=r.arg;C(a)}return n}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=a),x}},r}function a(t,e,a,r,n,o,i){try{var c=t[o](i),l=c.value}catch(t){return void a(t)}c.done?e(l):Promise.resolve(l).then(r,n)}function r(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function c(t){a(i,n,o,c,l,"next",t)}function l(t){a(i,n,o,c,l,"throw",t)}c(void 0)}))}}System.register(["./index-legacy-DL_UI4yt.js","./dateUtils-legacy-BnJ8iuER.js","./SpinnerLoading-legacy-B56tw_WS.js"],(function(t,a){"use strict";var n,o,i,c,l,s,f,d,u,p,v,h,m,g,x,y,b,w,k,_,L,E,j,z;return{setters:[t=>{n=t._,o=t.z,i=t.b,c=t.d,l=t.e,s=t.g,f=t.t,d=t.y,u=t.n,p=t.ak,v=t.i,h=t.r,m=t.c,g=t.o,x=t.a,y=t.x,b=t.s,w=t.f,k=t.E,_=t.K,L=t.L},t=>{E=t.f,j=t.u},t=>{z=t.S}],execute:function(){var a=document.createElement("style");a.textContent=".notification-item[data-v-45af7189]{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border-radius:8px;padding:10px;position:relative;transition:all .3s ease;border:1px solid rgba(255,255,255,.1)}.notification-item[data-v-45af7189]:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.1)}.notification-item.unread[data-v-45af7189]{background:rgba(255,255,255,.1);border-color:var(--accent-color)}.notification-content[data-v-45af7189]{display:flex;gap:8px;align-items:flex-start}.notification-avatar[data-v-45af7189]{flex-shrink:0;width:40px;height:40px;border-radius:50%;overflow:hidden;background:var(--accent-color);display:flex;align-items:center;justify-content:center}.avatar-img[data-v-45af7189]{width:100%;height:100%;object-fit:cover}.avatar-icon[data-v-45af7189]{color:#fff;font-size:18px}.notification-main[data-v-45af7189]{flex:1;min-width:0}.notification-header[data-v-45af7189]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:4px;gap:8px}.notification-info[data-v-45af7189]{display:flex;flex-wrap:wrap;gap:4px;align-items:center}.sender-name[data-v-45af7189]{font-weight:600;color:var(--text-color)}.notification-type[data-v-45af7189]{color:var(--text-color)}.movie-title[data-v-45af7189]{color:var(--text-color);font-weight:500;cursor:pointer;text-decoration:underline}.movie-title[data-v-45af7189]:hover{color:var(--text-color)}.notification-time[data-v-45af7189]{color:var(--muted-color);font-size:.85rem;white-space:nowrap}.notification-message[data-v-45af7189]{color:var(--text-color);margin-bottom:6px;font-weight:500;font-size:.95rem}.comment-preview[data-v-45af7189]{background:rgba(255,255,255,.05);border-radius:6px;padding:8px;margin-bottom:6px;border-left:2px solid var(--accent-color)}.original-comment[data-v-45af7189],.reply-comment[data-v-45af7189]{display:flex;align-items:flex-start;gap:8px;margin-bottom:6px}.original-comment[data-v-45af7189]:last-child,.reply-comment[data-v-45af7189]:last-child{margin-bottom:0}.comment-preview i[data-v-45af7189]{color:var(--muted-color);font-size:.8rem;margin-top:2px;flex-shrink:0}.comment-text[data-v-45af7189]{color:var(--text-color);font-size:.9rem;line-height:1.4}.comment-text[data-v-45af7189] img.inline-emoji{display:inline-block;vertical-align:middle;height:2em;width:auto;margin:0 .3em;max-height:32px}.comment-text[data-v-45af7189] .spoiler-text{background:#333;color:transparent;cursor:pointer;user-select:none;transition:all .2s ease}.comment-text[data-v-45af7189] .spoiler-text.revealed{background:none;color:inherit}.comment-text[data-v-45af7189] .comment-link{color:var(--accent-color);text-decoration:none;transition:color .2s ease}.comment-text[data-v-45af7189] .comment-link:hover{color:var(--accent-hover);text-decoration:underline}.movie-poster[data-v-45af7189]{margin-right:8px;flex-shrink:0}.poster-img[data-v-45af7189]{width:50px;height:75px;object-fit:cover;border-radius:4px;cursor:pointer;transition:transform .3s ease}.poster-img[data-v-45af7189]:hover{transform:scale(1.05)}.notification-actions[data-v-45af7189]{display:flex;flex-direction:column;gap:4px;flex-shrink:0}.action-btn[data-v-45af7189]{width:28px;height:28px;border:none;border-radius:4px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;font-size:.8rem}.mark-read-btn[data-v-45af7189]{background:var(--accent-color);color:#fff}.mark-read-btn[data-v-45af7189]:hover{background:var(--accent-hover)}.delete-btn[data-v-45af7189]{background:var(--error-color);color:#fff}.delete-btn[data-v-45af7189]:hover{background:#d63031}.unread-indicator[data-v-45af7189]{position:absolute;top:8px;right:8px;width:6px;height:6px;background:var(--error-color);border-radius:50%}@media (max-width: 768px){.notification-item[data-v-45af7189]{padding:8px}.notification-content[data-v-45af7189]{gap:6px}.notification-avatar[data-v-45af7189]{width:32px;height:32px}.avatar-icon[data-v-45af7189]{font-size:14px}.notification-header[data-v-45af7189]{flex-direction:column;align-items:flex-start;gap:4px}.notification-info[data-v-45af7189]{font-size:.9rem}.movie-poster[data-v-45af7189]{margin-right:8px}.poster-img[data-v-45af7189]{width:40px;height:60px}.notification-actions[data-v-45af7189]{flex-direction:row;gap:4px}.action-btn[data-v-45af7189]{width:24px;height:24px;font-size:.75rem}}[data-v-45af7189]:root{--accent-color: #6c5ce7;--accent-hover: #5a4fcf;--secondary-color: #74b9ff;--secondary-hover: #0984e3;--text-color: #2d3436;--muted-color: #636e72;--error-color: #e17055}[data-theme=dark][data-v-45af7189]{--text-color: #ddd;--muted-color: #999}.notifications-page[data-v-0c5e6811]{min-height:100vh;background:var(--bg-gradient);padding:20px 0}.container[data-v-0c5e6811]{max-width:800px;margin:0 auto;padding:0 20px}.notifications-header[data-v-0c5e6811]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;flex-wrap:wrap;gap:15px}.page-title[data-v-0c5e6811]{font-size:2.5rem;font-weight:700;color:var(--text-color);display:flex;align-items:center;gap:15px;margin:0}.page-title i[data-v-0c5e6811]{color:var(--text-color)}.header-actions[data-v-0c5e6811]{display:flex;gap:10px}.btn[data-v-0c5e6811]{background:var(--accent-color);color:#fff;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-size:.9rem;display:flex;align-items:center;gap:8px;transition:all .3s ease}.btn[data-v-0c5e6811]:hover:not(:disabled){background:var(--accent-hover);transform:translateY(-2px)}.btn[data-v-0c5e6811]:disabled{opacity:.6;cursor:not-allowed}.btn-secondary[data-v-0c5e6811]{background:var(--secondary-color)}.btn-secondary[data-v-0c5e6811]:hover:not(:disabled){background:var(--secondary-hover)}.loading-container[data-v-0c5e6811]{text-align:center;padding:60px 20px}.loading-text[data-v-0c5e6811]{margin-top:20px;color:var(--text-color);font-size:1.1rem}.empty-state[data-v-0c5e6811]{text-align:center;padding:60px 20px}.empty-icon[data-v-0c5e6811]{font-size:4rem;color:var(--muted-color);margin-bottom:20px}.empty-title[data-v-0c5e6811]{font-size:1.8rem;color:var(--text-color);margin-bottom:10px}.empty-text[data-v-0c5e6811]{color:var(--muted-color);font-size:1.1rem;line-height:1.5}.notifications-list[data-v-0c5e6811]{display:flex;flex-direction:column;gap:15px}@media (max-width: 768px){.notifications-header[data-v-0c5e6811]{flex-direction:column;align-items:flex-start}.page-title[data-v-0c5e6811]{font-size:2rem}.header-actions[data-v-0c5e6811]{width:100%}.btn[data-v-0c5e6811]{flex:1;justify-content:center}}[data-v-0c5e6811]:root{--bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);--accent-color: #6c5ce7;--accent-hover: #5a4fcf;--secondary-color: #74b9ff;--secondary-hover: #0984e3;--text-color: #2d3436;--muted-color: #636e72;--error-color: #e17055}[data-theme=dark][data-v-0c5e6811]{--bg-gradient: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);--text-color: #ddd;--muted-color: #999}\n/*$vite$:1*/",document.head.appendChild(a);var O={class:"notification-content"},S={key:0,class:"movie-poster"},N=["src","alt"],C={class:"notification-main"},P={class:"notification-header"},T={class:"notification-info"},G={class:"notification-time"},I={class:"notification-message"},F={key:0,class:"comment-preview"},M={key:0,class:"original-comment"},A=["innerHTML"],H={key:1,class:"reply-comment"},R=["innerHTML"],Y={class:"notification-actions"},$={key:0,class:"unread-indicator"},q=n({__name:"NotificationItem",props:{notification:{type:Object,required:!0}},emits:["mark-read","delete"],setup(t,e){var a=e.emit,r=t,n=a,p=o(),v=j().formatContent,h=t=>t?v(t):"",m=()=>{n("mark-read",r.notification.id)},g=()=>{n("delete",r.notification.id)},x=()=>{p.push(`/movie/${r.notification.movie_id}`)};return(e,a)=>(c(),i("div",{class:u(["notification-item",{unread:!t.notification.is_read,read:t.notification.is_read}])},[l("div",O,[t.notification.movie_cover?(c(),i("div",S,[l("img",{src:t.notification.movie_cover,alt:t.notification.movie_title,class:"poster-img",onClick:x},null,8,N)])):s("",!0),l("div",C,[l("div",P,[l("div",T,[l("span",{class:"movie-title",onClick:x},f(t.notification.movie_title),1)]),l("div",G,f(d(E)(t.notification.created_at)),1)]),l("div",I,f(t.notification.message),1),t.notification.comment_content||t.notification.reply_content?(c(),i("div",F,[t.notification.comment_content?(c(),i("div",M,[a[0]||(a[0]=l("i",{class:"fas fa-quote-left"},null,-1)),l("span",{class:"comment-text",innerHTML:h(t.notification.comment_content)},null,8,A)])):s("",!0),t.notification.reply_content?(c(),i("div",H,[a[1]||(a[1]=l("i",{class:"fas fa-reply"},null,-1)),l("span",{class:"comment-text",innerHTML:h(t.notification.reply_content)},null,8,R)])):s("",!0)])):s("",!0)]),l("div",Y,[t.notification.is_read?s("",!0):(c(),i("button",{key:0,onClick:m,class:"action-btn mark-read-btn",title:"Отметить как прочитанное"},a[2]||(a[2]=[l("i",{class:"fas fa-check"},null,-1)]))),l("button",{onClick:g,class:"action-btn delete-btn",title:"Удалить уведомление"},a[3]||(a[3]=[l("i",{class:"fas fa-trash"},null,-1)]))])]),t.notification.is_read?s("",!0):(c(),i("div",$))],2))}},[["__scopeId","data-v-45af7189"]]),U={class:"notifications-page"},D={class:"container"},K={class:"notifications-header"},B={key:0,class:"header-actions"},J=["disabled"],Q={key:0,class:"loading-container"},V={key:2,class:"empty-state"},W={key:3,class:"notifications-list"},X={__name:"NotificationsPage",setup(t){var a=p(),n=v(),f=o(),u=h(!1),E=m((()=>a.notifications));g(r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.token){t.next=3;break}return f.push("/login"),t.abrupt("return");case 3:return t.next=5,O();case 5:j=setInterval((()=>{a.fetchUnreadCount()}),3e4);case 6:case"end":return t.stop()}}),t)})))),x((()=>{j&&(clearInterval(j),j=null)}));var j=null;function O(){return S.apply(this,arguments)}function S(){return(S=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.fetchNotifications();case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function N(){return C.apply(this,arguments)}function C(){return(C=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u.value=!0,t.prev=1,t.next=4,a.markAsRead();case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),console.error("Error marking all as read:",t.t0);case 9:return t.prev=9,u.value=!1,t.finish(9);case 12:case"end":return t.stop()}}),t,null,[[1,6,9,12]])})))).apply(this,arguments)}function P(t){return T.apply(this,arguments)}function T(){return(T=r(e().mark((function t(r){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a.markAsRead([r]);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error("Error marking notification as read:",t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))).apply(this,arguments)}function G(t){return I.apply(this,arguments)}function I(){return(I=r(e().mark((function t(r){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a.deleteNotification(r);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error("Error deleting notification:",t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))).apply(this,arguments)}return(t,e)=>(c(),i("div",U,[l("div",D,[l("div",K,[e[1]||(e[1]=l("h1",{class:"page-title"},[l("i",{class:"fas fa-bell"}),b(" Уведомления ")],-1)),E.value.length>0?(c(),i("div",B,[d(a).unreadCount>0?(c(),i("button",{key:0,onClick:N,class:"btn",disabled:u.value},e[0]||(e[0]=[l("i",{class:"fas fa-check-double"},null,-1),b(" Отметить все как прочитанные ")]),8,J)):s("",!0)])):s("",!0)]),d(a).loading?(c(),i("div",Q,[w(z),e[2]||(e[2]=l("p",{class:"loading-text"},"Загрузка уведомлений...",-1))])):d(a).error?(c(),y(k,{key:1,message:d(a).error,onRetry:O},null,8,["message"])):0===E.value.length?(c(),i("div",V,e[3]||(e[3]=[l("i",{class:"fas fa-bell-slash empty-icon"},null,-1),l("h3",{class:"empty-title"},"Нет уведомлений",-1),l("p",{class:"empty-text"}," Когда кто-то ответит на ваш комментарий, вы увидите уведомление здесь ",-1)]))):(c(),i("div",W,[(c(!0),i(_,null,L(E.value,(t=>(c(),y(q,{key:t.id,notification:t,onMarkRead:P,onDelete:G},null,8,["notification"])))),128))]))])]))}};t("default",n(X,[["__scopeId","data-v-0c5e6811"]]))}}}))}();
