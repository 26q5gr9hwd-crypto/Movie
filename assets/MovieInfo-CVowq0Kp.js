import{_ as je,r as g,c as q,b as r,d as a,e,s as ce,t as y,K as ke,g as C,L as xe,n as j,q as ze,u as at,i as vt,N as yn,z as rt,l as Oe,o as Ze,O as st,x as Be,E as pn,f as pe,P as it,m as Z,Q as se,y as de,U as Q,R as Cn,D as dt,S as ve,V as wn,W as bn,X as _n,Y as cn,Z as Mn,k as En,v as ot,$ as Ln,a0 as $e,a1 as lt,a2 as In,a3 as Rn,a4 as Tn,a5 as Sn,a6 as dn,a7 as An,a8 as xn,a as $n,a9 as vn,aa as Pn,ab as Un,ac as jn}from"./index-DsJRXw8g.js";import{S as hn,_ as Hn,a as mn,b as fn,M as gn}from"./MovieList-B6qUCygK.js";import{N as ut}from"./ToastMessage-CuCV6P1D.js";import{u as Bn,S as Dn,a as Nn}from"./trailer-CgCS5Tv1.js";const Xe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVR4nO2ZQUoDMRSGR7eewHoFsVS0HkUUXNXqASqK2EURBPFIVRe6c+UN1CvUXWvbT4KvMAwzNnnJdCrmg1BKad7/v7y0b5IkiUQiCwGoAx3gQjEugZ0qxTeAIX6MKjMBnBOGS62AVWAPOHVYdlMu9YArYOhphLeBT+ALmOKGEd2QubaAK+B2zngFxt4GgDXgGZjgR8ch5oEkCi8DkvlnRcYLV0Apfqw10M7JvPkV6AN3FmVwK+WyZRnvMEe8ef/ibECyb2o+zRuwnpQAxeLNivQ0BvYyE46qEJ/8fK4ycJKp/X4V4n0MdDNfukkqEO9jwP1LDgD7BeKPgmgp04CL+KUz4Cp+qQxoxC+NAdsNm4c0hWkukkUa8BGfegiadbFDq3/2UAZ8xc+QVvzMtqcKYkBaZ5/MN5xEl2DgLGDZ1KswsC09FPJqXTZoNm5oA6kyMGI2FxqfkluJ0uMTDfhBXAHiHvCCWEL8/RLqlv1MPCf+TSZ+13WC7KnEfWlqcwAeU7GNjnbiQsG5UC1ZAEAt1UMhOpquk6zknMy9l20C2AA+MnEHRo9msuOCs9EH4Fp5TVQ0rqVs0plH4re02Qh1Oq1lCjypsp+5H3gKcD/gykTirqnFZ/ZDy+OGxpapzD+QePrM/2KkKfcGPcv7AdvRkz23G1x4JPIP+AY3r/ywUk/2JAAAAABJRU5ErkJggg==",Vn="/reyohoho/assets/icon-shikimori-DGvXK9Jc.svg",ct=i=>{const t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="rgba(0, 0, 0, 0.8)",t.style.color="white",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t.style.fontSize="2rem",t.style.zIndex="99000",t.textContent=i,document.body.appendChild(t),setTimeout(()=>{document.body.removeChild(t)},2e3)},On={key:0},Kn={key:1},qn={class:"players-list"},Fn=["onClick"],Wn={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},zn={key:0},Yn={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},Gn={key:1},Zn={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},Qn=["onClick"],Xn={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},Jn={__name:"PlayerModal",props:{players:{type:Array,required:!0},selectedPlayer:{type:Object,default:null}},emits:["close","select"],setup(i,{emit:t}){const c=i,n=t,m=g(null),_=q(()=>c.players.filter(w=>!E(w)&&!l(w))),d=q(()=>c.players.some(w=>E(w))),M=q(()=>c.players.some(w=>l(w))),E=w=>w.key.toUpperCase().includes("HDREZKA"),l=w=>w.key.toUpperCase().includes("KODIK"),p=w=>w.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"").trim(),u=w=>{n("select",w),n("close")},L=w=>c.selectedPlayer&&c.selectedPlayer.key===w.key,$=w=>c.selectedPlayer?w==="hdrezka"&&E(c.selectedPlayer)||w==="kodik"&&l(c.selectedPlayer):!1,z=w=>{m.value=w},ie=()=>{m.value=null},B=w=>{let x=c.players.filter(S=>w==="hdrezka"&&E(S)||w==="kodik"&&l(S));return w==="kodik"?x.sort((S,Y)=>p(S.translate).localeCompare(p(Y.translate))):x},P=w=>B(w).some(x=>x.warning);return(w,x)=>(a(),r("div",{class:"modal",onClick:x[4]||(x[4]=ze(S=>w.$emit("close"),["self"]))},[e("div",{class:"modal-content",onClick:x[3]||(x[3]=ze(()=>{},["stop"]))},[e("button",{class:"close",onClick:x[0]||(x[0]=S=>w.$emit("close"))},"√ó"),m.value?(a(),r("h2",Kn,[e("button",{class:"back-btn",onClick:ie},"‚Üê –ù–∞–∑–∞–¥"),ce(" "+y(m.value==="hdrezka"?"ReYohoho - HDrezka":"Kodik"),1)])):(a(),r("h2",On,"–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–µ–µ—Ä")),e("ul",qn,[m.value?(a(!0),r(ke,{key:1},xe(B(m.value),S=>(a(),r("li",{key:S.key},[e("button",{class:j(["player-item",{active:L(S)}]),onClick:Y=>u(S)},[ce(y(p(S.translate))+" ",1),S.warning?(a(),r("span",Xn,"warning")):C("",!0)],10,Qn)]))),128)):(a(),r(ke,{key:0},[(a(!0),r(ke,null,xe(_.value,S=>(a(),r("li",{key:S.key},[e("button",{class:j(["player-item",{active:L(S)}]),onClick:Y=>u(S)},[ce(y(p(S.translate))+" ",1),S.warning?(a(),r("span",Wn,"warning")):C("",!0)],10,Fn)]))),128)),d.value?(a(),r("li",zn,[e("button",{class:j(["group-item",{active:$("hdrezka")}]),onClick:x[1]||(x[1]=S=>z("hdrezka"))},[x[5]||(x[5]=e("span",{class:"material-icons group-icon"},"folder",-1)),x[6]||(x[6]=ce(" ReYohoho - HDrezka ")),P("hdrezka")?(a(),r("span",Yn,"warning")):C("",!0)],2)])):C("",!0),M.value?(a(),r("li",Gn,[e("button",{class:j(["group-item",{active:$("kodik")}]),onClick:x[2]||(x[2]=S=>z("kodik"))},[x[7]||(x[7]=e("span",{class:"material-icons group-icon"},"folder",-1)),x[8]||(x[8]=ce(" Kodik ")),P("kodik")?(a(),r("span",Zn,"warning")):C("",!0)],2)])):C("",!0)],64))])])]))}},eo=je(Jn,[["__scopeId","data-v-460326ba"]]),to={class:"players-list"},no=["src"],oo={key:1,class:"controls"},lo={class:"main-controls"},so={class:"material-icons"},io={class:"list-button-item"},ao={class:"material-icons"},ro={class:"list-button-item"},uo={class:"material-icons"},co={class:"list-button-item"},vo={class:"list-button-item"},mo={class:"material-icons"},fo={class:"list-button-item"},go={class:"material-icons"},ko={class:"tooltip-container","data-tooltip-container":"dimming"},yo={class:"material-icons"},po={class:"tooltip-container","data-tooltip-container":"blur"},bo={class:"tooltip-container","data-tooltip-container":"compressor"},ho={class:"tooltip-container","data-tooltip-container":"mirror"},Co={class:"tooltip-container","data-tooltip-container":"theater"},wo={class:"material-symbols-outlined"},_o={class:"custom-tooltip","data-tooltip":"theater"},Mo={class:"tooltip-container","data-tooltip-container":"aspect_ratio"},Eo={class:"current-ratio"},Lo=["onClick"],Io={key:0,class:"tooltip-container","data-tooltip-container":"app_link"},Ro={class:"custom-tooltip","data-tooltip":"app_link"},To={key:1,class:"tooltip-container","data-tooltip-container":"copy_link"},So={class:"custom-tooltip","data-tooltip":"copy_link"},Ao={key:0,class:"desktop-list-buttons"},xo={class:"tooltip-container"},$o={class:"material-icons"},Po={class:"custom-tooltip"},Uo={class:"tooltip-container"},jo={class:"material-icons"},Ho={class:"custom-tooltip"},Bo={class:"tooltip-container"},Do={class:"custom-tooltip"},No={class:"tooltip-container"},Vo={class:"material-icons"},Oo={class:"custom-tooltip"},Ko={class:"tooltip-container"},qo={class:"material-icons"},Fo={class:"custom-tooltip"},Wo={key:1,class:"mobile-list-buttons"},zo={class:"tooltip-container"},Yo={class:"material-icons"},Go={class:"custom-tooltip"},Zo={class:"tooltip-container"},Qo={class:"material-icons"},Xo={class:"custom-tooltip"},Jo={class:"tooltip-container"},el={class:"custom-tooltip"},tl={class:"tooltip-container"},nl={class:"material-icons"},ol={class:"custom-tooltip"},ll={class:"tooltip-container"},sl={class:"material-icons"},il={class:"custom-tooltip"},al={__name:"PlayerComponent",props:{kpId:String,movieInfo:{type:Object,default:()=>({})}},emits:["update:selectedPlayer","update:movieInfo"],setup(i,{emit:t}){const c=at(),n=Bn(),m=vt(),_=yn(),d=rt(),M=g(_.params.kp_id),E=i,l=t,p=g([]),u=g(null),L=g(!0),$=g(!1),z=g(!1),ie=g(null),B=g(null),P=g(!1),w=g(""),x=g(null),S=g(window.innerHeight*.9),Y=q(()=>"".concat(S.value,"px")),F=q(()=>c.isMobile),G=q(()=>!!window.electronAPI),R=g(null),_e=g(!1);let Me=null;const fe=g(null),Se=g(null),Ee=g(null),D=k=>{const o=document.querySelector('[data-tooltip-container="'.concat(k,'"]')),U=document.querySelector('[data-tooltip="'.concat(k,'"]'));if(!o||!U)return;const te=o.getBoundingClientRect(),le=U.getBoundingClientRect(),ue=window.innerHeight;te.bottom+le.height>ue?(U.style.top="auto",U.style.bottom="100%",U.style.marginTop="0",U.style.marginBottom="12px",U.style.transform="translateX(-50%)"):(U.style.top="100%",U.style.bottom="auto",U.style.marginTop="12px",U.style.marginBottom="0",U.style.transform="translateX(-50%)")},v=k=>{R.value=k,_e.value=!1,clearTimeout(Me),ve(()=>{D(k)})},O=()=>{_e.value||(Me=setTimeout(()=>{R.value=null},300))},ee=()=>{_e.value=!0,clearTimeout(Me)},X=()=>{_e.value=!1,R.value=null},ne=q({get:()=>n.aspectRatio,set:k=>n.updateAspectRatio(k)}),Le=q({get:()=>n.isCentered,set:k=>n.updateCentering(k)}),ge=q(()=>{var k,o,U,te,le,ue,me,Re,Ce,we;return((o=(k=E.movieInfo)==null?void 0:k.lists)==null?void 0:o.isFavorite)||((te=(U=E.movieInfo)==null?void 0:U.lists)==null?void 0:te.isWatching)||((ue=(le=E.movieInfo)==null?void 0:le.lists)==null?void 0:ue.isLater)||((Re=(me=E.movieInfo)==null?void 0:me.lists)==null?void 0:Re.isCompleted)||((we=(Ce=E.movieInfo)==null?void 0:Ce.lists)==null?void 0:we.isAbandoned)}),A=q(()=>n.preferredPlayer),f=g(0),ae=k=>k.toUpperCase(),be=()=>{if($.value||!B.value)return;const[k,o]=ne.value.split(":").map(Number);S.value=window.innerHeight*.9,f.value=Math.min(B.value.clientWidth*(o/k),S.value)},K=q(()=>{if($.value)return{};const[k,o]=ne.value.split(":").map(Number),U=S.value*(k/o);return{width:"100%",maxWidth:"".concat(U,"px"),maxHeight:Y.value,margin:"0 auto",overflow:"hidden"}}),Ae=q(()=>{const[k,o]=ne.value.split(":").map(Number);return{position:"relative",width:"100%",paddingTop:"".concat(o/k*100,"%")}}),Pe=()=>{B.value&&setTimeout(()=>{ve(()=>{B.value.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},500)},Ke=async()=>{try{w.value="",x.value=null;const k=await Cn(E.kpId);if(p.value=Object.entries(k).map(([o,U])=>({key:o.toUpperCase(),...U})),p.value.length>0){if(A.value){const o=ae(A.value),U=p.value.find(te=>ae(te.key)===o);u.value=U||p.value[0]}else u.value=p.value[0];l("update:selectedPlayer",u.value)}}catch(k){const{message:o,code:U}=dt(k);w.value=o,x.value=U,console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–ª–µ–µ—Ä–æ–≤:",k)}},qe=()=>{P.value=!0},Te=()=>{P.value=!1},Ie=k=>{var o;if(((o=u.value)==null?void 0:o.key)===k.key){Te();return}u.value=k,L.value=!0,n.updatePreferredPlayer(ae(k.key)),l("update:selectedPlayer",k)},Fe=()=>{G.value?window.electronAPI.sendHotKey("F2"):(ct("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},De=()=>{G.value?window.electronAPI.sendHotKey("F3"):(ct("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},Ye=()=>{G.value?window.electronAPI.sendHotKey("F4"):(ct("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},We=()=>{$.value=!$.value,$.value?(window.addEventListener("mousemove",Ge),document.addEventListener("keydown",H),document.body.classList.add("no-scroll")):(window.removeEventListener("mousemove",Ge),document.removeEventListener("keydown",H),document.body.classList.remove("no-scroll")),z.value=$.value,ve(()=>Pe())},Qe=g(null),Ge=()=>{Qe.value=setTimeout(()=>{clearTimeout(Qe.value),z.value=!1},4e3),z.value=!0},Ne=q(()=>c.dimmingEnabled),b=()=>{$.value||c.toggleDimming()},H=k=>{(k.key==="Escape"&&$.value||k.altKey&&k.keyCode===84)&&We()},N=k=>{ne.value=k,setTimeout(()=>{Le.value&&Pe()},310)},W=()=>{const k="reyohoho://#".concat(M.value);try{window.location.href=k}catch(o){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Å—ã–ª–∫–∏:",o)}},ye=()=>{const k=window.location.href;navigator.clipboard.writeText(k).then(()=>{}),fe.value.showNotification("–°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∏–ª—å–º —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞")},re=()=>{L.value=!1};function he(k){return k.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"HDRezka - ").replace(/KODIK>/,"Kodik - ").trim()}const He=q(()=>{var k,o;return G.value?!1:!((o=(k=u.value)==null?void 0:k.key)!=null&&o.toUpperCase().includes("TORRENTS"))});Oe(u,k=>{if(k)if(L.value=!0,n.updatePreferredPlayer(ae(k.key)),l("update:selectedPlayer",k),k.key.toUpperCase().includes("TORRENTS")){const o=document.querySelector(".rocketme_fon");o&&(o.style.display="none");const U=document.querySelector(".pm_preloader");U&&(U.style.display="none")}else{const o=document.querySelector(".rocketme_fon");o&&(o.style.display="");const U=document.querySelector(".pm_preloader");U&&(U.style.display="")}}),Oe(()=>_.params.kp_id,async k=>{k&&k!==M.value&&(M.value=k,Le.value&&Pe())},{immediate:!0});const Ve=["16:9","12:5","4:3"],s=()=>{const o=(Ve.indexOf(ne.value)+1)%Ve.length;N(Ve[o])},h=k=>{var U,te,le,ue,me,Re,Ce,we,Ue,Je,et,tt,nt;return(nt={[Q.FAVORITE]:((te=(U=E.movieInfo)==null?void 0:U.lists)==null?void 0:te.isFavorite)||!1,[Q.HISTORY]:((ue=(le=E.movieInfo)==null?void 0:le.lists)==null?void 0:ue.isHistory)||!1,[Q.LATER]:((Re=(me=E.movieInfo)==null?void 0:me.lists)==null?void 0:Re.isLater)||!1,[Q.COMPLETED]:((we=(Ce=E.movieInfo)==null?void 0:Ce.lists)==null?void 0:we.isCompleted)||!1,[Q.ABANDONED]:((Je=(Ue=E.movieInfo)==null?void 0:Ue.lists)==null?void 0:Je.isAbandoned)||!1,[Q.WATCHING]:((tt=(et=E.movieInfo)==null?void 0:et.lists)==null?void 0:tt.isWatching)||!1}[k])!=null?nt:!1},T=async k=>{if(!m.token){fe.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:oe});return}try{const o={[Q.FAVORITE]:"–∏–∑–±—Ä–∞–Ω–Ω–æ–µ",[Q.HISTORY]:"–∏—Å—Ç–æ—Ä–∏—é",[Q.LATER]:'—Å–ø–∏—Å–æ–∫ "–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ"',[Q.COMPLETED]:'—Å–ø–∏—Å–æ–∫ "–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"',[Q.ABANDONED]:'—Å–ø–∏—Å–æ–∫ "–ë—Ä–æ—à–µ–Ω–æ"',[Q.WATCHING]:'—Å–ø–∏—Å–æ–∫ "–°–º–æ—Ç—Ä—é"'};h(k)?(await wn(M.value,k),fe.value.showNotification("–£–¥–∞–ª–µ–Ω–æ –∏–∑ ".concat(o[k]))):(await bn(M.value,k),fe.value.showNotification("–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ ".concat(o[k])))}catch(o){const{message:U,code:te}=dt(o);fe.value.showNotification("".concat(U," ").concat(te))}l("update:movieInfo")},oe=()=>{d.push("/login")},J=q(()=>n.showFavoriteTooltip),V=()=>{d.push("/settings"),X()};return Ze(()=>{L.value=!0,Ke(),F.value&&(ne.value="4:3"),be(),window.addEventListener("resize",be),window.addEventListener("resize",D),Le.value&&Pe()}),st(()=>{window.removeEventListener("resize",be),window.removeEventListener("resize",D),window.removeEventListener("mousemove",Ge),document.removeEventListener("keydown",H),document.body.classList.remove("no-scroll")}),(k,o)=>{var U,te,le,ue,me,Re,Ce,we,Ue,Je,et,tt,nt,kt,yt,pt,bt,ht,Ct,wt,_t,Mt,Et,Lt,It,Rt,Tt,St,At,xt,$t,Pt,Ut,jt,Ht,Bt,Dt,Nt,Vt,Ot,Kt,qt,Ft,Wt,zt,Yt,Gt,Zt,Qt,Xt,Jt,en,tn,nn,on,ln,sn,an,rn,un;return w.value?(a(),Be(pn,{key:0,message:w.value,code:x.value},null,8,["message","code"])):(a(),r(ke,{key:1},[e("div",to,[o[54]||(o[54]=e("span",null,"–ü–ª–µ–µ—Ä:",-1)),e("button",{class:"player-btn",onClick:qe},y(u.value?he(u.value.translate).toUpperCase():"–ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–µ–µ—Ä–æ–≤..."),1)]),P.value?(a(),Be(eo,{key:0,players:p.value,"selected-player":u.value,onClose:Te,onSelect:Ie},null,8,["players","selected-player"])):C("",!0),e("div",{ref_key:"containerRef",ref:B,class:j(["player-container",{"theater-mode":$.value}]),style:it($.value?{}:K.value)},[e("div",{class:j(["iframe-wrapper",{pm_video:He.value}]),style:it($.value?{}:Ae.value)},[Z(e("iframe",{ref_key:"playerIframe",ref:ie,src:(U=u.value)==null?void 0:U.iframe,frameborder:"0",allowfullscreen:"",webkitallowfullscreen:"",class:j(["responsive-iframe",{"theater-mode-unlock":z.value,"theater-mode-lock":$.value,dimmed:Ne.value}]),onLoad:re},null,42,no),[[se,!L.value&&((te=u.value)==null?void 0:te.iframe)]]),L.value?(a(),Be(hn,{key:0})):C("",!0)],6),$.value?(a(),r("button",{key:0,class:j(["close-theater-btn",{visible:z.value}]),onClick:We}," ‚úñ ",2)):C("",!0)],6),$.value?C("",!0):(a(),r("div",oo,[e("div",lo,[F.value?C("",!0):(a(),r("div",{key:0,ref_key:"tooltipContainer",ref:Se,class:"tooltip-container list-buttons-container","data-tooltip-container":"favorite"},[J.value?(a(),r("button",{key:0,class:j(["favorite-btn",{active:(ue=(le=i.movieInfo)==null?void 0:le.lists)==null?void 0:ue.isFavorite}]),onMouseenter:o[0]||(o[0]=I=>v("favorite")),onMouseleave:O,onClick:o[1]||(o[1]=I=>T(de(Q).FAVORITE))},[e("span",so,y((Re=(me=i.movieInfo)==null?void 0:me.lists)!=null&&Re.isFavorite?"favorite":"favorite_border"),1),e("span",{class:j(["material-icons dropdown-arrow",{highlighted:ge.value}])},"expand_more",2)],34)):C("",!0),Z(e("div",{ref_key:"tooltip",ref:Ee,class:"custom-tooltip advanced-tooltip list-buttons-dropdown","data-tooltip":"favorite",onMouseenter:ee,onMouseleave:X},[e("div",io,[e("button",{class:j(["favorite-btn",{active:(we=(Ce=i.movieInfo)==null?void 0:Ce.lists)==null?void 0:we.isFavorite}]),onClick:o[2]||(o[2]=I=>T(de(Q).FAVORITE))},[e("span",ao,y((Je=(Ue=i.movieInfo)==null?void 0:Ue.lists)!=null&&Je.isFavorite?"favorite":"favorite_border"),1),o[55]||(o[55]=e("span",{class:"button-label"},"–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ",-1))],2)]),e("div",ro,[e("button",{class:j(["watching-btn",{active:(tt=(et=i.movieInfo)==null?void 0:et.lists)==null?void 0:tt.isWatching}]),onClick:o[3]||(o[3]=I=>T(de(Q).WATCHING))},[e("span",uo,y((kt=(nt=i.movieInfo)==null?void 0:nt.lists)!=null&&kt.isWatching?"visibility_off":"visibility"),1),o[56]||(o[56]=e("span",{class:"button-label"},"–°–º–æ—Ç—Ä—é",-1))],2)]),e("div",co,[e("button",{class:j(["later-btn",{active:(pt=(yt=i.movieInfo)==null?void 0:yt.lists)==null?void 0:pt.isLater}]),onClick:o[4]||(o[4]=I=>T(de(Q).LATER))},o[57]||(o[57]=[e("span",{class:"material-icons"},"watch_later",-1),e("span",{class:"button-label"},"–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ",-1)]),2)]),e("div",vo,[e("button",{class:j(["completed-btn",{active:(ht=(bt=i.movieInfo)==null?void 0:bt.lists)==null?void 0:ht.isCompleted}]),onClick:o[5]||(o[5]=I=>T(de(Q).COMPLETED))},[e("span",mo,y((wt=(Ct=i.movieInfo)==null?void 0:Ct.lists)!=null&&wt.isCompleted?"check_circle":"check_circle_outline"),1),o[58]||(o[58]=e("span",{class:"button-label"},"–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ",-1))],2)]),e("div",fo,[e("button",{class:j(["abandoned-btn",{active:(Mt=(_t=i.movieInfo)==null?void 0:_t.lists)==null?void 0:Mt.isAbandoned}]),onClick:o[6]||(o[6]=I=>T(de(Q).ABANDONED))},[e("span",go,y(((Lt=(Et=i.movieInfo)==null?void 0:Et.lists)!=null&&Lt.isAbandoned,"not_interested")),1),o[59]||(o[59]=e("span",{class:"button-label"},"–ë—Ä–æ—à–µ–Ω–æ",-1))],2)]),e("div",{class:"tooltip-hint"},[o[61]||(o[61]=e("span",{class:"material-icons"},"settings",-1)),e("span",null,[o[60]||(o[60]=ce("–°—Ç–∏–ª—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ ")),e("a",{class:"settings-link",onClick:V},"–Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö")])])],544),[[se,R.value==="favorite"&&J.value]])],512)),F.value?C("",!0):(a(),r(ke,{key:1},[e("div",ko,[e("button",{class:j(["dimming-btn",{active:Ne.value}]),onMouseenter:o[7]||(o[7]=I=>v("dimming")),onMouseleave:o[8]||(o[8]=I=>R.value=null),onClick:b},[e("span",yo,y(Ne.value?"light_mode":"dark_mode"),1)],34),Z(e("div",{class:"custom-tooltip","data-tooltip":"dimming"},y(Ne.value?"–û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ":"–í–∫–ª—é—á–∏—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ"),513),[[se,R.value==="dimming"]])]),e("div",po,[e("button",{class:j(["blur-btn",{"electron-only":!G.value}]),onMouseenter:o[9]||(o[9]=I=>v("blur")),onMouseleave:o[10]||(o[10]=I=>R.value=null),onClick:Fe},o[62]||(o[62]=[e("span",{class:"material-icons"},"blur_on",-1)]),34),Z(e("div",{class:"custom-tooltip","data-tooltip":"blur"},y(G.value?"–ë–ª—é—Ä":"–ë–ª—é—Ä, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[se,R.value==="blur"]])]),e("div",bo,[e("button",{class:j(["material-symbols-outlined",{"electron-only":!G.value}]),onMouseenter:o[11]||(o[11]=I=>v("compressor")),onMouseleave:o[12]||(o[12]=I=>R.value=null),onClick:De},o[63]||(o[63]=[e("span",{class:"material-icons"},"graphic_eq",-1)]),34),Z(e("div",{class:"custom-tooltip","data-tooltip":"compressor"},y(G.value?"–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä":"–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[se,R.value==="compressor"]])]),e("div",ho,[e("button",{class:j(["mirror-btn",{"electron-only":!G.value}]),onMouseenter:o[13]||(o[13]=I=>v("mirror")),onMouseleave:o[14]||(o[14]=I=>R.value=null),onClick:Ye},o[64]||(o[64]=[e("span",{class:"material-icons"},"flip",-1)]),34),Z(e("div",{class:"custom-tooltip","data-tooltip":"mirror"},y(G.value?"–ó–µ—Ä–∫–∞–ª–æ":"–ó–µ—Ä–∫–∞–ª–æ, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[se,R.value==="mirror"]])]),e("div",Co,[e("button",{class:"theater-mode-btn",onMouseenter:o[15]||(o[15]=I=>v("theater")),onMouseleave:o[16]||(o[16]=I=>R.value=null),onClick:We},[e("span",wo,y($.value?"fullscreen_exit":"aspect_ratio"),1)],32),Z(e("div",_o,[ce(y($.value?"–í—ã–π—Ç–∏ –∏–∑ —Ç–µ–∞—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞":"–¢–µ–∞—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º")+" ",1),o[65]||(o[65]=e("span",{class:"shortcut-hint"},"Alt+T",-1))],512),[[se,R.value==="theater"]])]),e("div",Mo,[e("button",{class:"aspect-ratio-dropdown-btn",onMouseenter:o[17]||(o[17]=I=>v("aspect_ratio")),onMouseleave:O,onClick:s},[e("span",Eo,y(ne.value),1)],32),Z(e("div",{class:"custom-tooltip advanced-tooltip aspect-ratio-dropdown","data-tooltip":"aspect_ratio",onMouseenter:ee,onMouseleave:X},[(a(),r(ke,null,xe(Ve,I=>e("div",{key:I,class:j(["aspect-ratio-option",{active:ne.value===I}]),onClick:xa=>N(I)},y(I),11,Lo)),64))],544),[[se,R.value==="aspect_ratio"]])]),e("div",{class:"tooltip-container","data-tooltip-container":"centering",onMouseenter:o[19]||(o[19]=I=>v("centering")),onMouseleave:O},[e("button",{class:"center-btn",onClick:Pe},o[66]||(o[66]=[e("span",{class:"material-icons"},"center_focus_strong",-1)])),Z(e("div",{class:"custom-tooltip advanced-tooltip","data-tooltip":"centering",onMouseenter:ee,onMouseleave:X},[o[67]||(o[67]=ce(" –û—Ç—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–ª–µ–µ—Ä ")),pe(Dn,{modelValue:Le.value,"onUpdate:modelValue":o[18]||(o[18]=I=>Le.value=I),title:"–ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞"},null,8,["modelValue"]),o[68]||(o[68]=e("span",{class:"tooltip-title"},"–ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞",-1))],544),[[se,R.value==="centering"]])],32),G.value?C("",!0):(a(),r("div",Io,[e("button",{class:"app-link-btn",onMouseenter:o[20]||(o[20]=I=>v("app_link")),onMouseleave:o[21]||(o[21]=I=>R.value=null),onClick:W},o[69]||(o[69]=[e("span",{class:"material-icons"},"open_in_new",-1)]),32),Z(e("div",Ro," –û—Ç–∫—Ä—ã—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ",512),[[se,R.value==="app_link"]])])),G.value?(a(),r("div",To,[e("button",{class:"copy-link-btn",onMouseenter:o[22]||(o[22]=I=>v("copy_link")),onMouseleave:o[23]||(o[23]=I=>R.value=null),onClick:ye},o[70]||(o[70]=[e("span",{class:"material-icons"},"content_copy",-1)]),32),Z(e("div",So," –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É ",512),[[se,R.value==="copy_link"]])])):C("",!0)],64))]),!F.value&&!J.value?(a(),r("div",Ao,[e("div",xo,[e("button",{class:j(["favorite-btn",{active:(Rt=(It=i.movieInfo)==null?void 0:It.lists)==null?void 0:Rt.isFavorite}]),onMouseenter:o[24]||(o[24]=I=>v("favorite")),onMouseleave:o[25]||(o[25]=I=>R.value=null),onClick:o[26]||(o[26]=I=>T(de(Q).FAVORITE))},[e("span",$o,y((St=(Tt=i.movieInfo)==null?void 0:Tt.lists)!=null&&St.isFavorite?"favorite":"favorite_border"),1)],34),Z(e("div",Po,y("–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ"),512),[[se,R.value==="favorite"]])]),e("div",Uo,[e("button",{class:j(["watching-btn",{active:(xt=(At=i.movieInfo)==null?void 0:At.lists)==null?void 0:xt.isWatching}]),onMouseenter:o[27]||(o[27]=I=>v("watching")),onMouseleave:o[28]||(o[28]=I=>R.value=null),onClick:o[29]||(o[29]=I=>T(de(Q).WATCHING))},[e("span",jo,y((Pt=($t=i.movieInfo)==null?void 0:$t.lists)!=null&&Pt.isWatching?"visibility_off":"visibility"),1)],34),Z(e("div",Ho,y("–°–º–æ—Ç—Ä—é"),512),[[se,R.value==="watching"]])]),e("div",Bo,[e("button",{class:j(["later-btn",{active:(jt=(Ut=i.movieInfo)==null?void 0:Ut.lists)==null?void 0:jt.isLater}]),onMouseenter:o[30]||(o[30]=I=>v("later")),onMouseleave:o[31]||(o[31]=I=>R.value=null),onClick:o[32]||(o[32]=I=>T(de(Q).LATER))},o[71]||(o[71]=[e("span",{class:"material-icons"},"watch_later",-1)]),34),Z(e("div",Do,y("–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ"),512),[[se,R.value==="later"]])]),e("div",No,[e("button",{class:j(["completed-btn",{active:(Bt=(Ht=i.movieInfo)==null?void 0:Ht.lists)==null?void 0:Bt.isCompleted}]),onMouseenter:o[33]||(o[33]=I=>v("completed")),onMouseleave:o[34]||(o[34]=I=>R.value=null),onClick:o[35]||(o[35]=I=>T(de(Q).COMPLETED))},[e("span",Vo,y((Nt=(Dt=i.movieInfo)==null?void 0:Dt.lists)!=null&&Nt.isCompleted?"check_circle":"check_circle_outline"),1)],34),Z(e("div",Oo,y("–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"),512),[[se,R.value==="completed"]])]),e("div",Ko,[e("button",{class:j(["abandoned-btn",{active:(Ot=(Vt=i.movieInfo)==null?void 0:Vt.lists)==null?void 0:Ot.isAbandoned}]),onMouseenter:o[36]||(o[36]=I=>v("abandoned")),onMouseleave:o[37]||(o[37]=I=>R.value=null),onClick:o[38]||(o[38]=I=>T(de(Q).ABANDONED))},[e("span",qo,y(((qt=(Kt=i.movieInfo)==null?void 0:Kt.lists)!=null&&qt.isAbandoned,"not_interested")),1)],34),Z(e("div",Fo,y("–ë—Ä–æ—à–µ–Ω–æ"),512),[[se,R.value==="abandoned"]])])])):F.value?(a(),r("div",Wo,[e("div",zo,[e("button",{class:j(["favorite-btn",{active:(Wt=(Ft=i.movieInfo)==null?void 0:Ft.lists)==null?void 0:Wt.isFavorite}]),onMouseenter:o[39]||(o[39]=I=>v("favorite")),onMouseleave:o[40]||(o[40]=I=>R.value=null),onClick:o[41]||(o[41]=I=>T(de(Q).FAVORITE))},[e("span",Yo,y((Yt=(zt=i.movieInfo)==null?void 0:zt.lists)!=null&&Yt.isFavorite?"favorite":"favorite_border"),1)],34),Z(e("div",Go,y("–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ"),512),[[se,R.value==="favorite"]])]),e("div",Zo,[e("button",{class:j(["watching-btn",{active:(Zt=(Gt=i.movieInfo)==null?void 0:Gt.lists)==null?void 0:Zt.isWatching}]),onMouseenter:o[42]||(o[42]=I=>v("watching")),onMouseleave:o[43]||(o[43]=I=>R.value=null),onClick:o[44]||(o[44]=I=>T(de(Q).WATCHING))},[e("span",Qo,y((Xt=(Qt=i.movieInfo)==null?void 0:Qt.lists)!=null&&Xt.isWatching?"visibility_off":"visibility"),1)],34),Z(e("div",Xo,y("–°–º–æ—Ç—Ä—é"),512),[[se,R.value==="watching"]])]),e("div",Jo,[e("button",{class:j(["later-btn",{active:(en=(Jt=i.movieInfo)==null?void 0:Jt.lists)==null?void 0:en.isLater}]),onMouseenter:o[45]||(o[45]=I=>v("later")),onMouseleave:o[46]||(o[46]=I=>R.value=null),onClick:o[47]||(o[47]=I=>T(de(Q).LATER))},o[72]||(o[72]=[e("span",{class:"material-icons"},"watch_later",-1)]),34),Z(e("div",el,y("–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ"),512),[[se,R.value==="later"]])]),e("div",tl,[e("button",{class:j(["completed-btn",{active:(nn=(tn=i.movieInfo)==null?void 0:tn.lists)==null?void 0:nn.isCompleted}]),onMouseenter:o[48]||(o[48]=I=>v("completed")),onMouseleave:o[49]||(o[49]=I=>R.value=null),onClick:o[50]||(o[50]=I=>T(de(Q).COMPLETED))},[e("span",nl,y((ln=(on=i.movieInfo)==null?void 0:on.lists)!=null&&ln.isCompleted?"check_circle":"check_circle_outline"),1)],34),Z(e("div",ol,y("–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"),512),[[se,R.value==="completed"]])]),e("div",ll,[e("button",{class:j(["abandoned-btn",{active:(an=(sn=i.movieInfo)==null?void 0:sn.lists)==null?void 0:an.isAbandoned}]),onMouseenter:o[51]||(o[51]=I=>v("abandoned")),onMouseleave:o[52]||(o[52]=I=>R.value=null),onClick:o[53]||(o[53]=I=>T(de(Q).ABANDONED))},[e("span",sl,y(((un=(rn=i.movieInfo)==null?void 0:rn.lists)!=null&&un.isAbandoned,"not_interested")),1)],34),Z(e("div",il,y("–ë—Ä–æ—à–µ–Ω–æ"),512),[[se,R.value==="abandoned"]])])])):C("",!0)])),pe(ut,{ref_key:"notificationRef",ref:fe},null,512)],64))}}},kn=je(al,[["__scopeId","data-v-2037cb5b"]]),rl={key:0,class:"carousel-container"},ul={class:"carousel-wrapper"},cl=["onClick"],dl=["src","alt"],vl={class:"video-name"},ml={key:0,class:"video-player"},fl=["src"],gl={__name:"TrailerCarousel",props:{videos:{type:Array,required:!0},activeVideoIndex:{type:Number,default:null}},emits:["select"],setup(i,{emit:t}){const c=at(),n=q(()=>c.isMobile),m=i,_=t,d=g(m.activeVideoIndex),M=g(null),E=g(!1),l=g(!1),p=()=>{if(!M.value)return;const{scrollLeft:B,scrollWidth:P,clientWidth:w}=M.value;E.value=B>0,l.value=B<P-w-1},u=B=>{if(!M.value)return;const P=M.value.querySelector(".carousel-item");if(!P)return;const w=P.clientWidth+16;M.value.scrollBy({left:w*B,behavior:"smooth"})},L=B=>{d.value=B,_("select",m.videos[B])},$=()=>p(),z=g([]),ie=async B=>{try{return(await fetch("https://img.youtube.com/vi/".concat(B,"/0.jpg"))).ok}catch(P){return!1}};return Ze(async()=>{const B=m.videos.map(async w=>await ie(w.videoId)?w:null),P=await Promise.all(B);z.value=P.filter(Boolean),p(),window.addEventListener("resize",$)}),Oe(()=>m.videos,async B=>{const P=B.map(async x=>await ie(x.videoId)?x:null),w=await Promise.all(P);z.value=w.filter(Boolean)}),Oe(()=>m.activeVideoIndex,B=>{d.value=B}),st(()=>{window.removeEventListener("resize",$)}),(B,P)=>z.value.length?(a(),r("div",rl,[P[4]||(P[4]=e("h2",null,"–¢—Ä–µ–π–ª–µ—Ä—ã (YouTube)",-1)),e("div",ul,[Z(e("button",{class:"scroll-button left",onClick:P[0]||(P[0]=w=>u(-1))},P[2]||(P[2]=[e("span",{class:"material-symbols-outlined"},"arrow_back_ios",-1)]),512),[[se,!n.value&&E.value]]),e("div",{ref_key:"carousel",ref:M,class:"carousel",onScroll:p},[(a(!0),r(ke,null,xe(z.value,(w,x)=>(a(),r("div",{key:x,class:"carousel-item",onClick:S=>L(x)},[e("img",{src:"https://img.youtube.com/vi/".concat(w.videoId,"/0.jpg"),alt:w.name},null,8,dl),e("div",vl,y(w.name),1)],8,cl))),128))],544),Z(e("button",{class:"scroll-button right",onClick:P[1]||(P[1]=w=>u(1))},P[3]||(P[3]=[e("span",{class:"material-symbols-outlined"},"arrow_forward_ios",-1)]),512),[[se,!n.value&&l.value]])]),d.value!==null?(a(),r("div",ml,[e("iframe",{src:i.videos[d.value].iframeUrl,frameborder:"0",allowfullscreen:""},null,8,fl)])):C("",!0)])):C("",!0)}},kl=je(gl,[["__scopeId","data-v-e60b5c29"]]),yl={class:"rating-container"},pl={class:"rating-display"},bl={class:"average-rating"},hl={class:"rating-numbers"},Cl=["onClick","onMouseenter"],wl={key:0,class:"tooltip-footer"},_l={class:"rating-numbers mobile-rating-numbers"},Ml=["onClick"],El={key:0,class:"mobile-modal-footer"},Ll={__name:"MovieRating",props:{kpId:{type:String,required:!0},showDash:{type:Boolean,default:!1}},setup(i){const t=at(),c=rt(),n=i,m=g(null),_=g(null),d=g(null),M=g(null),E=g(0),l=g(!1),p=g(!1);let u=null;const L=S=>S?S.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "):"0",$=()=>{u=setTimeout(()=>{l.value=!1,t.isMobile||(p.value=!1)},100)},z=()=>{u&&(clearTimeout(u),u=null),l.value=!0},ie=()=>{t.isMobile&&(p.value=!p.value)},B=()=>{c.push("/login")},P=async()=>{try{const S=await _n(n.kpId);_.value=S.user_rating,d.value=S.average_rating,M.value=L(S.vote_count)}catch(S){console.error("Error loading rating:",S)}},w=async S=>{var Y;try{S===_.value?(await cn(n.kpId,null),_.value=null,m.value.showNotification("–û—Ü–µ–Ω–∫–∞ —É–¥–∞–ª–µ–Ω–∞")):(await cn(n.kpId,S),_.value=S,m.value.showNotification("–û—Ü–µ–Ω–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞")),t.isMobile&&(p.value=!1),P()}catch(F){console.error("Error setting rating:",F),((Y=F.response)==null?void 0:Y.status)===401?m.value.showNotification('–î–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:B}):m.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ—Ü–µ–Ω–∫–∏"),t.isMobile&&(p.value=!1)}},x=()=>{p.value=!1};return Ze(()=>{P()}),(S,Y)=>(a(),r("div",yl,[e("div",pl,[e("a",{href:"#",class:j(["rating-link",{"has-rating":_.value}]),onMouseenter:Y[0]||(Y[0]=F=>l.value=!0),onMouseleave:$,onClick:ze(ie,["prevent"])},[Y[3]||(Y[3]=e("img",{src:Hn,alt:"ReYohoho",class:"rating-logo"},null,-1)),e("span",bl,y(d.value?d.value.toFixed(1).replace(/\.0$/,""):"‚Äî"),1)],34),Z(e("div",{class:"rating-tooltip",onMouseenter:z,onMouseleave:$},[e("div",hl,[(a(),r(ke,null,xe(10,F=>e("button",{key:F,class:j(["number-btn",{active:F===_.value,hover:F===E.value,"average-highlight":d.value&&F<=Math.round(d.value)}]),onClick:G=>w(F),onMouseenter:G=>E.value=F,onMouseleave:Y[1]||(Y[1]=G=>E.value=0)},y(F),43,Cl)),64))]),M.value?(a(),r("div",wl,"–û—Ü–µ–Ω–æ–∫: "+y(M.value),1)):C("",!0)],544),[[se,(l.value||p.value)&&!de(t).isMobile]])]),pe(ut,{ref_key:"notificationRef",ref:m},null,512),de(t).isMobile&&p.value?(a(),r("div",{key:0,class:"mobile-modal-overlay",onClick:x},[e("div",{class:"mobile-modal",onClick:Y[2]||(Y[2]=ze(()=>{},["stop"]))},[e("div",{class:"mobile-modal-header"},[Y[4]||(Y[4]=e("h3",null,"–û—Ü–µ–Ω–∏—Ç—å —Ñ–∏–ª—å–º",-1)),e("button",{class:"close-button",onClick:x},"√ó")]),e("div",_l,[(a(),r(ke,null,xe(10,F=>e("button",{key:F,class:j(["number-btn",{active:F===_.value,"average-highlight":d.value&&F<=Math.round(d.value)}]),onClick:G=>w(F)},y(F),11,Ml)),64))]),M.value?(a(),r("div",El,"–û—Ü–µ–Ω–æ–∫: "+y(M.value),1)):C("",!0)])])):C("",!0)]))}},Il=je(Ll,[["__scopeId","data-v-906480ed"]]),Rl={name:"EmojiPicker",props:{isVisible:{type:Boolean,default:!1}},emits:["emoji-selected","mouse-enter","mouse-leave","close"],data(){return{activeCategory:"smileys",categories:[{name:"smileys",icon:"üòÄ",emojis:["üòÄ","üòÉ","üòÑ","üòÅ","üòÜ","üòÖ","üòÇ","ü§£","üòä","üòá","üôÇ","üôÉ","üòâ","üòå","üòç","ü•∞","üòò","üòó","üòô","üòö","üòã","üòõ","üòù","üòú","ü§™","ü§®","üßê","ü§ì","üòé","ü§©","ü•≥"]},{name:"emotions",icon:"üò¢",emojis:["üò•","üò¢","üò≠","üò§","üò†","üò°","ü§¨","ü§Ø","üò≥","ü•µ","ü•∂","üò±","üò®","üò∞","üò•","üòì","ü§ó","ü§î","ü§≠","ü§´","ü§•","üò∂","üòê","üòë","üò¨","üôÑ","üòØ","üò¶","üòß","üòÆ","üò≤"]},{name:"gestures",icon:"üëç",emojis:["üëç","üëé","üëå","ü§å","ü§è","‚úåÔ∏è","ü§û","ü§ü","ü§ò","ü§ô","üëà","üëâ","üëÜ","üñï","üëá","‚òùÔ∏è","üëè","üôå","üëê","ü§≤","ü§ù","üôè","‚úçÔ∏è","üí™","ü¶æ","ü¶ø","ü¶µ","ü¶∂","üëÇ","ü¶ª","üëÉ"]},{name:"hearts",icon:"‚ù§Ô∏è",emojis:["‚ù§Ô∏è","üß°","üíõ","üíö","üíô","üíú","ü§é","üñ§","ü§ç","üíî","‚ù£Ô∏è","üíï","üíû","üíì","üíó","üíñ","üíò","üíù","üíü","‚ô•Ô∏è","üíØ","üí¢","üí•","üí´","üí¶","üí®","üï≥Ô∏è","üí£","üí¨","üëÅÔ∏è‚Äçüó®Ô∏è","üó®Ô∏è"]},{name:"objects",icon:"üéâ",emojis:["üéâ","üéä","üéà","üéÅ","üéÄ","üéÇ","üç∞","üßÅ","üç≠","üç¨","üç´","üç©","üç™","üçï","üçî","üçü","üå≠","ü•™","üåÆ","üåØ","ü•ô","ü•ö","üç≥","ü•ò","üç≤","ü•ó","üçø","üßà","üßÄ","ü•®","ü•Ø"]}]}},computed:{currentEmojis(){const i=this.categories.find(t=>t.name===this.activeCategory);return i?i.emojis:[]}},methods:{selectEmoji(i){this.$emit("emoji-selected",i)}}},Tl={class:"emoji-categories"},Sl=["onClick"],Al={class:"emoji-grid"},xl=["onClick"];function $l(i,t,c,n,m,_){return c.isVisible?(a(),r("div",{key:0,class:"emoji-picker",onMouseenter:t[1]||(t[1]=d=>i.$emit("mouse-enter")),onMouseleave:t[2]||(t[2]=d=>i.$emit("mouse-leave"))},[e("button",{class:"close-btn mobile-only",onClick:t[0]||(t[0]=d=>i.$emit("close"))},t[3]||(t[3]=[e("i",{class:"fas fa-times"},null,-1)])),e("div",Tl,[(a(!0),r(ke,null,xe(m.categories,d=>(a(),r("button",{key:d.name,onClick:M=>m.activeCategory=d.name,class:j([{active:m.activeCategory===d.name},"category-btn"]),type:"button"},y(d.icon),11,Sl))),128))]),e("div",Al,[(a(!0),r(ke,null,xe(_.currentEmojis,d=>(a(),r("button",{key:d,onClick:M=>_.selectEmoji(d),class:"emoji-btn",type:"button"},y(d),9,xl))),128))])],32)):C("",!0)}const mt=je(Rl,[["render",$l],["__scopeId","data-v-5f18a3b7"]]),Pl=async i=>{const t=await Mn();return await i(t)},Ul=async i=>{const{data:t}=await Pl(c=>c.get("/search_emotes/".concat(i)));return t.emotes||[]},jl={name:"ImagePicker",props:{isVisible:{type:Boolean,required:!0},currentUser:{type:Object,default:null}},emits:["image-selected","mouse-enter","mouse-leave","close","login-required"],setup(i,{emit:t}){const c=g(""),n=g([]),m=g(null),_=g(!1),M=En(async u=>{if(!i.currentUser){console.warn("–ü–æ–ø—ã—Ç–∫–∞ –ø–æ–∏—Å–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏");return}if(!u.trim()){n.value=[],_.value=!1;return}_.value=!0;try{n.value=await Ul(u)}catch(L){console.error("Error searching images:",L),n.value=[]}finally{_.value=!1}},300),E=()=>{if(!i.currentUser){t("login-required");return}c.value.trim()&&(_.value=!0),M(c.value)},l=u=>{if(!i.currentUser){t("login-required");return}t("image-selected",u),t("close")},p=()=>{setTimeout(()=>{i.isVisible&&t("mouse-leave")},100)};return Oe(()=>i.isVisible,u=>{u&&(c.value="",n.value=[],_.value=!1)}),{searchQuery:c,images:n,searchInput:m,isLoading:_,handleSearch:E,selectImage:l,handleInputBlur:p}}},Hl={key:0,class:"auth-required"},Bl={class:"auth-message"},Dl={key:1},Nl={class:"image-picker-header"},Vl={class:"image-content"},Ol={key:0,class:"loading-spinner"},Kl={key:1,class:"image-grid"},ql=["onClick"],Fl=["src","alt"],Wl={key:2,class:"no-images"},zl={key:3,class:"no-search"};function Yl(i,t,c,n,m,_){return c.isVisible?(a(),r("div",{key:0,class:"image-picker",onMouseenter:t[7]||(t[7]=d=>i.$emit("mouse-enter")),onMouseleave:t[8]||(t[8]=d=>i.$emit("mouse-leave")),onClick:t[9]||(t[9]=ze(()=>{},["stop"]))},[e("button",{class:"close-btn mobile-only",onClick:t[0]||(t[0]=d=>i.$emit("close"))},t[10]||(t[10]=[e("i",{class:"fas fa-times"},null,-1)])),c.currentUser?(a(),r("div",Dl,[e("div",Nl,[Z(e("input",{ref:"searchInput",type:"text","onUpdate:modelValue":t[2]||(t[2]=d=>n.searchQuery=d),placeholder:"–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–º–∞–π–ª–∞ 7tv",class:"image-search-input",onInput:t[3]||(t[3]=(...d)=>n.handleSearch&&n.handleSearch(...d)),onClick:t[4]||(t[4]=ze(()=>{},["stop"])),onFocus:t[5]||(t[5]=d=>i.$emit("mouse-enter")),onBlur:t[6]||(t[6]=(...d)=>n.handleInputBlur&&n.handleInputBlur(...d))},null,544),[[ot,n.searchQuery]])]),e("div",Vl,[n.isLoading?(a(),r("div",Ol,t[14]||(t[14]=[e("div",{class:"spinner"},null,-1),e("p",null,"–ü–æ–∏—Å–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...",-1)]))):n.images.length>0?(a(),r("div",Kl,[(a(!0),r(ke,null,xe(n.images,(d,M)=>(a(),r("div",{key:M,class:"image-item",onClick:E=>n.selectImage(d)},[e("img",{src:d,alt:"Image "+(M+1)},null,8,Fl)],8,ql))),128))])):n.searchQuery.trim()?(a(),r("div",Wl,t[15]||(t[15]=[e("p",null,"–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤",-1)]))):(a(),r("div",zl,t[16]||(t[16]=[e("p",null,"–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞",-1)])))])])):(a(),r("div",Hl,[e("div",Bl,[t[11]||(t[11]=e("i",{class:"fas fa-lock"},null,-1)),t[12]||(t[12]=e("h3",null,"–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è",-1)),t[13]||(t[13]=e("p",null,"–î–ª—è –ø–æ–∏—Å–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç",-1)),e("button",{class:"login-button",onClick:t[1]||(t[1]=d=>i.$emit("login-required"))},"–í–æ–π—Ç–∏")])]))],32)):C("",!0)}const ft=je(jl,[["render",Yl],["__scopeId","data-v-be44d2b6"]]),Gl={name:"LinkModal",props:{isVisible:{type:Boolean,default:!1},selectedText:{type:String,default:""}},emits:["close","submit"],setup(i,{emit:t}){const c=g(""),n=g(""),m=g(null),_=g(null),d=q(()=>/^https?:\/\/.+/.test(c.value.trim())&&n.value.trim()),M=()=>{t("close"),l()},E=()=>{d.value&&(t("submit",{url:c.value.trim(),title:n.value.trim()}),M())},l=()=>{c.value="",n.value=""},p=u=>{var L;u.key==="Enter"?(u.preventDefault(),d.value?E():u.target===m.value&&c.value.trim()&&((L=_.value)==null||L.focus())):u.key==="Escape"&&M()};return Oe(()=>i.isVisible,u=>{u&&(i.selectedText.trim()&&(n.value=i.selectedText.trim()),ve(()=>{var L;(L=m.value)==null||L.focus()}))}),{linkUrl:c,linkTitle:n,urlInput:m,titleInput:_,isValidLink:d,closeModal:M,submitLink:E,handleKeydown:p}}},Zl={class:"link-modal-header"},Ql={class:"link-modal-content"},Xl={class:"form-group"},Jl={class:"form-group"},es={class:"link-modal-footer"},ts=["disabled"];function ns(i,t,c,n,m,_){return c.isVisible?(a(),r("div",{key:0,class:"link-modal-overlay",onClick:t[8]||(t[8]=(...d)=>n.closeModal&&n.closeModal(...d))},[e("div",{class:"link-modal",onClick:t[7]||(t[7]=ze(()=>{},["stop"]))},[e("div",Zl,[t[10]||(t[10]=e("h3",null,"–î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É",-1)),e("button",{class:"close-button",onClick:t[0]||(t[0]=(...d)=>n.closeModal&&n.closeModal(...d))},t[9]||(t[9]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",Ql,[e("div",Xl,[t[11]||(t[11]=e("label",{for:"link-url"},"URL —Å—Å—ã–ª–∫–∏:",-1)),Z(e("input",{id:"link-url",ref:"urlInput","onUpdate:modelValue":t[1]||(t[1]=d=>n.linkUrl=d),type:"url",placeholder:"https://example.com",class:"link-input",onKeydown:t[2]||(t[2]=(...d)=>n.handleKeydown&&n.handleKeydown(...d))},null,544),[[ot,n.linkUrl]])]),e("div",Jl,[t[12]||(t[12]=e("label",{for:"link-title"},"–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏:",-1)),Z(e("input",{id:"link-title",ref:"titleInput","onUpdate:modelValue":t[3]||(t[3]=d=>n.linkTitle=d),type:"text",placeholder:"–ù–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è",class:"link-input",onKeydown:t[4]||(t[4]=(...d)=>n.handleKeydown&&n.handleKeydown(...d))},null,544),[[ot,n.linkTitle]])])]),e("div",es,[e("button",{class:"cancel-button",onClick:t[5]||(t[5]=(...d)=>n.closeModal&&n.closeModal(...d))},"–û—Ç–º–µ–Ω–∞"),e("button",{class:"submit-button",disabled:!n.isValidLink,onClick:t[6]||(t[6]=(...d)=>n.submitLink&&n.submitLink(...d))},"–î–æ–±–∞–≤–∏—Ç—å",8,ts)])])])):C("",!0)}const gt=je(Gl,[["render",ns],["__scopeId","data-v-4b811824"]]),os={name:"CommentItem",components:{EmojiPicker:mt,ImagePicker:ft,LinkModal:gt},props:{comment:{type:Object,required:!0,default:()=>({username:"–ê–Ω–æ–Ω–∏–º",user_avatar:null,content:"",created_at:new Date().toISOString(),rating:0,replies:[]})},currentUser:{type:Object,required:!0,default:()=>({})},editingCommentId:{type:Number,default:null}},emits:["reply","start-edit","cancel-edit","edit","delete","rate"],setup(i,{emit:t}){var He,Ve;const c=rt(),n=q(()=>{var s;return i.editingCommentId===((s=i.comment)==null?void 0:s.id)}),m=g(((He=i.comment)==null?void 0:He.content)||""),_=g(((Ve=i.comment)==null?void 0:Ve.user_rating)||0),d=g(null),M=g(null),E=g(!1),l=g(!1),p=g(!1),u=g(!1),L=g(!1),$=g(!1),z=g(""),ie=s=>{if(!s)return"?";const h=s.split(" ");return h.length===1?s.slice(0,2).toUpperCase():(h[0][0]+h[h.length-1][0]).toUpperCase()},B=s=>{if(!s)return"";const h=s.substring(0,4),T=s.substring(4,6),oe=s.substring(6,8),J=s.substring(9,11),V=s.substring(11,13),k=s.substring(13,15);return new Date(Date.UTC(parseInt(h),parseInt(T)-1,parseInt(oe),parseInt(J),parseInt(V),parseInt(k))).toLocaleDateString("ru-RU",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone})},P=s=>{if(!s)return"";const h=s.substring(0,4),T=s.substring(4,6),oe=s.substring(6,8),J=s.substring(9,11),V=s.substring(11,13),k=s.substring(13,15),o=new Date(Date.UTC(parseInt(h),parseInt(T)-1,parseInt(oe),parseInt(J),parseInt(V),parseInt(k))),te=Math.floor((new Date-o)/1e3);if(te<60)return"—Ç–æ–ª—å–∫–æ —á—Ç–æ";const le=Math.floor(te/60);if(le<60)return"".concat(le," ").concat(w(le)," –Ω–∞–∑–∞–¥");const ue=Math.floor(le/60);if(ue<24)return"".concat(ue," ").concat(x(ue)," –Ω–∞–∑–∞–¥");const me=Math.floor(ue/24);if(me<7)return"".concat(me," ").concat(S(me)," –Ω–∞–∑–∞–¥");const Re=Math.floor(me/7);if(Re<4)return"".concat(Re," ").concat(Y(Re)," –Ω–∞–∑–∞–¥");const Ce=Math.floor(me/30);if(Ce<12)return"".concat(Ce," ").concat(F(Ce)," –Ω–∞–∑–∞–¥");const we=Math.floor(me/365);return"".concat(we," ").concat(G(we)," –Ω–∞–∑–∞–¥")},w=s=>s%10===1&&s%100!==11?"–º–∏–Ω—É—Ç—É":[2,3,4].includes(s%10)&&![12,13,14].includes(s%100)?"–º–∏–Ω—É—Ç—ã":"–º–∏–Ω—É—Ç",x=s=>s%10===1&&s%100!==11?"—á–∞—Å":[2,3,4].includes(s%10)&&![12,13,14].includes(s%100)?"—á–∞—Å–∞":"—á–∞—Å–æ–≤",S=s=>s%10===1&&s%100!==11?"–¥–µ–Ω—å":[2,3,4].includes(s%10)&&![12,13,14].includes(s%100)?"–¥–Ω—è":"–¥–Ω–µ–π",Y=s=>s%10===1&&s%100!==11?"–Ω–µ–¥–µ–ª—é":[2,3,4].includes(s%10)&&![12,13,14].includes(s%100)?"–Ω–µ–¥–µ–ª–∏":"–Ω–µ–¥–µ–ª—å",F=s=>s%10===1&&s%100!==11?"–º–µ—Å—è—Ü":[2,3,4].includes(s%10)&&![12,13,14].includes(s%100)?"–º–µ—Å—è—Ü–∞":"–º–µ—Å—è—Ü–µ–≤",G=s=>s%10===1&&s%100!==11?"–≥–æ–¥":[2,3,4].includes(s%10)&&![12,13,14].includes(s%100)?"–≥–æ–¥–∞":"–ª–µ—Ç";Ze(async()=>{var s;if((s=i.comment)!=null&&s.user_avatar){const h=await Ln();d.value="".concat(h).concat(i.comment.user_avatar)}document.addEventListener("click",W)}),st(()=>{document.removeEventListener("click",W)});const R=q(()=>{var s;return i.currentUser&&((s=i.comment)==null?void 0:s.user_id)===i.currentUser.id}),_e=q(()=>{var s;return i.currentUser&&((s=i.comment)==null?void 0:s.user_id)===i.currentUser.id||i.currentUser&&i.currentUser.is_admin===1}),Me=q(()=>{var s,h,T;return((s=i.comment)==null?void 0:s.updated_at)&&((h=i.comment)==null?void 0:h.updated_at)!==((T=i.comment)==null?void 0:T.created_at)}),fe=q(()=>{var s,h;return(s=i.comment)!=null&&s.is_deleted?!1:(((h=i.comment)==null?void 0:h.rating)||0)<=-3}),Se=q(()=>fe.value),Ee=g(!1),D=q(()=>{var s,h;return(s=i.comment)!=null&&s.is_deleted?null:(((h=i.comment)==null?void 0:h.rating)||0)<=-3?"lowRating":null}),v=()=>{var s,h;t("start-edit",(s=i.comment)==null?void 0:s.id),m.value=((h=i.comment)==null?void 0:h.content)||"",ve(()=>{M.value&&(M.value.focus(),Ae({target:M.value}))})},O=()=>{var s;t("cancel-edit"),m.value=((s=i.comment)==null?void 0:s.content)||""},ee=()=>{var s;m.value.trim()&&t("edit",(s=i.comment)==null?void 0:s.id,m.value.trim())},X=()=>{var s;confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π?")&&t("delete",(s=i.comment)==null?void 0:s.id)},ne=s=>{var h,T;_.value===s?(_.value=0,t("rate",(h=i.comment)==null?void 0:h.id,s)):(_.value=s,t("rate",(T=i.comment)==null?void 0:T.id,s))},Le=()=>{var s;c.push("/lists/".concat((s=i.comment)==null?void 0:s.user_id))},ge=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),ee())},A=q(()=>{var s,h;return((h=(s=i.comment)==null?void 0:s.content)==null?void 0:h.length)>300}),f=g(!1),ae=q(()=>{var s,h,T;return A.value&&!f.value?((h=(s=i.comment)==null?void 0:s.content)==null?void 0:h.slice(0,300))+"...":((T=i.comment)==null?void 0:T.content)||""}),be=q(()=>{var J;if(!((J=i.comment)!=null&&J.content))return"";let s=i.comment.content;if(A.value&&!f.value){let V=s.slice(0,300);const o=(s.match(/\[img\].*?\[\/img\]/g)||[]).length,U=(V.match(/\[img\].*?\[\/img\]/g)||[]).length,te=o-U,le=V.lastIndexOf("[img]"),ue=V.lastIndexOf("[/img]");le>ue&&le!==-1&&(V=s.slice(0,le)),V=V.trim();const me=["[img","[im","[i","["];for(const we of me)if(V.endsWith(we)){const Ue=V.lastIndexOf("[");if(Ue!==-1){V=V.slice(0,Ue).trim();break}}const Re=["[/img","[/im","[/i","[/"];for(const we of Re)if(V.endsWith(we)){const Ue=V.lastIndexOf("[");if(Ue!==-1){V=V.slice(0,Ue).trim();break}}let Ce="...";te>0&&(Ce="... (+".concat(te," ").concat(te===1?"–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ":"–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π",")")),s=V+Ce}const h=V=>{try{const k=new URL(V),o=k.hostname==="cdn.7tv.app"&&k.protocol==="https:";return o||console.warn("URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–∫–ª–æ–Ω–µ–Ω:",{url:V,hostname:k.hostname,protocol:k.protocol,reason:k.hostname!=="cdn.7tv.app"?"–Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π –¥–æ–º–µ–Ω":"–Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª"}),o}catch(k){return console.warn("–ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:",V,"–û—à–∏–±–∫–∞:",k.message),!1}},T=V=>{const k=document.createElement("div");return k.textContent=V,k.innerHTML};let oe=s.replace(/\[img\](.*?)\[\/img\]/g,(V,k)=>{const o=k.trim();if(h(o)){const U=T(o);return'<img src="'.concat(U,'" alt="7TV emote" class="inline-emoji" loading="lazy" />')}return"[–Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ".concat(T(o),"]")});return oe=oe.replace(new RegExp("\\[spoiler\\](.*?)\\[\\/spoiler\\]","gs"),(V,k,o,U)=>{const te=T(k.trim()),le=o>0?U[o-1]:" ",ue=o+V.length<U.length?U[o+V.length]:" ",me=le&&le!==" "&&le!=="\n"&&le!=="	",Re=ue&&ue!==" "&&ue!=="\n"&&ue!=="	",Ce=me?" ":"",we=Re?" ":"";return"".concat(Ce,'<span class="spoiler-text" onclick="this.classList.toggle(\'revealed\')" title="–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–æ–π–ª–µ—Ä">').concat(te,"</span>").concat(we)}),oe=oe.replace(/\[link=([^\]]+)\](.*?)\[\/link\]/g,(V,k,o)=>{const U=k.trim(),te=o.trim();if(/^https?:\/\/.+/.test(U)&&te){const ue=T(U),me=T(te);return'<a href="'.concat(ue,'" target="_blank" rel="noopener noreferrer" class="comment-link">').concat(me,"</a>")}return T(te||U)}),oe}),K=()=>{f.value=!f.value},Ae=s=>{const h=s.target;h&&(h.style.height="auto",h.style.height="".concat(Math.min(h.scrollHeight,200),"px"))},Pe=s=>{const h=M.value;if(h){const T=h.selectionStart,oe=h.selectionEnd,J=m.value.substring(0,T),V=m.value.substring(oe);m.value=J+s+V,ve(()=>{h.focus(),h.setSelectionRange(T+s.length,T+s.length),Ae({target:h})})}else m.value+=s},Ke=()=>{p.value=!0},qe=()=>{p.value=!1,setTimeout(()=>{!p.value&&!l.value&&(E.value=!1)},300)},Te=()=>{E.value=!1},Ie=()=>{l.value=!0,E.value=!0,u.value=!1},Fe=()=>{l.value=!1,setTimeout(()=>{!p.value&&!L.value&&!l.value&&(E.value=!1,u.value=!1)},300)},De=()=>{console.log("Avatar load error, falling back to initials"),d.value=null,ve(()=>{const s=document.querySelector(".avatar-placeholder");s&&(s.style.display="flex")})},Ye=()=>{L.value=!0},We=()=>{L.value=!1,setTimeout(()=>{!L.value&&!l.value&&(u.value=!1)},300)},Qe=()=>{u.value=!1},Ge=()=>{l.value=!0,u.value=!0,E.value=!1},Ne=s=>{const h=M.value;if(h){const T=h.selectionStart,oe=h.selectionEnd,J="[img]".concat(s,"[/img]");m.value=m.value.slice(0,T)+J+m.value.slice(oe),ve(()=>{h.focus(),h.setSelectionRange(T+J.length,T+J.length),Ae({target:h})})}},b=()=>{const s=M.value;if(s){const h=s.selectionStart,T=s.selectionEnd,oe=m.value.slice(h,T);let J;oe.trim()?J="[spoiler]".concat(oe,"[/spoiler]"):J="[spoiler][/spoiler]",m.value=m.value.slice(0,h)+J+m.value.slice(T),ve(()=>{if(s.focus(),oe.trim())s.setSelectionRange(h+J.length,h+J.length);else{const V=h+9;s.setSelectionRange(V,V)}Ae({target:s})})}},H=()=>{const s=M.value;if(s){const h=s.selectionStart,T=s.selectionEnd,oe=m.value.slice(h,T);z.value=oe.trim()||"",$.value=!0}},N=()=>{E.value=!1,u.value=!1},W=s=>{!s.target.closest(".emoji-picker")&&!s.target.closest(".image-picker")&&!s.target.closest(".emoji-button-inline")&&N()},ye=()=>{c.push("/login")},re=s=>{const h=M.value;if(h){const T=h.selectionStart,oe=h.selectionEnd,J="[link=".concat(s.url,"]").concat(s.title,"[/link]");m.value=m.value.slice(0,T)+J+m.value.slice(oe),ve(()=>{h.focus(),h.setSelectionRange(T+J.length,T+J.length),Ae({target:h})})}},he=()=>{$.value=!1};return Oe(m,()=>{n.value&&M.value&&ve(()=>{Ae({target:M.value})})}),{isEditing:n,editContent:m,userRating:_,isCommentOwner:R,canDeleteComment:_e,isCommentEdited:Me,formatDate:B,formatRelativeTime:P,startEdit:v,cancelEdit:O,saveEdit:ee,confirmDelete:X,rateComment:ne,avatarUrl:d,getInitials:ie,goToUserLists:Le,handleEditKeydown:ge,isCommentHidden:Se,showHiddenComment:Ee,hiddenCommentReason:D,isLongComment:A,isExpanded:f,displayedText:ae,formattedContent:be,toggleExpanded:K,autoResizeEdit:Ae,editTextarea:M,showEmojiPicker:E,showImagePicker:u,insertEmojiEdit:Pe,insertImageEdit:Ne,insertSpoilerEdit:b,insertLinkEdit:H,handleEmojiMouseEnter:Ke,handleEmojiMouseLeave:qe,handleImageMouseEnter:Ye,handleImageMouseLeave:We,closeEmojiPicker:Te,closeImagePicker:Qe,handleButtonMouseEnter:Ie,handleButtonMouseLeave:Fe,handleImageButtonMouseEnter:Ge,handleAvatarError:De,openLogin:ye,showLinkModal:$,selectedTextForLink:z,insertLinkFromModal:re,closeLinkModal:he}}},ls=["data-comment-id"],ss={class:"comment-header"},is={class:"user-info"},as=["href"],rs={class:"user-avatar"},us=["src","alt"],cs={class:"user-details"},ds=["href"],vs={class:"username"},ms={key:0,class:"user-rating"},fs=["title"],gs=["title"],ks={class:"comment-content"},ys={key:0,class:"hidden-comment-warning"},ps={key:1},bs={key:0,class:"deleted-comment"},hs={key:1},Cs={key:0,class:"edit-form"},ws={class:"edit-textarea-container"},_s={class:"edit-footer"},Ms={class:"edit-actions"},Es=["disabled"],Ls={class:"character-counter-container"},Is={key:1,class:"comment-text-container"},Rs=["innerHTML"],Ts={class:"comment-footer"},Ss={class:"comment-actions"},As={class:"rating-buttons"},xs={class:"action-buttons"};function $s(i,t,c,n,m,_){var l,p,u,L,$,z,ie,B,P,w,x,S,Y,F,G,R,_e,Me,fe,Se,Ee,D;const d=$e("EmojiPicker"),M=$e("ImagePicker"),E=$e("LinkModal");return a(),r("div",{class:"comment-item","data-comment-id":(l=c.comment)==null?void 0:l.id},[e("div",ss,[e("div",is,[e("a",{href:"/lists/".concat((p=c.comment)==null?void 0:p.user_id),target:"_blank",rel:"noopener noreferrer",class:"user-avatar-link"},[e("div",rs,[n.avatarUrl?(a(),r("img",{key:0,src:n.avatarUrl,alt:((u=c.comment)==null?void 0:u.username)||"–ê–Ω–æ–Ω–∏–º",onError:t[0]||(t[0]=(...v)=>n.handleAvatarError&&n.handleAvatarError(...v)),onerror:"this.onerror=null; this.style.display='none'; this.nextElementSibling.style.display='flex';"},null,40,us)):(a(),r("div",{key:1,class:"avatar-placeholder",style:it({display:n.avatarUrl?"none":"flex"})},y(n.getInitials(((L=c.comment)==null?void 0:L.username)||"–ê–Ω–æ–Ω–∏–º")),5))])],8,as),e("div",cs,[e("a",{href:"/lists/".concat(($=c.comment)==null?void 0:$.user_id),target:"_blank",rel:"noopener noreferrer",class:"username-link"},[e("span",vs,y(((z=c.comment)==null?void 0:z.username)||"–ê–Ω–æ–Ω–∏–º"),1)],8,ds),(ie=c.comment)!=null&&ie.user_movie_rating?(a(),r("span",ms,[t[19]||(t[19]=e("i",{class:"fas fa-star"},null,-1)),ce(" "+y(c.comment.user_movie_rating),1)])):C("",!0),e("span",{class:"date",title:n.isCommentEdited?"–°–æ–∑–¥–∞–Ω–æ: ".concat(n.formatDate((B=c.comment)==null?void 0:B.created_at),"\n–ò–∑–º–µ–Ω–µ–Ω–æ: ").concat(n.formatDate((P=c.comment)==null?void 0:P.updated_at)):"–°–æ–∑–¥–∞–Ω–æ: ".concat(n.formatDate((w=c.comment)==null?void 0:w.created_at))},[ce(y(n.formatRelativeTime((x=c.comment)==null?void 0:x.created_at))+" ",1),n.isCommentEdited?(a(),r("i",{key:0,class:"fas fa-pencil-alt edit-icon",title:n.isCommentEdited?"–°–æ–∑–¥–∞–Ω–æ: ".concat(n.formatDate((S=c.comment)==null?void 0:S.created_at),"\n–ò–∑–º–µ–Ω–µ–Ω–æ: ").concat(n.formatDate((Y=c.comment)==null?void 0:Y.updated_at)):"–°–æ–∑–¥–∞–Ω–æ: ".concat(n.formatDate((F=c.comment)==null?void 0:F.created_at))},null,8,gs)):C("",!0)],8,fs)])])]),e("div",ks,[!((G=c.comment)!=null&&G.is_deleted)&&n.isCommentHidden&&!n.showHiddenComment?(a(),r("div",ys,[n.hiddenCommentReason==="lowRating"?(a(),r("p",{key:0,class:"warning-text",onClick:t[1]||(t[1]=v=>n.showHiddenComment=!0)},t[20]||(t[20]=[e("i",{class:"fas fa-eye-slash"},null,-1),ce(" –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–∫—Ä—ã—Ç –∏–∑-–∑–∞ –Ω–∏–∑–∫–æ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞. –ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å. ")]))):C("",!0)])):(a(),r("div",ps,[(R=c.comment)!=null&&R.is_deleted?(a(),r("div",bs,t[21]||(t[21]=[e("p",{class:"deleted-message"},[e("i",{class:"fas fa-trash"}),ce(" –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É–¥–∞–ª—ë–Ω ")],-1)]))):(a(),r("div",hs,[n.isEditing?(a(),r("div",Cs,[e("div",ws,[Z(e("textarea",{ref:"editTextarea","onUpdate:modelValue":t[2]||(t[2]=v=>n.editContent=v),class:"edit-textarea",rows:"3",maxlength:"1500",onKeydown:t[3]||(t[3]=(...v)=>n.handleEditKeydown&&n.handleEditKeydown(...v)),onInput:t[4]||(t[4]=(...v)=>n.autoResizeEdit&&n.autoResizeEdit(...v))},null,544),[[ot,n.editContent]])]),e("div",_s,[e("div",Ms,[e("button",{onClick:t[5]||(t[5]=(...v)=>n.cancelEdit&&n.cancelEdit(...v)),class:"cancel-button"},"–û—Ç–º–µ–Ω–∞"),e("button",{onClick:t[6]||(t[6]=(...v)=>n.saveEdit&&n.saveEdit(...v)),class:"save-button",disabled:!n.editContent.trim()||n.editContent.length>1500}," –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ",8,Es)]),e("div",Ls,[e("div",{class:j(["character-counter-inline",{"near-limit":n.editContent.length>1400,"at-limit":n.editContent.length>=1500}])},y(n.editContent.length)+"/1500 ",3),e("button",{type:"button",class:j(["emoji-button-inline",{active:n.showEmojiPicker}]),onMouseenter:t[7]||(t[7]=(...v)=>n.handleButtonMouseEnter&&n.handleButtonMouseEnter(...v)),onMouseleave:t[8]||(t[8]=(...v)=>n.handleButtonMouseLeave&&n.handleButtonMouseLeave(...v))}," üòä ",34),e("button",{type:"button",class:j(["emoji-button-inline",{active:n.showImagePicker}]),onMouseenter:t[9]||(t[9]=(...v)=>n.handleImageButtonMouseEnter&&n.handleImageButtonMouseEnter(...v)),onMouseleave:t[10]||(t[10]=(...v)=>n.handleButtonMouseLeave&&n.handleButtonMouseLeave(...v))},t[22]||(t[22]=[lt('<svg width="28" height="28" viewBox="0 0 28 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="seven-tv-icon" data-v-df2c9071><g id="logo" data-v-df2c9071><path d="M20.7465 5.48825L21.9799 3.33745L22.646 2.20024L21.4125 0.0494437V0H14.8259L17.2928 4.3016L17.9836 5.48825H20.7465Z" data-v-df2c9071></path><path d="M7.15395 19.9258L14.5546 7.02104L15.4673 5.43884L13.0004 1.13724L12.3097 0.0247596H1.8995L0.666057 2.17556L0 3.31276L1.23344 5.46356V5.51301H9.12745L2.96025 16.267L2.09685 17.7998L3.33029 19.9506V20H7.15395" data-v-df2c9071></path><path d="M17.4655 19.9257H21.2398L26.1736 11.3225L27.037 9.83924L25.8036 7.68844V7.63899H22.0046L19.5377 11.9406L19.365 12.262L16.8981 7.96038L16.7255 7.63899L14.2586 11.9406L13.5679 13.1272L17.2682 19.5796L17.4655 19.9257Z" data-v-df2c9071></path></g></svg>',1)]),34),e("button",{type:"button",class:"emoji-button-inline spoiler-button",onClick:t[11]||(t[11]=(...v)=>n.insertSpoilerEdit&&n.insertSpoilerEdit(...v)),title:"–î–æ–±–∞–≤–∏—Ç—å —Å–ø–æ–π–ª–µ—Ä"},t[23]||(t[23]=[e("i",{class:"fas fa-eye-slash"},null,-1)])),e("button",{type:"button",class:"emoji-button-inline link-button",onClick:t[12]||(t[12]=(...v)=>n.insertLinkEdit&&n.insertLinkEdit(...v)),title:"–î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É"},t[24]||(t[24]=[e("i",{class:"fas fa-link"},null,-1)])),pe(d,{"is-visible":n.showEmojiPicker,onEmojiSelected:n.insertEmojiEdit,onMouseEnter:n.handleEmojiMouseEnter,onMouseLeave:n.handleEmojiMouseLeave,onClose:n.closeEmojiPicker},null,8,["is-visible","onEmojiSelected","onMouseEnter","onMouseLeave","onClose"]),pe(M,{"is-visible":n.showImagePicker,"current-user":c.currentUser,onImageSelected:n.insertImageEdit,onMouseEnter:n.handleImageMouseEnter,onMouseLeave:n.handleImageMouseLeave,onClose:n.closeImagePicker,onLoginRequired:n.openLogin},null,8,["is-visible","current-user","onImageSelected","onMouseEnter","onMouseLeave","onClose","onLoginRequired"]),pe(E,{"is-visible":n.showLinkModal,"selected-text":n.selectedTextForLink,onClose:n.closeLinkModal,onSubmit:n.insertLinkFromModal},null,8,["is-visible","selected-text","onClose","onSubmit"])])])])):(a(),r("div",Is,[e("p",{class:j(["comment-text",{truncated:n.isLongComment&&!n.isExpanded}]),innerHTML:n.formattedContent},null,10,Rs),n.isLongComment?(a(),r("button",{key:0,onClick:t[13]||(t[13]=(...v)=>n.toggleExpanded&&n.toggleExpanded(...v)),class:"expand-button"},y(n.isExpanded?"–°–≤–µ—Ä–Ω—É—Ç—å":"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å"),1)):C("",!0)]))]))]))]),e("div",Ts,[e("div",Ss,[e("div",As,[!n.isCommentOwner&&!((_e=c.comment)!=null&&_e.is_deleted)?(a(),r("button",{key:0,onClick:t[14]||(t[14]=v=>n.rateComment(1)),class:j(["rating-button",{"rated-up":n.userRating===1}])},t[25]||(t[25]=[e("i",{class:"fas fa-thumbs-up"},null,-1)]),2)):C("",!0),e("span",{class:j(["rating-count",{"rating-positive":n.userRating===1,"rating-negative":n.userRating===-1}])},y(((Me=c.comment)==null?void 0:Me.rating)||0),3),!n.isCommentOwner&&!((fe=c.comment)!=null&&fe.is_deleted)?(a(),r("button",{key:1,onClick:t[15]||(t[15]=v=>n.rateComment(-1)),class:j(["rating-button",{"rated-down":n.userRating===-1}])},t[26]||(t[26]=[e("i",{class:"fas fa-thumbs-down"},null,-1)]),2)):C("",!0)]),e("div",xs,[!c.currentUser||c.currentUser.allow_comments===1?(a(),r("button",{key:0,onClick:t[16]||(t[16]=v=>i.$emit("reply",c.comment)),class:"action-button reply-button"},t[27]||(t[27]=[e("i",{class:"fas fa-reply"},null,-1)]))):C("",!0),n.isCommentOwner&&!((Se=c.comment)!=null&&Se.is_deleted)&&!n.isEditing&&((Ee=c.currentUser)==null?void 0:Ee.allow_comments)===1?(a(),r("button",{key:1,onClick:t[17]||(t[17]=(...v)=>n.startEdit&&n.startEdit(...v)),class:"action-button edit-button"},t[28]||(t[28]=[e("i",{class:"fas fa-edit"},null,-1)]))):C("",!0),n.canDeleteComment&&!((D=c.comment)!=null&&D.is_deleted)?(a(),r("button",{key:2,onClick:t[18]||(t[18]=(...v)=>n.confirmDelete&&n.confirmDelete(...v)),class:"action-button delete-button"},t[29]||(t[29]=[e("i",{class:"fas fa-trash"},null,-1)]))):C("",!0)])])])],8,ls)}const Ps=je(os,[["render",$s],["__scopeId","data-v-df2c9071"]]),Us={name:"CommentThread",components:{CommentItem:Ps,EmojiPicker:mt,ImagePicker:ft,LinkModal:gt},props:{comment:{type:Object,required:!0},currentUser:{type:Object,required:!0},replyTo:{type:Object,default:null},replyContent:{type:String,default:""},editingCommentId:{type:Number,default:null}},emits:["reply","start-edit","cancel-edit","edit","delete","rate","submit-reply","cancel-reply","update-reply-content","reply-keydown"],setup(i,{emit:t}){const c=g(null),n=g(!1),m=g(!1),_=g(!1),d=g(!1),M=g(!1),E=g(!1),l=g(!1),p=g(""),u=D=>{t("update-reply-content",D.target.value);const v=D.target;v&&(v.style.height="auto",v.style.height="".concat(Math.min(v.scrollHeight,200),"px"))},L=D=>{const v=c.value;if(v){const O=v.selectionStart,ee=v.selectionEnd,X=v.value,ne=X.substring(0,O),Le=X.substring(ee);v.value=ne+D+Le,t("update-reply-content",v.value),ve(()=>{v.focus(),v.setSelectionRange(O+D.length,O+D.length),u({target:v})})}},$=()=>{d.value=!0},z=()=>{d.value=!1,setTimeout(()=>{!d.value&&!_.value&&(n.value=!1)},300)},ie=()=>{_.value=!0,n.value=!0,m.value=!1},B=()=>{_.value=!1,setTimeout(()=>{!d.value&&!M.value&&!_.value&&(n.value=!1,m.value=!1)},300)},P=()=>{n.value=!1},w=()=>{M.value=!0},x=()=>{M.value=!1,setTimeout(()=>{!M.value&&!_.value&&(m.value=!1)},300)},S=()=>{m.value=!1},Y=()=>{_.value=!0,m.value=!0,n.value=!1},F=D=>{const v=c.value;if(v){const O=v.selectionStart,ee=v.selectionEnd,X="[img]".concat(D,"[/img]"),ne=v.value.slice(0,O)+X+v.value.slice(ee);v.value=ne,t("update-reply-content",ne),ve(()=>{v.focus(),v.setSelectionRange(O+X.length,O+X.length),u({target:v})})}},G=()=>{const D=c.value;if(D){const v=D.selectionStart,O=D.selectionEnd,ee=D.value.slice(v,O);let X;ee.trim()?X="[spoiler]".concat(ee,"[/spoiler]"):X="[spoiler][/spoiler]";const ne=D.value.slice(0,v)+X+D.value.slice(O);D.value=ne,t("update-reply-content",ne),ve(()=>{if(D.focus(),ee.trim())D.setSelectionRange(v+X.length,v+X.length);else{const Le=v+9;D.setSelectionRange(Le,Le)}u({target:D})})}},R=()=>{const D=c.value;if(D){const v=D.selectionStart,O=D.selectionEnd,ee=D.value.slice(v,O);p.value=ee.trim()||""}l.value=!0},_e=()=>{l.value=!1},Me=D=>{const v=c.value;if(v){const O=v.selectionStart,ee=v.selectionEnd,X="[link=".concat(D.url,"]").concat(D.title,"[/link]"),ne=v.value.slice(0,O)+X+v.value.slice(ee);v.value=ne,t("update-reply-content",ne),ve(()=>{v.focus(),v.setSelectionRange(O+X.length,O+X.length),u({target:v})})}},fe=()=>{E.value=!E.value},Se=()=>{n.value=!1,m.value=!1},Ee=D=>{!D.target.closest(".emoji-picker")&&!D.target.closest(".image-picker")&&!D.target.closest(".emoji-button-inline")&&Se()};return Ze(()=>{document.addEventListener("click",Ee)}),st(()=>{document.removeEventListener("click",Ee)}),{replyTextarea:c,showEmojiPicker:n,showImagePicker:m,isCollapsed:E,insertEmoji:L,insertImage:F,insertSpoiler:G,handleEmojiMouseEnter:$,handleEmojiMouseLeave:z,handleImageMouseEnter:w,handleImageMouseLeave:x,handleButtonMouseEnter:ie,handleButtonMouseLeave:B,closeEmojiPicker:P,closeImagePicker:S,handleImageButtonMouseEnter:Y,handleReplyInput:u,toggleCollapsed:fe,closeAllPickers:Se,showLinkModal:l,selectedTextForLink:p,insertLink:R,closeLinkModal:_e,insertLinkFromModal:Me}},computed:{canReply(){return this.currentUser?this.currentUser.allow_comments===1:!0},getReplyPlaceholder(){return this.currentUser?this.currentUser.allow_comments!==1?"–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤":"–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç...":"–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç..."},formattedContent(){if(!this.comment.content)return"";const i=n=>{try{const m=new URL(n),_=m.hostname==="cdn.7tv.app"&&m.protocol==="https:";return _||console.warn("URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–∫–ª–æ–Ω–µ–Ω:",{url:n,hostname:m.hostname,protocol:m.protocol,reason:m.hostname!=="cdn.7tv.app"?"–Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π –¥–æ–º–µ–Ω":"–Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª"}),_}catch(m){return console.warn("–ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:",n,"–û—à–∏–±–∫–∞:",m.message),!1}},t=n=>{const m=document.createElement("div");return m.textContent=n,m.innerHTML};let c=this.comment.content.replace(/\[img\](.*?)\[\/img\]/g,(n,m)=>{const _=m.trim();if(i(_)){const d=t(_);return'<img src="'.concat(d,'" alt="7TV emote" class="inline-emoji" loading="lazy" />')}return"[–Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ".concat(t(_),"]")});return c=c.replace(new RegExp("\\[spoiler\\](.*?)\\[\\/spoiler\\]","gs"),(n,m,_,d)=>{const M=t(m.trim()),E=_>0?d[_-1]:" ",l=_+n.length<d.length?d[_+n.length]:" ",p=E&&E!==" "&&E!=="\n"&&E!=="	",u=l&&l!==" "&&l!=="\n"&&l!=="	",L=p?" ":"",$=u?" ":"";return"".concat(L,'<span class="spoiler-text" onclick="this.classList.toggle(\'revealed\')" title="–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–æ–π–ª–µ—Ä">').concat(M,"</span>").concat($)}),c}}},js={class:"comment-thread"},Hs={key:0,class:"reply-form"},Bs={class:"textarea-container"},Ds=["value","placeholder","disabled"],Ns={class:"reply-footer"},Vs={class:"reply-actions"},Os=["disabled"],Ks={class:"character-counter-container"},qs=["disabled"],Fs={key:1,class:"replies-container"},Ws=["title"],zs={class:"replies-count"},Ys=["title"],Gs={key:0,class:"replies-content"};function Zs(i,t,c,n,m,_){const d=$e("CommentItem"),M=$e("EmojiPicker"),E=$e("ImagePicker"),l=$e("LinkModal"),p=$e("CommentThread",!0);return a(),r("div",js,[pe(d,{comment:c.comment,"current-user":c.currentUser,"editing-comment-id":c.editingCommentId,onReply:t[0]||(t[0]=u=>i.$emit("reply",u)),onStartEdit:t[1]||(t[1]=u=>i.$emit("start-edit",u)),onCancelEdit:t[2]||(t[2]=u=>i.$emit("cancel-edit")),onEdit:t[3]||(t[3]=(u,L)=>i.$emit("edit",u,L)),onDelete:t[4]||(t[4]=u=>i.$emit("delete",u)),onRate:t[5]||(t[5]=(u,L)=>i.$emit("rate",u,L))},null,8,["comment","current-user","editing-comment-id"]),c.replyTo&&c.replyTo.id===c.comment.id?(a(),r("div",Hs,[e("div",Bs,[e("textarea",{ref:"replyTextarea",class:"comment-textarea",value:c.replyContent,placeholder:_.getReplyPlaceholder,disabled:c.currentUser&&c.currentUser.allow_comments!==1,rows:"3",maxlength:"1500",onInput:t[6]||(t[6]=(...u)=>n.handleReplyInput&&n.handleReplyInput(...u)),onKeydown:t[7]||(t[7]=u=>i.$emit("reply-keydown",u))},null,40,Ds)]),e("div",Ns,[e("div",Vs,[e("button",{class:"cancel-reply",onClick:t[8]||(t[8]=u=>i.$emit("cancel-reply"))},"–û—Ç–º–µ–Ω–∞"),e("button",{class:"submit-button",disabled:!c.replyContent.trim()||c.replyContent.length>1500||c.currentUser&&c.currentUser.allow_comments!==1,onClick:t[9]||(t[9]=u=>i.$emit("submit-reply"))}," –û—Ç–≤–µ—Ç–∏—Ç—å ",8,Os)]),e("div",Ks,[e("div",{class:j(["character-counter-inline",{"near-limit":c.replyContent.length>1400,"at-limit":c.replyContent.length>=1500}])},y(c.replyContent.length)+"/1500 ",3),e("button",{type:"button",class:j(["emoji-button-inline",{active:n.showEmojiPicker}]),onMouseenter:t[10]||(t[10]=(...u)=>n.handleButtonMouseEnter&&n.handleButtonMouseEnter(...u)),onMouseleave:t[11]||(t[11]=(...u)=>n.handleButtonMouseLeave&&n.handleButtonMouseLeave(...u))}," üòä ",34),e("button",{type:"button",class:j(["emoji-button-inline",{active:n.showImagePicker}]),onMouseenter:t[12]||(t[12]=(...u)=>n.handleImageButtonMouseEnter&&n.handleImageButtonMouseEnter(...u)),onMouseleave:t[13]||(t[13]=(...u)=>n.handleButtonMouseLeave&&n.handleButtonMouseLeave(...u))},t[29]||(t[29]=[lt('<svg width="28" height="28" viewBox="0 0 28 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="seven-tv-icon" data-v-015a3cbf><g id="logo" data-v-015a3cbf><path d="M20.7465 5.48825L21.9799 3.33745L22.646 2.20024L21.4125 0.0494437V0H14.8259L17.2928 4.3016L17.9836 5.48825H20.7465Z" data-v-015a3cbf></path><path d="M7.15395 19.9258L14.5546 7.02104L15.4673 5.43884L13.0004 1.13724L12.3097 0.0247596H1.8995L0.666057 2.17556L0 3.31276L1.23344 5.46356V5.51301H9.12745L2.96025 16.267L2.09685 17.7998L3.33029 19.9506V20H7.15395" data-v-015a3cbf></path><path d="M17.4655 19.9257H21.2398L26.1736 11.3225L27.037 9.83924L25.8036 7.68844V7.63899H22.0046L19.5377 11.9406L19.365 12.262L16.8981 7.96038L16.7255 7.63899L14.2586 11.9406L13.5679 13.1272L17.2682 19.5796L17.4655 19.9257Z" data-v-015a3cbf></path></g></svg>',1)]),34),e("button",{type:"button",class:"emoji-button-inline spoiler-button",disabled:c.currentUser&&c.currentUser.allow_comments!==1,onClick:t[14]||(t[14]=(...u)=>n.insertSpoiler&&n.insertSpoiler(...u)),title:"–î–æ–±–∞–≤–∏—Ç—å —Å–ø–æ–π–ª–µ—Ä"},t[30]||(t[30]=[e("i",{class:"fas fa-eye-slash"},null,-1)]),8,qs),e("button",{type:"button",class:"emoji-button-inline link-button",onClick:t[15]||(t[15]=(...u)=>n.insertLink&&n.insertLink(...u)),title:"–î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É"},t[31]||(t[31]=[e("i",{class:"fas fa-link"},null,-1)])),pe(M,{"is-visible":n.showEmojiPicker,onEmojiSelected:n.insertEmoji,onMouseEnter:n.handleEmojiMouseEnter,onMouseLeave:n.handleEmojiMouseLeave,onClose:n.closeEmojiPicker},null,8,["is-visible","onEmojiSelected","onMouseEnter","onMouseLeave","onClose"]),pe(E,{"is-visible":n.showImagePicker,"current-user":c.currentUser,onImageSelected:n.insertImage,onMouseEnter:n.handleImageMouseEnter,onMouseLeave:n.handleImageMouseLeave,onClose:n.closeImagePicker,onLoginRequired:t[16]||(t[16]=()=>i.$router.push("/login"))},null,8,["is-visible","current-user","onImageSelected","onMouseEnter","onMouseLeave","onClose"]),pe(l,{"is-visible":n.showLinkModal,"selected-text":n.selectedTextForLink,onClose:n.closeLinkModal,onSubmit:n.insertLinkFromModal},null,8,["is-visible","selected-text","onClose","onSubmit"])])])])):C("",!0),c.comment.replies&&c.comment.replies.length>0?(a(),r("div",Fs,[e("button",{class:"collapse-toggle",title:n.isCollapsed?"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç—ã":"–°–≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç—ã",onClick:t[17]||(t[17]=(...u)=>n.toggleCollapsed&&n.toggleCollapsed(...u))},[e("span",{class:j(["collapse-icon",{expanded:!n.isCollapsed}])},t[32]||(t[32]=[e("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor"},[e("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})],-1)]),2),e("span",zs,y(c.comment.replies.length)+" "+y(c.comment.replies.length===1?"–æ—Ç–≤–µ—Ç":"–æ—Ç–≤–µ—Ç–æ–≤"),1)],8,Ws),e("div",{class:"vertical-line-clickable",title:n.isCollapsed?"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç—ã":"–°–≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç—ã",onClick:t[18]||(t[18]=(...u)=>n.toggleCollapsed&&n.toggleCollapsed(...u))},[e("div",{class:j(["vertical-line-visual",{collapsed:n.isCollapsed}])},null,2)],8,Ys),n.isCollapsed?C("",!0):(a(),r("div",Gs,[(a(!0),r(ke,null,xe(c.comment.replies,u=>(a(),Be(p,{key:u.id,comment:u,"current-user":c.currentUser,"reply-to":c.replyTo,"reply-content":c.replyContent,"editing-comment-id":c.editingCommentId,onReply:t[19]||(t[19]=L=>i.$emit("reply",L)),onStartEdit:t[20]||(t[20]=L=>i.$emit("start-edit",L)),onCancelEdit:t[21]||(t[21]=L=>i.$emit("cancel-edit")),onEdit:t[22]||(t[22]=(L,$)=>i.$emit("edit",L,$)),onDelete:t[23]||(t[23]=L=>i.$emit("delete",L)),onRate:t[24]||(t[24]=(L,$)=>i.$emit("rate",L,$)),onSubmitReply:t[25]||(t[25]=L=>i.$emit("submit-reply")),onCancelReply:t[26]||(t[26]=L=>i.$emit("cancel-reply")),onUpdateReplyContent:t[27]||(t[27]=L=>i.$emit("update-reply-content",L)),onReplyKeydown:t[28]||(t[28]=L=>i.$emit("reply-keydown",L))},null,8,["comment","current-user","reply-to","reply-content","editing-comment-id"]))),128))]))])):C("",!0)])}const Qs=je(Us,[["render",Zs],["__scopeId","data-v-015a3cbf"]]),Xs={name:"Comments",components:{CommentThread:Qs,Notification:ut,EmojiPicker:mt,ImagePicker:ft,LinkModal:gt},props:{movieId:{type:[String,Number],required:!0}},setup(i){const t=vt(),c=rt(),n=g([]),m=g(""),_=g(null),d=g(""),M=g(null),E=g(t.user),l=g(null),p=g(null),u=g(!1),L=g(!1),$=g(!1),z=g(!1),ie=g(""),B=g(!1),P=g(!1),w=g(!1),x=g(!1),S=q(()=>{const b=(H=null)=>n.value.filter(N=>N.parent_id===H).sort((N,W)=>N.id-W.id).map(N=>({...N,replies:b(N.id)})).filter(N=>!N.is_deleted||N.replies&&N.replies.length>0);return b()}),Y=q(()=>{const b=H=>H.reduce((N,W)=>N+1+b(W.replies||[]),0);return b(S.value)}),F=b=>b===1?"–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π":b>=2&&b<=4?"–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è":"–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤",G=async()=>{try{const b=await In(i.movieId);n.value=b}catch(b){console.error("Failed to load comments:",b),l.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.")}},R=async()=>{if(!x.value){if(!t.token){l.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:O});return}if(E.value&&E.value.allow_comments!==1){l.value.showNotification("–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤");return}if(m.value.trim()){if(m.value.length>1500){l.value.showNotification("–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π. –ú–∞–∫—Å–∏–º—É–º 1500 —Å–∏–º–≤–æ–ª–æ–≤.");return}try{await dn(i.movieId,m.value.trim()),m.value="",await G(),u.value=!0,ve(()=>{p.value&&(p.value.focus(),p.value.style.height="auto"),setTimeout(()=>{const b=document.querySelectorAll(".comment-item[data-comment-id]");if(b.length>0){const H=Array.from(b).map(N=>parseInt(N.getAttribute("data-comment-id"))).filter(N=>!isNaN(N));if(H.length>0){const N=Math.max(...H),W=document.querySelector('[data-comment-id="'.concat(N,'"]'));W&&W.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}}},300)})}catch(b){console.error("Failed to create comment:",b),l.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")}}}},_e=b=>{if(!t.token){l.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:O});return}M.value=null,_.value=b,d.value="",ve(()=>{const H=document.querySelector(".reply-form");H&&H.scrollIntoView({behavior:"smooth",block:"center"})})},Me=async()=>{if(!t.token){l.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:O});return}if(E.value&&E.value.allow_comments!==1){l.value.showNotification("–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤");return}if(!(!d.value.trim()||!_.value)){if(d.value.length>1500){l.value.showNotification("–û—Ç–≤–µ—Ç —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π. –ú–∞–∫—Å–∏–º—É–º 1500 —Å–∏–º–≤–æ–ª–æ–≤.");return}try{await dn(i.movieId,d.value.trim(),_.value.id);const b=_.value.id;await G(),d.value="",_.value=null,ve(()=>{setTimeout(()=>{const H=document.querySelector('[data-comment-id="'.concat(b,'"]'));if(H){const N=H.querySelector(".replies-content");if(N){const W=N.querySelectorAll(".comment-item[data-comment-id]");if(W.length>0){const ye=Array.from(W).map(re=>parseInt(re.getAttribute("data-comment-id"))).filter(re=>!isNaN(re));if(ye.length>0){const re=Math.max(...ye),he=document.querySelector('[data-comment-id="'.concat(re,'"]'));he&&he.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}}}}},300)})}catch(b){console.error("Error submitting reply:",b),l.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ—Ç–≤–µ—Ç–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")}}},fe=async(b,H)=>{if(!t.token){l.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:O});return}if(E.value&&E.value.allow_comments!==1){l.value.showNotification("–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤");return}if(H.length>1500){l.value.showNotification("–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π. –ú–∞–∫—Å–∏–º—É–º 1500 —Å–∏–º–≤–æ–ª–æ–≤.");return}try{await Sn(b,H.trim()),await G(),M.value=null}catch(N){console.error("Failed to update comment:",N),l.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")}},Se=async b=>{if(!t.token){l.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:O});return}try{await Tn(b),await G()}catch(H){console.error("Failed to delete comment:",H),l.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")}},Ee=async(b,H)=>{if(!t.token){l.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:O});return}try{await Rn(b,H),await G()}catch(N){console.error("Failed to rate comment:",N),l.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ü–µ–Ω–∫–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")}},D=b=>{x.value||L.value||b.key==="Enter"&&!b.shiftKey&&(b.preventDefault(),R())},v=b=>{b.key==="Enter"&&!b.shiftKey&&(b.preventDefault(),Me())},O=()=>{c.push("/login")},ee=b=>{const H=(b==null?void 0:b.target)||p.value;H&&(H.style.height="auto",H.style.height="".concat(Math.min(H.scrollHeight,200),"px"))},X=b=>{if(x.value=!0,p.value){const H=p.value.selectionStart,N=p.value.selectionEnd;m.value=m.value.slice(0,H)+b+m.value.slice(N),ve(()=>{p.value.focus(),p.value.setSelectionRange(H+b.length,H+b.length),ee(),setTimeout(()=>{x.value=!1},100)})}else x.value=!1},ne=b=>{if(p.value){const H=p.value.selectionStart,N=p.value.selectionEnd,W="[img]".concat(b,"[/img]");m.value=m.value.slice(0,H)+W+m.value.slice(N),ve(()=>{p.value.focus(),p.value.setSelectionRange(H+W.length,H+W.length),ee()})}},Le=()=>{if(p.value){const b=p.value.selectionStart,H=p.value.selectionEnd,N=m.value.slice(b,H);let W;N.trim()?W="[spoiler]".concat(N,"[/spoiler]"):W="[spoiler][/spoiler]",m.value=m.value.slice(0,b)+W+m.value.slice(H),ve(()=>{if(p.value.focus(),N.trim())p.value.setSelectionRange(b+W.length,b+W.length);else{const ye=b+9;p.value.setSelectionRange(ye,ye)}ee()})}},ge=()=>{const b=p.value;if(b){const H=b.selectionStart,N=b.selectionEnd,W=m.value.slice(H,N);ie.value=W.trim()||""}z.value=!0},A=b=>{if(p.value){const H=p.value.selectionStart,N=p.value.selectionEnd,W="[link=".concat(b.url,"]").concat(b.title,"[/link]");m.value=m.value.slice(0,H)+W+m.value.slice(N),ve(()=>{p.value.focus(),p.value.setSelectionRange(H+W.length,H+W.length),ee()})}},f=()=>{z.value=!1},ae=b=>{if(!b)return"";const H=ye=>{try{const re=new URL(ye),he=re.hostname==="cdn.7tv.app"&&re.protocol==="https:";return he||console.warn("URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–∫–ª–æ–Ω–µ–Ω:",{url:ye,hostname:re.hostname,protocol:re.protocol,reason:re.hostname!=="cdn.7tv.app"?"–Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π –¥–æ–º–µ–Ω":"–Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª"}),he}catch(re){return console.warn("–ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:",ye,"–û—à–∏–±–∫–∞:",re.message),!1}},N=ye=>{const re=document.createElement("div");return re.textContent=ye,re.innerHTML};let W=b.replace(/\[img\](.*?)\[\/img\]/g,(ye,re)=>{const he=re.trim();if(H(he)){const He=N(he);return'<img src="'.concat(He,'" alt="7TV emote" class="inline-emoji" loading="lazy" />')}return"[–Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ".concat(N(he),"]")});return W=W.replace(new RegExp("\\[spoiler\\](.*?)\\[\\/spoiler\\]","gs"),(ye,re,he,He)=>{const Ve=N(re.trim()),s=he>0?He[he-1]:" ",h=he+ye.length<He.length?He[he+ye.length]:" ",T=s&&s!==" "&&s!=="\n"&&s!=="	",oe=h&&h!==" "&&h!=="\n"&&h!=="	",J=T?" ":"",V=oe?" ":"";return"".concat(J,'<span class="spoiler-text" onclick="this.classList.toggle(\'revealed\')" title="–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–æ–π–ª–µ—Ä">').concat(Ve,"</span>").concat(V)}),W},be=()=>{B.value=!0},K=()=>{B.value=!1,setTimeout(()=>{!B.value&&!w.value&&(L.value=!1)},300)},Ae=()=>{L.value=!1},Pe=()=>{w.value=!1,setTimeout(()=>{!B.value&&!P.value&&!w.value&&(L.value=!1,$.value=!1)},300)},Ke=()=>{w.value=!0,L.value=!0,$.value=!1},qe=()=>{P.value=!0},Te=()=>{P.value=!1,setTimeout(()=>{!P.value&&!w.value&&($.value=!1)},300)},Ie=()=>{$.value=!1},Fe=()=>{w.value=!0,$.value=!0,L.value=!1},De=q(()=>E.value?E.value.allow_comments!==1?"–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤":"–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π...":"–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."),Ye=q(()=>E.value?E.value.allow_comments===1:!0),We=b=>{_.value=null,d.value="",M.value=b},Qe=()=>{M.value=null},Ge=()=>{L.value=!1,$.value=!1},Ne=b=>{!b.target.closest(".emoji-picker")&&!b.target.closest(".image-picker")&&!b.target.closest(".emoji-button-inline")&&Ge()};return Ze(()=>{G(),document.addEventListener("click",Ne)}),st(()=>{document.removeEventListener("click",Ne)}),{comments:n,groupedComments:S,newComment:m,replyTo:_,replyContent:d,editingCommentId:M,currentUser:E,notificationRef:l,commentTextarea:p,showComments:u,submitComment:R,handleReply:_e,submitReply:Me,handleEdit:fe,handleDelete:Se,handleRate:Ee,handleCommentKeydown:D,handleReplyKeydown:v,autoResize:ee,totalCommentsCount:Y,getCommentWordForm:F,showEmojiPicker:L,showImagePicker:$,showLinkModal:z,selectedTextForLink:ie,insertEmoji:X,insertImage:ne,formatCommentContent:ae,handleEmojiMouseEnter:be,handleEmojiMouseLeave:K,handleImageMouseEnter:qe,handleImageMouseLeave:Te,closeEmojiPicker:Ae,closeImagePicker:Ie,handleButtonMouseLeave:Pe,handleButtonMouseEnter:Ke,handleImageButtonMouseEnter:Fe,getCommentPlaceholder:De,canComment:Ye,handleStartEdit:We,handleCancelEdit:Qe,insertSpoiler:Le,insertLink:ge,insertLinkFromModal:A,closeLinkModal:f}}},Js={class:"comments-section"},ei={class:"spoiler-content"},ti={key:1,class:"comments-container"},ni={class:"comments-header"},oi={class:"textarea-container"},li=["placeholder","disabled"],si={class:"comment-footer"},ii={class:"comment-actions"},ai=["disabled"],ri={class:"character-counter-container"},ui=["disabled"],ci=["disabled"],di=["disabled"],vi={class:"comments-list"};function mi(i,t,c,n,m,_){const d=$e("EmojiPicker"),M=$e("ImagePicker"),E=$e("LinkModal"),l=$e("CommentThread"),p=$e("Notification");return a(),r("div",Js,[n.showComments?(a(),r("div",ti,[e("div",ni,[e("button",{class:"hide-comments-btn",onClick:t[1]||(t[1]=u=>n.showComments=!1)},t[17]||(t[17]=[e("i",{class:"fas fa-eye-slash"},null,-1),ce(" –°–∫—Ä—ã—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ")]))]),e("form",{class:"comment-form",onSubmit:t[11]||(t[11]=ze((...u)=>n.submitComment&&n.submitComment(...u),["prevent"]))},[e("div",oi,[Z(e("textarea",{ref:"commentTextarea","onUpdate:modelValue":t[2]||(t[2]=u=>n.newComment=u),class:"comment-textarea",placeholder:n.getCommentPlaceholder,disabled:n.currentUser&&n.currentUser.allow_comments!==1,rows:"3",maxlength:"1500",onInput:t[3]||(t[3]=(...u)=>n.autoResize&&n.autoResize(...u)),onKeydown:t[4]||(t[4]=(...u)=>n.handleCommentKeydown&&n.handleCommentKeydown(...u))},null,40,li),[[ot,n.newComment]])]),e("div",si,[e("div",ii,[e("button",{class:"submit-button",type:"submit",disabled:!n.newComment.trim()||n.newComment.length>1500||n.currentUser&&n.currentUser.allow_comments!==1}," –û—Ç–ø—Ä–∞–≤–∏—Ç—å ",8,ai)]),e("div",ri,[e("div",{class:j(["character-counter-inline",{"near-limit":n.newComment.length>1400,"at-limit":n.newComment.length>=1500}])},y(n.newComment.length)+"/1500 ",3),e("button",{type:"button",class:j(["emoji-button-inline",{active:n.showEmojiPicker}]),disabled:n.currentUser&&n.currentUser.allow_comments!==1,onMouseenter:t[5]||(t[5]=(...u)=>n.handleButtonMouseEnter&&n.handleButtonMouseEnter(...u)),onMouseleave:t[6]||(t[6]=(...u)=>n.handleButtonMouseLeave&&n.handleButtonMouseLeave(...u))}," üòä ",42,ui),e("button",{type:"button",class:j(["emoji-button-inline",{active:n.showImagePicker}]),disabled:n.currentUser&&n.currentUser.allow_comments!==1,onMouseenter:t[7]||(t[7]=(...u)=>n.handleImageButtonMouseEnter&&n.handleImageButtonMouseEnter(...u)),onMouseleave:t[8]||(t[8]=(...u)=>n.handleButtonMouseLeave&&n.handleButtonMouseLeave(...u))},t[18]||(t[18]=[lt('<svg width="28" height="28" viewBox="0 0 28 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="seven-tv-icon" data-v-5502f18f><g id="logo" data-v-5502f18f><path d="M20.7465 5.48825L21.9799 3.33745L22.646 2.20024L21.4125 0.0494437V0H14.8259L17.2928 4.3016L17.9836 5.48825H20.7465Z" data-v-5502f18f></path><path d="M7.15395 19.9258L14.5546 7.02104L15.4673 5.43884L13.0004 1.13724L12.3097 0.0247596H1.8995L0.666057 2.17556L0 3.31276L1.23344 5.46356V5.51301H9.12745L2.96025 16.267L2.09685 17.7998L3.33029 19.9506V20H7.15395" data-v-5502f18f></path><path d="M17.4655 19.9257H21.2398L26.1736 11.3225L27.037 9.83924L25.8036 7.68844V7.63899H22.0046L19.5377 11.9406L19.365 12.262L16.8981 7.96038L16.7255 7.63899L14.2586 11.9406L13.5679 13.1272L17.2682 19.5796L17.4655 19.9257Z" data-v-5502f18f></path></g></svg>',1)]),42,ci),e("button",{type:"button",class:"emoji-button-inline spoiler-button",disabled:n.currentUser&&n.currentUser.allow_comments!==1,onClick:t[9]||(t[9]=(...u)=>n.insertSpoiler&&n.insertSpoiler(...u)),title:"–î–æ–±–∞–≤–∏—Ç—å —Å–ø–æ–π–ª–µ—Ä"},t[19]||(t[19]=[e("i",{class:"fas fa-eye-slash"},null,-1)]),8,di),e("button",{type:"button",class:"emoji-button-inline link-button",onClick:t[10]||(t[10]=(...u)=>n.insertLink&&n.insertLink(...u)),title:"–î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É"},t[20]||(t[20]=[e("i",{class:"fas fa-link"},null,-1)])),pe(d,{"is-visible":n.showEmojiPicker&&n.canComment,onEmojiSelected:n.insertEmoji,onMouseEnter:n.handleEmojiMouseEnter,onMouseLeave:n.handleEmojiMouseLeave,onClose:n.closeEmojiPicker},null,8,["is-visible","onEmojiSelected","onMouseEnter","onMouseLeave","onClose"]),pe(M,{"is-visible":n.showImagePicker&&n.canComment,"current-user":n.currentUser,onImageSelected:n.insertImage,onMouseEnter:n.handleImageMouseEnter,onMouseLeave:n.handleImageMouseLeave,onClose:n.closeImagePicker,onLoginRequired:i.openLogin},null,8,["is-visible","current-user","onImageSelected","onMouseEnter","onMouseLeave","onClose","onLoginRequired"]),pe(E,{"is-visible":n.showLinkModal,"selected-text":n.selectedTextForLink,onClose:n.closeLinkModal,onSubmit:n.insertLinkFromModal},null,8,["is-visible","selected-text","onClose","onSubmit"])])])],32),e("div",vi,[(a(!0),r(ke,null,xe(n.groupedComments,u=>(a(),Be(l,{key:u.id,comment:u,"current-user":n.currentUser,"reply-to":n.replyTo,"reply-content":n.replyContent,"editing-comment-id":n.editingCommentId,"is-first-comment":!1,onReply:n.handleReply,onStartEdit:n.handleStartEdit,onCancelEdit:n.handleCancelEdit,onEdit:n.handleEdit,onDelete:n.handleDelete,onRate:n.handleRate,onSubmitReply:n.submitReply,onCancelReply:t[12]||(t[12]=L=>n.replyTo=null),onUpdateReplyContent:t[13]||(t[13]=L=>n.replyContent=L),onReplyKeydown:n.handleReplyKeydown},null,8,["comment","current-user","reply-to","reply-content","editing-comment-id","onReply","onStartEdit","onCancelEdit","onEdit","onDelete","onRate","onSubmitReply","onReplyKeydown"]))),128))])])):(a(),r("div",{key:0,class:"spoiler-warning",onClick:t[0]||(t[0]=u=>n.showComments=!0)},[e("div",ei,[t[14]||(t[14]=e("i",{class:"fas fa-eye-slash"},null,-1)),t[15]||(t[15]=e("h3",null,"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å–∫—Ä—ã—Ç—ã",-1)),t[16]||(t[16]=e("p",null,"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–æ–π–ª–µ—Ä—ã. –ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å.",-1)),e("div",{class:j(["comments-count",{"no-comments":n.totalCommentsCount===0}])},[n.totalCommentsCount===0?(a(),r(ke,{key:0},[ce(" –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ–∫–∞ –Ω–µ—Ç ")],64)):(a(),r(ke,{key:1},[ce(y(n.totalCommentsCount)+" "+y(n.getCommentWordForm(n.totalCommentsCount)),1)],64))],2)])])),pe(p,{ref:"notificationRef"},null,512)])}const fi=je(Xs,[["render",mi],["__scopeId","data-v-5502f18f"]]),gi={class:"movie-info"},ki={class:"content"},yi={key:0,class:"content-card"},pi={class:"movie-skeleton"},bi={class:"movie-skeleton__player"},hi={key:2,class:"content-card"},Ci={key:3,class:"content-card"},wi={class:"content-header"},_i=["src"],Mi={class:"content-title"},Ei={key:0,class:"ratings-links"},Li={key:1},Ii=["href","title"],Ri={key:2},Ti=["href","title"],Si={key:3},Ai=["href","title"],xi={key:4},$i=["href","title"],Pi={key:5},Ui=["href"],ji={key:6,class:"rating-links-group"},Hi=["href"],Bi=["title"],Di={key:0,class:"fa-regular fa-face-grin-wink"},Ni={key:1,class:"fas fa-spinner fa-spin"},Vi={key:2,class:"nudity-info-popup"},Oi={class:"nudity-info-content"},Ki=["content"],qi=["content"],Fi={class:"additional-info"},Wi={class:"info-content"},zi={class:"details-container"},Yi={class:"info-list"},Gi={key:0},Zi={key:1},Qi={key:2},Xi={key:3},Ji={key:4},ea={key:5},ta={key:6},na={key:7},oa={key:8},la={class:"content-info"},sa={key:0,class:"content-description-text"},ia={key:2,class:"comments-section"},aa={key:3,class:"staff-section"},ra={class:"staff-categories"},ua={key:0,class:"staff-category"},ca={class:"staff-list"},da=["href","title"],va=["src","alt"],ma={class:"staff-name"},fa={key:0,class:"staff-role"},ga=["href","title"],ka={key:1,class:"staff-category"},ya={class:"staff-names-container"},pa={class:"staff-names-list"},ba=["href"],ha=["href","title"],Ca={key:2,class:"staff-category"},wa={class:"staff-names-container"},_a={class:"staff-names-list"},Ma=["href"],Ea=["href","title"],La={key:4,class:"yt-video-container"},Ia={key:5,class:"related-movies"},Ra=["title"],Ta={key:6,class:"related-movies"},Sa=["title"],Aa={__name:"MovieInfo",setup(i){const t=g(!0),c=at(),n=vt(),m=An(),_=yn(),d=g(_.params.kp_id),M=g(""),E=g(null),l=g(null),p=xn(),L=Nn().areTrailersActive,$=g(null),z=g(!1),ie=g(!1),B=g(10),P=g(null),w=g(!1),x=q(()=>c.isCommentsEnabled),S=()=>{if(l.value){const A=l.value.name_ru||l.value.name_en||l.value.name_original||"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∏–ª—å–º–µ";document.title=A}},Y=A=>A?A.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "):"0",F=A=>(A||[]).map(f=>({kp_id:f.film_id,poster:f.poster_url_preview||f.poster_url,title:f.name_ru||f.name_en||f.name_original})),G=A=>{if(typeof A!="number")return;const f=Math.floor(A/60),ae=A%60;return"".concat(f," —á. ").concat(ae," –º–∏–Ω.")},R=g(!1),_e=g({top:"0px",left:"0px"}),Me=A=>{R.value=!0,_e.value={top:"".concat(A.pageY+10,"px"),left:"".concat(A.pageX-70,"px")}},fe=g(null),Se=async()=>{try{const A=[l.value.name_ru||l.value.name_en||l.value.name_original,...l.value.year?[l.value.year]:[],...l.value.film_length?[G(l.value.film_length)]:[]];await navigator.clipboard.writeText(A.join(", ")),fe.value.showNotification("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ")}catch(A){console.error("–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:",A)}},Ee=async(A=!0)=>{var f,ae,be,K,Ae,Pe,Ke,qe;try{let Te;if(d.value.startsWith("shiki")?Te=await Pn(d.value):Te=await Un(d.value,n.token),Array.isArray(Te)&&Te.length===0)throw new Error("–î–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–∏—Å–∫.");l.value=Te,d.value.startsWith("shiki")?l.value={...l.value,title:l.value.name_ru||l.value.name_en,name_original:l.value.name_en,short_description:l.value.slogan}:l.value={...l.value,title:l.value.name_ru||l.value.name_en||l.value.name_original,kinopoisk_id:d.value},p.setHeaderContent({text:l.value.title,imageUrl:l.value.logo_url}),S();const Ie={kp_id:d.value,title:((f=l.value)==null?void 0:f.name_ru)||((ae=l.value)==null?void 0:ae.name_en)||((be=l.value)==null?void 0:be.name_original),poster:((K=l.value)==null?void 0:K.poster_url)||((Ae=l.value)==null?void 0:Ae.cover_url)||((Pe=l.value)==null?void 0:Pe.screenshots[0]),year:(Ke=l.value)==null?void 0:Ke.year,type:(qe=l.value)==null?void 0:qe.type};if(d.value.startsWith("shiki"))if(l.value.screenshots&&l.value.screenshots.length>0){const De=Math.floor(Math.random()*l.value.screenshots.length),Ye=l.value.screenshots[De];m.updateMoviePoster(Ye)}else Ie.poster&&m.updateMoviePoster(Ie.poster);else Ie.poster&&m.updateMoviePoster(Ie.poster);if(q(()=>c.isHistoryAllowed).value&&Ie.kp_id&&Ie.title&&A)if(n.token)try{await bn(Ie.kp_id,Q.HISTORY)}catch(De){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∏—Å—Ç–æ—Ä–∏—é:",De)}else c.addToHistory({...Ie})}catch(Te){const{message:Ie,code:Fe}=dt(Te);M.value=Ie,E.value=Fe,console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∏–ª—å–º–∞—Ö:",Te)}},D=q(()=>{var A,f;return console.log("–¢—Ä–µ–π–ª–µ—Ä—ã:",(A=l.value)==null?void 0:A.videos),(f=l.value)==null?void 0:f.videos}),v=q(()=>{var A;return F((A=l.value)==null?void 0:A.sequels_and_prequels)}),O=q(()=>{var A;return F((A=l.value)==null?void 0:A.similars)}),ee=()=>{var be;const A=((be=document.querySelector(".related-movies"))==null?void 0:be.clientWidth)||0,ae=Math.floor(A/160)||10;B.value=Math.max(1,ae)},X=()=>{ee()},ne=A=>{if(A.altKey&&A.keyCode===84&&document.querySelector(".player-container")){const ae=document.querySelector(".theater-mode-btn");ae&&ae.click()}},Le=async()=>{var A;if(!n.token){fe.value.showNotification('–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:()=>p.openLogin()});return}if((A=l.value)!=null&&A.imdb_id){if(P.value){P.value=null;return}w.value=!0;try{const f=await jn(l.value.imdb_id);P.value=f.nudity_info}catch(f){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ü–µ–Ω–∞—Ö:",f),fe.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ü–µ–Ω–∞—Ö")}finally{w.value=!1}}};Ze(async()=>{await Ee(),t.value=!1,document.addEventListener("keydown",ne),window.addEventListener("resize",X),setTimeout(ee,100)}),$n(async()=>{p.clearHeaderContent(),document.removeEventListener("keydown",ne),window.removeEventListener("resize",X)}),Oe(()=>_.params.kp_id,async A=>{A&&A!==d.value&&(p.clearHeaderContent(),d.value=A,$.value=null,await Ee(),t.value=!1)},{immediate:!0}),Oe(l,()=>{S()},{deep:!0});const ge=A=>{var f,ae;return((ae=(f=l.value)==null?void 0:f.staff)==null?void 0:ae.filter(be=>be.profession_key===A))||[]};return(A,f)=>{var ae,be;return a(),r(ke,null,[e("div",gi,[e("div",ki,[(t.value||!l.value)&&!M.value?(a(),r("div",yi,[e("div",pi,[f[4]||(f[4]=lt('<div class="movie-skeleton__header" data-v-8c9baba0><div class="movie-skeleton__title" data-v-8c9baba0></div></div><div class="movie-skeleton__ratings" data-v-8c9baba0><div class="movie-skeleton__rating-item" data-v-8c9baba0></div><div class="movie-skeleton__rating-item" data-v-8c9baba0></div><div class="movie-skeleton__rating-item" data-v-8c9baba0></div></div>',2)),e("div",bi,[pe(hn)]),f[5]||(f[5]=lt('<div class="movie-skeleton__additional-info" data-v-8c9baba0><div class="movie-skeleton__section-title" data-v-8c9baba0></div><div class="movie-skeleton__info-list" data-v-8c9baba0><div class="movie-skeleton__info-item" data-v-8c9baba0></div><div class="movie-skeleton__info-item" data-v-8c9baba0></div><div class="movie-skeleton__info-item" data-v-8c9baba0></div><div class="movie-skeleton__info-item" data-v-8c9baba0></div><div class="movie-skeleton__info-item" data-v-8c9baba0></div></div></div><div class="movie-skeleton__description" data-v-8c9baba0><div class="movie-skeleton__description-line" data-v-8c9baba0></div><div class="movie-skeleton__description-line" data-v-8c9baba0></div><div class="movie-skeleton__description-line" data-v-8c9baba0></div><div class="movie-skeleton__description-line" data-v-8c9baba0></div></div>',2))])])):C("",!0),M.value?(a(),Be(pn,{key:1,message:M.value,code:E.value},null,8,["message","code"])):C("",!0),M.value?(a(),r("div",hi,[(a(),Be(kn,{key:d.value,"kp-id":d.value,"movie-info":l.value,"onUpdate:movieInfo":Ee},null,8,["kp-id","movie-info"]))])):C("",!0),l.value&&!t.value?(a(),r("div",Ci,[e("div",wi,[l.value.logo_url?(a(),r("div",{key:0,class:"content-logo",onMousemove:Me,onMouseleave:f[0]||(f[0]=K=>R.value=!1),onClick:Se},[e("img",{src:l.value.logo_url,alt:"–õ–æ–≥–æ—Ç–∏–ø —Ñ–∏–ª—å–º–∞",class:"content-logo"},null,8,_i)],32)):(a(),r("div",{key:1,onMousemove:Me,onMouseleave:f[1]||(f[1]=K=>R.value=!1),onClick:Se},[e("h1",Mi,y(l.value.title),1)],32)),Z(e("div",{class:"title-copy-tooltip",style:it(_e.value)}," –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å ",4),[[se,R.value]])]),l.value.kinopoisk_id||l.value.title||l.value.imdb_id||l.value.rating_imdb||l.value.shikimori_id?(a(),r("div",Ei,[l.value.kinopoisk_id?(a(),Be(Il,{key:0,"kp-id":l.value.kinopoisk_id,"show-dash":!0},null,8,["kp-id"])):C("",!0),l.value.kinopoisk_id?(a(),r("div",Li,[e("a",{href:"https://www.kinopoisk.ru/film/".concat(l.value.kinopoisk_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:l.value.rating_kinopoisk_vote_count?"–û—Ü–µ–Ω–æ–∫: ".concat(Y(l.value.rating_kinopoisk_vote_count)):"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –≥–æ–ª–æ—Å–æ–≤"},[f[6]||(f[6]=e("img",{src:mn,alt:"–ö–ü",class:"rating-logo"},null,-1)),e("span",null,y(l.value.rating_kinopoisk?l.value.rating_kinopoisk:"‚Äî"),1),f[7]||(f[7]=e("img",{src:Xe,alt:"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",class:"external-link-icon"},null,-1))],8,Ii)])):C("",!0),!l.value.kinopoisk_id&&l.value.title?(a(),r("div",Ri,[e("a",{href:"https://www.kinopoisk.ru/index.php?kp_query=".concat(encodeURIComponent(l.value.title+(l.value.year?" "+l.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:l.value.rating_kinopoisk_vote_count?"–û—Ü–µ–Ω–æ–∫: ".concat(Y(l.value.rating_kinopoisk_vote_count)):"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –≥–æ–ª–æ—Å–æ–≤"},[f[8]||(f[8]=e("img",{src:mn,alt:"–ö–ü",class:"rating-logo"},null,-1)),e("span",null,y(l.value.rating_kinopoisk?l.value.rating_kinopoisk:"‚Äî"),1),f[9]||(f[9]=e("img",{src:Xe,alt:"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",class:"external-link-icon"},null,-1))],8,Ti)])):C("",!0),l.value.imdb_id?(a(),r("div",Si,[e("a",{href:"https://www.imdb.com/title/".concat(l.value.imdb_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:l.value.rating_imdb_vote_count?"–û—Ü–µ–Ω–æ–∫: ".concat(Y(l.value.rating_imdb_vote_count)):"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –≥–æ–ª–æ—Å–æ–≤"},[f[10]||(f[10]=e("img",{src:fn,alt:"IMDb",class:"rating-logo"},null,-1)),e("span",null,y(l.value.rating_imdb?l.value.rating_imdb:"‚Äî"),1),f[11]||(f[11]=e("img",{src:Xe,alt:"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",class:"external-link-icon"},null,-1))],8,Ai)])):C("",!0),!l.value.imdb_id&&l.value.title?(a(),r("div",xi,[e("a",{href:"https://www.imdb.com/find/?q=".concat(encodeURIComponent(l.value.title+(l.value.year?" "+l.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:l.value.rating_imdb_vote_count?"–û—Ü–µ–Ω–æ–∫: ".concat(Y(l.value.rating_imdb_vote_count)):"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –≥–æ–ª–æ—Å–æ–≤"},[f[12]||(f[12]=e("img",{src:fn,alt:"IMDb",class:"rating-logo"},null,-1)),e("span",null,y(l.value.rating_imdb?l.value.rating_imdb:"‚Äî"),1),f[13]||(f[13]=e("img",{src:Xe,alt:"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",class:"external-link-icon"},null,-1))],8,$i)])):C("",!0),l.value.shikimori_id?(a(),r("div",Pi,[e("a",{href:"https://shikimori.one/animes/".concat(l.value.shikimori_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},f[14]||(f[14]=[e("img",{src:Vn,alt:"Shiki",class:"rating-logo"},null,-1),e("img",{src:Xe,alt:"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",class:"external-link-icon"},null,-1)]),8,Ui)])):C("",!0),l.value.imdb_id?(a(),r("div",ji,[e("a",{href:"https://www.imdb.com/title/".concat(l.value.imdb_id,"/parentalguide"),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},f[15]||(f[15]=[e("span",null,"Parents Guide",-1),e("img",{src:Xe,alt:"–í–Ω–µ—à–Ω—è—è —Å—Å—ã–ª–∫–∞",class:"external-link-icon"},null,-1)]),8,Hi),e("button",{class:"rating-link nudity-info-btn",onClick:Le,title:P.value?"–°–∫—Ä—ã—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é":"–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ü–µ–Ω–∞—Ö(Sex & Nudity)"},[w.value?(a(),r("i",Ni)):(a(),r("i",Di)),P.value?(a(),r("div",Vi,[e("div",Oi,y(P.value),1)])):C("",!0)],8,Bi)])):C("",!0)])):C("",!0),(a(),Be(kn,{key:d.value,"kp-id":d.value,"movie-info":l.value,"onUpdate:movieInfo":Ee},null,8,["kp-id","movie-info"])),e("meta",{name:"title-and-year",content:l.value.type==="FILM"&&l.value.year?"".concat(l.value.title," (").concat(l.value.year,")"):l.value.title},null,8,Ki),l.value.name_original?(a(),r("meta",{key:1,name:"original-title",content:l.value.name_original},null,8,qi)):C("",!0),e("div",Fi,[f[25]||(f[25]=e("h2",{class:"additional-info-title"},"–ü–æ–¥—Ä–æ–±–Ω–µ–µ",-1)),e("div",Wi,[e("div",zi,[e("ul",Yi,[l.value.type&&de(vn)[l.value.type]?(a(),r("li",Gi,[f[16]||(f[16]=e("strong",null,"–¢–∏–ø:",-1)),ce(" "+y(de(vn)[l.value.type]),1)])):C("",!0),l.value.year?(a(),r("li",Zi,[f[17]||(f[17]=e("strong",null,"–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞:",-1)),ce(" "+y(l.value.year),1)])):C("",!0),l.value.title?(a(),r("li",Qi,[f[18]||(f[18]=e("strong",null,"–ù–∞–∑–≤–∞–Ω–∏–µ:",-1)),ce(" "+y(l.value.title),1)])):C("",!0),l.value.name_original?(a(),r("li",Xi,[f[19]||(f[19]=e("strong",null,"–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:",-1)),ce(" "+y(l.value.name_original),1)])):C("",!0),l.value.slogan?(a(),r("li",Ji,[f[20]||(f[20]=e("strong",null,"–°–ª–æ–≥–∞–Ω:",-1)),ce(" "+y(l.value.slogan),1)])):C("",!0),l.value.production_companies?(a(),r("li",ea,[f[21]||(f[21]=e("strong",null,"–ü—Ä–æ–¥–∞–∫—à–Ω:",-1)),ce(" "+y(l.value.production_companies),1)])):C("",!0),(ae=l.value.countries)!=null&&ae.length?(a(),r("li",ta,[f[22]||(f[22]=e("strong",null,"–°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞:",-1)),ce(" "+y(l.value.countries.map(K=>K.country).join(", ")),1)])):C("",!0),(be=l.value.genres)!=null&&be.length?(a(),r("li",na,[f[23]||(f[23]=e("strong",null,"–ñ–∞–Ω—Ä—ã:",-1)),ce(" "+y(l.value.genres.map(K=>K.genre).join(", ")),1)])):C("",!0),l.value.film_length?(a(),r("li",oa,[f[24]||(f[24]=e("strong",null,"–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:",-1)),ce(" "+y(G(l.value.film_length)),1)])):C("",!0)])])])]),e("div",la,[l.value.description?(a(),r("p",sa,y(l.value.description),1)):C("",!0)]),x.value?(a(),r("div",ia,[(a(),Be(fi,{"movie-id":d.value,key:d.value},null,8,["movie-id"]))])):C("",!0),l.value.staff?(a(),r("div",aa,[e("div",ra,[ge("ACTOR").length?(a(),r("div",ua,[f[26]||(f[26]=e("h3",{class:"additional-info-title"},"–ê–∫—Ç—ë—Ä—ã",-1)),e("div",ca,[(a(!0),r(ke,null,xe(ge("ACTOR").slice(0,12),K=>(a(),r("div",{key:K.staff_id,class:"staff-item"},[e("a",{href:"https://www.kinopoisk.ru/name/".concat(K.staff_id,"/"),target:"_blank",rel:"noopener noreferrer",class:"staff-link",title:K.description||""},[e("img",{src:K.poster_url,alt:K.name_ru,class:"staff-photo"},null,8,va),e("span",ma,y(K.name_ru||K.name_en),1),K.description?(a(),r("span",fa,y(K.description),1)):C("",!0)],8,da)]))),128)),e("a",{class:"expand-actors-circle-button",href:"https://www.kinopoisk.ru/film/".concat(d.value,"/cast/"),target:"_blank",rel:"noopener noreferrer",title:"–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ—Ö ".concat(ge("ACTOR").length," –∞–∫—Ç–µ—Ä–æ–≤")}," +"+y(ge("ACTOR").length-12),9,ga)])])):C("",!0),ge("DIRECTOR").length?(a(),r("div",ka,[f[27]||(f[27]=e("h3",{class:"additional-info-title"},"–†–µ–∂–∏—Å—Å—ë—Ä—ã",-1)),e("div",ya,[e("div",pa,[(a(!0),r(ke,null,xe(ge("DIRECTOR").slice(0,5),K=>(a(),r("a",{key:K.staff_id,href:"https://www.kinopoisk.ru/name/".concat(K.staff_id,"/"),target:"_blank",rel:"noopener noreferrer",class:"staff-name-link"},y(K.name_ru||K.name_en),9,ba))),128)),ge("DIRECTOR").length>5?(a(),r("a",{key:0,class:"expand-actors-circle-button",href:"https://www.kinopoisk.ru/film/".concat(d.value,"/cast/"),target:"_blank",rel:"noopener noreferrer",title:"–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ—Ö ".concat(ge("DIRECTOR").length," —Ä–µ–∂–∏—Å—Å—ë—Ä–æ–≤")}," +"+y(ge("DIRECTOR").length-5),9,ha)):C("",!0)])])])):C("",!0),ge("PRODUCER").length?(a(),r("div",Ca,[f[28]||(f[28]=e("h3",{class:"additional-info-title"},"–ü—Ä–æ–¥—é—Å–µ—Ä—ã",-1)),e("div",wa,[e("div",_a,[(a(!0),r(ke,null,xe(ge("PRODUCER").slice(0,5),K=>(a(),r("a",{key:K.staff_id,href:"https://www.kinopoisk.ru/name/".concat(K.staff_id,"/"),target:"_blank",rel:"noopener noreferrer",class:"staff-name-link"},y(K.name_ru||K.name_en),9,Ma))),128)),ge("PRODUCER").length>5?(a(),r("a",{key:0,class:"expand-actors-circle-button",href:"https://www.kinopoisk.ru/film/".concat(d.value,"/cast/"),target:"_blank",rel:"noopener noreferrer",title:"–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ—Ö ".concat(ge("PRODUCER").length," –ø—Ä–æ–¥—é—Å–µ—Ä–æ–≤")}," +"+y(ge("PRODUCER").length-5),9,Ea)):C("",!0)])])])):C("",!0)])])):C("",!0),D.value.length&&de(L)?(a(),r("div",La,[pe(kl,{videos:D.value,"active-video-index":$.value,onSelect:A.playTrailer},null,8,["videos","active-video-index","onSelect"])])):C("",!0),v.value.length?(a(),r("div",Ia,[f[29]||(f[29]=e("h2",null,"–°–∏–∫–≤–µ–ª—ã –∏ –ø—Ä–∏–∫–≤–µ–ª—ã",-1)),pe(de(gn),{"movies-list":z.value?v.value:v.value.slice(0,B.value),loading:!1,"is-history":!1,class:"related-movies-list"},null,8,["movies-list"]),v.value.length>B.value?(a(),r("a",{key:0,class:"expand-circle-button",onClick:f[2]||(f[2]=K=>z.value=!z.value),title:"".concat(z.value?"–°–∫—Ä—ã—Ç—å":"–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ"," (").concat(v.value.length,")")},y(z.value?"‚àí":"+".concat(v.value.length-B.value)),9,Ra)):C("",!0)])):C("",!0),O.value.length?(a(),r("div",Ta,[f[30]||(f[30]=e("h2",null,"–ü–æ—Ö–æ–∂–∏–µ",-1)),pe(de(gn),{"movies-list":ie.value?O.value:O.value.slice(0,B.value),loading:!1,"is-history":!1,class:"related-movies-list"},null,8,["movies-list"]),O.value.length>B.value?(a(),r("a",{key:0,class:"expand-circle-button",onClick:f[3]||(f[3]=K=>ie.value=!ie.value),title:"".concat(ie.value?"–°–∫—Ä—ã—Ç—å":"–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ"," (").concat(O.value.length,")")},y(ie.value?"‚àí":"+".concat(O.value.length-B.value)),9,Sa)):C("",!0)])):C("",!0)])):C("",!0)])]),pe(ut,{ref_key:"notificationRef",ref:fe},null,512)],64)}}},Ha=je(Aa,[["__scopeId","data-v-8c9baba0"]]);export{Ha as default};
