import{_ as Rt,r as c,c as J,b as $,d as T,e as n,m as Re,t as k,O as Oe,g as K,P as lt,n as B,l as ft,u as Zt,q as No,N as Fo,B as jt,x as Ue,o as Jt,S as Po,k as $t,E as Lo,f as Bt,Z as Gt,p as Z,V as j,A as me,U as z,am as Do,an as _o,G as Kt,X as Mt,af as qo,ad as Ho,a7 as zo,ao as Wo,ap as Yt}from"./index-XAioAQH5.js";import{S as Vo}from"./SpinnerLoading-BI8fQquV.js";import{N as Qt}from"./ToastMessage-C7qutIL0.js";import{u as Uo,S as Go}from"./player-cG3ogbZ4.js";import{p as Xt,b as Ge}from"./dateUtils-BWepax9P.js";import{_ as Ko}from"./icon-imdb-logo-5qtstUwS.js";const bs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVR4nO2ZQUoDMRSGR7eewHoFsVS0HkUUXNXqASqK2EURBPFIVRe6c+UN1CvUXWvbT4KvMAwzNnnJdCrmg1BKad7/v7y0b5IkiUQiCwGoAx3gQjEugZ0qxTeAIX6MKjMBnBOGS62AVWAPOHVYdlMu9YArYOhphLeBT+ALmOKGEd2QubaAK+B2zngFxt4GgDXgGZjgR8ch5oEkCi8DkvlnRcYLV0Apfqw10M7JvPkV6AN3FmVwK+WyZRnvMEe8ef/ibECyb2o+zRuwnpQAxeLNivQ0BvYyE46qEJ/8fK4ycJKp/X4V4n0MdDNfukkqEO9jwP1LDgD7BeKPgmgp04CL+KUz4Cp+qQxoxC+NAdsNm4c0hWkukkUa8BGfegiadbFDq3/2UAZ8xc+QVvzMtqcKYkBaZ5/MN5xEl2DgLGDZ1KswsC09FPJqXTZoNm5oA6kyMGI2FxqfkluJ0uMTDfhBXAHiHvCCWEL8/RLqlv1MPCf+TSZ+13WC7KnEfWlqcwAeU7GNjnbiQsG5UC1ZAEAt1UMhOpquk6zknMy9l20C2AA+MnEHRo9msuOCs9EH4Fp5TVQ0rqVs0plH4re02Qh1Oq1lCjypsp+5H3gKcD/gykTirqnFZ/ZDy+OGxpapzD+QePrM/2KkKfcGPcv7AdvRkz23G1x4JPIP+AY3r/ywUk/2JAAAAABJRU5ErkJggg==",ws="/reyohoho/assets/icon-shikimori-DGvXK9Jc.svg",Ke=R=>{const s=document.createElement("div");s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.style.backgroundColor="rgba(0, 0, 0, 0.8)",s.style.color="white",s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.style.fontSize="2rem",s.style.zIndex="99000",s.textContent=R,document.body.appendChild(s),setTimeout(()=>{document.body.removeChild(s)},2e3)},Yo={key:0},Xo={key:1},Zo={class:"players-list"},jo=["onClick"],Jo={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},Qo={key:0},en={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},tn={key:1},on={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},nn=["onClick"],sn={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},ln={__name:"PlayerModal",props:{players:{type:Array,required:!0},selectedPlayer:{type:Object,default:null}},emits:["close","select"],setup(R,{emit:s}){const a=R,r=s,u=c(null),g=J(()=>a.players.filter(h=>!v(h)&&!O(h))),P=J(()=>a.players.some(h=>v(h))),I=J(()=>a.players.some(h=>O(h))),v=h=>h.key.toUpperCase().includes("HDREZKA"),O=h=>h.key.toUpperCase().includes("KODIK"),H=h=>h.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"").trim(),A=h=>{r("select",h),r("close")},Q=h=>a.selectedPlayer&&a.selectedPlayer.key===h.key,L=h=>a.selectedPlayer?h==="hdrezka"&&v(a.selectedPlayer)||h==="kodik"&&O(a.selectedPlayer):!1,E=h=>{u.value=h},y=()=>{u.value=null},we=h=>{let M=a.players.filter(f=>h==="hdrezka"&&v(f)||h==="kodik"&&O(f));return h==="kodik"?M.sort((f,Y)=>H(f.translate).localeCompare(H(Y.translate))):M},Ie=h=>we(h).some(M=>M.warning);return(h,M)=>(T(),$("div",{class:"modal",onClick:M[4]||(M[4]=ft(f=>h.$emit("close"),["self"]))},[n("div",{class:"modal-content",onClick:M[3]||(M[3]=ft(()=>{},["stop"]))},[n("button",{class:"close",onClick:M[0]||(M[0]=f=>h.$emit("close"))},"√ó"),u.value?(T(),$("h2",Xo,[n("button",{class:"back-btn",onClick:y},"‚Üê –ù–∞–∑–∞–¥"),Re(" "+k(u.value==="hdrezka"?"ReYohoho - HDrezka":"Kodik"),1)])):(T(),$("h2",Yo,"–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–µ–µ—Ä")),n("ul",Zo,[u.value?(T(!0),$(Oe,{key:1},lt(we(u.value),f=>(T(),$("li",{key:f.key},[n("button",{class:B(["player-item",{active:Q(f)}]),onClick:Y=>A(f)},[Re(k(H(f.translate))+" ",1),f.warning?(T(),$("span",sn,"warning")):K("",!0)],10,nn)]))),128)):(T(),$(Oe,{key:0},[(T(!0),$(Oe,null,lt(g.value,f=>(T(),$("li",{key:f.key},[n("button",{class:B(["player-item",{active:Q(f)}]),onClick:Y=>A(f)},[Re(k(H(f.translate))+" ",1),f.warning?(T(),$("span",Jo,"warning")):K("",!0)],10,jo)]))),128)),P.value?(T(),$("li",Qo,[n("button",{class:B(["group-item",{active:L("hdrezka")}]),onClick:M[1]||(M[1]=f=>E("hdrezka"))},[M[5]||(M[5]=n("span",{class:"material-icons group-icon"},"folder",-1)),M[6]||(M[6]=Re(" ReYohoho - HDrezka ")),Ie("hdrezka")?(T(),$("span",en,"warning")):K("",!0)],2)])):K("",!0),I.value?(T(),$("li",tn,[n("button",{class:B(["group-item",{active:L("kodik")}]),onClick:M[2]||(M[2]=f=>E("kodik"))},[M[7]||(M[7]=n("span",{class:"material-icons group-icon"},"folder",-1)),M[8]||(M[8]=Re(" Kodik ")),Ie("kodik")?(T(),$("span",on,"warning")):K("",!0)],2)])):K("",!0)],64))])])]))}},an=Rt(ln,[["__scopeId","data-v-8b8d2b67"]]);class rn{constructor(){this.ws=null,this.isConnected=!1,this.isAuthenticated=!1,this.messageId=0,this.sources=new Map,this.filtersFound=new Map,this.pendingRequests=new Map,this.callbacks={onConnect:null,onDisconnect:null,onSourcesUpdated:null,onFiltersFound:null,onError:null},this.BLUR_FILTER_NAME="reyohoho"}generateMessageId(){return++this.messageId}setCallbacks(s){this.callbacks=s}async connect(s="localhost",a=4455,r=""){return new Promise((u,g)=>{const P="ws://".concat(s,":").concat(a);console.log("Connecting to OBS WebSocket at ".concat(P)),this.ws=new WebSocket(P),this.ws.onopen=async()=>{var I,v;console.log("WebSocket connection opened");try{const O=await this.authenticate(r);console.log("Authentication response:",O),O.success?(console.log("Successfully authenticated to OBS"),(v=(I=this.callbacks).onConnect)==null||v.call(I),this.loadSourcesAndSearchFilters(),u()):(console.error("Authentication failed"),g(new Error("Authentication failed")))}catch(O){console.error("Error during authentication:",O),g(O)}},this.ws.onmessage=I=>{this.handleMessage(JSON.parse(I.data))},this.ws.onclose=()=>{var I,v;console.log("WebSocket connection closed"),(v=(I=this.callbacks).onDisconnect)==null||v.call(I)},this.ws.onerror=I=>{var v,O;console.error("WebSocket error:",I),(O=(v=this.callbacks).onError)==null||O.call(v,I.message||"Connection error"),g(I)}})}disconnect(){if(this.ws&&(this.ws.close(),this.ws=null),this.pendingRequests){for(const[,{reject:s}]of this.pendingRequests.entries())s(new Error("Connection closed"));this.pendingRequests.clear()}this.sources.clear(),this.filtersFound.clear()}sendRequest(s,a={}){return new Promise((r,u)=>{if(!this.isConnected||!this.ws){console.warn("No connection to OBS"),u(new Error("No connection to OBS"));return}const g=this.generateMessageId().toString(),P={op:6,d:{requestType:s,requestId:g,requestData:a}};console.log("Sending OBS request: ".concat(s),a),this.pendingRequests.set(g,{resolve:r,reject:u}),this.ws.send(JSON.stringify(P)),setTimeout(()=>{this.pendingRequests&&this.pendingRequests.has(g)&&(this.pendingRequests.delete(g),u(new Error("Request ".concat(s," timed out"))))},1e4)})}handleMessage(s){switch(s.op){case 0:this.handleHello(s.d);break;case 2:this.handleIdentified();break;case 7:this.handleRequestResponse(s.d);break;case 5:this.handleEvent(s.d);break;default:console.log("Unknown OBS message: op=".concat(s.op))}}authenticate(s=""){return new Promise(a=>{this.password=s,this.authResolve=a})}async handleHello(s){console.log("Received OBS hello"),this.isConnected=!0;const a={op:1,d:{rpcVersion:1}};if(s.authentication&&this.password)try{const r=new TextEncoder,u=await crypto.subtle.digest("SHA-256",r.encode(this.password+s.authentication.salt)),g=Array.from(new Uint8Array(u)),P=btoa(String.fromCharCode(...g)),I=await crypto.subtle.digest("SHA-256",r.encode(P+s.authentication.challenge)),v=Array.from(new Uint8Array(I)),O=btoa(String.fromCharCode(...v));a.d.authentication=O}catch(r){console.error("Authentication error:",r)}this.ws.send(JSON.stringify(a))}handleIdentified(){console.log("OBS authentication successful"),this.isAuthenticated=!0,this.authResolve&&(this.authResolve({success:!0}),this.authResolve=null)}handleRequestResponse(s){const{requestId:a,requestType:r,requestStatus:u,responseData:g}=s;if(console.log("Received response for ".concat(r,":"),{success:u.result,code:u.code,comment:u.comment}),!this.pendingRequests){console.warn("No pending requests map");return}const P=this.pendingRequests.get(a);if(!P){console.warn("No pending request found for ID: ".concat(a));return}this.pendingRequests.delete(a),u.result?(console.log("Request ".concat(r," successful"),g),P.resolve(g)):(console.error("Request ".concat(r," failed:"),u.comment),P.reject(new Error("".concat(r," failed: ").concat(u.comment))))}handleFilterListResponse(s){const a=s.sourceName,u=(s.filters||[]).find(g=>g.filterName.toLowerCase()===this.BLUR_FILTER_NAME.toLowerCase());u&&(this.foundFilters.set(a,{sourceName:a,filterName:u.filterName,enabled:u.filterEnabled}),console.log("Found reyohoho filter in source: ".concat(a))),this.checkSearchComplete()}checkSearchComplete(){setTimeout(()=>{var s,a;console.log("Search complete. Found ".concat(this.foundFilters.size," reyohoho filters")),(a=(s=this.callbacks).onFiltersFound)==null||a.call(s,Array.from(this.foundFilters.values()))},500)}handleEvent(s){console.log("OBS event: ".concat(s.eventType))}async testConnection(){try{console.log("Testing OBS connection...");const s=await this.sendRequest("GetVersion");return console.log("OBS connection test successful:",s),{success:!0,version:s}}catch(s){return console.error("OBS connection test failed:",s),{success:!1,error:s.message}}}async loadSourcesAndSearchFilters(){var s,a,r,u,g,P,I,v,O,H;try{console.log("Loading sources and searching for filters...");try{const E=await this.sendRequest("GetVersion");console.log("OBS version info:",E)}catch(E){console.warn("Could not get OBS version:",E)}console.log("Requesting scene list...");const A=await this.sendRequest("GetSceneList");if(console.log("Raw scenes response:",A),!A||!A.scenes){console.error("Invalid scenes response structure:",A),(a=(s=this.callbacks).onError)==null||a.call(s,"Invalid response from OBS - no scenes data");return}console.log("Found scenes:",A.scenes.length),console.log("Requesting input list...");const Q=await this.sendRequest("GetInputList");if(console.log("Raw inputs response:",Q),!Q||!Q.inputs){console.error("Invalid inputs response structure:",Q),(u=(r=this.callbacks).onError)==null||u.call(r,"Invalid response from OBS - no inputs data");return}console.log("Found inputs:",Q.inputs.length),this.sources.clear(),this.filtersFound.clear();for(const E of A.scenes)if(console.log("Checking scene: ".concat(E.sceneName," with ").concat(E.sceneItems?E.sceneItems.length:0," items")),E.sceneItems&&Array.isArray(E.sceneItems))for(const y of E.sceneItems)y.sourceName&&(this.sources.set(y.sourceName,{sceneName:E.sceneName,sourceId:y.sceneItemId,sourceName:y.sourceName}),await this.searchFiltersInSource(y.sourceName,E.sceneName));for(const E of Q.inputs)console.log("Checking input: ".concat(E.inputName)),this.sources.has(E.inputName)||this.sources.set(E.inputName,{sceneName:"Direct Input",sourceId:null,sourceName:E.inputName}),await this.searchFiltersInSource(E.inputName,"Direct Input");const L=Array.from(this.filtersFound.values());console.log("Total filters found:",L.length),L.forEach(E=>{console.log("- ".concat(E.sourceName,": ").concat(E.filterName," (").concat(E.enabled?"enabled":"disabled",")"))}),(P=(g=this.callbacks).onFiltersFound)==null||P.call(g,L),(v=(I=this.callbacks).onSourcesUpdated)==null||v.call(I,Array.from(this.sources.values()))}catch(A){console.error("Error loading sources:",A),console.error("Error stack:",A.stack),(H=(O=this.callbacks).onError)==null||H.call(O,"Error loading sources: ".concat(A.message))}}async searchFiltersInSource(s,a){try{console.log("Searching filters in source: ".concat(s));const r=await this.sendRequest("GetSourceFilterList",{sourceName:s});console.log("Source ".concat(s," has ").concat(r.filters.length," filters"));for(const u of r.filters){console.log("  Filter: ".concat(u.filterName," (").concat(u.filterEnabled?"enabled":"disabled",")"));const g="".concat(s,"::").concat(u.filterName);this.filtersFound.set(g,{id:g,sourceName:s,sceneName:a,filterName:u.filterName,enabled:u.filterEnabled})}}catch(r){console.warn("Could not get filters for source ".concat(s,":"),r)}}async enableBlur(s){var r,u;if(!s){console.warn("No filter selected for blur");return}const a=this.filtersFound.get(s);if(!a){console.warn("Selected filter not found:",s);return}try{await this.sendRequest("SetSourceFilterEnabled",{sourceName:a.sourceName,filterName:a.filterName,filterEnabled:!0}),a.enabled=!0,console.log("Enabled blur filter: ".concat(a.sourceName,"::").concat(a.filterName))}catch(g){(u=(r=this.callbacks).onError)==null||u.call(r,"Error enabling filter: ".concat(g.message))}}async disableBlur(s){var r,u;if(!s){console.warn("No filter selected for blur");return}const a=this.filtersFound.get(s);if(!a){console.warn("Selected filter not found:",s);return}try{await this.sendRequest("SetSourceFilterEnabled",{sourceName:a.sourceName,filterName:a.filterName,filterEnabled:!1}),a.enabled=!1,console.log("Disabled blur filter: ".concat(a.sourceName,"::").concat(a.filterName))}catch(g){(u=(r=this.callbacks).onError)==null||u.call(r,"Error disabling filter: ".concat(g.message))}}async testBlur(s,a=2e3){if(!s){console.warn("No filter selected for test");return}await this.enableBlur(s),setTimeout(()=>{this.disableBlur(s)},a)}getFilterById(s){return this.filtersFound.get(s)}getAllFilters(){return Array.from(this.filtersFound.values())}}const cn={class:"players-list"},un=["src"],dn={key:1,class:"controls"},vn={class:"main-controls"},pn={class:"material-icons"},mn={class:"list-button-item"},fn={class:"material-icons"},gn={class:"list-button-item"},yn={class:"material-icons"},hn={class:"list-button-item"},bn={class:"list-button-item"},wn={class:"material-icons"},kn={class:"list-button-item"},xn={class:"material-icons"},Cn={class:"tooltip-container","data-tooltip-container":"dimming"},Sn={class:"material-icons"},Tn={class:"tooltip-container","data-tooltip-container":"blur"},In={class:"tooltip-container","data-tooltip-container":"compressor"},En={class:"tooltip-container","data-tooltip-container":"mirror"},An={class:"tooltip-container","data-tooltip-container":"theater"},$n={class:"material-symbols-outlined"},Mn={class:"custom-tooltip","data-tooltip":"theater"},Bn={class:"tooltip-container","data-tooltip-container":"pip"},Rn={class:"tooltip-container","data-tooltip-container":"aspect_ratio"},On={class:"current-ratio"},Nn=["onClick"],Fn={key:0,class:"tooltip-container","data-tooltip-container":"app_link"},Pn={class:"custom-tooltip","data-tooltip":"app_link"},Ln={key:1,class:"tooltip-container","data-tooltip-container":"copy_link"},Dn={class:"custom-tooltip","data-tooltip":"copy_link"},_n={key:2,class:"tooltip-container","data-tooltip-container":"overlay"},qn={class:"material-icons"},Hn={key:0,class:"desktop-list-buttons"},zn={class:"tooltip-container"},Wn={class:"material-icons"},Vn={class:"custom-tooltip"},Un={class:"tooltip-container"},Gn={class:"material-icons"},Kn={class:"custom-tooltip"},Yn={class:"tooltip-container"},Xn={class:"custom-tooltip"},Zn={class:"tooltip-container"},jn={class:"material-icons"},Jn={class:"custom-tooltip"},Qn={class:"tooltip-container"},es={class:"material-icons"},ts={class:"custom-tooltip"},os={__name:"PlayerComponent",props:{kpId:String,movieInfo:{type:Object,default:()=>({})}},emits:["update:selectedPlayer","update:movieInfo"],setup(R,{emit:s}){const a=Zt(),r=Uo(),u=No(),g=Fo(),P=jt(),I=c(g.params.kp_id),v=R,O=s,H=c([]),A=c(null),Q=c(!0),L=c(!1),E=c(!1),y=c(null),we=c(null),Ie=c(!1),h=c(""),M=c(null),f=c(window.innerHeight*.9),Y=J(()=>"".concat(f.value,"px")),W=J(()=>a.isMobile),m=J(()=>!!window.electronAPI),x=c(null),at=c(!1);let gt=null;const De=c(null),eo=c(null),to=c(null),de=c(null),_e=c(!1),ge=c(!1),ve=c(null),yt=c(null),rt=c(0),ae=c(null),ke=c(null),ye=c(null),Ne=c(null),Fe=c(null),xe=c(null),D=J({get:()=>r.videoOverlayEnabled2,set:t=>r.updateVideoOverlay(t)}),V=J({get:()=>r.overlaySettings,set:t=>r.updateOverlaySettings(t)}),Ot=c(0),Nt=c(0),Ye=c([]),b=c(null),qe=c(null),Ce=c(!1),U=c(null),Se=c(!1),Ft=c([]),He=c([]),ce=J({get:()=>r.obsSettings,set:t=>r.updateObsSettings(t)}),ht=t=>{const e=document.querySelector('[data-tooltip-container="'.concat(t,'"]')),o=document.querySelector('[data-tooltip="'.concat(t,'"]'));if(!e||!o)return;const i=e.getBoundingClientRect(),l=o.getBoundingClientRect(),w=window.innerHeight;i.bottom+l.height>w?(o.style.top="auto",o.style.bottom="100%",o.style.marginTop="0",o.style.marginBottom="12px",o.style.transform="translateX(-50%)"):(o.style.top="100%",o.style.bottom="auto",o.style.marginTop="12px",o.style.marginBottom="0",o.style.transform="translateX(-50%)")},ne=t=>{x.value=t,at.value=!1,clearTimeout(gt),Mt(()=>{ht(t)})},bt=()=>{at.value||(gt=setTimeout(()=>{x.value=null},300))},wt=()=>{at.value=!0,clearTimeout(gt)},ct=()=>{at.value=!1,x.value=null},Ae=J({get:()=>r.aspectRatio,set:t=>r.updateAspectRatio(t)}),Xe=J({get:()=>r.isCentered,set:t=>r.updateCentering(t)}),oo=J(()=>{var t,e,o,i,l,w,p,C,G,se;return((e=(t=v.movieInfo)==null?void 0:t.lists)==null?void 0:e.isFavorite)||((i=(o=v.movieInfo)==null?void 0:o.lists)==null?void 0:i.isWatching)||((w=(l=v.movieInfo)==null?void 0:l.lists)==null?void 0:w.isLater)||((C=(p=v.movieInfo)==null?void 0:p.lists)==null?void 0:C.isCompleted)||((se=(G=v.movieInfo)==null?void 0:G.lists)==null?void 0:se.isAbandoned)}),Pt=J(()=>r.preferredPlayer),no=c(0),ut=t=>t.toUpperCase(),kt=()=>{if(L.value||!we.value)return;const[t,e]=Ae.value.split(":").map(Number);f.value=window.innerHeight*.9,no.value=Math.min(we.value.clientWidth*(e/t),f.value)},so=J(()=>{if(L.value)return{};const[t,e]=Ae.value.split(":").map(Number),o=f.value*(t/e);return{width:"100%",maxWidth:"".concat(o,"px"),maxHeight:Y.value,margin:"0 auto",overflow:"hidden"}}),io=J(()=>{const[t,e]=Ae.value.split(":").map(Number);return{position:"relative",width:"100%",paddingTop:"".concat(e/t*100,"%")}}),Ze=()=>{we.value&&setTimeout(()=>{Mt(()=>{we.value.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},500)},lo=async()=>{try{h.value="",M.value=null;let t;if(v.kpId.startsWith("shiki")){const e=v.kpId.replace("shiki","");t=await Do(e)}else t=await _o(v.kpId);if(H.value=Object.entries(t).map(([e,o])=>({key:e.toUpperCase(),...o})),H.value.length>0){if(Pt.value){const e=ut(Pt.value),o=H.value.find(i=>ut(i.key)===e);A.value=o||H.value[0]}else A.value=H.value[0];O("update:selectedPlayer",A.value)}}catch(t){const{message:e,code:o}=Kt(t);h.value=e,M.value=o,console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–ª–µ–µ—Ä–æ–≤:",t)}},ao=()=>{Ie.value=!0},Lt=()=>{Ie.value=!1},ro=()=>{try{return ae.value||(ae.value=new(window.AudioContext||window.webkitAudioContext)),ke.value||(ke.value=ae.value.createDynamicsCompressor(),ke.value.threshold.value=-50,ke.value.knee.value=40,ke.value.ratio.value=12,ke.value.attack.value=0,ke.value.release.value=.25,Ne.value=ae.value.createGain(),Fe.value=ae.value.createGain(),Ne.value.gain.value=0,Fe.value.gain.value=1,ke.value.connect(Ne.value),Ne.value.connect(ae.value.destination),Fe.value.connect(ae.value.destination)),!0}catch(t){return console.log("Error initializing audio context:",t),!1}},co=async t=>{try{if(!ae.value||xe.value===t)return!0;const e=y.value,o=(e==null?void 0:e.src)||"";if(o.includes("videoframe")||o.includes("kinoserial.net")||o.includes("allarknow"))return console.log("Player detected as unsupported for compressor:",o),xe.value=t,ye.value=null,ge.value=!1,m.value&&window.electronAPI.showToast("–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —ç—Ç–∏–º –ø–ª–µ–µ—Ä–æ–º"),!1;if(ye.value)try{ye.value.disconnect()}catch(l){}const i=async(l=0)=>{l>0&&await new Promise(w=>setTimeout(w,l));try{return ye.value=ae.value.createMediaElementSource(t),xe.value=t,ye.value.connect(ke.value),ye.value.connect(Fe.value),console.log("Video audio setup completed (attempt with ".concat(l,"ms delay)")),!0}catch(w){if(w.name==="InvalidStateError"&&w.message.includes("already connected"))return console.log("MediaElementSource already connected (".concat(l,"ms delay attempt)")),!1;throw w}};return await i(0)||await i(100)||await i(300)||await i(800)?!0:(console.log("Video element has internal audio processing, compressor not available for this player"),xe.value=t,ye.value=null,ge.value=!1,m.value&&window.electronAPI.showToast("–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —ç—Ç–∏–º –ø–ª–µ–µ—Ä–æ–º"),!1)}catch(e){return console.log("Error setting up video audio:",e),!1}},xt=async t=>{if(y.value)try{const e=y.value,o=e.contentDocument||e.contentWindow.document;if(!o)return;const i=o.querySelectorAll("video");if(i.length===0)return;const l=i[0];if(!ro())return;if(!await co(l)||!ye.value){console.log("Compressor not available for this player");return}t&&!ge.value?(Ne.value.gain.setValueAtTime(1,ae.value.currentTime),Fe.value.gain.setValueAtTime(0,ae.value.currentTime),ge.value=!0,m.value&&window.electronAPI.showToast("–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –≤–∫–ª—é—á—ë–Ω"),console.log("Compressor enabled")):!t&&ge.value&&(Ne.value.gain.setValueAtTime(0,ae.value.currentTime),Fe.value.gain.setValueAtTime(1,ae.value.currentTime),ge.value=!1,m.value&&window.electronAPI.showToast("–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –æ—Ç–∫–ª—é—á—ë–Ω"),console.log("Compressor disabled"))}catch(e){console.log("Compressor error:",e),m.value&&window.electronAPI.showToast("–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞")}},uo=()=>{if(y.value)try{const t=y.value,e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=e.querySelectorAll("video");if(o.length>0){const i=o[0];i.style.filter.includes("blur")||(i.style.filter="blur(50px)")}else t.style.filter.includes("blur")||(t.style.filter="blur(50px)")}catch(t){console.log("Error enabling blur:",t)}},vo=()=>{if(y.value)try{const t=y.value,e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=e.querySelectorAll("video");if(o.length>0){const i=o[0];i.style.filter.includes("blur")&&(i.style.filter="")}else t.style.filter.includes("blur")&&(t.style.filter="")}catch(t){console.log("Error disabling blur:",t)}},po=()=>{if(m.value)try{const t=y.value,e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=e.querySelectorAll("video");if(o.length>0){const i=o[0];i.style.filter.includes("blur")?i.style.filter="":i.style.filter="blur(50px)"}else t.style.filter.includes("blur")?t.style.filter="":t.style.filter="blur(50px)"}catch(t){console.log("Error toggling blur:",t)}else Ke("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank")},Dt=()=>{m.value?(Pe.value=!Pe.value,xt(Pe.value)):(Ke("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},_t=()=>{m.value?(ze.value=!ze.value,fo(ze.value)):(Ke("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},dt=()=>{L.value=!L.value,L.value?(window.addEventListener("mousemove",Ct),document.addEventListener("keydown",St),document.body.classList.add("no-scroll")):(window.removeEventListener("mousemove",Ct),document.removeEventListener("keydown",St),document.body.classList.remove("no-scroll")),E.value=L.value,Mt(()=>Ze())},qt=c(null),Ct=()=>{qt.value=setTimeout(()=>{clearTimeout(qt.value),E.value=!1},4e3),E.value=!0},vt=J(()=>a.dimmingEnabled),mo=()=>{L.value||a.toggleDimming()},Pe=J({get:()=>r.compressorEnabled,set:t=>r.updateCompressor(t)}),ze=J({get:()=>r.mirrorEnabled,set:t=>r.updateMirror(t)}),fo=t=>{if(y.value)try{const e=y.value,o=e.contentDocument||e.contentWindow.document;if(!o)return;const i=o.querySelectorAll("video");if(i.length>0&&(i.forEach(l=>{t?l.style.transform="scaleX(-1)":l.style.transform="scaleX(1)"}),_e.value=t,m.value)){const l=t?"–ó–µ—Ä–∫–∞–ª–æ –≤–∫–ª—é—á–µ–Ω–æ":"–ó–µ—Ä–∫–∞–ª–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ";window.electronAPI.showToast(l)}}catch(e){}},go=()=>{de.value&&clearInterval(de.value),de.value=setInterval(()=>{if(y.value)try{const t=y.value,e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=e.querySelectorAll("video");if(o.length>0){const i=o[0],w=i.style.transform==="scaleX(-1)";ze.value&&!w?(i.style.transform="scaleX(-1)",_e.value=!0):!ze.value&&w&&(i.style.transform="scaleX(1)",_e.value=!1),xe.value!==i?(xe.value=null,ge.value=!1,Pe.value&&setTimeout(()=>{xt(!0)},500)):Pe.value!==ge.value&&ye.value&&(console.log("Compressor state mismatch, reapplying"),xt(Pe.value))}}catch(t){}},1e3)},yo=(t=!1)=>{if(!m.value)return;ve.value&&clearInterval(ve.value);let e=!1,o=[];function i(){var l;if(o=[],window.selectedNudityTimings&&Array.isArray(window.selectedNudityTimings)&&((l=v.movieInfo)!=null&&l.nudity_timings)){for(const w of v.movieInfo.nudity_timings)if(window.selectedNudityTimings.includes(w.id)){const p=Xt(w.timing_text);p&&p.length>0&&o.push(...p)}}}i(),ve.value=setInterval(()=>{var l,w,p;if(y.value){i();try{const C=y.value,G=C.contentDocument||C.contentWindow.document;if(!G)return;const se=G.querySelectorAll("video");if(se.length>0){const ee=se[0];if(Ot.value=ee.currentTime||0,Nt.value=ee.duration||0,m.value&&D.value&&!b.value&&!Ce.value&&Date.now()-(window.iframeLoadTime||0)>=3e3)try{We(G,ee)}catch(X){console.log("Error creating overlay:",X),Ce.value=!1}if(m.value&&!D.value&&b.value&&setTimeout(()=>{!D.value&&b.value&&$e()},100),m.value&&((l=v.movieInfo)!=null&&l.nudity_timings)){const _=ee.currentTime,X=[],pe=[];if(window.overlayNudityTimings&&Array.isArray(window.overlayNudityTimings)&&window.overlayNudityTimings.length>0){for(const S of v.movieInfo.nudity_timings)if(window.overlayNudityTimings.includes(S.id)){const N=Xt(S.timing_text);if(N&&N.length>0){const re=[];for(const[ie,te]of N){let q="normal";_>=ie&&_<=te?(q="active",pe.push(S.id)):ie>_&&ie-_<=5&&(q="upcoming"),re.push({text:"[".concat(Ge(ie),"-").concat(Ge(te),"]"),status:q})}X.push({id:S.id,intervals:re})}}}Ye.value=X}if(m.value&&b.value&&D.value&&Ut(),!ee.paused){const _=ee.currentTime,X=ee.duration,pe=X>0?_/X*100:0;if(t&&(console.log("Video position: ".concat(_.toFixed(2),"s / ").concat(X.toFixed(2),"s (").concat(pe.toFixed(1),"%)")),o.length>0)){const N=o.map(([re,ie])=>"".concat(Ge(re)," - ").concat(Ge(ie))).join(", ");console.log("Active blur intervals: [".concat(N,"]"))}let S=!1;for(const[N,re]of o)if(_>=N&&_<=re){S=!0;break}ce.value.enabled&&Se.value&&ce.value.selectedFilterId?S&&!e?((w=U.value)==null||w.enableBlur(ce.value.selectedFilterId),e=!0,console.log("OBS Blur applied at",_.toFixed(2),"seconds")):!S&&e&&((p=U.value)==null||p.disableBlur(ce.value.selectedFilterId),e=!1,console.log("OBS Blur removed at",_.toFixed(2),"seconds")):S&&!e&&m.value?(uo(),e=!0,console.log("Blur applied at",_.toFixed(2),"seconds")):!S&&e&&!ce.value.enabled&&(vo(),e=!1,console.log("Blur removed at",_.toFixed(2),"seconds"))}}}catch(C){console.log("Error monitoring video position:",C)}}},100)},ho=()=>{Q.value=!1,window.iframeLoadTime=Date.now(),go(),yo(),m.value&&D.value&&!b.value&&setTimeout(()=>{try{const t=y.value,e=t.contentDocument||t.contentWindow.document;if(e){const o=e.querySelector("video");o&&We(e,o)}}catch(t){console.log("Error creating overlay on iframe load:",t),Ce.value=!1}},3e3)},St=t=>{(t.key==="Escape"&&L.value||t.altKey&&t.keyCode===84)&&dt()},Ht=t=>{Ae.value=t,setTimeout(()=>{Xe.value&&Ze()},310)},bo=()=>{const t="reyohoho://#".concat(I.value);try{window.location.href=t}catch(e){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Å—ã–ª–∫–∏:",e)}},wo=()=>{const t=window.location.href;navigator.clipboard.writeText(t).then(()=>{}),De.value.showNotification("–°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∏–ª—å–º —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞")};function zt(t){return t.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"HDRezka - ").replace(/KODIK>/,"Kodik - ").trim()}const ko=()=>{try{ye.value&&(ye.value.disconnect(),ye.value=null),ae.value&&(ae.value.close(),ae.value=null),ke.value=null,Ne.value=null,Fe.value=null,xe.value=null,ge.value=!1}catch(t){console.log("Error cleaning up audio context:",t)}},xo=t=>{var e;if(((e=A.value)==null?void 0:e.key)===t.key){Lt();return}A.value=t,Q.value=!0,_e.value=!1,ge.value=!1,xe.value=null,b.value&&$e(),de.value&&(clearInterval(de.value),de.value=null),ve.value&&(clearInterval(ve.value),ve.value=null),t.key.toLowerCase().includes("torrents")||r.updatePreferredPlayer(ut(t.key)),O("update:selectedPlayer",t)};Ue(A,t=>{t&&(Q.value=!0,_e.value=!1,ge.value=!1,xe.value=null,b.value&&$e(),de.value&&(clearInterval(de.value),de.value=null),ve.value&&(clearInterval(ve.value),ve.value=null),t.key.toLowerCase().includes("torrents")||r.updatePreferredPlayer(ut(t.key)),O("update:selectedPlayer",t))}),Ue(()=>g.params.kp_id,async t=>{t&&t!==I.value&&(I.value=t,_e.value=!1,ge.value=!1,xe.value=null,b.value&&$e(),de.value&&(clearInterval(de.value),de.value=null),ve.value&&(clearInterval(ve.value),ve.value=null),rt.value=0,Xe.value&&Ze())},{immediate:!0}),Ue(D,t=>{if(m.value)if(t&&!b.value){const e=()=>{if(y.value)try{const o=y.value,i=o.contentDocument||o.contentWindow.document;if(i){const l=i.querySelector("video");if(l){const w=Date.now()-(window.iframeLoadTime||0);w>=3e3?We(i,l):setTimeout(e,3e3-w)}}}catch(o){console.log("Error creating overlay via watcher:",o),Ce.value=!1}};e()}else!t&&b.value&&$e()}),Ue(Ye,(t,e)=>{if(!m.value)return;const o=e&&e.length>0,i=t&&t.length>0;!o&&i&&(D.value||(D.value=!0,window.electronAPI&&window.electronAPI.showToast("–û–≤–µ—Ä–ª–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á—ë–Ω - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∞–π–º–∏–Ω–≥–∏")))},{deep:!0}),Ue(()=>ce.value.enabled,t=>{t&&!Se.value?It():!t&&Se.value&&Vt()}),Ue(V,(t,e)=>{!m.value||!D.value||(e&&t.showBackground!==e.showBackground?b.value&&($e(),setTimeout(()=>{if(y.value&&D.value)try{const o=y.value,i=o.contentDocument||o.contentWindow.document;if(i){const l=i.querySelector("video");l&&We(i,l)}}catch(o){console.log("Error recreating overlay:",o)}},100)):b.value&&Ut())},{deep:!0});const pt=["16:9","12:5","4:3"],Co=()=>{const e=(pt.indexOf(Ae.value)+1)%pt.length;Ht(pt[e])},So=t=>{var o,i,l,w,p,C,G,se,ee,_,X,pe,S;return(S={[z.FAVORITE]:((i=(o=v.movieInfo)==null?void 0:o.lists)==null?void 0:i.isFavorite)||!1,[z.HISTORY]:((w=(l=v.movieInfo)==null?void 0:l.lists)==null?void 0:w.isHistory)||!1,[z.LATER]:((C=(p=v.movieInfo)==null?void 0:p.lists)==null?void 0:C.isLater)||!1,[z.COMPLETED]:((se=(G=v.movieInfo)==null?void 0:G.lists)==null?void 0:se.isCompleted)||!1,[z.ABANDONED]:((_=(ee=v.movieInfo)==null?void 0:ee.lists)==null?void 0:_.isAbandoned)||!1,[z.WATCHING]:((pe=(X=v.movieInfo)==null?void 0:X.lists)==null?void 0:pe.isWatching)||!1}[t])!=null?S:!1},he=async t=>{if(!u.token){De.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:To});return}try{const e={[z.FAVORITE]:"–∏–∑–±—Ä–∞–Ω–Ω–æ–µ",[z.HISTORY]:"–∏—Å—Ç–æ—Ä–∏—é",[z.LATER]:'—Å–ø–∏—Å–æ–∫ "–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ"',[z.COMPLETED]:'—Å–ø–∏—Å–æ–∫ "–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"',[z.ABANDONED]:'—Å–ø–∏—Å–æ–∫ "–ë—Ä–æ—à–µ–Ω–æ"',[z.WATCHING]:'—Å–ø–∏—Å–æ–∫ "–°–º–æ—Ç—Ä—é"'};So(t)?(await qo(I.value,t),De.value.showNotification("–£–¥–∞–ª–µ–Ω–æ –∏–∑ ".concat(e[t]))):(await Ho(I.value,t),De.value.showNotification("–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ ".concat(e[t])))}catch(e){const{message:o,code:i}=Kt(e);De.value.showNotification("".concat(o," ").concat(i))}O("update:movieInfo")},To=()=>{P.push("/login")},Tt=J(()=>r.showFavoriteTooltip),Io=()=>{P.push("/settings"),ct()},Eo=async()=>{if(!m.value){Ke("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank");return}if(y.value)try{const t=y.value,e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=e.querySelector("video");if(!o)return;document.pictureInPictureElement?await document.exitPictureInPicture():document.pictureInPictureEnabled?await o.requestPictureInPicture():Ke('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–∂–∏–º "–ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –∫–∞—Ä—Ç–∏–Ω–∫–µ"')}catch(t){console.error("Error toggling PiP:",t),Ke('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º "–ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –∫–∞—Ä—Ç–∏–Ω–∫–µ"')}},Ao=()=>{if(D.value=!D.value,!D.value)$e();else{const t=()=>{if(!b.value&&y.value)try{const e=y.value,o=e.contentDocument||e.contentWindow.document;if(o){const i=o.querySelector("video");if(i){const l=Date.now()-(window.iframeLoadTime||0);l>=3e3?We(o,i):setTimeout(t,3e3-l)}}}catch(e){console.log("Error creating overlay:",e),Ce.value=!1}};t()}},Wt=()=>{U.value&&U.value.disconnect(),U.value=new rn,U.value.setCallbacks({onConnect:()=>{Se.value=!0,r.setObsConnected(!0),m.value&&window.electronAPI&&window.electronAPI.showToast("–ü–æ–¥–∫–ª—é—á–µ–Ω –∫ OBS WebSocket")},onDisconnect:()=>{Se.value=!1,r.setObsConnected(!1),Ft.value=[],He.value=[]},onSourcesUpdated:t=>{Ft.value=t,window.obsSources=t},onFiltersFound:t=>{He.value=t,window.obsFiltersFound=t,r.updateObsSettings({filtersFound:t})},onError:t=>{console.error("OBS WebSocket error:",t),m.value&&window.electronAPI&&window.electronAPI.showToast("–û—à–∏–±–∫–∞ OBS: ".concat(t))}})},It=async()=>{U.value||Wt(),await U.value.connect(ce.value.host,ce.value.port,ce.value.password)},Vt=()=>{U.value&&U.value.disconnect()},$o=t=>{U.value&&Se.value&&t?U.value.testBlur(t):m.value&&window.electronAPI&&window.electronAPI.showToast("–§–∏–ª—å—Ç—Ä –Ω–µ –≤—ã–±—Ä–∞–Ω –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ OBS")},Mo=()=>{U.value&&Se.value&&U.value.loadSourcesAndSearchFilters()},Bo=()=>He.value,Ro=()=>{if(!m.value)return;const t=y.value,e=t.contentDocument||t.contentWindow.document;if(!e||e.getElementById("overlay-settings-modal"))return;const o=V.value,i=e.createElement("div");i.id="overlay-settings-modal",i.style.cssText="\n    position: fixed !important;\n    top: 0 !important;\n    left: 0 !important;\n    width: 100% !important;\n    height: 100% !important;\n    background: rgba(0, 0, 0, 0.8) !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    z-index: 9999 !important;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n  ";const l=e.createElement("div");l.style.cssText="\n    background: rgba(30, 30, 30, 0.95) !important;\n    backdrop-filter: blur(20px) !important;\n    border-radius: 16px !important;\n    padding: 32px !important;\n    max-width: 400px !important;\n    width: 90% !important;\n    border: 1px solid rgba(255, 255, 255, 0.1) !important;\n    box-shadow: 0 8px 40px rgba(0, 0, 0, 0.5) !important;\n  ",l.innerHTML='\n    <h3 style="color: #ff6b35; margin: 0 0 24px 0; font-size: 20px; font-weight: 600; text-align: center;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–≤–µ—Ä–ª–µ—è</h3>\n    \n    <div style="display: flex; flex-direction: column; gap: 16px;">\n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="showTitle" '.concat(o.showTitle?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞</span>\n      </label>\n      \n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="showDuration" ').concat(o.showDuration2?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</span>\n      </label>\n      \n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="showBackground" ').concat(o.showBackground?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–Ω—ã–π —Ñ–æ–Ω</span>\n      </label>\n      \n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="showTimingsOnMouseMove" ').concat(o.showTimingsOnMouseMove?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∞–π–º–∏–Ω–≥–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –º—ã—à–∫–∏</span>\n      </label>\n      \n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="highlightTimings" ').concat(o.highlightTimings?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–¥—Å–≤–µ—á–∏–≤–∞—Ç—å –±–ª–∏–∑–∫–∏–µ –∏ —Ç–µ–∫—É—â–∏–µ —Ç–∞–π–º–∏–Ω–≥–∏</span>\n      </label>\n\n    </div>\n    \n    <div style="display: flex; gap: 12px; margin-top: 24px; justify-content: center;">\n      <button id="saveSettings" style="background: #ff6b35; color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">\n        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å\n      </button>\n      <button id="cancelSettings" style="background: rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.8); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; padding: 10px 16px; cursor: pointer; font-size: 14px; transition: all 0.3s ease;">\n        –û—Ç–º–µ–Ω–∞\n      </button>\n    </div>\n  '),i.appendChild(l),i.addEventListener("click",p=>{p.target===i&&i.remove()}),l.querySelector("#saveSettings").addEventListener("click",()=>{var C;const p={showTitle:l.querySelector("#showTitle").checked,showDuration2:l.querySelector("#showDuration").checked,showBackground:l.querySelector("#showBackground").checked,showTimingsOnMouseMove:l.querySelector("#showTimingsOnMouseMove").checked,highlightTimings:l.querySelector("#highlightTimings").checked};V.value=p,(C=window.electronAPI)==null||C.showToast("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–≤–µ—Ä–ª–µ—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã"),i.remove()}),l.querySelector("#cancelSettings").addEventListener("click",()=>{i.remove()}),l.querySelectorAll("button").forEach(p=>{p.addEventListener("mouseenter",()=>{p.id==="saveSettings"?(p.style.background="#e55a2b",p.style.transform="translateY(-1px)"):p.style.background="rgba(255, 255, 255, 0.15)"}),p.addEventListener("mouseleave",()=>{p.id==="saveSettings"?(p.style.background="#ff6b35",p.style.transform="translateY(0)"):p.style.background="rgba(255, 255, 255, 0.1)"})}),e.body.appendChild(i)},We=(t,e)=>{if(!D.value||b.value||Ce.value)return;Ce.value=!0;const o=t.createElement("div");o.id="reyohoho-video-overlay";let i=()=>{o.style.cssText="\n      position: absolute !important;\n      top: 0 !important;\n      left: 0 !important;\n      width: 100% !important;\n      height: 100% !important;\n      pointer-events: none !important;\n      z-index: 999999999 !important;\n      display: flex !important;\n      flex-direction: column !important;\n      justify-content: space-between !important;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n      visibility: visible !important;\n      opacity: 1 !important;\n    "};const l=t.createElement("div");l.style.cssText="\n    color: white !important;\n    padding: 20px !important;\n    text-align: left !important;\n    pointer-events: none !important;\n  ";const w=t.createElement("div"),p=V.value.showBackground?"rgba(0, 0, 0, 0.7)":"transparent",C=V.value.showBackground?"blur(10px)":"none",G=V.value.showBackground?"fit-content":"auto";w.style.cssText="\n    font-size: 20px !important;\n    font-weight: 600 !important;\n    margin-bottom: 8px !important;\n    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8) !important;\n    line-height: 1.2 !important;\n    padding: 8px 12px !important;\n    border-radius: 6px !important;\n    display: inline-block !important;\n    color: rgba(255, 255, 255, 0.6) !important;\n    background: ".concat(p," !important;\n    backdrop-filter: ").concat(C," !important;\n    width: ").concat(G," !important;\n  ");const se=t.createElement("div"),ee=V.value.showBackground?"rgba(0, 0, 0, 0.7)":"transparent",_=V.value.showBackground?"blur(10px)":"none",X=V.value.showBackground?"6px":"0",pe=V.value.showBackground?"inline-flex":"flex",S=V.value.showBackground?"fit-content":"auto";se.style.cssText="\n    font-size: 18px !important;\n    font-weight: 500 !important;\n    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8) !important;\n    display: ".concat(pe," !important;\n    align-items: center !important;\n    gap: 8px !important;\n    flex-wrap: wrap !important;\n    color: rgba(255, 255, 255, 0.6) !important;\n    margin-left: 12px !important;\n    background: ").concat(ee," !important;\n    backdrop-filter: ").concat(_," !important;\n    border-radius: ").concat(X," !important;\n    width: ").concat(S," !important;\n  ");const N=t.createElement("div"),re=V.value.showBackground?"rgba(0, 0, 0, 0.7)":"transparent",ie=V.value.showBackground?"blur(10px)":"none";N.style.cssText="\n    position: absolute !important;\n    top: 20px !important;\n    right: 110px !important;\n    background: ".concat(re," !important;\n    backdrop-filter: ").concat(ie," !important;\n    border-radius: 12px !important;\n    padding: 16px !important;\n    width: fit-content !important;\n    max-width: 800px !important;\n    pointer-events: none !important;\n    display: none !important;\n    transition: opacity 0.3s ease, visibility 0.3s ease !important;\n    opacity: 0 !important;\n    visibility: hidden !important;\n  ");const te=t.createElement("div");te.style.cssText="\n    font-size: 14px !important;\n    color: rgba(255, 255, 255, 0.6) !important;\n    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8) !important;\n    line-height: 1.4 !important;\n    word-wrap: break-word !important;\n  ";const q=t.createElement("div");q.style.cssText="\n    position: absolute !important;\n    top: 20px !important;\n    right: 20px !important;\n    display: flex !important;\n    gap: 8px !important;\n    pointer-events: all !important;\n  ";const le=t.createElement("button");le.style.cssText="\n    background: rgba(0, 0, 0, 0.8) !important;\n    backdrop-filter: blur(10px) !important;\n    color: white !important;\n    border: 1px solid rgba(255, 255, 255, 0.2) !important;\n    border-radius: 50% !important;\n    width: 40px !important;\n    height: 40px !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n    font-size: 18px !important;\n  ",le.innerHTML="‚öôÔ∏è",le.title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–≤–µ—Ä–ª–µ—è";const fe=t.createElement("button");fe.style.cssText="\n    background: rgba(0, 0, 0, 0.8) !important;\n    backdrop-filter: blur(10px) !important;\n    color: white !important;\n    border: 1px solid rgba(255, 255, 255, 0.2) !important;\n    border-radius: 50% !important;\n    width: 40px !important;\n    height: 40px !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n    font-size: 18px !important;\n  ",fe.innerHTML="üëÅÔ∏è",fe.title="–û—Ç–∫–ª—é—á–∏—Ç—å –æ–≤–µ—Ä–ª–µ–π",fe.addEventListener("click",()=>{D.value=!1}),le.addEventListener("click",()=>{Ro()}),[le,fe].forEach(F=>{F.addEventListener("mouseenter",()=>{F.style.background="#ff6b35",F.style.borderColor="#ff6b35",F.style.transform="scale(1.1)"}),F.addEventListener("mouseleave",()=>{F.style.background="rgba(0, 0, 0, 0.8)",F.style.borderColor="rgba(255, 255, 255, 0.2)",F.style.transform="scale(1)"})}),q.appendChild(le),q.appendChild(fe),N.appendChild(te),l.appendChild(w),l.appendChild(se),o.appendChild(l),o.appendChild(N),o.appendChild(q),q.style.transition="opacity 0.3s ease, visibility 0.3s ease",q.style.opacity="0",q.style.visibility="hidden",l.style.transition="opacity 0.3s ease";let Le=null,je=null;const Je=()=>{q.style.opacity="1",q.style.visibility="visible",l.style.opacity="0",V.value.showTimingsOnMouseMove&&Ye.value.length>0&&(N.style.opacity="1",N.style.visibility="visible",clearTimeout(je),je=setTimeout(()=>{N.style.opacity="0",N.style.visibility="hidden"},3e3)),clearTimeout(qe.value),clearTimeout(Le),qe.value=setTimeout(()=>{q.style.opacity="0",q.style.visibility="hidden"},3e3),Le=setTimeout(()=>{l.style.opacity="1"},2e3)};t.addEventListener("mousemove",Je),o.addEventListener("mouseenter",()=>{q.style.opacity="1",q.style.visibility="visible",l.style.opacity="0",clearTimeout(Le)}),o.addEventListener("mouseleave",()=>{clearTimeout(qe.value),clearTimeout(Le),q.style.opacity="0",q.style.visibility="hidden",l.style.opacity="1"}),o._mouseHandler=Je;const Me=(F=>{let oe=F.parentNode,ue=0;const be=5;for(;oe&&ue<be;){const Ee=t.defaultView.getComputedStyle(oe),Be=oe.getBoundingClientRect();if(Be.width>0&&Be.height>0&&(Ee.position==="relative"||Ee.position==="absolute"||Ee.position==="fixed"||oe.tagName==="BODY"))return oe;oe=oe.parentNode,ue++}return F.parentNode})(e);o._targetContainer=Me,o._videoElement=e,i=()=>{const F=o._videoElement.getBoundingClientRect(),oe=o._targetContainer.getBoundingClientRect(),ue=F.top-oe.top,be=F.left-oe.left;o.style.cssText="\n      position: absolute !important;\n      top: ".concat(ue,"px !important;\n      left: ").concat(be,"px !important;\n      width: ").concat(F.width,"px !important;\n      height: ").concat(F.height,"px !important;\n      pointer-events: none !important;\n      z-index: 999999999 !important;\n      display: flex !important;\n      flex-direction: column !important;\n      justify-content: space-between !important;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n      visibility: visible !important;\n      opacity: 1 !important;\n      box-sizing: border-box !important;\n    ")},e.style.position="relative",(Me.style.position===""||Me.style.position==="static")&&(Me.style.position="relative"),Me.appendChild(o),i(),b.value=o,Ce.value=!1;const Qe=setInterval(()=>{if(!b.value||!D.value){clearInterval(Qe);return}if(!t.body.contains(o))try{const ue=t.querySelectorAll("video");if(ue.length>0){const be=ue[0];o._videoElement=be;const Be=(nt=>{let Te=nt.parentNode,st=0;const mt=5;for(;Te&&st<mt;){const Ve=t.defaultView.getComputedStyle(Te),it=Te.getBoundingClientRect();if(it.width>0&&it.height>0&&(Ve.position==="relative"||Ve.position==="absolute"||Ve.position==="fixed"||Te.tagName==="BODY"))return Te;Te=Te.parentNode,st++}return nt.parentNode})(be);o._targetContainer=Be,Be.appendChild(o),i(),o._mouseHandler&&(t.removeEventListener("mousemove",o._mouseHandler),t.addEventListener("mousemove",o._mouseHandler))}}catch(ue){console.log("Error re-adding overlay to DOM:",ue)}const F=t.defaultView.getComputedStyle(o);if((F.visibility==="hidden"||F.display==="none"||F.opacity==="0")&&i(),(parseInt(F.zIndex)||0)<999999999&&i(),o._videoElement&&o._targetContainer){const ue=o._videoElement.getBoundingClientRect(),be=parseInt(F.width)||0,Ee=parseInt(F.height)||0;(Math.abs(be-ue.width)>5||Math.abs(Ee-ue.height)>5)&&i()}},1e3),et=new window.MutationObserver(F=>{F.forEach(oe=>{oe.type==="attributes"&&oe.target===o&&oe.attributeName==="style"&&setTimeout(()=>{b.value&&D.value&&i()},100)})});et.observe(o,{attributes:!0,attributeFilter:["style","class"]});const tt=()=>{b.value&&D.value&&i()};t.defaultView.addEventListener("resize",tt),o._monitorInterval=Qe,o._mutationObserver=et,o._resizeHandler=tt,o._iframeDoc=t;const ot=setInterval(()=>{if(!b.value||!D.value){clearInterval(ot);return}i()},500);setTimeout(()=>{clearInterval(ot)},1e4)},Ut=()=>{var se,ee,_,X,pe;if(!b.value||!D.value)return;const t=y.value;if(!t)return;const e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=b.value,i=o.children[0],l=o.children[1],w=e.defaultView.getComputedStyle(o);(w.display==="none"||w.visibility==="hidden")&&(o.style.display="flex !important",o.style.visibility="visible !important");const p=i.children[0];if(V.value.showTitle){p.style.display="block";const S=((se=v.movieInfo)==null?void 0:se.title)||((ee=v.movieInfo)==null?void 0:ee.name_ru)||((_=v.movieInfo)==null?void 0:_.name_en)||((X=v.movieInfo)==null?void 0:X.name_original)||"–ó–∞–≥—Ä—É–∑–∫–∞...",N=(pe=v.movieInfo)!=null&&pe.year?" (".concat(v.movieInfo.year,")"):"";p.textContent=S+N,V.value.showBackground?(p.style.background="rgba(0, 0, 0, 0.7) !important",p.style.backdropFilter="blur(10px) !important",p.style.width="fit-content !important",p.style.display="inline-block !important"):(p.style.background="transparent !important",p.style.backdropFilter="none !important",p.style.width="auto !important",p.style.display="inline-block !important")}else p.style.display="none";const C=i.children[1];let G="";if(V.value.showDuration2){const S=Ge(Ot.value),N=Ge(Nt.value);G="\n      <span style=\"font-family: 'Courier New', monospace; color: rgba(255, 255, 255, 0.6);\">".concat(S,'</span>\n      <span style="opacity: 0.6;">/</span>\n      <span style="font-family: \'Courier New\', monospace; color: rgba(255, 255, 255, 0.6);">').concat(N,"</span>\n    ")}if(ce.value.enabled&&ce.value.showObsInOverlay){let S="–û—Ç–∫–ª—é—á–µ–Ω";const N="#999999";if(Se.value)if(ce.value.selectedFilterId){const ie=He.value.find(te=>te.id===ce.value.selectedFilterId);ie?S="".concat(ie.filterName," (").concat(ie.sceneName,")"):S="–§–∏–ª—å—Ç—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω"}else He.value.length>0?S="–§–∏–ª—å—Ç—Ä –Ω–µ –≤—ã–±—Ä–∞–Ω":S="–§–∏–ª—å—Ç—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã";const re='\n      <span style="color: '.concat(N,';">\n        OBS: ').concat(S,"\n      </span>\n    ");G=G?"".concat(G," ").concat(re):re}if(G?(C.style.display="flex",C.innerHTML=G,V.value.showBackground?(C.style.background="rgba(0, 0, 0, 0.7) !important",C.style.backdropFilter="blur(10px) !important",C.style.borderRadius="6px !important",C.style.padding="8px 12px !important",C.style.width="fit-content !important",C.style.display="inline-flex !important"):(C.style.background="transparent !important",C.style.backdropFilter="none !important",C.style.borderRadius="0 !important",C.style.padding="0 !important",C.style.width="auto !important",C.style.display="flex !important")):C.style.display="none",Ye.value.length>0){const S=l.children[0];S.innerHTML="";const N=e.createElement("span");N.textContent="–¢–∞–π–º–∏–Ω–≥–∏: ",N.style.color="rgba(255, 255, 255, 0.6)",S.appendChild(N),Ye.value.forEach((re,ie)=>{if(ie>0){const te=e.createElement("span");te.textContent=", ",te.style.color="rgba(255, 255, 255, 0.6)",S.appendChild(te)}re.intervals.forEach((te,q)=>{if(q>0){const fe=e.createElement("span");fe.textContent=", ",fe.style.color="rgba(255, 255, 255, 0.6)",S.appendChild(fe)}const le=e.createElement("span");le.textContent=te.text,te.status==="active"&&V.value.highlightTimings?(le.style.color="#ff4444",le.style.fontWeight="bold"):te.status==="upcoming"&&V.value.highlightTimings?(le.style.color="#ff6b35",le.style.fontWeight="500"):le.style.color="rgba(255, 255, 255, 0.6)",S.appendChild(le)})}),l.style.display="block",V.value.showTimingsOnMouseMove||(l.style.opacity="1",l.style.visibility="visible"),V.value.showBackground?(l.style.background="rgba(0, 0, 0, 0.7) !important",l.style.backdropFilter="blur(10px) !important",l.style.width="fit-content !important",l.style.minWidth="auto !important"):(l.style.background="transparent !important",l.style.backdropFilter="none !important",l.style.width="fit-content !important",l.style.minWidth="auto !important")}else l.style.display="none"},$e=()=>{if(b.value){try{b.value._monitorInterval&&clearInterval(b.value._monitorInterval),b.value._mutationObserver&&b.value._mutationObserver.disconnect(),b.value._resizeHandler&&b.value._iframeDoc&&b.value._iframeDoc.defaultView.removeEventListener("resize",b.value._resizeHandler),b.value._mouseHandler&&b.value._iframeDoc&&b.value._iframeDoc.removeEventListener("mousemove",b.value._mouseHandler),b.value.remove()}catch(t){console.log("Error removing overlay:",t)}b.value=null}Ce.value=!1,qe.value&&(clearTimeout(qe.value),qe.value=null)};Jt(()=>{if(Q.value=!0,lo(),W.value&&(Ae.value="4:3"),kt(),window.addEventListener("resize",kt),window.addEventListener("resize",ht),Xe.value&&Ze(),window.toggleCompressor=Dt,window.toggleMirror=_t,Wt(),window.connectToOBS=It,window.testOBSBlur=$o,window.refreshOBSFilters=Mo,window.getOBSFiltersInfo=Bo,window.testOBSConnection=Oo,window.debugOBS=()=>{var t;console.log("=== OBS Debug Info ==="),console.log("OBS Settings:",ce.value),console.log("OBS Connected:",Se.value),console.log("OBS Filters Found:",He.value),console.log("OBS WebSocket instance:",U.value),U.value&&(console.log("WebSocket state:",(t=U.value.ws)==null?void 0:t.readyState),console.log("Is Connected:",U.value.isConnected),console.log("Is Authenticated:",U.value.isAuthenticated))},ce.value.enabled&&It(),m.value&&(yt.value=setInterval(()=>{const t=window.overlayNudityTimings?window.overlayNudityTimings.length:0;t>rt.value?(rt.value=t,D.value||(D.value=!0,window.electronAPI&&window.electronAPI.showToast("–û–≤–µ—Ä–ª–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á—ë–Ω - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∞–π–º–∏–Ω–≥–∏"))):rt.value=t},1e3)),m.value&&D.value){const t=()=>{if(y.value&&!b.value)try{const e=y.value,o=e.contentDocument||e.contentWindow.document;if(o){const i=o.querySelector("video");if(i){const l=Date.now()-(window.iframeLoadTime||0);l>=3e3?We(o,i):setTimeout(t,3e3-l)}}}catch(e){console.log("Error initializing overlay on mount:",e),Ce.value=!1}};setTimeout(t,1e3)}}),Po(()=>{window.removeEventListener("resize",kt),window.removeEventListener("resize",ht),window.removeEventListener("mousemove",Ct),document.removeEventListener("keydown",St),document.body.classList.remove("no-scroll"),de.value&&clearInterval(de.value),ve.value&&clearInterval(ve.value),yt.value&&clearInterval(yt.value),$e(),ko(),Vt(),delete window.toggleCompressor,delete window.toggleMirror,delete window.connectToOBS,delete window.testOBSBlur,delete window.refreshOBSFilters,delete window.getOBSFiltersInfo,delete window.testOBSConnection,delete window.debugOBS,delete window.obsSources,delete window.obsFiltersFound});const Oo=async()=>U.value&&Se.value?await U.value.testConnection():{success:!1,error:"Not connected"};return(t,e)=>{var o,i,l,w,p,C,G,se,ee,_,X,pe,S,N,re,ie,te,q,le,fe,Le,je,Je,Et,Me,At,Qe,et,tt,ot,F,oe,ue,be,Ee,Be,nt,Te,st,mt,Ve,it;return h.value?(T(),$t(Lo,{key:0,message:h.value,code:M.value},null,8,["message","code"])):(T(),$(Oe,{key:1},[n("div",cn,[e[43]||(e[43]=n("span",null,"–ü–ª–µ–µ—Ä:",-1)),n("button",{class:"player-btn",onClick:ao},k(A.value?zt(A.value.translate).toUpperCase():"–ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–µ–µ—Ä–æ–≤..."),1)]),Ie.value?(T(),$t(an,{key:0,players:H.value,"selected-player":A.value,onClose:Lt,onSelect:xo},null,8,["players","selected-player"])):K("",!0),n("div",{ref_key:"containerRef",ref:we,class:B(["player-container",{"theater-mode":L.value}]),style:Gt(L.value?{}:so.value)},[n("div",{class:"iframe-wrapper",style:Gt(L.value?{}:io.value)},[Z(n("iframe",{ref_key:"playerIframe",ref:y,src:(o=A.value)==null?void 0:o.iframe,frameborder:"0",allowfullscreen:"",webkitallowfullscreen:"",class:B(["responsive-iframe",{"theater-mode-unlock":E.value,"theater-mode-lock":L.value,dimmed:vt.value}]),onLoad:ho},null,42,un),[[j,!Q.value&&((i=A.value)==null?void 0:i.iframe)]]),Q.value?(T(),$t(Vo,{key:0,text:"–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–ª–µ–µ—Ä: ".concat(A.value?zt(A.value.translate):"–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –ø–ª–µ–µ—Ä–æ–≤","\n–ï—Å–ª–∏ –ø–ª–µ–µ—Ä –Ω–µ –≥—Ä—É–∑–∏—Ç—Å—è, —Ç–æ —Å–º–µ–Ω–∏—Ç–µ –ø–ª–µ–µ—Ä –≤—ã—à–µ –∏–ª–∏ –≤–∫–ª—é—á–∏—Ç–µ VPN"),style:{"white-space":"pre-line"}},null,8,["text"])):K("",!0)],4),L.value?(T(),$("button",{key:0,class:B(["close-theater-btn",{visible:E.value}]),onClick:dt}," ‚úñ ",2)):K("",!0)],6),L.value?K("",!0):(T(),$("div",dn,[n("div",vn,[!W.value&&I.value?(T(),$("div",{key:0,ref_key:"tooltipContainer",ref:eo,class:"tooltip-container list-buttons-container","data-tooltip-container":"favorite"},[Tt.value?(T(),$("button",{key:0,class:B(["favorite-btn",{active:(w=(l=R.movieInfo)==null?void 0:l.lists)==null?void 0:w.isFavorite}]),onMouseenter:e[0]||(e[0]=d=>ne("favorite")),onMouseleave:bt,onClick:e[1]||(e[1]=d=>he(me(z).FAVORITE))},[n("span",pn,k((C=(p=R.movieInfo)==null?void 0:p.lists)!=null&&C.isFavorite?"favorite":"favorite_border"),1),n("span",{class:B(["material-icons dropdown-arrow",{highlighted:oo.value}])},"expand_more",2)],34)):K("",!0),Z(n("div",{ref_key:"tooltip",ref:to,class:"custom-tooltip advanced-tooltip list-buttons-dropdown","data-tooltip":"favorite",onMouseenter:wt,onMouseleave:ct},[n("div",mn,[n("button",{class:B(["favorite-btn",{active:(se=(G=R.movieInfo)==null?void 0:G.lists)==null?void 0:se.isFavorite}]),onClick:e[2]||(e[2]=d=>he(me(z).FAVORITE))},[n("span",fn,k((_=(ee=R.movieInfo)==null?void 0:ee.lists)!=null&&_.isFavorite?"favorite":"favorite_border"),1),e[44]||(e[44]=n("span",{class:"button-label"},"–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ",-1))],2)]),n("div",gn,[n("button",{class:B(["watching-btn",{active:(pe=(X=R.movieInfo)==null?void 0:X.lists)==null?void 0:pe.isWatching}]),onClick:e[3]||(e[3]=d=>he(me(z).WATCHING))},[n("span",yn,k((N=(S=R.movieInfo)==null?void 0:S.lists)!=null&&N.isWatching?"visibility":"visibility_off"),1),e[45]||(e[45]=n("span",{class:"button-label"},"–°–º–æ—Ç—Ä—é",-1))],2)]),n("div",hn,[n("button",{class:B(["later-btn",{active:(ie=(re=R.movieInfo)==null?void 0:re.lists)==null?void 0:ie.isLater}]),onClick:e[4]||(e[4]=d=>he(me(z).LATER))},e[46]||(e[46]=[n("span",{class:"material-icons"},"watch_later",-1),n("span",{class:"button-label"},"–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ",-1)]),2)]),n("div",bn,[n("button",{class:B(["completed-btn",{active:(q=(te=R.movieInfo)==null?void 0:te.lists)==null?void 0:q.isCompleted}]),onClick:e[5]||(e[5]=d=>he(me(z).COMPLETED))},[n("span",wn,k((fe=(le=R.movieInfo)==null?void 0:le.lists)!=null&&fe.isCompleted?"check_circle":"check_circle_outline"),1),e[47]||(e[47]=n("span",{class:"button-label"},"–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ",-1))],2)]),n("div",kn,[n("button",{class:B(["abandoned-btn",{active:(je=(Le=R.movieInfo)==null?void 0:Le.lists)==null?void 0:je.isAbandoned}]),onClick:e[6]||(e[6]=d=>he(me(z).ABANDONED))},[n("span",xn,k(((Et=(Je=R.movieInfo)==null?void 0:Je.lists)!=null&&Et.isAbandoned,"not_interested")),1),e[48]||(e[48]=n("span",{class:"button-label"},"–ë—Ä–æ—à–µ–Ω–æ",-1))],2)]),n("div",{class:"tooltip-hint"},[e[50]||(e[50]=n("span",{class:"material-icons"},"settings",-1)),n("span",null,[e[49]||(e[49]=Re("–°—Ç–∏–ª—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ ")),n("a",{class:"settings-link",onClick:Io},"–Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö")])])],544),[[j,x.value==="favorite"&&Tt.value]])],512)):K("",!0),W.value?K("",!0):(T(),$(Oe,{key:1},[n("div",Cn,[n("button",{class:B(["dimming-btn",{active:vt.value}]),onMouseenter:e[7]||(e[7]=d=>ne("dimming")),onMouseleave:e[8]||(e[8]=d=>x.value=null),onClick:mo},[n("span",Sn,k(vt.value?"light_mode":"dark_mode"),1)],34),Z(n("div",{class:"custom-tooltip","data-tooltip":"dimming"},k(vt.value?"–û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ":"–í–∫–ª—é—á–∏—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ"),513),[[j,x.value==="dimming"]])]),n("div",Tn,[n("button",{class:B(["blur-btn",{"electron-only":!m.value}]),onMouseenter:e[9]||(e[9]=d=>ne("blur")),onMouseleave:e[10]||(e[10]=d=>x.value=null),onClick:po},e[51]||(e[51]=[n("span",{class:"material-icons"},"blur_on",-1)]),34),Z(n("div",{class:"custom-tooltip","data-tooltip":"blur"},k(m.value?"–ë–ª—é—Ä":"–ë–ª—é—Ä, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[j,x.value==="blur"]])]),n("div",In,[n("button",{class:B(["material-symbols-outlined",{active:Pe.value,"electron-only":!m.value}]),onMouseenter:e[11]||(e[11]=d=>ne("compressor")),onMouseleave:e[12]||(e[12]=d=>x.value=null),onClick:Dt},e[52]||(e[52]=[n("span",{class:"material-icons"},"graphic_eq",-1)]),34),Z(n("div",{class:"custom-tooltip","data-tooltip":"compressor"},k(m.value?"–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä":"–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[j,x.value==="compressor"]])]),n("div",En,[n("button",{class:B(["mirror-btn",{active:ze.value,"electron-only":!m.value}]),onMouseenter:e[13]||(e[13]=d=>ne("mirror")),onMouseleave:e[14]||(e[14]=d=>x.value=null),onClick:_t},e[53]||(e[53]=[n("span",{class:"material-icons"},"flip",-1)]),34),Z(n("div",{class:"custom-tooltip","data-tooltip":"mirror"},k(m.value?"–ó–µ—Ä–∫–∞–ª–æ":"–ó–µ—Ä–∫–∞–ª–æ, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[j,x.value==="mirror"]])]),n("div",An,[n("button",{class:"theater-mode-btn",onMouseenter:e[15]||(e[15]=d=>ne("theater")),onMouseleave:e[16]||(e[16]=d=>x.value=null),onClick:dt},[n("span",$n,k(L.value?"fullscreen_exit":"aspect_ratio"),1)],32),Z(n("div",Mn,[Re(k(L.value?"–í—ã–π—Ç–∏ –∏–∑ —Ç–µ–∞—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞":"–¢–µ–∞—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º")+" ",1),e[54]||(e[54]=n("span",{class:"shortcut-hint"},"Alt+T",-1))],512),[[j,x.value==="theater"]])]),n("div",Bn,[n("button",{class:B(["pip-btn",{"electron-only":!m.value}]),onMouseenter:e[17]||(e[17]=d=>ne("pip")),onMouseleave:e[18]||(e[18]=d=>x.value=null),onClick:Eo},e[55]||(e[55]=[n("span",{class:"material-icons"},"picture_in_picture_alt",-1)]),34),Z(n("div",{class:"custom-tooltip","data-tooltip":"pip"},k(m.value?"–ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –∫–∞—Ä—Ç–∏–Ω–∫–µ":"–ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –∫–∞—Ä—Ç–∏–Ω–∫–µ, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[j,x.value==="pip"]])]),n("div",Rn,[n("button",{class:"aspect-ratio-dropdown-btn",onMouseenter:e[19]||(e[19]=d=>ne("aspect_ratio")),onMouseleave:bt,onClick:Co},[n("span",On,k(Ae.value),1)],32),Z(n("div",{class:"custom-tooltip advanced-tooltip aspect-ratio-dropdown","data-tooltip":"aspect_ratio",onMouseenter:wt,onMouseleave:ct},[(T(),$(Oe,null,lt(pt,d=>n("div",{key:d,class:B(["aspect-ratio-option",{active:Ae.value===d}]),onClick:vs=>Ht(d)},k(d),11,Nn)),64))],544),[[j,x.value==="aspect_ratio"]])]),n("div",{class:"tooltip-container","data-tooltip-container":"centering",onMouseenter:e[21]||(e[21]=d=>ne("centering")),onMouseleave:bt},[n("button",{class:"center-btn",onClick:Ze},e[56]||(e[56]=[n("span",{class:"material-icons"},"center_focus_strong",-1)])),Z(n("div",{class:"custom-tooltip advanced-tooltip","data-tooltip":"centering",onMouseenter:wt,onMouseleave:ct},[e[57]||(e[57]=Re(" –û—Ç—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–ª–µ–µ—Ä ")),Bt(Go,{modelValue:Xe.value,"onUpdate:modelValue":e[20]||(e[20]=d=>Xe.value=d),title:"–ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞"},null,8,["modelValue"]),e[58]||(e[58]=n("span",{class:"tooltip-title"},"–ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞",-1))],544),[[j,x.value==="centering"]])],32),!m.value&&I.value?(T(),$("div",Fn,[n("button",{class:"app-link-btn",onMouseenter:e[22]||(e[22]=d=>ne("app_link")),onMouseleave:e[23]||(e[23]=d=>x.value=null),onClick:bo},e[59]||(e[59]=[n("span",{class:"material-icons"},"open_in_new",-1)]),32),Z(n("div",Pn," –û—Ç–∫—Ä—ã—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ",512),[[j,x.value==="app_link"]])])):K("",!0),m.value?(T(),$("div",Ln,[n("button",{class:"copy-link-btn",onMouseenter:e[24]||(e[24]=d=>ne("copy_link")),onMouseleave:e[25]||(e[25]=d=>x.value=null),onClick:wo},e[60]||(e[60]=[n("span",{class:"material-icons"},"content_copy",-1)]),32),Z(n("div",Dn," –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É ",512),[[j,x.value==="copy_link"]])])):K("",!0),m.value?(T(),$("div",_n,[n("button",{class:B(["overlay-btn",{active:D.value}]),onMouseenter:e[26]||(e[26]=d=>ne("overlay")),onMouseleave:e[27]||(e[27]=d=>x.value=null),onClick:Ao},[n("span",qn,k(D.value?"layers":"layers_clear"),1)],34),Z(n("div",{class:"custom-tooltip","data-tooltip":"overlay"},k(D.value?"–°–∫—Ä—ã—Ç—å –æ–≤–µ—Ä–ª–µ–π –≤–∏–¥–µ–æ":"–ü–æ–∫–∞–∑–∞—Ç—å –æ–≤–µ—Ä–ª–µ–π –≤–∏–¥–µ–æ"),513),[[j,x.value==="overlay"]])])):K("",!0)],64))]),!W.value&&!Tt.value&&I.value?(T(),$("div",Hn,[n("div",zn,[n("button",{class:B(["favorite-btn",{active:(At=(Me=R.movieInfo)==null?void 0:Me.lists)==null?void 0:At.isFavorite}]),onMouseenter:e[28]||(e[28]=d=>ne("favorite")),onMouseleave:e[29]||(e[29]=d=>x.value=null),onClick:e[30]||(e[30]=d=>he(me(z).FAVORITE))},[n("span",Wn,k((et=(Qe=R.movieInfo)==null?void 0:Qe.lists)!=null&&et.isFavorite?"favorite":"favorite_border"),1)],34),Z(n("div",Vn,k("–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ"),512),[[j,x.value==="favorite"]])]),n("div",Un,[n("button",{class:B(["watching-btn",{active:(ot=(tt=R.movieInfo)==null?void 0:tt.lists)==null?void 0:ot.isWatching}]),onMouseenter:e[31]||(e[31]=d=>ne("watching")),onMouseleave:e[32]||(e[32]=d=>x.value=null),onClick:e[33]||(e[33]=d=>he(me(z).WATCHING))},[n("span",Gn,k((oe=(F=R.movieInfo)==null?void 0:F.lists)!=null&&oe.isWatching?"visibility":"visibility_off"),1)],34),Z(n("div",Kn,k("–°–º–æ—Ç—Ä—é"),512),[[j,x.value==="watching"]])]),n("div",Yn,[n("button",{class:B(["later-btn",{active:(be=(ue=R.movieInfo)==null?void 0:ue.lists)==null?void 0:be.isLater}]),onMouseenter:e[34]||(e[34]=d=>ne("later")),onMouseleave:e[35]||(e[35]=d=>x.value=null),onClick:e[36]||(e[36]=d=>he(me(z).LATER))},e[61]||(e[61]=[n("span",{class:"material-icons"},"watch_later",-1)]),34),Z(n("div",Xn,k("–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ"),512),[[j,x.value==="later"]])]),n("div",Zn,[n("button",{class:B(["completed-btn",{active:(Be=(Ee=R.movieInfo)==null?void 0:Ee.lists)==null?void 0:Be.isCompleted}]),onMouseenter:e[37]||(e[37]=d=>ne("completed")),onMouseleave:e[38]||(e[38]=d=>x.value=null),onClick:e[39]||(e[39]=d=>he(me(z).COMPLETED))},[n("span",jn,k((Te=(nt=R.movieInfo)==null?void 0:nt.lists)!=null&&Te.isCompleted?"check_circle":"check_circle_outline"),1)],34),Z(n("div",Jn,k("–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"),512),[[j,x.value==="completed"]])]),n("div",Qn,[n("button",{class:B(["abandoned-btn",{active:(mt=(st=R.movieInfo)==null?void 0:st.lists)==null?void 0:mt.isAbandoned}]),onMouseenter:e[40]||(e[40]=d=>ne("abandoned")),onMouseleave:e[41]||(e[41]=d=>x.value=null),onClick:e[42]||(e[42]=d=>he(me(z).ABANDONED))},[n("span",es,k(((it=(Ve=R.movieInfo)==null?void 0:Ve.lists)!=null&&it.isAbandoned,"not_interested")),1)],34),Z(n("div",ts,k("–ë—Ä–æ—à–µ–Ω–æ"),512),[[j,x.value==="abandoned"]])])])):K("",!0)])),Bt(Qt,{ref_key:"notificationRef",ref:De},null,512)],64))}}},ks=Rt(os,[["__scopeId","data-v-0430cfa4"]]),ns={class:"rating-container"},ss={class:"rating-display"},is={class:"rating-numbers"},ls=["onClick","onMouseenter"],as={key:0,class:"tooltip-footer"},rs={class:"rating-numbers mobile-rating-numbers"},cs=["onClick"],us={key:0,class:"mobile-modal-footer"},ds={__name:"MovieRating",props:{kpId:{type:String,required:!0},showDash:{type:Boolean,default:!1}},setup(R){const s=Zt(),a=jt(),r=R,u=c(null),g=c(null),P=c(null),I=c(null),v=c(0),O=c(!1),H=c(!1);let A=null;const Q=f=>f?f.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "):"0",L=()=>{A=setTimeout(()=>{O.value=!1,s.isMobile||(H.value=!1)},100)},E=()=>{A&&(clearTimeout(A),A=null),O.value=!0},y=()=>{s.isMobile&&(H.value=!H.value)},we=()=>{a.push("/login")},Ie=async()=>{try{const f=await Wo(r.kpId);g.value=f.user_rating,P.value=f.average_rating,I.value=Q(f.vote_count)}catch(f){console.error("Error loading rating:",f)}},h=async f=>{var Y;try{f===g.value?(await Yt(r.kpId,null),g.value=null,u.value.showNotification("–û—Ü–µ–Ω–∫–∞ —É–¥–∞–ª–µ–Ω–∞")):(await Yt(r.kpId,f),g.value=f,u.value.showNotification("–û—Ü–µ–Ω–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞")),s.isMobile&&(H.value=!1),Ie()}catch(W){console.error("Error setting rating:",W),((Y=W.response)==null?void 0:Y.status)===401?u.value.showNotification('–î–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:we}):u.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ—Ü–µ–Ω–∫–∏"),s.isMobile&&(H.value=!1)}},M=()=>{H.value=!1};return Jt(()=>{Ie()}),(f,Y)=>(T(),$("div",ns,[n("div",ss,[n("a",{href:"#",class:B(["rating-link",{"has-rating":g.value}]),onMouseenter:Y[0]||(Y[0]=W=>O.value=!0),onMouseleave:L,onClick:ft(y,["prevent"])},[Y[3]||(Y[3]=n("img",{src:Ko,alt:"ReYohoho",class:"rating-logo"},null,-1)),n("span",{class:B(["average-rating",me(zo)(P.value)])},k(P.value?P.value.toFixed(1).replace(/\.0$/,""):"‚Äî"),3)],34),Z(n("div",{class:"rating-tooltip",onMouseenter:E,onMouseleave:L},[n("div",is,[(T(),$(Oe,null,lt(10,W=>n("button",{key:W,class:B(["number-btn",{active:W===g.value,hover:W===v.value,"average-highlight":P.value&&W<=Math.round(P.value)}]),onClick:m=>h(W),onMouseenter:m=>v.value=W,onMouseleave:Y[1]||(Y[1]=m=>v.value=0)},k(W),43,ls)),64))]),I.value?(T(),$("div",as,"–û—Ü–µ–Ω–æ–∫: "+k(I.value),1)):K("",!0)],544),[[j,(O.value||H.value)&&!me(s).isMobile]])]),Bt(Qt,{ref_key:"notificationRef",ref:u},null,512),me(s).isMobile&&H.value?(T(),$("div",{key:0,class:"mobile-modal-overlay",onClick:M},[n("div",{class:"mobile-modal",onClick:Y[2]||(Y[2]=ft(()=>{},["stop"]))},[n("div",{class:"mobile-modal-header"},[Y[4]||(Y[4]=n("h3",null,"–û—Ü–µ–Ω–∏—Ç—å —Ñ–∏–ª—å–º",-1)),n("button",{class:"close-button",onClick:M},"√ó")]),n("div",rs,[(T(),$(Oe,null,lt(10,W=>n("button",{key:W,class:B(["number-btn",{active:W===g.value,"average-highlight":P.value&&W<=Math.round(P.value)}]),onClick:m=>h(W)},k(W),11,cs)),64))]),I.value?(T(),$("div",us,"–û—Ü–µ–Ω–æ–∫: "+k(I.value),1)):K("",!0)])])):K("",!0)]))}},xs=Rt(ds,[["__scopeId","data-v-2df64bd5"]]);export{xs as M,ks as P,bs as _,ws as a};
