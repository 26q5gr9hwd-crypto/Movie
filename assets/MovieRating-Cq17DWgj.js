import{_ as Rt,r as c,c as ee,b as $,d as C,e as n,m as Ne,t as w,O as Fe,g as X,P as lt,n as R,l as ft,u as Zt,q as Ro,N as Oo,B as jt,x as Ke,o as Jt,S as No,k as $t,E as Fo,f as Bt,Z as Kt,p as J,V as Q,A as me,U as W,am as Po,an as Lo,G as Gt,X as Mt,af as Do,ad as _o,a7 as qo,ao as Ho,ap as Yt}from"./index-D5enEYNC.js";import{S as zo}from"./SpinnerLoading-BIva3oFp.js";import{N as Qt}from"./ToastMessage-mQNvr4yy.js";import{u as Vo,S as Wo}from"./player-Cezz4aI9.js";import{p as Xt,b as Oe}from"./dateUtils-B7qr26DJ.js";import{_ as Uo}from"./icon-imdb-logo-5qtstUwS.js";const ys="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVR4nO2ZQUoDMRSGR7eewHoFsVS0HkUUXNXqASqK2EURBPFIVRe6c+UN1CvUXWvbT4KvMAwzNnnJdCrmg1BKad7/v7y0b5IkiUQiCwGoAx3gQjEugZ0qxTeAIX6MKjMBnBOGS62AVWAPOHVYdlMu9YArYOhphLeBT+ALmOKGEd2QubaAK+B2zngFxt4GgDXgGZjgR8ch5oEkCi8DkvlnRcYLV0Apfqw10M7JvPkV6AN3FmVwK+WyZRnvMEe8ef/ibECyb2o+zRuwnpQAxeLNivQ0BvYyE46qEJ/8fK4ycJKp/X4V4n0MdDNfukkqEO9jwP1LDgD7BeKPgmgp04CL+KUz4Cp+qQxoxC+NAdsNm4c0hWkukkUa8BGfegiadbFDq3/2UAZ8xc+QVvzMtqcKYkBaZ5/MN5xEl2DgLGDZ1KswsC09FPJqXTZoNm5oA6kyMGI2FxqfkluJ0uMTDfhBXAHiHvCCWEL8/RLqlv1MPCf+TSZ+13WC7KnEfWlqcwAeU7GNjnbiQsG5UC1ZAEAt1UMhOpquk6zknMy9l20C2AA+MnEHRo9msuOCs9EH4Fp5TVQ0rqVs0plH4re02Qh1Oq1lCjypsp+5H3gKcD/gykTirqnFZ/ZDy+OGxpapzD+QePrM/2KkKfcGPcv7AdvRkz23G1x4JPIP+AY3r/ywUk/2JAAAAABJRU5ErkJggg==",hs="/reyohoho/assets/icon-shikimori-DGvXK9Jc.svg",Ge=N=>{const s=document.createElement("div");s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.style.backgroundColor="rgba(0, 0, 0, 0.8)",s.style.color="white",s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.style.fontSize="2rem",s.style.zIndex="99000",s.textContent=N,document.body.appendChild(s),setTimeout(()=>{document.body.removeChild(s)},2e3)},Ko={key:0},Go={key:1},Yo={class:"players-list"},Xo=["onClick"],Zo={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},jo={key:0},Jo={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},Qo={key:1},en={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},tn=["onClick"],on={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},nn={__name:"PlayerModal",props:{players:{type:Array,required:!0},selectedPlayer:{type:Object,default:null}},emits:["close","select"],setup(N,{emit:s}){const a=N,r=s,u=c(null),y=ee(()=>a.players.filter(h=>!v(h)&&!F(h))),L=ee(()=>a.players.some(h=>v(h))),S=ee(()=>a.players.some(h=>F(h))),v=h=>h.key.toUpperCase().includes("HDREZKA"),F=h=>h.key.toUpperCase().includes("KODIK"),V=h=>h.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"").trim(),A=h=>{r("select",h),r("close")},te=h=>a.selectedPlayer&&a.selectedPlayer.key===h.key,D=h=>a.selectedPlayer?h==="hdrezka"&&v(a.selectedPlayer)||h==="kodik"&&F(a.selectedPlayer):!1,I=h=>{u.value=h},T=()=>{u.value=null},ke=h=>{let M=a.players.filter(g=>h==="hdrezka"&&v(g)||h==="kodik"&&F(g));return h==="kodik"?M.sort((g,Z)=>V(g.translate).localeCompare(V(Z.translate))):M},Te=h=>ke(h).some(M=>M.warning);return(h,M)=>(C(),$("div",{class:"modal",onClick:M[4]||(M[4]=ft(g=>h.$emit("close"),["self"]))},[n("div",{class:"modal-content",onClick:M[3]||(M[3]=ft(()=>{},["stop"]))},[n("button",{class:"close",onClick:M[0]||(M[0]=g=>h.$emit("close"))},"√ó"),u.value?(C(),$("h2",Go,[n("button",{class:"back-btn",onClick:T},"‚Üê –ù–∞–∑–∞–¥"),Ne(" "+w(u.value==="hdrezka"?"ReYohoho - HDrezka":"Kodik"),1)])):(C(),$("h2",Ko,"–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–µ–µ—Ä")),n("ul",Yo,[u.value?(C(!0),$(Fe,{key:1},lt(ke(u.value),g=>(C(),$("li",{key:g.key},[n("button",{class:R(["player-item",{active:te(g)}]),onClick:Z=>A(g)},[Ne(w(V(g.translate))+" ",1),g.warning?(C(),$("span",on,"warning")):X("",!0)],10,tn)]))),128)):(C(),$(Fe,{key:0},[(C(!0),$(Fe,null,lt(y.value,g=>(C(),$("li",{key:g.key},[n("button",{class:R(["player-item",{active:te(g)}]),onClick:Z=>A(g)},[Ne(w(V(g.translate))+" ",1),g.warning?(C(),$("span",Zo,"warning")):X("",!0)],10,Xo)]))),128)),L.value?(C(),$("li",jo,[n("button",{class:R(["group-item",{active:D("hdrezka")}]),onClick:M[1]||(M[1]=g=>I("hdrezka"))},[M[5]||(M[5]=n("span",{class:"material-icons group-icon"},"folder",-1)),M[6]||(M[6]=Ne(" ReYohoho - HDrezka ")),Te("hdrezka")?(C(),$("span",Jo,"warning")):X("",!0)],2)])):X("",!0),S.value?(C(),$("li",Qo,[n("button",{class:R(["group-item",{active:D("kodik")}]),onClick:M[2]||(M[2]=g=>I("kodik"))},[M[7]||(M[7]=n("span",{class:"material-icons group-icon"},"folder",-1)),M[8]||(M[8]=Ne(" Kodik ")),Te("kodik")?(C(),$("span",en,"warning")):X("",!0)],2)])):X("",!0)],64))])])]))}},sn=Rt(nn,[["__scopeId","data-v-8b8d2b67"]]);class ln{constructor(){this.ws=null,this.isConnected=!1,this.isAuthenticated=!1,this.messageId=0,this.sources=new Map,this.filtersFound=new Map,this.pendingRequests=new Map,this.callbacks={onConnect:null,onDisconnect:null,onSourcesUpdated:null,onFiltersFound:null,onError:null},this.BLUR_FILTER_NAME="reyohoho"}generateMessageId(){return++this.messageId}setCallbacks(s){this.callbacks=s}async connect(s="localhost",a=4455,r=""){return new Promise((u,y)=>{const L="ws://".concat(s,":").concat(a);console.log("Connecting to OBS WebSocket at ".concat(L)),this.ws=new WebSocket(L),this.ws.onopen=async()=>{var S,v;console.log("WebSocket connection opened");try{const F=await this.authenticate(r);console.log("Authentication response:",F),F.success?(console.log("Successfully authenticated to OBS"),(v=(S=this.callbacks).onConnect)==null||v.call(S),this.loadSourcesAndSearchFilters(),u()):(console.error("Authentication failed"),y(new Error("Authentication failed")))}catch(F){console.error("Error during authentication:",F),y(F)}},this.ws.onmessage=S=>{this.handleMessage(JSON.parse(S.data))},this.ws.onclose=()=>{var S,v;console.log("WebSocket connection closed"),(v=(S=this.callbacks).onDisconnect)==null||v.call(S)},this.ws.onerror=S=>{var v,F;console.error("WebSocket error:",S),(F=(v=this.callbacks).onError)==null||F.call(v,S.message||"Connection error"),y(S)}})}disconnect(){if(this.ws&&(this.ws.close(),this.ws=null),this.pendingRequests){for(const[,{reject:s}]of this.pendingRequests.entries())s(new Error("Connection closed"));this.pendingRequests.clear()}this.sources.clear(),this.filtersFound.clear()}sendRequest(s,a={}){return new Promise((r,u)=>{if(!this.isConnected||!this.ws){console.warn("No connection to OBS"),u(new Error("No connection to OBS"));return}const y=this.generateMessageId().toString(),L={op:6,d:{requestType:s,requestId:y,requestData:a}};console.log("Sending OBS request: ".concat(s),a),this.pendingRequests.set(y,{resolve:r,reject:u}),this.ws.send(JSON.stringify(L)),setTimeout(()=>{this.pendingRequests&&this.pendingRequests.has(y)&&(this.pendingRequests.delete(y),u(new Error("Request ".concat(s," timed out"))))},1e4)})}handleMessage(s){switch(s.op){case 0:this.handleHello(s.d);break;case 2:this.handleIdentified();break;case 7:this.handleRequestResponse(s.d);break;case 5:this.handleEvent(s.d);break;default:console.log("Unknown OBS message: op=".concat(s.op))}}authenticate(s=""){return new Promise(a=>{this.password=s,this.authResolve=a})}async handleHello(s){console.log("Received OBS hello"),this.isConnected=!0;const a={op:1,d:{rpcVersion:1}};if(s.authentication&&this.password)try{const r=new TextEncoder,u=await crypto.subtle.digest("SHA-256",r.encode(this.password+s.authentication.salt)),y=Array.from(new Uint8Array(u)),L=btoa(String.fromCharCode(...y)),S=await crypto.subtle.digest("SHA-256",r.encode(L+s.authentication.challenge)),v=Array.from(new Uint8Array(S)),F=btoa(String.fromCharCode(...v));a.d.authentication=F}catch(r){console.error("Authentication error:",r)}this.ws.send(JSON.stringify(a))}handleIdentified(){console.log("OBS authentication successful"),this.isAuthenticated=!0,this.authResolve&&(this.authResolve({success:!0}),this.authResolve=null)}handleRequestResponse(s){const{requestId:a,requestType:r,requestStatus:u,responseData:y}=s;if(console.log("Received response for ".concat(r,":"),{success:u.result,code:u.code,comment:u.comment}),!this.pendingRequests){console.warn("No pending requests map");return}const L=this.pendingRequests.get(a);if(!L){console.warn("No pending request found for ID: ".concat(a));return}this.pendingRequests.delete(a),u.result?(console.log("Request ".concat(r," successful"),y),L.resolve(y)):(console.error("Request ".concat(r," failed:"),u.comment),L.reject(new Error("".concat(r," failed: ").concat(u.comment))))}handleFilterListResponse(s){const a=s.sourceName,u=(s.filters||[]).find(y=>y.filterName.toLowerCase()===this.BLUR_FILTER_NAME.toLowerCase());u&&(this.foundFilters.set(a,{sourceName:a,filterName:u.filterName,enabled:u.filterEnabled}),console.log("Found reyohoho filter in source: ".concat(a))),this.checkSearchComplete()}checkSearchComplete(){setTimeout(()=>{var s,a;console.log("Search complete. Found ".concat(this.foundFilters.size," reyohoho filters")),(a=(s=this.callbacks).onFiltersFound)==null||a.call(s,Array.from(this.foundFilters.values()))},500)}handleEvent(s){console.log("OBS event: ".concat(s.eventType))}async testConnection(){try{console.log("Testing OBS connection...");const s=await this.sendRequest("GetVersion");return console.log("OBS connection test successful:",s),{success:!0,version:s}}catch(s){return console.error("OBS connection test failed:",s),{success:!1,error:s.message}}}async loadSourcesAndSearchFilters(){var s,a,r,u,y,L,S,v,F,V;try{console.log("Loading sources and searching for filters...");try{const I=await this.sendRequest("GetVersion");console.log("OBS version info:",I)}catch(I){console.warn("Could not get OBS version:",I)}console.log("Requesting scene list...");const A=await this.sendRequest("GetSceneList");if(console.log("Raw scenes response:",A),!A||!A.scenes){console.error("Invalid scenes response structure:",A),(a=(s=this.callbacks).onError)==null||a.call(s,"Invalid response from OBS - no scenes data");return}console.log("Found scenes:",A.scenes.length),console.log("Requesting input list...");const te=await this.sendRequest("GetInputList");if(console.log("Raw inputs response:",te),!te||!te.inputs){console.error("Invalid inputs response structure:",te),(u=(r=this.callbacks).onError)==null||u.call(r,"Invalid response from OBS - no inputs data");return}console.log("Found inputs:",te.inputs.length),this.sources.clear(),this.filtersFound.clear();for(const I of A.scenes)if(console.log("Checking scene: ".concat(I.sceneName," with ").concat(I.sceneItems?I.sceneItems.length:0," items")),I.sceneItems&&Array.isArray(I.sceneItems))for(const T of I.sceneItems)T.sourceName&&(this.sources.set(T.sourceName,{sceneName:I.sceneName,sourceId:T.sceneItemId,sourceName:T.sourceName}),await this.searchFiltersInSource(T.sourceName,I.sceneName));for(const I of te.inputs)console.log("Checking input: ".concat(I.inputName)),this.sources.has(I.inputName)||this.sources.set(I.inputName,{sceneName:"Direct Input",sourceId:null,sourceName:I.inputName}),await this.searchFiltersInSource(I.inputName,"Direct Input");const D=Array.from(this.filtersFound.values());console.log("Total filters found:",D.length),D.forEach(I=>{console.log("- ".concat(I.sourceName,": ").concat(I.filterName," (").concat(I.enabled?"enabled":"disabled",")"))}),(L=(y=this.callbacks).onFiltersFound)==null||L.call(y,D),(v=(S=this.callbacks).onSourcesUpdated)==null||v.call(S,Array.from(this.sources.values()))}catch(A){console.error("Error loading sources:",A),console.error("Error stack:",A.stack),(V=(F=this.callbacks).onError)==null||V.call(F,"Error loading sources: ".concat(A.message))}}async searchFiltersInSource(s,a){try{console.log("Searching filters in source: ".concat(s));const r=await this.sendRequest("GetSourceFilterList",{sourceName:s});console.log("Source ".concat(s," has ").concat(r.filters.length," filters"));for(const u of r.filters){console.log("  Filter: ".concat(u.filterName," (").concat(u.filterEnabled?"enabled":"disabled",")"));const y="".concat(s,"::").concat(u.filterName);this.filtersFound.set(y,{id:y,sourceName:s,sceneName:a,filterName:u.filterName,enabled:u.filterEnabled})}}catch(r){console.warn("Could not get filters for source ".concat(s,":"),r)}}async enableBlur(s){var r,u;if(!s){console.warn("No filter selected for blur");return}const a=this.filtersFound.get(s);if(!a){console.warn("Selected filter not found:",s);return}try{await this.sendRequest("SetSourceFilterEnabled",{sourceName:a.sourceName,filterName:a.filterName,filterEnabled:!0}),a.enabled=!0,console.log("Enabled blur filter: ".concat(a.sourceName,"::").concat(a.filterName))}catch(y){(u=(r=this.callbacks).onError)==null||u.call(r,"Error enabling filter: ".concat(y.message))}}async disableBlur(s){var r,u;if(!s){console.warn("No filter selected for blur");return}const a=this.filtersFound.get(s);if(!a){console.warn("Selected filter not found:",s);return}try{await this.sendRequest("SetSourceFilterEnabled",{sourceName:a.sourceName,filterName:a.filterName,filterEnabled:!1}),a.enabled=!1,console.log("Disabled blur filter: ".concat(a.sourceName,"::").concat(a.filterName))}catch(y){(u=(r=this.callbacks).onError)==null||u.call(r,"Error disabling filter: ".concat(y.message))}}async testBlur(s,a=2e3){if(!s){console.warn("No filter selected for test");return}await this.enableBlur(s),setTimeout(()=>{this.disableBlur(s)},a)}getFilterById(s){return this.filtersFound.get(s)}getAllFilters(){return Array.from(this.filtersFound.values())}}const an={class:"players-list"},rn=["src"],cn={key:1,class:"controls"},un={class:"main-controls"},dn={class:"material-icons"},vn={class:"list-button-item"},pn={class:"material-icons"},mn={class:"list-button-item"},fn={class:"material-icons"},gn={class:"list-button-item"},yn={class:"list-button-item"},hn={class:"material-icons"},bn={class:"list-button-item"},wn={class:"material-icons"},kn={class:"tooltip-container","data-tooltip-container":"dimming"},xn={class:"material-icons"},Cn={class:"tooltip-container","data-tooltip-container":"blur"},Sn={class:"tooltip-container","data-tooltip-container":"compressor"},In={class:"tooltip-container","data-tooltip-container":"mirror"},Tn={class:"tooltip-container","data-tooltip-container":"theater"},En={class:"material-symbols-outlined"},An={class:"custom-tooltip","data-tooltip":"theater"},$n={class:"tooltip-container","data-tooltip-container":"pip"},Mn={class:"tooltip-container","data-tooltip-container":"aspect_ratio"},Bn={class:"current-ratio"},Rn=["onClick"],On={key:0,class:"tooltip-container","data-tooltip-container":"app_link"},Nn={class:"custom-tooltip","data-tooltip":"app_link"},Fn={key:1,class:"tooltip-container","data-tooltip-container":"copy_link"},Pn={class:"custom-tooltip","data-tooltip":"copy_link"},Ln={key:2,class:"tooltip-container","data-tooltip-container":"overlay"},Dn={class:"material-icons"},_n={key:0,class:"desktop-list-buttons"},qn={class:"tooltip-container"},Hn={class:"material-icons"},zn={class:"custom-tooltip"},Vn={class:"tooltip-container"},Wn={class:"material-icons"},Un={class:"custom-tooltip"},Kn={class:"tooltip-container"},Gn={class:"custom-tooltip"},Yn={class:"tooltip-container"},Xn={class:"material-icons"},Zn={class:"custom-tooltip"},jn={class:"tooltip-container"},Jn={class:"material-icons"},Qn={class:"custom-tooltip"},es={__name:"PlayerComponent",props:{kpId:String,movieInfo:{type:Object,default:()=>({})}},emits:["update:selectedPlayer","update:movieInfo"],setup(N,{emit:s}){const a=Zt(),r=Vo(),u=Ro(),y=Oo(),L=jt(),S=c(y.params.kp_id),v=N,F=s,V=c([]),A=c(null),te=c(!0),D=c(!1),I=c(!1),T=c(null),ke=c(null),Te=c(!1),h=c(""),M=c(null),g=c(window.innerHeight*.9),Z=ee(()=>"".concat(g.value,"px")),U=ee(()=>a.isMobile),f=ee(()=>!!window.electronAPI),k=c(null),at=c(!1);let gt=null;const qe=c(null),eo=c(null),to=c(null),ve=c(null),He=c(!1),ge=c(!1),pe=c(null),yt=c(null),rt=c(0),ae=c(null),xe=c(null),ye=c(null),Pe=c(null),Le=c(null),Ce=c(null),_=ee({get:()=>r.videoOverlayEnabled,set:t=>r.updateVideoOverlay(t)}),Y=ee({get:()=>r.overlaySettings,set:t=>r.updateOverlaySettings(t)}),Ot=c(0),Nt=c(0),Ye=c([]),b=c(null),ze=c(null),Se=c(!1),K=c(null),he=c(!1),Ft=c([]),Ve=c([]),re=ee({get:()=>r.obsSettings,set:t=>r.updateObsSettings(t)}),ht=t=>{const e=document.querySelector('[data-tooltip-container="'.concat(t,'"]')),o=document.querySelector('[data-tooltip="'.concat(t,'"]'));if(!e||!o)return;const l=e.getBoundingClientRect(),i=o.getBoundingClientRect(),m=window.innerHeight;l.bottom+i.height>m?(o.style.top="auto",o.style.bottom="100%",o.style.marginTop="0",o.style.marginBottom="12px",o.style.transform="translateX(-50%)"):(o.style.top="100%",o.style.bottom="auto",o.style.marginTop="12px",o.style.marginBottom="0",o.style.transform="translateX(-50%)")},ie=t=>{k.value=t,at.value=!1,clearTimeout(gt),Mt(()=>{ht(t)})},bt=()=>{at.value||(gt=setTimeout(()=>{k.value=null},300))},wt=()=>{at.value=!0,clearTimeout(gt)},ct=()=>{at.value=!1,k.value=null},Ae=ee({get:()=>r.aspectRatio,set:t=>r.updateAspectRatio(t)}),Xe=ee({get:()=>r.isCentered,set:t=>r.updateCentering(t)}),oo=ee(()=>{var t,e,o,l,i,m,p,x,G,le;return((e=(t=v.movieInfo)==null?void 0:t.lists)==null?void 0:e.isFavorite)||((l=(o=v.movieInfo)==null?void 0:o.lists)==null?void 0:l.isWatching)||((m=(i=v.movieInfo)==null?void 0:i.lists)==null?void 0:m.isLater)||((x=(p=v.movieInfo)==null?void 0:p.lists)==null?void 0:x.isCompleted)||((le=(G=v.movieInfo)==null?void 0:G.lists)==null?void 0:le.isAbandoned)}),Pt=ee(()=>r.preferredPlayer),no=c(0),ut=t=>t.toUpperCase(),kt=()=>{if(D.value||!ke.value)return;const[t,e]=Ae.value.split(":").map(Number);g.value=window.innerHeight*.9,no.value=Math.min(ke.value.clientWidth*(e/t),g.value)},so=ee(()=>{if(D.value)return{};const[t,e]=Ae.value.split(":").map(Number),o=g.value*(t/e);return{width:"100%",maxWidth:"".concat(o,"px"),maxHeight:Z.value,margin:"0 auto",overflow:"hidden"}}),io=ee(()=>{const[t,e]=Ae.value.split(":").map(Number);return{position:"relative",width:"100%",paddingTop:"".concat(e/t*100,"%")}}),Ze=()=>{ke.value&&setTimeout(()=>{Mt(()=>{ke.value.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},500)},lo=async()=>{try{h.value="",M.value=null;let t;if(v.kpId.startsWith("shiki")){const e=v.kpId.replace("shiki","");t=await Po(e)}else t=await Lo(v.kpId);if(V.value=Object.entries(t).map(([e,o])=>({key:e.toUpperCase(),...o})),V.value.length>0){if(Pt.value){const e=ut(Pt.value),o=V.value.find(l=>ut(l.key)===e);A.value=o||V.value[0]}else A.value=V.value[0];F("update:selectedPlayer",A.value)}}catch(t){const{message:e,code:o}=Gt(t);h.value=e,M.value=o,console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–ª–µ–µ—Ä–æ–≤:",t)}},ao=()=>{Te.value=!0},Lt=()=>{Te.value=!1},ro=()=>{try{return ae.value||(ae.value=new(window.AudioContext||window.webkitAudioContext)),xe.value||(xe.value=ae.value.createDynamicsCompressor(),xe.value.threshold.value=-50,xe.value.knee.value=40,xe.value.ratio.value=12,xe.value.attack.value=0,xe.value.release.value=.25,Pe.value=ae.value.createGain(),Le.value=ae.value.createGain(),Pe.value.gain.value=0,Le.value.gain.value=1,xe.value.connect(Pe.value),Pe.value.connect(ae.value.destination),Le.value.connect(ae.value.destination)),!0}catch(t){return console.log("Error initializing audio context:",t),!1}},co=async t=>{try{if(!ae.value||Ce.value===t)return!0;const e=T.value,o=(e==null?void 0:e.src)||"";if(o.includes("videoframe")||o.includes("kinoserial.net")||o.includes("allarknow"))return console.log("Player detected as unsupported for compressor:",o),Ce.value=t,ye.value=null,ge.value=!1,f.value&&window.electronAPI.showToast("–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —ç—Ç–∏–º –ø–ª–µ–µ—Ä–æ–º"),!1;if(ye.value)try{ye.value.disconnect()}catch(i){}const l=async(i=0)=>{i>0&&await new Promise(m=>setTimeout(m,i));try{return ye.value=ae.value.createMediaElementSource(t),Ce.value=t,ye.value.connect(xe.value),ye.value.connect(Le.value),console.log("Video audio setup completed (attempt with ".concat(i,"ms delay)")),!0}catch(m){if(m.name==="InvalidStateError"&&m.message.includes("already connected"))return console.log("MediaElementSource already connected (".concat(i,"ms delay attempt)")),!1;throw m}};return await l(0)||await l(100)||await l(300)||await l(800)?!0:(console.log("Video element has internal audio processing, compressor not available for this player"),Ce.value=t,ye.value=null,ge.value=!1,f.value&&window.electronAPI.showToast("–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —ç—Ç–∏–º –ø–ª–µ–µ—Ä–æ–º"),!1)}catch(e){return console.log("Error setting up video audio:",e),!1}},xt=async t=>{if(T.value)try{const e=T.value,o=e.contentDocument||e.contentWindow.document;if(!o)return;const l=o.querySelectorAll("video");if(l.length===0)return;const i=l[0];if(!ro())return;if(!await co(i)||!ye.value){console.log("Compressor not available for this player");return}t&&!ge.value?(Pe.value.gain.setValueAtTime(1,ae.value.currentTime),Le.value.gain.setValueAtTime(0,ae.value.currentTime),ge.value=!0,f.value&&window.electronAPI.showToast("–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –≤–∫–ª—é—á—ë–Ω"),console.log("Compressor enabled")):!t&&ge.value&&(Pe.value.gain.setValueAtTime(0,ae.value.currentTime),Le.value.gain.setValueAtTime(1,ae.value.currentTime),ge.value=!1,f.value&&window.electronAPI.showToast("–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –æ—Ç–∫–ª—é—á—ë–Ω"),console.log("Compressor disabled"))}catch(e){console.log("Compressor error:",e),f.value&&window.electronAPI.showToast("–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞")}},uo=()=>{f.value?window.electronAPI.sendHotKey("F2"):(Ge("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},Dt=()=>{f.value?(De.value=!De.value,xt(De.value)):(Ge("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},_t=()=>{f.value?(We.value=!We.value,po(We.value)):(Ge("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},dt=()=>{D.value=!D.value,D.value?(window.addEventListener("mousemove",Ct),document.addEventListener("keydown",St),document.body.classList.add("no-scroll")):(window.removeEventListener("mousemove",Ct),document.removeEventListener("keydown",St),document.body.classList.remove("no-scroll")),I.value=D.value,Mt(()=>Ze())},qt=c(null),Ct=()=>{qt.value=setTimeout(()=>{clearTimeout(qt.value),I.value=!1},4e3),I.value=!0},vt=ee(()=>a.dimmingEnabled),vo=()=>{D.value||a.toggleDimming()},De=ee({get:()=>r.compressorEnabled,set:t=>r.updateCompressor(t)}),We=ee({get:()=>r.mirrorEnabled,set:t=>r.updateMirror(t)}),po=t=>{if(T.value)try{const e=T.value,o=e.contentDocument||e.contentWindow.document;if(!o)return;const l=o.querySelectorAll("video");if(l.length>0&&(l.forEach(i=>{t?i.style.transform="scaleX(-1)":i.style.transform="scaleX(1)"}),He.value=t,f.value)){const i=t?"–ó–µ—Ä–∫–∞–ª–æ –≤–∫–ª—é—á–µ–Ω–æ":"–ó–µ—Ä–∫–∞–ª–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ";window.electronAPI.showToast(i)}}catch(e){}},mo=()=>{ve.value&&clearInterval(ve.value),ve.value=setInterval(()=>{if(T.value)try{const t=T.value,e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=e.querySelectorAll("video");if(o.length>0){const l=o[0],m=l.style.transform==="scaleX(-1)";We.value&&!m?(l.style.transform="scaleX(-1)",He.value=!0):!We.value&&m&&(l.style.transform="scaleX(1)",He.value=!1),Ce.value!==l?(Ce.value=null,ge.value=!1,De.value&&setTimeout(()=>{xt(!0)},500)):De.value!==ge.value&&ye.value&&(console.log("Compressor state mismatch, reapplying"),xt(De.value))}}catch(t){}},1e3)},fo=(t=!1)=>{if(!f.value)return;pe.value&&clearInterval(pe.value);let e=!1,o=[];function l(){var i;if(o=[],window.selectedNudityTimings&&Array.isArray(window.selectedNudityTimings)&&((i=v.movieInfo)!=null&&i.nudity_timings)){for(const m of v.movieInfo.nudity_timings)if(window.selectedNudityTimings.includes(m.id)){const p=Xt(m.timing_text);p&&p.length>0&&o.push(...p)}}}l(),pe.value=setInterval(()=>{var i,m,p;if(T.value){l();try{const x=T.value,G=x.contentDocument||x.contentWindow.document;if(!G)return;const le=G.querySelectorAll("video");if(le.length>0){const oe=le[0];if(Ot.value=oe.currentTime||0,Nt.value=oe.duration||0,f.value&&_.value&&!b.value&&!Se.value&&Date.now()-(window.iframeLoadTime||0)>=3e3)try{$e(G,oe)}catch(j){console.log("Error creating overlay:",j),Se.value=!1}if(f.value&&!_.value&&b.value&&setTimeout(()=>{!_.value&&b.value&&Me()},100),f.value&&((i=v.movieInfo)!=null&&i.nudity_timings)){const O=oe.currentTime,j=[],ue=[],E=re.value.enabled&&he.value;if(window.overlayNudityTimings&&Array.isArray(window.overlayNudityTimings)&&window.overlayNudityTimings.length>0){for(const B of v.movieInfo.nudity_timings)if(window.overlayNudityTimings.includes(B.id)){const ne=Xt(B.timing_text);if(ne&&ne.length>0){const ce=[];if(E)for(const[H,q]of ne){let z="normal";E&&O>=H&&O<=q?(z="active",ue.push(B.id)):E&&H>O&&H-O<=20&&(z="upcoming"),ce.push({text:"[".concat(Oe(H),"-").concat(Oe(q),"]"),status:z})}else for(const[H,q]of ne){let z="normal";O>=H&&O<=q?(z="active",ue.push(B.id)):H>O&&H-O<=20&&(z="upcoming"),ce.push({text:"[".concat(Oe(H),"-").concat(Oe(q),"]"),status:z})}j.push({id:B.id,intervals:ce})}}}Ye.value=j}if(f.value&&b.value&&_.value&&Ut(),!oe.paused){const O=oe.currentTime,j=oe.duration,ue=j>0?O/j*100:0;if(t&&(console.log("Video position: ".concat(O.toFixed(2),"s / ").concat(j.toFixed(2),"s (").concat(ue.toFixed(1),"%)")),o.length>0)){const B=o.map(([ne,ce])=>"".concat(Oe(ne)," - ").concat(Oe(ce))).join(", ");console.log("Active blur intervals: [".concat(B,"]"))}let E=!1;for(const[B,ne]of o)if(O>=B&&O<=ne){E=!0;break}re.value.enabled&&he.value&&re.value.selectedFilterId?E&&!e?((m=K.value)==null||m.enableBlur(re.value.selectedFilterId),e=!0,console.log("OBS Blur applied at",O.toFixed(2),"seconds")):!E&&e&&((p=K.value)==null||p.disableBlur(re.value.selectedFilterId),e=!1,console.log("OBS Blur removed at",O.toFixed(2),"seconds")):E&&!e&&f.value?(window.electronAPI.sendHotKey("F2"),e=!0,console.log("Blur applied at",O.toFixed(2),"seconds")):!E&&e&&!re.value.enabled&&(window.electronAPI.sendHotKey("F2"),e=!1,console.log("Blur removed at",O.toFixed(2),"seconds"))}}}catch(x){console.log("Error monitoring video position:",x)}}},100)},go=()=>{te.value=!1,window.iframeLoadTime=Date.now(),mo(),fo(),f.value&&_.value&&!b.value&&setTimeout(()=>{try{const t=T.value,e=t.contentDocument||t.contentWindow.document;if(e){const o=e.querySelector("video");o&&$e(e,o)}}catch(t){console.log("Error creating overlay on iframe load:",t),Se.value=!1}},3e3)},St=t=>{(t.key==="Escape"&&D.value||t.altKey&&t.keyCode===84)&&dt()},Ht=t=>{Ae.value=t,setTimeout(()=>{Xe.value&&Ze()},310)},yo=()=>{const t="reyohoho://#".concat(S.value);try{window.location.href=t}catch(e){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Å—ã–ª–∫–∏:",e)}},ho=()=>{const t=window.location.href;navigator.clipboard.writeText(t).then(()=>{}),qe.value.showNotification("–°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∏–ª—å–º —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞")};function zt(t){return t.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"HDRezka - ").replace(/KODIK>/,"Kodik - ").trim()}const bo=()=>{try{ye.value&&(ye.value.disconnect(),ye.value=null),ae.value&&(ae.value.close(),ae.value=null),xe.value=null,Pe.value=null,Le.value=null,Ce.value=null,ge.value=!1}catch(t){console.log("Error cleaning up audio context:",t)}},wo=t=>{var e;if(((e=A.value)==null?void 0:e.key)===t.key){Lt();return}A.value=t,te.value=!0,He.value=!1,ge.value=!1,Ce.value=null,b.value&&Me(),ve.value&&(clearInterval(ve.value),ve.value=null),pe.value&&(clearInterval(pe.value),pe.value=null),t.key.toLowerCase().includes("torrents")||r.updatePreferredPlayer(ut(t.key)),F("update:selectedPlayer",t)};Ke(A,t=>{t&&(te.value=!0,He.value=!1,ge.value=!1,Ce.value=null,b.value&&Me(),ve.value&&(clearInterval(ve.value),ve.value=null),pe.value&&(clearInterval(pe.value),pe.value=null),t.key.toLowerCase().includes("torrents")||r.updatePreferredPlayer(ut(t.key)),F("update:selectedPlayer",t))}),Ke(()=>y.params.kp_id,async t=>{t&&t!==S.value&&(S.value=t,He.value=!1,ge.value=!1,Ce.value=null,b.value&&Me(),ve.value&&(clearInterval(ve.value),ve.value=null),pe.value&&(clearInterval(pe.value),pe.value=null),rt.value=0,Xe.value&&Ze())},{immediate:!0}),Ke(_,t=>{if(f.value)if(t&&!b.value){const e=()=>{if(T.value)try{const o=T.value,l=o.contentDocument||o.contentWindow.document;if(l){const i=l.querySelector("video");if(i){const m=Date.now()-(window.iframeLoadTime||0);m>=3e3?$e(l,i):setTimeout(e,3e3-m)}}}catch(o){console.log("Error creating overlay via watcher:",o),Se.value=!1}};e()}else!t&&b.value&&Me()}),Ke(Ye,(t,e)=>{if(!f.value)return;const o=e&&e.length>0,l=t&&t.length>0;!o&&l&&(_.value||(_.value=!0,window.electronAPI&&window.electronAPI.showToast("–û–≤–µ—Ä–ª–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á—ë–Ω - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∞–π–º–∏–Ω–≥–∏")))},{deep:!0}),Ke(()=>re.value.enabled,t=>{t&&!he.value?Tt():!t&&he.value&&Wt()}),Ke(Y,(t,e)=>{!f.value||!_.value||(e&&t.showBackground!==e.showBackground?b.value&&(Me(),setTimeout(()=>{if(T.value&&_.value)try{const o=T.value,l=o.contentDocument||o.contentWindow.document;if(l){const i=l.querySelector("video");i&&$e(l,i)}}catch(o){console.log("Error recreating overlay:",o)}},100)):b.value&&Ut())},{deep:!0});const pt=["16:9","12:5","4:3"],ko=()=>{const e=(pt.indexOf(Ae.value)+1)%pt.length;Ht(pt[e])},xo=t=>{var o,l,i,m,p,x,G,le,oe,O,j,ue,E;return(E={[W.FAVORITE]:((l=(o=v.movieInfo)==null?void 0:o.lists)==null?void 0:l.isFavorite)||!1,[W.HISTORY]:((m=(i=v.movieInfo)==null?void 0:i.lists)==null?void 0:m.isHistory)||!1,[W.LATER]:((x=(p=v.movieInfo)==null?void 0:p.lists)==null?void 0:x.isLater)||!1,[W.COMPLETED]:((le=(G=v.movieInfo)==null?void 0:G.lists)==null?void 0:le.isCompleted)||!1,[W.ABANDONED]:((O=(oe=v.movieInfo)==null?void 0:oe.lists)==null?void 0:O.isAbandoned)||!1,[W.WATCHING]:((ue=(j=v.movieInfo)==null?void 0:j.lists)==null?void 0:ue.isWatching)||!1}[t])!=null?E:!1},be=async t=>{if(!u.token){qe.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:Co});return}try{const e={[W.FAVORITE]:"–∏–∑–±—Ä–∞–Ω–Ω–æ–µ",[W.HISTORY]:"–∏—Å—Ç–æ—Ä–∏—é",[W.LATER]:'—Å–ø–∏—Å–æ–∫ "–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ"',[W.COMPLETED]:'—Å–ø–∏—Å–æ–∫ "–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"',[W.ABANDONED]:'—Å–ø–∏—Å–æ–∫ "–ë—Ä–æ—à–µ–Ω–æ"',[W.WATCHING]:'—Å–ø–∏—Å–æ–∫ "–°–º–æ—Ç—Ä—é"'};xo(t)?(await Do(S.value,t),qe.value.showNotification("–£–¥–∞–ª–µ–Ω–æ –∏–∑ ".concat(e[t]))):(await _o(S.value,t),qe.value.showNotification("–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ ".concat(e[t])))}catch(e){const{message:o,code:l}=Gt(e);qe.value.showNotification("".concat(o," ").concat(l))}F("update:movieInfo")},Co=()=>{L.push("/login")},It=ee(()=>r.showFavoriteTooltip),So=()=>{L.push("/settings"),ct()},Io=async()=>{if(!f.value){Ge("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank");return}if(T.value)try{const t=T.value,e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=e.querySelector("video");if(!o)return;document.pictureInPictureElement?await document.exitPictureInPicture():document.pictureInPictureEnabled?await o.requestPictureInPicture():Ge('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–∂–∏–º "–ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –∫–∞—Ä—Ç–∏–Ω–∫–µ"')}catch(t){console.error("Error toggling PiP:",t),Ge('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º "–ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –∫–∞—Ä—Ç–∏–Ω–∫–µ"')}},To=()=>{if(_.value=!_.value,!_.value)Me();else{const t=()=>{if(!b.value&&T.value)try{const e=T.value,o=e.contentDocument||e.contentWindow.document;if(o){const l=o.querySelector("video");if(l){const i=Date.now()-(window.iframeLoadTime||0);i>=3e3?$e(o,l):setTimeout(t,3e3-i)}}}catch(e){console.log("Error creating overlay:",e),Se.value=!1}};t()}},Vt=()=>{K.value&&K.value.disconnect(),K.value=new ln,K.value.setCallbacks({onConnect:()=>{he.value=!0,r.setObsConnected(!0),f.value&&window.electronAPI&&window.electronAPI.showToast("–ü–æ–¥–∫–ª—é—á–µ–Ω –∫ OBS WebSocket")},onDisconnect:()=>{he.value=!1,r.setObsConnected(!1),Ft.value=[],Ve.value=[]},onSourcesUpdated:t=>{Ft.value=t,window.obsSources=t},onFiltersFound:t=>{Ve.value=t,window.obsFiltersFound=t,r.updateObsSettings({filtersFound:t})},onError:t=>{console.error("OBS WebSocket error:",t),f.value&&window.electronAPI&&window.electronAPI.showToast("–û—à–∏–±–∫–∞ OBS: ".concat(t))}})},Tt=async()=>{K.value||Vt(),await K.value.connect(re.value.host,re.value.port,re.value.password)},Wt=()=>{K.value&&K.value.disconnect()},Eo=t=>{K.value&&he.value&&t?K.value.testBlur(t):f.value&&window.electronAPI&&window.electronAPI.showToast("–§–∏–ª—å—Ç—Ä –Ω–µ –≤—ã–±—Ä–∞–Ω –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ OBS")},Ao=()=>{K.value&&he.value&&K.value.loadSourcesAndSearchFilters()},$o=()=>Ve.value,Mo=()=>{if(!f.value)return;const t=T.value,e=t.contentDocument||t.contentWindow.document;if(!e||e.getElementById("overlay-settings-modal"))return;const o=Y.value,l=e.createElement("div");l.id="overlay-settings-modal",l.style.cssText="\n    position: fixed !important;\n    top: 0 !important;\n    left: 0 !important;\n    width: 100% !important;\n    height: 100% !important;\n    background: rgba(0, 0, 0, 0.8) !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    z-index: 9999 !important;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n  ";const i=e.createElement("div");i.style.cssText="\n    background: rgba(30, 30, 30, 0.95) !important;\n    backdrop-filter: blur(20px) !important;\n    border-radius: 16px !important;\n    padding: 32px !important;\n    max-width: 400px !important;\n    width: 90% !important;\n    border: 1px solid rgba(255, 255, 255, 0.1) !important;\n    box-shadow: 0 8px 40px rgba(0, 0, 0, 0.5) !important;\n  ",i.innerHTML='\n    <h3 style="color: #ff6b35; margin: 0 0 24px 0; font-size: 20px; font-weight: 600; text-align: center;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–≤–µ—Ä–ª–µ—è</h3>\n    \n    <div style="display: flex; flex-direction: column; gap: 16px;">\n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="showTitle" '.concat(o.showTitle?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞</span>\n      </label>\n      \n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="showDuration" ').concat(o.showDuration?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</span>\n      </label>\n      \n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="showBackground" ').concat(o.showBackground?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–Ω—ã–π —Ñ–æ–Ω</span>\n      </label>\n      \n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="showTimingsOnMouseMove" ').concat(o.showTimingsOnMouseMove?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∞–π–º–∏–Ω–≥–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –º—ã—à–∫–∏</span>\n      </label>\n\n    </div>\n    \n    <div style="display: flex; gap: 12px; margin-top: 24px; justify-content: center;">\n      <button id="saveSettings" style="background: #ff6b35; color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">\n        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å\n      </button>\n      <button id="cancelSettings" style="background: rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.8); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; padding: 10px 16px; cursor: pointer; font-size: 14px; transition: all 0.3s ease;">\n        –û—Ç–º–µ–Ω–∞\n      </button>\n    </div>\n  '),l.appendChild(i),l.addEventListener("click",p=>{p.target===l&&l.remove()}),i.querySelector("#saveSettings").addEventListener("click",()=>{var x;const p={showTitle:i.querySelector("#showTitle").checked,showDuration:i.querySelector("#showDuration").checked,showBackground:i.querySelector("#showBackground").checked,showTimingsOnMouseMove:i.querySelector("#showTimingsOnMouseMove").checked};Y.value=p,(x=window.electronAPI)==null||x.showToast("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–≤–µ—Ä–ª–µ—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã"),l.remove()}),i.querySelector("#cancelSettings").addEventListener("click",()=>{l.remove()}),i.querySelectorAll("button").forEach(p=>{p.addEventListener("mouseenter",()=>{p.id==="saveSettings"?(p.style.background="#e55a2b",p.style.transform="translateY(-1px)"):p.style.background="rgba(255, 255, 255, 0.15)"}),p.addEventListener("mouseleave",()=>{p.id==="saveSettings"?(p.style.background="#ff6b35",p.style.transform="translateY(0)"):p.style.background="rgba(255, 255, 255, 0.1)"})}),e.body.appendChild(l)},$e=(t,e)=>{if(!_.value||b.value||Se.value)return;Se.value=!0;const o=t.createElement("div");o.id="reyohoho-video-overlay";let l=()=>{o.style.cssText="\n      position: absolute !important;\n      top: 0 !important;\n      left: 0 !important;\n      width: 100% !important;\n      height: 100% !important;\n      pointer-events: none !important;\n      z-index: 999999999 !important;\n      display: flex !important;\n      flex-direction: column !important;\n      justify-content: space-between !important;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n      visibility: visible !important;\n      opacity: 1 !important;\n    "};const i=t.createElement("div");i.style.cssText="\n    color: white !important;\n    padding: 20px !important;\n    text-align: left !important;\n    pointer-events: none !important;\n  ";const m=t.createElement("div"),p=Y.value.showBackground?"rgba(0, 0, 0, 0.7)":"transparent",x=Y.value.showBackground?"blur(10px)":"none",G=Y.value.showBackground?"fit-content":"auto";m.style.cssText="\n    font-size: 20px !important;\n    font-weight: 600 !important;\n    margin-bottom: 8px !important;\n    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8) !important;\n    line-height: 1.2 !important;\n    padding: 8px 12px !important;\n    border-radius: 6px !important;\n    display: inline-block !important;\n    color: rgba(255, 255, 255, 0.6) !important;\n    background: ".concat(p," !important;\n    backdrop-filter: ").concat(x," !important;\n    width: ").concat(G," !important;\n  ");const le=t.createElement("div"),oe=Y.value.showBackground?"rgba(0, 0, 0, 0.7)":"transparent",O=Y.value.showBackground?"blur(10px)":"none",j=Y.value.showBackground?"6px":"0",ue=Y.value.showBackground?"inline-flex":"flex",E=Y.value.showBackground?"fit-content":"auto";le.style.cssText="\n    font-size: 18px !important;\n    font-weight: 500 !important;\n    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8) !important;\n    display: ".concat(ue," !important;\n    align-items: center !important;\n    gap: 8px !important;\n    flex-wrap: wrap !important;\n    color: rgba(255, 255, 255, 0.6) !important;\n    margin-left: 12px !important;\n    background: ").concat(oe," !important;\n    backdrop-filter: ").concat(O," !important;\n    border-radius: ").concat(j," !important;\n    width: ").concat(E," !important;\n  ");const B=t.createElement("div"),ne=Y.value.showBackground?"rgba(0, 0, 0, 0.7)":"transparent",ce=Y.value.showBackground?"blur(10px)":"none";B.style.cssText="\n    position: absolute !important;\n    top: 20px !important;\n    right: 110px !important;\n    background: ".concat(ne," !important;\n    backdrop-filter: ").concat(ce," !important;\n    border-radius: 12px !important;\n    padding: 16px !important;\n    width: fit-content !important;\n    max-width: 800px !important;\n    pointer-events: none !important;\n    display: none !important;\n    transition: opacity 0.3s ease, visibility 0.3s ease !important;\n    opacity: 0 !important;\n    visibility: hidden !important;\n  ");const H=t.createElement("div");H.style.cssText="\n    font-size: 14px !important;\n    color: rgba(255, 255, 255, 0.6) !important;\n    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8) !important;\n    line-height: 1.4 !important;\n    word-wrap: break-word !important;\n  ";const q=t.createElement("div");q.style.cssText="\n    position: absolute !important;\n    top: 20px !important;\n    right: 20px !important;\n    display: flex !important;\n    gap: 8px !important;\n    pointer-events: all !important;\n  ";const z=t.createElement("button");z.style.cssText="\n    background: rgba(0, 0, 0, 0.8) !important;\n    backdrop-filter: blur(10px) !important;\n    color: white !important;\n    border: 1px solid rgba(255, 255, 255, 0.2) !important;\n    border-radius: 50% !important;\n    width: 40px !important;\n    height: 40px !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n    font-size: 18px !important;\n  ",z.innerHTML="‚öôÔ∏è",z.title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–≤–µ—Ä–ª–µ—è";const fe=t.createElement("button");fe.style.cssText="\n    background: rgba(0, 0, 0, 0.8) !important;\n    backdrop-filter: blur(10px) !important;\n    color: white !important;\n    border: 1px solid rgba(255, 255, 255, 0.2) !important;\n    border-radius: 50% !important;\n    width: 40px !important;\n    height: 40px !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n    font-size: 18px !important;\n  ",fe.innerHTML="üëÅÔ∏è",fe.title="–û—Ç–∫–ª—é—á–∏—Ç—å –æ–≤–µ—Ä–ª–µ–π",fe.addEventListener("click",()=>{_.value=!1}),z.addEventListener("click",()=>{Mo()}),[z,fe].forEach(P=>{P.addEventListener("mouseenter",()=>{P.style.background="#ff6b35",P.style.borderColor="#ff6b35",P.style.transform="scale(1.1)"}),P.addEventListener("mouseleave",()=>{P.style.background="rgba(0, 0, 0, 0.8)",P.style.borderColor="rgba(255, 255, 255, 0.2)",P.style.transform="scale(1)"})}),q.appendChild(z),q.appendChild(fe),B.appendChild(H),i.appendChild(m),i.appendChild(le),o.appendChild(i),o.appendChild(B),o.appendChild(q),q.style.transition="opacity 0.3s ease, visibility 0.3s ease",q.style.opacity="0",q.style.visibility="hidden",i.style.transition="opacity 0.3s ease";let _e=null,je=null;const Je=()=>{q.style.opacity="1",q.style.visibility="visible",i.style.opacity="0",Y.value.showTimingsOnMouseMove&&Ye.value.length>0&&(B.style.opacity="1",B.style.visibility="visible",clearTimeout(je),je=setTimeout(()=>{B.style.opacity="0",B.style.visibility="hidden"},3e3)),clearTimeout(ze.value),clearTimeout(_e),ze.value=setTimeout(()=>{q.style.opacity="0",q.style.visibility="hidden"},3e3),_e=setTimeout(()=>{i.style.opacity="1"},2e3)};t.addEventListener("mousemove",Je),o.addEventListener("mouseenter",()=>{q.style.opacity="1",q.style.visibility="visible",i.style.opacity="0",clearTimeout(_e)}),o.addEventListener("mouseleave",()=>{clearTimeout(ze.value),clearTimeout(_e),q.style.opacity="0",q.style.visibility="hidden",i.style.opacity="1"}),o._mouseHandler=Je;const Be=(P=>{let se=P.parentNode,de=0;const we=5;for(;se&&de<we;){const Ee=t.defaultView.getComputedStyle(se),Re=se.getBoundingClientRect();if(Re.width>0&&Re.height>0&&(Ee.position==="relative"||Ee.position==="absolute"||Ee.position==="fixed"||se.tagName==="BODY"))return se;se=se.parentNode,de++}return P.parentNode})(e);o._targetContainer=Be,o._videoElement=e,l=()=>{const P=o._videoElement.getBoundingClientRect(),se=o._targetContainer.getBoundingClientRect(),de=P.top-se.top,we=P.left-se.left;o.style.cssText="\n      position: absolute !important;\n      top: ".concat(de,"px !important;\n      left: ").concat(we,"px !important;\n      width: ").concat(P.width,"px !important;\n      height: ").concat(P.height,"px !important;\n      pointer-events: none !important;\n      z-index: 999999999 !important;\n      display: flex !important;\n      flex-direction: column !important;\n      justify-content: space-between !important;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n      visibility: visible !important;\n      opacity: 1 !important;\n      box-sizing: border-box !important;\n    ")},e.style.position="relative",(Be.style.position===""||Be.style.position==="static")&&(Be.style.position="relative"),Be.appendChild(o),l(),b.value=o,Se.value=!1;const Qe=setInterval(()=>{if(!b.value||!_.value){clearInterval(Qe);return}if(!t.body.contains(o))try{const de=t.querySelectorAll("video");if(de.length>0){const we=de[0];o._videoElement=we;const Re=(nt=>{let Ie=nt.parentNode,st=0;const mt=5;for(;Ie&&st<mt;){const Ue=t.defaultView.getComputedStyle(Ie),it=Ie.getBoundingClientRect();if(it.width>0&&it.height>0&&(Ue.position==="relative"||Ue.position==="absolute"||Ue.position==="fixed"||Ie.tagName==="BODY"))return Ie;Ie=Ie.parentNode,st++}return nt.parentNode})(we);o._targetContainer=Re,Re.appendChild(o),l(),o._mouseHandler&&(t.removeEventListener("mousemove",o._mouseHandler),t.addEventListener("mousemove",o._mouseHandler))}}catch(de){console.log("Error re-adding overlay to DOM:",de)}const P=t.defaultView.getComputedStyle(o);if((P.visibility==="hidden"||P.display==="none"||P.opacity==="0")&&l(),(parseInt(P.zIndex)||0)<999999999&&l(),o._videoElement&&o._targetContainer){const de=o._videoElement.getBoundingClientRect(),we=parseInt(P.width)||0,Ee=parseInt(P.height)||0;(Math.abs(we-de.width)>5||Math.abs(Ee-de.height)>5)&&l()}},1e3),et=new window.MutationObserver(P=>{P.forEach(se=>{se.type==="attributes"&&se.target===o&&se.attributeName==="style"&&setTimeout(()=>{b.value&&_.value&&l()},100)})});et.observe(o,{attributes:!0,attributeFilter:["style","class"]});const tt=()=>{b.value&&_.value&&l()};t.defaultView.addEventListener("resize",tt),o._monitorInterval=Qe,o._mutationObserver=et,o._resizeHandler=tt,o._iframeDoc=t;const ot=setInterval(()=>{if(!b.value||!_.value){clearInterval(ot);return}l()},500);setTimeout(()=>{clearInterval(ot)},1e4)},Ut=()=>{var le,oe,O,j,ue;if(!b.value||!_.value)return;const t=T.value;if(!t)return;const e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=b.value,l=o.children[0],i=o.children[1],m=e.defaultView.getComputedStyle(o);(m.display==="none"||m.visibility==="hidden")&&(o.style.display="flex !important",o.style.visibility="visible !important");const p=l.children[0];if(Y.value.showTitle){p.style.display="block";const E=((le=v.movieInfo)==null?void 0:le.title)||((oe=v.movieInfo)==null?void 0:oe.name_ru)||((O=v.movieInfo)==null?void 0:O.name_en)||((j=v.movieInfo)==null?void 0:j.name_original)||"–ó–∞–≥—Ä—É–∑–∫–∞...",B=(ue=v.movieInfo)!=null&&ue.year?" (".concat(v.movieInfo.year,")"):"";p.textContent=E+B,Y.value.showBackground?(p.style.background="rgba(0, 0, 0, 0.7) !important",p.style.backdropFilter="blur(10px) !important",p.style.width="fit-content !important",p.style.display="inline-block !important"):(p.style.background="transparent !important",p.style.backdropFilter="none !important",p.style.width="auto !important",p.style.display="inline-block !important")}else p.style.display="none";const x=l.children[1];let G="";if(Y.value.showDuration){const E=Oe(Ot.value),B=Oe(Nt.value);G="\n      <span style=\"font-family: 'Courier New', monospace; color: rgba(255, 255, 255, 0.6);\">".concat(E,'</span>\n      <span style="opacity: 0.6;">/</span>\n      <span style="font-family: \'Courier New\', monospace; color: rgba(255, 255, 255, 0.6);">').concat(B,"</span>\n    ")}if(re.value.enabled&&re.value.showObsInOverlay){let E="–û—Ç–∫–ª—é—á–µ–Ω";const B="#999999";if(he.value)if(re.value.selectedFilterId){const ce=Ve.value.find(H=>H.id===re.value.selectedFilterId);ce?E="".concat(ce.filterName," (").concat(ce.sceneName,")"):E="–§–∏–ª—å—Ç—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω"}else Ve.value.length>0?E="–§–∏–ª—å—Ç—Ä –Ω–µ –≤—ã–±—Ä–∞–Ω":E="–§–∏–ª—å—Ç—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã";const ne='\n      <span style="color: '.concat(B,';">\n        OBS: ').concat(E,"\n      </span>\n    ");G=G?"".concat(G," ").concat(ne):ne}if(G?(x.style.display="flex",x.innerHTML=G,Y.value.showBackground?(x.style.background="rgba(0, 0, 0, 0.7) !important",x.style.backdropFilter="blur(10px) !important",x.style.borderRadius="6px !important",x.style.padding="8px 12px !important",x.style.width="fit-content !important",x.style.display="inline-flex !important"):(x.style.background="transparent !important",x.style.backdropFilter="none !important",x.style.borderRadius="0 !important",x.style.padding="0 !important",x.style.width="auto !important",x.style.display="flex !important")):x.style.display="none",Ye.value.length>0){const E=i.children[0];E.innerHTML="";const B=e.createElement("span");B.textContent="–¢–∞–π–º–∏–Ω–≥–∏: ",B.style.color="rgba(255, 255, 255, 0.6)",E.appendChild(B),Ye.value.forEach((ne,ce)=>{if(ce>0){const H=e.createElement("span");H.textContent=", ",H.style.color="rgba(255, 255, 255, 0.6)",E.appendChild(H)}ne.intervals.forEach((H,q)=>{if(q>0){const fe=e.createElement("span");fe.textContent=", ",fe.style.color="rgba(255, 255, 255, 0.6)",E.appendChild(fe)}const z=e.createElement("span");z.textContent=H.text,H.status==="active"?(z.style.color="#ff4444",z.style.fontWeight="bold"):H.status==="upcoming"?(z.style.color="#ff6b35",z.style.fontWeight="500"):z.style.color="rgba(255, 255, 255, 0.6)",E.appendChild(z)})}),i.style.display="block",Y.value.showTimingsOnMouseMove||(i.style.opacity="1",i.style.visibility="visible"),Y.value.showBackground?(i.style.background="rgba(0, 0, 0, 0.7) !important",i.style.backdropFilter="blur(10px) !important",i.style.width="fit-content !important",i.style.minWidth="auto !important"):(i.style.background="transparent !important",i.style.backdropFilter="none !important",i.style.width="fit-content !important",i.style.minWidth="auto !important")}else i.style.display="none"},Me=()=>{if(b.value){try{b.value._monitorInterval&&clearInterval(b.value._monitorInterval),b.value._mutationObserver&&b.value._mutationObserver.disconnect(),b.value._resizeHandler&&b.value._iframeDoc&&b.value._iframeDoc.defaultView.removeEventListener("resize",b.value._resizeHandler),b.value._mouseHandler&&b.value._iframeDoc&&b.value._iframeDoc.removeEventListener("mousemove",b.value._mouseHandler),b.value.remove()}catch(t){console.log("Error removing overlay:",t)}b.value=null}Se.value=!1,ze.value&&(clearTimeout(ze.value),ze.value=null)};Jt(()=>{if(te.value=!0,lo(),U.value&&(Ae.value="4:3"),kt(),window.addEventListener("resize",kt),window.addEventListener("resize",ht),Xe.value&&Ze(),window.toggleCompressor=Dt,window.toggleMirror=_t,Vt(),window.connectToOBS=Tt,window.testOBSBlur=Eo,window.refreshOBSFilters=Ao,window.getOBSFiltersInfo=$o,window.testOBSConnection=Bo,window.debugOBS=()=>{var t;console.log("=== OBS Debug Info ==="),console.log("OBS Settings:",re.value),console.log("OBS Connected:",he.value),console.log("OBS Filters Found:",Ve.value),console.log("OBS WebSocket instance:",K.value),K.value&&(console.log("WebSocket state:",(t=K.value.ws)==null?void 0:t.readyState),console.log("Is Connected:",K.value.isConnected),console.log("Is Authenticated:",K.value.isAuthenticated))},re.value.enabled&&Tt(),f.value&&(yt.value=setInterval(()=>{const t=window.overlayNudityTimings?window.overlayNudityTimings.length:0;t>rt.value?(rt.value=t,_.value||(_.value=!0,window.electronAPI&&window.electronAPI.showToast("–û–≤–µ—Ä–ª–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á—ë–Ω - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∞–π–º–∏–Ω–≥–∏"))):rt.value=t},1e3)),f.value&&_.value){const t=()=>{if(T.value&&!b.value)try{const e=T.value,o=e.contentDocument||e.contentWindow.document;if(o){const l=o.querySelector("video");if(l){const i=Date.now()-(window.iframeLoadTime||0);i>=3e3?$e(o,l):setTimeout(t,3e3-i)}else{const i=setInterval(()=>{try{const m=o.querySelector("video");if(m){clearInterval(i);const p=Date.now()-(window.iframeLoadTime||0);p>=3e3?$e(o,m):setTimeout(()=>$e(o,m),3e3-p)}}catch(m){console.log("Waiting for video element...",m)}},1e3);setTimeout(()=>clearInterval(i),15e3)}}}catch(e){console.log("Error initializing overlay on mount:",e),Se.value=!1}};setTimeout(t,1e3)}}),No(()=>{window.removeEventListener("resize",kt),window.removeEventListener("resize",ht),window.removeEventListener("mousemove",Ct),document.removeEventListener("keydown",St),document.body.classList.remove("no-scroll"),ve.value&&clearInterval(ve.value),pe.value&&clearInterval(pe.value),yt.value&&clearInterval(yt.value),Me(),bo(),Wt(),delete window.toggleCompressor,delete window.toggleMirror,delete window.connectToOBS,delete window.testOBSBlur,delete window.refreshOBSFilters,delete window.getOBSFiltersInfo,delete window.testOBSConnection,delete window.debugOBS,delete window.obsSources,delete window.obsFiltersFound});const Bo=async()=>K.value&&he.value?await K.value.testConnection():{success:!1,error:"Not connected"};return(t,e)=>{var o,l,i,m,p,x,G,le,oe,O,j,ue,E,B,ne,ce,H,q,z,fe,_e,je,Je,Et,Be,At,Qe,et,tt,ot,P,se,de,we,Ee,Re,nt,Ie,st,mt,Ue,it;return h.value?(C(),$t(Fo,{key:0,message:h.value,code:M.value},null,8,["message","code"])):(C(),$(Fe,{key:1},[n("div",an,[e[43]||(e[43]=n("span",null,"–ü–ª–µ–µ—Ä:",-1)),n("button",{class:"player-btn",onClick:ao},w(A.value?zt(A.value.translate).toUpperCase():"–ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–µ–µ—Ä–æ–≤..."),1)]),Te.value?(C(),$t(sn,{key:0,players:V.value,"selected-player":A.value,onClose:Lt,onSelect:wo},null,8,["players","selected-player"])):X("",!0),n("div",{ref_key:"containerRef",ref:ke,class:R(["player-container",{"theater-mode":D.value}]),style:Kt(D.value?{}:so.value)},[n("div",{class:"iframe-wrapper",style:Kt(D.value?{}:io.value)},[J(n("iframe",{ref_key:"playerIframe",ref:T,src:(o=A.value)==null?void 0:o.iframe,frameborder:"0",allowfullscreen:"",webkitallowfullscreen:"",class:R(["responsive-iframe",{"theater-mode-unlock":I.value,"theater-mode-lock":D.value,dimmed:vt.value}]),onLoad:go},null,42,rn),[[Q,!te.value&&((l=A.value)==null?void 0:l.iframe)]]),te.value?(C(),$t(zo,{key:0,text:"–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–ª–µ–µ—Ä: ".concat(A.value?zt(A.value.translate):"–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –ø–ª–µ–µ—Ä–æ–≤","\n–ï—Å–ª–∏ –ø–ª–µ–µ—Ä –Ω–µ –≥—Ä—É–∑–∏—Ç—Å—è, —Ç–æ —Å–º–µ–Ω–∏—Ç–µ –ø–ª–µ–µ—Ä –≤—ã—à–µ –∏–ª–∏ –≤–∫–ª—é—á–∏—Ç–µ VPN"),style:{"white-space":"pre-line"}},null,8,["text"])):X("",!0)],4),D.value?(C(),$("button",{key:0,class:R(["close-theater-btn",{visible:I.value}]),onClick:dt}," ‚úñ ",2)):X("",!0)],6),D.value?X("",!0):(C(),$("div",cn,[n("div",un,[!U.value&&S.value?(C(),$("div",{key:0,ref_key:"tooltipContainer",ref:eo,class:"tooltip-container list-buttons-container","data-tooltip-container":"favorite"},[It.value?(C(),$("button",{key:0,class:R(["favorite-btn",{active:(m=(i=N.movieInfo)==null?void 0:i.lists)==null?void 0:m.isFavorite}]),onMouseenter:e[0]||(e[0]=d=>ie("favorite")),onMouseleave:bt,onClick:e[1]||(e[1]=d=>be(me(W).FAVORITE))},[n("span",dn,w((x=(p=N.movieInfo)==null?void 0:p.lists)!=null&&x.isFavorite?"favorite":"favorite_border"),1),n("span",{class:R(["material-icons dropdown-arrow",{highlighted:oo.value}])},"expand_more",2)],34)):X("",!0),J(n("div",{ref_key:"tooltip",ref:to,class:"custom-tooltip advanced-tooltip list-buttons-dropdown","data-tooltip":"favorite",onMouseenter:wt,onMouseleave:ct},[n("div",vn,[n("button",{class:R(["favorite-btn",{active:(le=(G=N.movieInfo)==null?void 0:G.lists)==null?void 0:le.isFavorite}]),onClick:e[2]||(e[2]=d=>be(me(W).FAVORITE))},[n("span",pn,w((O=(oe=N.movieInfo)==null?void 0:oe.lists)!=null&&O.isFavorite?"favorite":"favorite_border"),1),e[44]||(e[44]=n("span",{class:"button-label"},"–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ",-1))],2)]),n("div",mn,[n("button",{class:R(["watching-btn",{active:(ue=(j=N.movieInfo)==null?void 0:j.lists)==null?void 0:ue.isWatching}]),onClick:e[3]||(e[3]=d=>be(me(W).WATCHING))},[n("span",fn,w((B=(E=N.movieInfo)==null?void 0:E.lists)!=null&&B.isWatching?"visibility":"visibility_off"),1),e[45]||(e[45]=n("span",{class:"button-label"},"–°–º–æ—Ç—Ä—é",-1))],2)]),n("div",gn,[n("button",{class:R(["later-btn",{active:(ce=(ne=N.movieInfo)==null?void 0:ne.lists)==null?void 0:ce.isLater}]),onClick:e[4]||(e[4]=d=>be(me(W).LATER))},e[46]||(e[46]=[n("span",{class:"material-icons"},"watch_later",-1),n("span",{class:"button-label"},"–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ",-1)]),2)]),n("div",yn,[n("button",{class:R(["completed-btn",{active:(q=(H=N.movieInfo)==null?void 0:H.lists)==null?void 0:q.isCompleted}]),onClick:e[5]||(e[5]=d=>be(me(W).COMPLETED))},[n("span",hn,w((fe=(z=N.movieInfo)==null?void 0:z.lists)!=null&&fe.isCompleted?"check_circle":"check_circle_outline"),1),e[47]||(e[47]=n("span",{class:"button-label"},"–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ",-1))],2)]),n("div",bn,[n("button",{class:R(["abandoned-btn",{active:(je=(_e=N.movieInfo)==null?void 0:_e.lists)==null?void 0:je.isAbandoned}]),onClick:e[6]||(e[6]=d=>be(me(W).ABANDONED))},[n("span",wn,w(((Et=(Je=N.movieInfo)==null?void 0:Je.lists)!=null&&Et.isAbandoned,"not_interested")),1),e[48]||(e[48]=n("span",{class:"button-label"},"–ë—Ä–æ—à–µ–Ω–æ",-1))],2)]),n("div",{class:"tooltip-hint"},[e[50]||(e[50]=n("span",{class:"material-icons"},"settings",-1)),n("span",null,[e[49]||(e[49]=Ne("–°—Ç–∏–ª—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ ")),n("a",{class:"settings-link",onClick:So},"–Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö")])])],544),[[Q,k.value==="favorite"&&It.value]])],512)):X("",!0),U.value?X("",!0):(C(),$(Fe,{key:1},[n("div",kn,[n("button",{class:R(["dimming-btn",{active:vt.value}]),onMouseenter:e[7]||(e[7]=d=>ie("dimming")),onMouseleave:e[8]||(e[8]=d=>k.value=null),onClick:vo},[n("span",xn,w(vt.value?"light_mode":"dark_mode"),1)],34),J(n("div",{class:"custom-tooltip","data-tooltip":"dimming"},w(vt.value?"–û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ":"–í–∫–ª—é—á–∏—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ"),513),[[Q,k.value==="dimming"]])]),n("div",Cn,[n("button",{class:R(["blur-btn",{"electron-only":!f.value}]),onMouseenter:e[9]||(e[9]=d=>ie("blur")),onMouseleave:e[10]||(e[10]=d=>k.value=null),onClick:uo},e[51]||(e[51]=[n("span",{class:"material-icons"},"blur_on",-1)]),34),J(n("div",{class:"custom-tooltip","data-tooltip":"blur"},w(f.value?"–ë–ª—é—Ä":"–ë–ª—é—Ä, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[Q,k.value==="blur"]])]),n("div",Sn,[n("button",{class:R(["material-symbols-outlined",{active:De.value,"electron-only":!f.value}]),onMouseenter:e[11]||(e[11]=d=>ie("compressor")),onMouseleave:e[12]||(e[12]=d=>k.value=null),onClick:Dt},e[52]||(e[52]=[n("span",{class:"material-icons"},"graphic_eq",-1)]),34),J(n("div",{class:"custom-tooltip","data-tooltip":"compressor"},w(f.value?"–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä":"–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[Q,k.value==="compressor"]])]),n("div",In,[n("button",{class:R(["mirror-btn",{active:We.value,"electron-only":!f.value}]),onMouseenter:e[13]||(e[13]=d=>ie("mirror")),onMouseleave:e[14]||(e[14]=d=>k.value=null),onClick:_t},e[53]||(e[53]=[n("span",{class:"material-icons"},"flip",-1)]),34),J(n("div",{class:"custom-tooltip","data-tooltip":"mirror"},w(f.value?"–ó–µ—Ä–∫–∞–ª–æ":"–ó–µ—Ä–∫–∞–ª–æ, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[Q,k.value==="mirror"]])]),n("div",Tn,[n("button",{class:"theater-mode-btn",onMouseenter:e[15]||(e[15]=d=>ie("theater")),onMouseleave:e[16]||(e[16]=d=>k.value=null),onClick:dt},[n("span",En,w(D.value?"fullscreen_exit":"aspect_ratio"),1)],32),J(n("div",An,[Ne(w(D.value?"–í—ã–π—Ç–∏ –∏–∑ —Ç–µ–∞—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞":"–¢–µ–∞—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º")+" ",1),e[54]||(e[54]=n("span",{class:"shortcut-hint"},"Alt+T",-1))],512),[[Q,k.value==="theater"]])]),n("div",$n,[n("button",{class:R(["pip-btn",{"electron-only":!f.value}]),onMouseenter:e[17]||(e[17]=d=>ie("pip")),onMouseleave:e[18]||(e[18]=d=>k.value=null),onClick:Io},e[55]||(e[55]=[n("span",{class:"material-icons"},"picture_in_picture_alt",-1)]),34),J(n("div",{class:"custom-tooltip","data-tooltip":"pip"},w(f.value?"–ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –∫–∞—Ä—Ç–∏–Ω–∫–µ":"–ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –∫–∞—Ä—Ç–∏–Ω–∫–µ, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[Q,k.value==="pip"]])]),n("div",Mn,[n("button",{class:"aspect-ratio-dropdown-btn",onMouseenter:e[19]||(e[19]=d=>ie("aspect_ratio")),onMouseleave:bt,onClick:ko},[n("span",Bn,w(Ae.value),1)],32),J(n("div",{class:"custom-tooltip advanced-tooltip aspect-ratio-dropdown","data-tooltip":"aspect_ratio",onMouseenter:wt,onMouseleave:ct},[(C(),$(Fe,null,lt(pt,d=>n("div",{key:d,class:R(["aspect-ratio-option",{active:Ae.value===d}]),onClick:us=>Ht(d)},w(d),11,Rn)),64))],544),[[Q,k.value==="aspect_ratio"]])]),n("div",{class:"tooltip-container","data-tooltip-container":"centering",onMouseenter:e[21]||(e[21]=d=>ie("centering")),onMouseleave:bt},[n("button",{class:"center-btn",onClick:Ze},e[56]||(e[56]=[n("span",{class:"material-icons"},"center_focus_strong",-1)])),J(n("div",{class:"custom-tooltip advanced-tooltip","data-tooltip":"centering",onMouseenter:wt,onMouseleave:ct},[e[57]||(e[57]=Ne(" –û—Ç—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–ª–µ–µ—Ä ")),Bt(Wo,{modelValue:Xe.value,"onUpdate:modelValue":e[20]||(e[20]=d=>Xe.value=d),title:"–ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞"},null,8,["modelValue"]),e[58]||(e[58]=n("span",{class:"tooltip-title"},"–ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞",-1))],544),[[Q,k.value==="centering"]])],32),!f.value&&S.value?(C(),$("div",On,[n("button",{class:"app-link-btn",onMouseenter:e[22]||(e[22]=d=>ie("app_link")),onMouseleave:e[23]||(e[23]=d=>k.value=null),onClick:yo},e[59]||(e[59]=[n("span",{class:"material-icons"},"open_in_new",-1)]),32),J(n("div",Nn," –û—Ç–∫—Ä—ã—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ",512),[[Q,k.value==="app_link"]])])):X("",!0),f.value?(C(),$("div",Fn,[n("button",{class:"copy-link-btn",onMouseenter:e[24]||(e[24]=d=>ie("copy_link")),onMouseleave:e[25]||(e[25]=d=>k.value=null),onClick:ho},e[60]||(e[60]=[n("span",{class:"material-icons"},"content_copy",-1)]),32),J(n("div",Pn," –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É ",512),[[Q,k.value==="copy_link"]])])):X("",!0),f.value?(C(),$("div",Ln,[n("button",{class:R(["overlay-btn",{active:_.value}]),onMouseenter:e[26]||(e[26]=d=>ie("overlay")),onMouseleave:e[27]||(e[27]=d=>k.value=null),onClick:To},[n("span",Dn,w(_.value?"layers":"layers_clear"),1)],34),J(n("div",{class:"custom-tooltip","data-tooltip":"overlay"},w(_.value?"–°–∫—Ä—ã—Ç—å –æ–≤–µ—Ä–ª–µ–π –≤–∏–¥–µ–æ":"–ü–æ–∫–∞–∑–∞—Ç—å –æ–≤–µ—Ä–ª–µ–π –≤–∏–¥–µ–æ"),513),[[Q,k.value==="overlay"]])])):X("",!0)],64))]),!U.value&&!It.value&&S.value?(C(),$("div",_n,[n("div",qn,[n("button",{class:R(["favorite-btn",{active:(At=(Be=N.movieInfo)==null?void 0:Be.lists)==null?void 0:At.isFavorite}]),onMouseenter:e[28]||(e[28]=d=>ie("favorite")),onMouseleave:e[29]||(e[29]=d=>k.value=null),onClick:e[30]||(e[30]=d=>be(me(W).FAVORITE))},[n("span",Hn,w((et=(Qe=N.movieInfo)==null?void 0:Qe.lists)!=null&&et.isFavorite?"favorite":"favorite_border"),1)],34),J(n("div",zn,w("–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ"),512),[[Q,k.value==="favorite"]])]),n("div",Vn,[n("button",{class:R(["watching-btn",{active:(ot=(tt=N.movieInfo)==null?void 0:tt.lists)==null?void 0:ot.isWatching}]),onMouseenter:e[31]||(e[31]=d=>ie("watching")),onMouseleave:e[32]||(e[32]=d=>k.value=null),onClick:e[33]||(e[33]=d=>be(me(W).WATCHING))},[n("span",Wn,w((se=(P=N.movieInfo)==null?void 0:P.lists)!=null&&se.isWatching?"visibility":"visibility_off"),1)],34),J(n("div",Un,w("–°–º–æ—Ç—Ä—é"),512),[[Q,k.value==="watching"]])]),n("div",Kn,[n("button",{class:R(["later-btn",{active:(we=(de=N.movieInfo)==null?void 0:de.lists)==null?void 0:we.isLater}]),onMouseenter:e[34]||(e[34]=d=>ie("later")),onMouseleave:e[35]||(e[35]=d=>k.value=null),onClick:e[36]||(e[36]=d=>be(me(W).LATER))},e[61]||(e[61]=[n("span",{class:"material-icons"},"watch_later",-1)]),34),J(n("div",Gn,w("–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ"),512),[[Q,k.value==="later"]])]),n("div",Yn,[n("button",{class:R(["completed-btn",{active:(Re=(Ee=N.movieInfo)==null?void 0:Ee.lists)==null?void 0:Re.isCompleted}]),onMouseenter:e[37]||(e[37]=d=>ie("completed")),onMouseleave:e[38]||(e[38]=d=>k.value=null),onClick:e[39]||(e[39]=d=>be(me(W).COMPLETED))},[n("span",Xn,w((Ie=(nt=N.movieInfo)==null?void 0:nt.lists)!=null&&Ie.isCompleted?"check_circle":"check_circle_outline"),1)],34),J(n("div",Zn,w("–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"),512),[[Q,k.value==="completed"]])]),n("div",jn,[n("button",{class:R(["abandoned-btn",{active:(mt=(st=N.movieInfo)==null?void 0:st.lists)==null?void 0:mt.isAbandoned}]),onMouseenter:e[40]||(e[40]=d=>ie("abandoned")),onMouseleave:e[41]||(e[41]=d=>k.value=null),onClick:e[42]||(e[42]=d=>be(me(W).ABANDONED))},[n("span",Jn,w(((it=(Ue=N.movieInfo)==null?void 0:Ue.lists)!=null&&it.isAbandoned,"not_interested")),1)],34),J(n("div",Qn,w("–ë—Ä–æ—à–µ–Ω–æ"),512),[[Q,k.value==="abandoned"]])])])):X("",!0)])),Bt(Qt,{ref_key:"notificationRef",ref:qe},null,512)],64))}}},bs=Rt(es,[["__scopeId","data-v-a437248b"]]),ts={class:"rating-container"},os={class:"rating-display"},ns={class:"rating-numbers"},ss=["onClick","onMouseenter"],is={key:0,class:"tooltip-footer"},ls={class:"rating-numbers mobile-rating-numbers"},as=["onClick"],rs={key:0,class:"mobile-modal-footer"},cs={__name:"MovieRating",props:{kpId:{type:String,required:!0},showDash:{type:Boolean,default:!1}},setup(N){const s=Zt(),a=jt(),r=N,u=c(null),y=c(null),L=c(null),S=c(null),v=c(0),F=c(!1),V=c(!1);let A=null;const te=g=>g?g.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "):"0",D=()=>{A=setTimeout(()=>{F.value=!1,s.isMobile||(V.value=!1)},100)},I=()=>{A&&(clearTimeout(A),A=null),F.value=!0},T=()=>{s.isMobile&&(V.value=!V.value)},ke=()=>{a.push("/login")},Te=async()=>{try{const g=await Ho(r.kpId);y.value=g.user_rating,L.value=g.average_rating,S.value=te(g.vote_count)}catch(g){console.error("Error loading rating:",g)}},h=async g=>{var Z;try{g===y.value?(await Yt(r.kpId,null),y.value=null,u.value.showNotification("–û—Ü–µ–Ω–∫–∞ —É–¥–∞–ª–µ–Ω–∞")):(await Yt(r.kpId,g),y.value=g,u.value.showNotification("–û—Ü–µ–Ω–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞")),s.isMobile&&(V.value=!1),Te()}catch(U){console.error("Error setting rating:",U),((Z=U.response)==null?void 0:Z.status)===401?u.value.showNotification('–î–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:ke}):u.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ—Ü–µ–Ω–∫–∏"),s.isMobile&&(V.value=!1)}},M=()=>{V.value=!1};return Jt(()=>{Te()}),(g,Z)=>(C(),$("div",ts,[n("div",os,[n("a",{href:"#",class:R(["rating-link",{"has-rating":y.value}]),onMouseenter:Z[0]||(Z[0]=U=>F.value=!0),onMouseleave:D,onClick:ft(T,["prevent"])},[Z[3]||(Z[3]=n("img",{src:Uo,alt:"ReYohoho",class:"rating-logo"},null,-1)),n("span",{class:R(["average-rating",me(qo)(L.value)])},w(L.value?L.value.toFixed(1).replace(/\.0$/,""):"‚Äî"),3)],34),J(n("div",{class:"rating-tooltip",onMouseenter:I,onMouseleave:D},[n("div",ns,[(C(),$(Fe,null,lt(10,U=>n("button",{key:U,class:R(["number-btn",{active:U===y.value,hover:U===v.value,"average-highlight":L.value&&U<=Math.round(L.value)}]),onClick:f=>h(U),onMouseenter:f=>v.value=U,onMouseleave:Z[1]||(Z[1]=f=>v.value=0)},w(U),43,ss)),64))]),S.value?(C(),$("div",is,"–û—Ü–µ–Ω–æ–∫: "+w(S.value),1)):X("",!0)],544),[[Q,(F.value||V.value)&&!me(s).isMobile]])]),Bt(Qt,{ref_key:"notificationRef",ref:u},null,512),me(s).isMobile&&V.value?(C(),$("div",{key:0,class:"mobile-modal-overlay",onClick:M},[n("div",{class:"mobile-modal",onClick:Z[2]||(Z[2]=ft(()=>{},["stop"]))},[n("div",{class:"mobile-modal-header"},[Z[4]||(Z[4]=n("h3",null,"–û—Ü–µ–Ω–∏—Ç—å —Ñ–∏–ª—å–º",-1)),n("button",{class:"close-button",onClick:M},"√ó")]),n("div",ls,[(C(),$(Fe,null,lt(10,U=>n("button",{key:U,class:R(["number-btn",{active:U===y.value,"average-highlight":L.value&&U<=Math.round(L.value)}]),onClick:f=>h(U)},w(U),11,as)),64))]),S.value?(C(),$("div",rs,"–û—Ü–µ–Ω–æ–∫: "+w(S.value),1)):X("",!0)])])):X("",!0)]))}},ws=Rt(cs,[["__scopeId","data-v-2df64bd5"]]);export{ws as M,bs as P,ys as _,hs as a};
