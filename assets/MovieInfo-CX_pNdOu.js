import{_ as ye,r as c,c as T,b as a,d as l,e as t,s as x,t as d,G as le,g as u,H as ke,n as U,J as We,u as Ae,K as Ie,l as ie,o as Me,L as De,q as se,E as Ne,f as ae,M as we,m as A,N as M,O as Ge,C as $e,P as Te,i as Fe,Q as Ze,R as je,a as Qe,x as F,U as K,S as Pe,V as Xe,W as Je,X as Se,Y as et}from"./index-BgxO_8E4.js";import{S as Ke,_ as Re,a as xe,M as Le}from"./MovieList-C5lAD2ou.js";import{N as Ue}from"./ToastMessage-4QXY77cS.js";import{u as tt,S as ot,a as st}from"./trailer-nX_EkBys.js";const ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVR4nO2ZQUoDMRSGR7eewHoFsVS0HkUUXNXqASqK2EURBPFIVRe6c+UN1CvUXWvbT4KvMAwzNnnJdCrmg1BKad7/v7y0b5IkiUQiCwGoAx3gQjEugZ0qxTeAIX6MKjMBnBOGS62AVWAPOHVYdlMu9YArYOhphLeBT+ALmOKGEd2QubaAK+B2zngFxt4GgDXgGZjgR8ch5oEkCi8DkvlnRcYLV0Apfqw10M7JvPkV6AN3FmVwK+WyZRnvMEe8ef/ibECyb2o+zRuwnpQAxeLNivQ0BvYyE46qEJ/8fK4ycJKp/X4V4n0MdDNfukkqEO9jwP1LDgD7BeKPgmgp04CL+KUz4Cp+qQxoxC+NAdsNm4c0hWkukkUa8BGfegiadbFDq3/2UAZ8xc+QVvzMtqcKYkBaZ5/MN5xEl2DgLGDZ1KswsC09FPJqXTZoNm5oA6kyMGI2FxqfkluJ0uMTDfhBXAHiHvCCWEL8/RLqlv1MPCf+TSZ+13WC7KnEfWlqcwAeU7GNjnbiQsG5UC1ZAEAt1UMhOpquk6zknMy9l20C2AA+MnEHRo9msuOCs9EH4Fp5TVQ0rqVs0plH4re02Qh1Oq1lCjypsp+5H3gKcD/gykTirqnFZ/ZDy+OGxpapzD+QePrM/2KkKfcGPcv7AdvRkz23G1x4JPIP+AY3r/ywUk/2JAAAAABJRU5ErkJggg==",lt="/reyohoho/assets/icon-shikimori-DGvXK9Jc.svg",he=Z=>{const y=document.createElement("div");y.style.position="fixed",y.style.top="0",y.style.left="0",y.style.width="100%",y.style.height="100%",y.style.backgroundColor="rgba(0, 0, 0, 0.8)",y.style.color="white",y.style.display="flex",y.style.justifyContent="center",y.style.alignItems="center",y.style.fontSize="2rem",y.style.zIndex="99000",y.textContent=Z,document.body.appendChild(y),setTimeout(()=>{document.body.removeChild(y)},2e3)},nt={class:"modal-content"},at={key:0},it={key:1},rt={class:"players-list"},ut=["onClick"],vt={key:0,class:"warning-icon material-icons",title:"Внимание!"},dt={key:0},ct={key:0,class:"warning-icon material-icons",title:"Внимание!"},pt={key:1},mt={key:0,class:"warning-icon material-icons",title:"Внимание!"},kt=["onClick"],yt={key:0,class:"warning-icon material-icons",title:"Внимание!"},ft={__name:"PlayerModal",props:{players:{type:Array,required:!0},selectedPlayer:{type:Object,default:null}},emits:["close","select"],setup(Z,{emit:y}){const S=Z,C=y,w=c(null),Y=T(()=>S.players.filter(n=>!P(n)&&!e(n))),f=T(()=>S.players.some(n=>P(n))),E=T(()=>S.players.some(n=>e(n))),P=n=>n.key.toUpperCase().includes("HDREZKA"),e=n=>n.key.toUpperCase().includes("KODIK"),$=n=>n.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"").trim(),h=n=>{C("select",n),C("close")},D=n=>S.selectedPlayer&&S.selectedPlayer.key===n.key,z=n=>{w.value=n},g=()=>{w.value=null},O=n=>{let r=S.players.filter(p=>n==="hdrezka"&&P(p)||n==="kodik"&&e(p));return n==="kodik"?r.sort((p,V)=>$(p.translate).localeCompare($(V.translate))):r},k=n=>O(n).some(r=>r.warning);return(n,r)=>(l(),a("div",{class:"modal",onClick:r[3]||(r[3]=We(p=>n.$emit("close"),["self"]))},[t("div",nt,[t("button",{class:"close",onClick:r[0]||(r[0]=p=>n.$emit("close"))},"×"),w.value?(l(),a("h2",it,[t("button",{class:"back-btn",onClick:g},"← Назад"),x(" "+d(w.value==="hdrezka"?"ReYohoho - HDrezka":"Kodik"),1)])):(l(),a("h2",at,"Выберите плеер")),t("ul",rt,[w.value?(l(!0),a(le,{key:1},ke(O(w.value),p=>(l(),a("li",{key:p.key},[t("button",{class:U(["player-item",{active:D(p)}]),onClick:V=>h(p)},[x(d($(p.translate))+" ",1),p.warning?(l(),a("span",yt,"warning")):u("",!0)],10,kt)]))),128)):(l(),a(le,{key:0},[(l(!0),a(le,null,ke(Y.value,p=>(l(),a("li",{key:p.key},[t("button",{class:U(["player-item",{active:D(p)}]),onClick:V=>h(p)},[x(d($(p.translate))+" ",1),p.warning?(l(),a("span",vt,"warning")):u("",!0)],10,ut)]))),128)),f.value?(l(),a("li",dt,[t("button",{class:"group-item",onClick:r[1]||(r[1]=p=>z("hdrezka"))},[r[4]||(r[4]=t("span",{class:"material-icons group-icon"},"folder",-1)),r[5]||(r[5]=x(" ReYohoho - HDrezka ")),k("hdrezka")?(l(),a("span",ct,"warning")):u("",!0)])])):u("",!0),E.value?(l(),a("li",pt,[t("button",{class:"group-item",onClick:r[2]||(r[2]=p=>z("kodik"))},[r[6]||(r[6]=t("span",{class:"material-icons group-icon"},"folder",-1)),r[7]||(r[7]=x(" Kodik ")),k("kodik")?(l(),a("span",mt,"warning")):u("",!0)])])):u("",!0)],64))])])]))}},gt=ye(ft,[["__scopeId","data-v-7e4f2528"]]),_t={class:"players-list"},bt=["src"],ht={key:1,class:"controls"},wt={class:"tooltip-container"},$t={class:"material-icons"},At={class:"tooltip-container"},Mt={class:"tooltip-container"},Ct={class:"tooltip-container"},Et={class:"tooltip-container"},Tt={class:"material-symbols-outlined"},Pt=["onMouseenter","onClick"],St={key:0,class:"tooltip-container"},Rt={class:"custom-tooltip"},xt={key:1,class:"tooltip-container"},Lt={class:"custom-tooltip"},Ht={__name:"PlayerComponent",props:{kpId:String},emits:["update:selectedPlayer"],setup(Z,{emit:y}){const S=Ae(),C=tt(),w=Ie(),Y=c(w.params.kp_id),f=Z,E=y,P=c([]),e=c(null),$=c(!0),h=c(!1),D=c(!1),z=c(null),g=c(null),O=c(!1),k=c(""),n=c(null),r=c(window.innerHeight*.9),p=T(()=>"".concat(r.value,"px")),V=T(()=>S.isMobile),I=T(()=>!!window.electronAPI),b=c(null),X=c(!1);let W=null;const re=c(null),B=v=>{b.value=v,X.value=!1,clearTimeout(W)},J=()=>{X.value||(W=setTimeout(()=>{b.value=null},300))},ue=()=>{X.value=!0,clearTimeout(W)},de=()=>{X.value=!1,b.value=null},j=T({get:()=>C.aspectRatio,set:v=>C.updateAspectRatio(v)}),Q=T({get:()=>C.isCentered,set:v=>C.updateCentering(v)}),i=T(()=>C.preferredPlayer),o=c(0),R=v=>v.toUpperCase(),L=()=>{if(h.value||!g.value)return;const[v,s]=j.value.split(":").map(Number);r.value=window.innerHeight*.9,o.value=Math.min(g.value.clientWidth*(s/v),r.value)},m=T(()=>{if(h.value)return{};const[v,s]=j.value.split(":").map(Number),G=r.value*(v/s);return{width:"100%",maxWidth:"".concat(G,"px"),maxHeight:p.value,margin:"0 auto",overflow:"hidden"}}),ee=T(()=>{const[v,s]=j.value.split(":").map(Number);return{position:"relative",width:"100%",paddingTop:"".concat(s/v*100,"%")}}),q=()=>{g.value&&Te(()=>{g.value.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},te=async()=>{try{k.value="",n.value=null;const v=await Ge(f.kpId);if(P.value=Object.entries(v).map(([s,G])=>({key:s.toUpperCase(),...G})),P.value.length>0){if(i.value){const s=R(i.value),G=P.value.find(me=>R(me.key)===s);e.value=G||P.value[0]}else e.value=P.value[0];E("update:selectedPlayer",e.value)}}catch(v){const{message:s,code:G}=$e(v);k.value=s,n.value=G,console.error("Ошибка при загрузке плееров:",v)}},oe=()=>{O.value=!0},H=()=>{O.value=!1},N=v=>{var s;if(((s=e.value)==null?void 0:s.key)===v.key){H();return}e.value=v,$.value=!0,C.updatePreferredPlayer(R(v.key)),E("update:selectedPlayer",v)},ce=()=>{I.value?window.electronAPI.sendHotKey("F2"):(he("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},ve=()=>{I.value?window.electronAPI.sendHotKey("F3"):(he("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},fe=()=>{I.value?window.electronAPI.sendHotKey("F4"):(he("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},ge=()=>{h.value=!h.value,h.value?(window.addEventListener("mousemove",_e),document.addEventListener("keydown",be),document.body.classList.add("no-scroll")):(window.removeEventListener("mousemove",_e),document.removeEventListener("keydown",be),document.body.classList.remove("no-scroll")),D.value=h.value,Te(()=>q())},Ce=c(null),_e=()=>{Ce.value=setTimeout(()=>{clearTimeout(Ce.value),D.value=!1},4e3),D.value=!0},pe=T(()=>S.dimmingEnabled),Oe=()=>{h.value||S.toggleDimming()},be=v=>{v.key==="Escape"&&h.value&&ge()},Ve=v=>{j.value=v,setTimeout(()=>{Q.value&&q()},310)},Be=()=>{const v="reyohoho://#".concat(Y.value);try{window.location.href=v}catch(s){console.error("Ошибка при открытии ссылки:",s)}},qe=()=>{const v=window.location.href;navigator.clipboard.writeText(v).then(()=>{}),re.value.showNotification("Ссылка на фильм скопирована")},Ye=()=>{$.value=!1};function ze(v){return v.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"KODIK - ").trim()}return ie(e,v=>{v&&($.value=!0,C.updatePreferredPlayer(R(v.key)),E("update:selectedPlayer",v))}),ie(()=>w.params.kp_id,async v=>{v&&v!==Y.value&&(Y.value=v,Q.value&&q())},{immediate:!0}),Me(()=>{$.value=!0,te(),V.value&&(j.value="4:3"),L(),window.addEventListener("resize",L),Q.value&&q()}),De(()=>{window.removeEventListener("resize",L),window.removeEventListener("mousemove",_e),document.removeEventListener("keydown",be),document.body.classList.remove("no-scroll")}),(v,s)=>{var G,me;return k.value?(l(),se(Ne,{key:0,message:k.value,code:n.value},null,8,["message","code"])):(l(),a(le,{key:1},[t("div",_t,[s[17]||(s[17]=t("span",null,"Плеер:",-1)),t("button",{class:"player-btn",onClick:oe},d(e.value?ze(e.value.translate).toUpperCase():"Загрузка плееров..."),1)]),O.value?(l(),se(gt,{key:0,players:P.value,"selected-player":e.value,onClose:H,onSelect:N},null,8,["players","selected-player"])):u("",!0),t("div",{ref_key:"containerRef",ref:g,class:U(["player-container",{"theater-mode":h.value}]),style:we(h.value?{}:m.value)},[t("div",{class:"iframe-wrapper",style:we(h.value?{}:ee.value)},[A(t("iframe",{ref_key:"playerIframe",ref:z,src:(G=e.value)==null?void 0:G.iframe,frameborder:"0",allowfullscreen:"",webkitallowfullscreen:"",class:U(["responsive-iframe",{"theater-mode-unlock":D.value,"theater-mode-lock":h.value,dimmed:pe.value}]),onLoad:Ye},null,42,bt),[[M,!$.value&&((me=e.value)==null?void 0:me.iframe)]]),$.value?(l(),se(Ke,{key:0})):u("",!0)],4),h.value?(l(),a("button",{key:0,class:U(["close-theater-btn",{visible:D.value}]),onClick:ge}," ✖ ",2)):u("",!0)],6),V.value?u("",!0):(l(),a("div",ht,[t("div",wt,[t("button",{class:U(["dimming-btn",{active:pe.value}]),onMouseenter:s[0]||(s[0]=_=>B("dimming")),onMouseleave:s[1]||(s[1]=_=>b.value=null),onClick:Oe},[t("span",$t,d(pe.value?"light_mode":"dark_mode"),1)],34),A(t("div",{class:"custom-tooltip"},d(pe.value?"Отключить затемнение":"Включить затемнение"),513),[[M,b.value==="dimming"]])]),t("div",At,[t("button",{class:"blur-btn",onMouseenter:s[2]||(s[2]=_=>B("blur")),onMouseleave:s[3]||(s[3]=_=>b.value=null),onClick:ce},s[18]||(s[18]=[t("span",{class:"material-icons"},"blur_on",-1)]),32),A(t("div",{class:"custom-tooltip"},d(I.value?"Блюр":"Блюр, функция доступна в приложении"),513),[[M,b.value==="blur"]])]),t("div",Mt,[t("button",{class:"material-symbols-outlined",onMouseenter:s[4]||(s[4]=_=>B("compressor")),onMouseleave:s[5]||(s[5]=_=>b.value=null),onClick:ve},s[19]||(s[19]=[t("span",{class:"material-icons"},"graphic_eq",-1)]),32),A(t("div",{class:"custom-tooltip"},d(I.value?"Компрессор":"Компрессор, функция доступна в приложении"),513),[[M,b.value==="compressor"]])]),t("div",Ct,[t("button",{class:"mirror-btn",onMouseenter:s[6]||(s[6]=_=>B("mirror")),onMouseleave:s[7]||(s[7]=_=>b.value=null),onClick:fe},s[20]||(s[20]=[t("span",{class:"material-icons"},"flip",-1)]),32),A(t("div",{class:"custom-tooltip"},d(I.value?"Зеркало":"Зеркало, функция доступна в приложении"),513),[[M,b.value==="mirror"]])]),t("div",Et,[t("button",{class:"theater-mode-btn",onMouseenter:s[8]||(s[8]=_=>B("theater")),onMouseleave:s[9]||(s[9]=_=>b.value=null),onClick:ge},[t("span",Tt,d(h.value?"fullscreen_exit":"aspect_ratio"),1)],32),A(t("div",{class:"custom-tooltip"},d(h.value?"Выйти из театрального режима":"Театральный режим"),513),[[M,b.value==="theater"]])]),(l(),a(le,null,ke(["16:9","12:5","4:3"],_=>t("div",{key:_,class:"tooltip-container"},[t("button",{class:U(["aspect-ratio-btn",{active:j.value===_}]),onMouseenter:Ee=>B(_),onMouseleave:s[10]||(s[10]=Ee=>b.value=null),onClick:Ee=>Ve(_)},d(_),43,Pt),A(t("div",{class:"custom-tooltip"}," Установить соотношение "+d(_),513),[[M,b.value===_]])])),64)),t("div",{class:"tooltip-container",onMouseenter:s[12]||(s[12]=_=>B("centering")),onMouseleave:J},[t("button",{class:"center-btn",onClick:q},s[21]||(s[21]=[t("span",{class:"material-icons"},"center_focus_strong",-1)])),A(t("div",{class:"custom-tooltip advanced-tooltip",onMouseenter:ue,onMouseleave:de},[s[22]||(s[22]=x(" Отцентрировать плеер ")),ae(ot,{modelValue:Q.value,"onUpdate:modelValue":s[11]||(s[11]=_=>Q.value=_),title:"Автоцентрирование плеера"},null,8,["modelValue"]),s[23]||(s[23]=t("span",{class:"tooltip-title"},"Автоцентрирование плеера",-1))],544),[[M,b.value==="centering"]])],32),I.value?u("",!0):(l(),a("div",St,[t("button",{class:"app-link-btn",onMouseenter:s[13]||(s[13]=_=>B("app_link")),onMouseleave:s[14]||(s[14]=_=>b.value=null),onClick:Be},s[24]||(s[24]=[t("span",{class:"material-icons"},"open_in_new",-1)]),32),A(t("div",Rt,"Открыть в приложении",512),[[M,b.value==="app_link"]])])),I.value?(l(),a("div",xt,[t("button",{class:"copy-link-btn",onMouseenter:s[15]||(s[15]=_=>B("copy_link")),onMouseleave:s[16]||(s[16]=_=>b.value=null),onClick:qe},s[25]||(s[25]=[t("span",{class:"material-icons"},"content_copy",-1)]),32),A(t("div",Lt,"Скопировать ссылку",512),[[M,b.value==="copy_link"]])])):u("",!0)])),ae(Ue,{ref_key:"notificationRef",ref:re},null,512)],64))}}},He=ye(Ht,[["__scopeId","data-v-527fa1fd"]]),It={key:0,class:"carousel-container"},Dt={class:"carousel-wrapper"},Nt=["onClick"],Kt=["src","alt"],Ut={class:"video-name"},Ot={key:0,class:"video-player"},Vt=["src"],Bt={__name:"TrailerCarousel",props:{videos:{type:Array,required:!0},activeVideoIndex:{type:Number,default:null}},emits:["select"],setup(Z,{emit:y}){const S=Ae(),C=T(()=>S.isMobile),w=Z,Y=y,f=c(w.activeVideoIndex),E=c(null),P=c(!1),e=c(!1),$=()=>{if(!E.value)return;const{scrollLeft:k,scrollWidth:n,clientWidth:r}=E.value;P.value=k>0,e.value=k<n-r-1},h=k=>{if(!E.value)return;const n=E.value.querySelector(".carousel-item");if(!n)return;const r=n.clientWidth+16;E.value.scrollBy({left:r*k,behavior:"smooth"})},D=k=>{f.value=k,Y("select",w.videos[k])},z=()=>$(),g=c([]),O=async k=>{try{return(await fetch("https://img.youtube.com/vi/".concat(k,"/0.jpg"))).ok}catch(n){return!1}};return Me(async()=>{const k=w.videos.map(async r=>await O(r.videoId)?r:null),n=await Promise.all(k);g.value=n.filter(Boolean),$(),window.addEventListener("resize",z)}),ie(()=>w.videos,async k=>{const n=k.map(async p=>await O(p.videoId)?p:null),r=await Promise.all(n);g.value=r.filter(Boolean)}),ie(()=>w.activeVideoIndex,k=>{f.value=k}),De(()=>{window.removeEventListener("resize",z)}),(k,n)=>g.value.length?(l(),a("div",It,[n[4]||(n[4]=t("h2",null,"Трейлеры (YouTube)",-1)),t("div",Dt,[A(t("button",{class:"scroll-button left",onClick:n[0]||(n[0]=r=>h(-1))},n[2]||(n[2]=[t("span",{class:"material-symbols-outlined"},"arrow_back_ios",-1)]),512),[[M,!C.value&&P.value]]),t("div",{ref_key:"carousel",ref:E,class:"carousel",onScroll:$},[(l(!0),a(le,null,ke(g.value,(r,p)=>(l(),a("div",{key:p,class:"carousel-item",onClick:V=>D(p)},[t("img",{src:"https://img.youtube.com/vi/".concat(r.videoId,"/0.jpg"),alt:r.name},null,8,Kt),t("div",Ut,d(r.name),1)],8,Nt))),128))],544),A(t("button",{class:"scroll-button right",onClick:n[1]||(n[1]=r=>h(1))},n[3]||(n[3]=[t("span",{class:"material-symbols-outlined"},"arrow_forward_ios",-1)]),512),[[M,!C.value&&e.value]])]),f.value!==null?(l(),a("div",Ot,[t("iframe",{src:Z.videos[f.value].iframeUrl,frameborder:"0",allowfullscreen:""},null,8,Vt)])):u("",!0)])):u("",!0)}},qt=ye(Bt,[["__scopeId","data-v-5d54158b"]]),Yt={class:"movie-info"},zt={class:"content"},Wt={key:2,class:"content-card"},Gt={key:3,class:"content-card"},Ft={class:"content-header"},Zt=["src"],jt={class:"content-title"},Qt={key:0,class:"ratings-links"},Xt={key:0},Jt=["href"],eo={key:0},to={key:1},oo=["href"],so={key:0},lo={key:2},no=["href"],ao={key:0},io={key:3},ro=["href"],uo={key:0},vo={key:4},co=["href"],po={key:5},mo=["href"],ko=["content"],yo=["content"],fo={class:"additional-info"},go={class:"controls"},_o={class:"tooltip-container"},bo={class:"material-icons"},ho={class:"custom-tooltip"},wo={class:"tooltip-container"},$o={class:"material-icons"},Ao={class:"custom-tooltip"},Mo={class:"tooltip-container"},Co={class:"custom-tooltip"},Eo={class:"tooltip-container"},To={class:"material-icons"},Po={class:"custom-tooltip"},So={class:"tooltip-container"},Ro={class:"material-icons"},xo={class:"custom-tooltip"},Lo={class:"info-content"},Ho={class:"details-container"},Io={class:"info-list"},Do={key:0},No={key:1},Ko={key:2},Uo={key:3},Oo={key:4},Vo={key:5},Bo={key:6},qo={key:7},Yo={key:8},zo={class:"content-info"},Wo={key:0,class:"content-description-text"},Go={key:2,class:"yt-video-container"},Fo={key:3,class:"related-movies"},Zo={key:4,class:"related-movies"},jo={__name:"MovieInfo",setup(Z){const y=c(!0),S=Ae(),C=Fe(),w=Ze(),Y=Ie(),f=c(Y.params.kp_id),E=c(""),P=c(null),e=c(null),$=je(),D=st().areTrailersActive,z=c(null),g=c(null),O=c(!1);let k=null;const n=i=>{g.value=i,O.value=!1,clearTimeout(k)},r=()=>{if(e.value){const i=e.value.name_ru||e.value.name_en||e.value.name_original||"Информация о фильме";document.title=i}},p=i=>(i||[]).map(o=>({kp_id:o.film_id,poster:o.poster_url_preview||o.poster_url,title:o.name_ru||o.name_en||o.name_original})),V=i=>{if(typeof i!="number")return;const o=Math.floor(i/60),R=i%60;return"".concat(o," ч. ").concat(R," мин.")},I=c(!1),b=c({top:"0px",left:"0px"}),X=i=>{I.value=!0,b.value={top:"".concat(i.pageY+10,"px"),left:"".concat(i.pageX-70,"px")}},W=c(null),re=async()=>{try{const i=[e.value.name_ru||e.value.name_en||e.value.name_original,...e.value.year?[e.value.year]:[],...e.value.film_length?[V(e.value.film_length)]:[]];await navigator.clipboard.writeText(i.join(", ")),W.value.showNotification("Скопировано")}catch(i){console.error("Ошибка копирования:",i)}},B=(i,o)=>{var L,m,ee,q,te,oe,H;return(H={[K.FAVORITE]:((L=i.lists)==null?void 0:L.isFavorite)||!1,[K.HISTORY]:((m=i.lists)==null?void 0:m.isHistory)||!1,[K.LATER]:((ee=i.lists)==null?void 0:ee.isLater)||!1,[K.COMPLETED]:((q=i.lists)==null?void 0:q.isCompleted)||!1,[K.ABANDONED]:((te=i.lists)==null?void 0:te.isAbandoned)||!1,[K.WATCHING]:((oe=i.lists)==null?void 0:oe.isWatching)||!1}[o])!=null?H:!1},J=async i=>{if(!C.token){W.value.showNotification("Необходимо авторизоваться",5e3);return}try{B(e.value,i)?(await et(f.value,i),W.value.showNotification("Удалено")):(await Se(f.value,i),W.value.showNotification("Добавлено"))}catch(o){const{message:R,code:L}=$e(o);W.value.showNotification("".concat(R," ").concat(L))}await ue(!1)},ue=async(i=!0)=>{var o,R,L,m,ee,q,te,oe;try{let H;if(f.value.startsWith("shiki")?H=await Xe(f.value):H=await Je(f.value,C.token),Array.isArray(H)&&H.length===0)throw new Error("Данные не найдены. Пожалуйста, повторите поиск.");e.value=H,f.value.startsWith("shiki")?e.value={...e.value,title:e.value.name_ru||e.value.name_en,name_original:e.value.name_en,short_description:e.value.slogan}:e.value={...e.value,title:e.value.name_ru||e.value.name_en||e.value.name_original,kinopoisk_id:f.value},$.setHeaderContent({text:e.value.title,imageUrl:e.value.logo_url}),r();const N={kp_id:f.value,title:((o=e.value)==null?void 0:o.name_ru)||((R=e.value)==null?void 0:R.name_en)||((L=e.value)==null?void 0:L.name_original),poster:((m=e.value)==null?void 0:m.poster_url)||((ee=e.value)==null?void 0:ee.cover_url)||((q=e.value)==null?void 0:q.screenshots[0]),year:(te=e.value)==null?void 0:te.year,type:(oe=e.value)==null?void 0:oe.type};if(f.value.startsWith("shiki"))if(e.value.screenshots&&e.value.screenshots.length>0){const ve=Math.floor(Math.random()*e.value.screenshots.length),fe=e.value.screenshots[ve];w.updateMoviePoster(fe)}else N.poster&&w.updateMoviePoster(N.poster);else N.poster&&w.updateMoviePoster(N.poster);if(T(()=>S.isHistoryAllowed).value&&N.kp_id&&N.title&&i)if(C.token)try{await Se(N.kp_id,K.HISTORY)}catch(ve){console.error("Ошибка при добавлении в историю:",ve)}else S.addToHistory({...N})}catch(H){const{message:N,code:ce}=$e(H);E.value=N,P.value=ce,console.error("Ошибка при загрузке информации о фильмах:",H)}},de=T(()=>{var i,o;return console.log("Трейлеры:",(i=e.value)==null?void 0:i.videos),(o=e.value)==null?void 0:o.videos}),j=T(()=>{var i;return p((i=e.value)==null?void 0:i.sequels_and_prequels)}),Q=T(()=>{var i;return p((i=e.value)==null?void 0:i.similars)});return Me(async()=>{await ue(),y.value=!1}),Qe(async()=>{$.clearHeaderContent()}),ie(()=>Y.params.kp_id,async i=>{i&&i!==f.value&&($.clearHeaderContent(),f.value=i,z.value=null,await ue(),y.value=!1)},{immediate:!0}),ie(e,()=>{r()},{deep:!0}),(i,o)=>{var R,L;return l(),a(le,null,[t("div",Yt,[t("div",zt,[y.value?(l(),se(Ke,{key:0})):u("",!0),E.value?(l(),se(Ne,{key:1,message:E.value,code:P.value},null,8,["message","code"])):u("",!0),E.value?(l(),a("div",Wt,[(l(),se(He,{key:f.value,"kp-id":f.value},null,8,["kp-id"]))])):u("",!0),e.value?(l(),a("div",Gt,[t("div",Ft,[e.value.logo_url?(l(),a("div",{key:0,class:"content-logo",onMousemove:X,onMouseleave:o[0]||(o[0]=m=>I.value=!1),onClick:re},[t("img",{src:e.value.logo_url,alt:"Логотип фильма",class:"content-logo"},null,8,Zt)],32)):(l(),a("div",{key:1,onMousemove:X,onMouseleave:o[1]||(o[1]=m=>I.value=!1),onClick:re},[t("h1",jt,d(e.value.title),1)],32)),A(t("div",{class:"title-copy-tooltip",style:we(b.value)}," Скопировать ",4),[[M,I.value]])]),e.value.kinopoisk_id||e.value.title||e.value.imdb_id||e.value.rating_imdb||e.value.shikimori_id?(l(),a("div",Qt,[e.value.kinopoisk_id?(l(),a("div",Xt,[t("a",{href:"https://www.kinopoisk.ru/film/".concat(e.value.kinopoisk_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[o[17]||(o[17]=t("img",{src:Re,alt:"КП",class:"rating-logo"},null,-1)),e.value.rating_kinopoisk?(l(),a("span",eo,d(e.value.rating_kinopoisk)+"/10",1)):u("",!0),o[18]||(o[18]=t("img",{src:ne,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Jt)])):u("",!0),!e.value.kinopoisk_id&&e.value.title?(l(),a("div",to,[t("a",{href:"https://www.kinopoisk.ru/index.php?kp_query=".concat(encodeURIComponent(e.value.title+(e.value.year?" "+e.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[o[19]||(o[19]=t("img",{src:Re,alt:"КП",class:"rating-logo"},null,-1)),e.value.rating_kinopoisk?(l(),a("span",so,d(e.value.rating_kinopoisk)+"/10",1)):u("",!0),o[20]||(o[20]=t("img",{src:ne,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,oo)])):u("",!0),e.value.imdb_id?(l(),a("div",lo,[t("a",{href:"https://www.imdb.com/title/".concat(e.value.imdb_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[o[21]||(o[21]=t("img",{src:xe,alt:"IMDb",class:"rating-logo"},null,-1)),e.value.rating_imdb?(l(),a("span",ao,d(e.value.rating_imdb)+"/10",1)):u("",!0),o[22]||(o[22]=t("img",{src:ne,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,no)])):u("",!0),!e.value.imdb_id&&e.value.title?(l(),a("div",io,[t("a",{href:"https://www.imdb.com/find/?q=".concat(encodeURIComponent(e.value.title+(e.value.year?" "+e.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[o[23]||(o[23]=t("img",{src:xe,alt:"IMDb",class:"rating-logo"},null,-1)),e.value.rating_imdb?(l(),a("span",uo,d(e.value.rating_imdb)+"/10",1)):u("",!0),o[24]||(o[24]=t("img",{src:ne,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,ro)])):u("",!0),e.value.shikimori_id?(l(),a("div",vo,[t("a",{href:"https://shikimori.one/animes/".concat(e.value.shikimori_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},o[25]||(o[25]=[t("img",{src:lt,alt:"Shiki",class:"rating-logo"},null,-1),t("img",{src:ne,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)]),8,co)])):u("",!0),e.value.imdb_id?(l(),a("div",po,[t("a",{href:"https://www.imdb.com/title/".concat(e.value.imdb_id,"/parentalguide"),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},o[26]||(o[26]=[t("span",null,"Parents Guide",-1),t("img",{src:ne,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)]),8,mo)])):u("",!0)])):u("",!0),(l(),se(He,{key:f.value,"kp-id":f.value},null,8,["kp-id"])),t("meta",{name:"title-and-year",content:e.value.type==="FILM"&&e.value.year?"".concat(e.value.title," (").concat(e.value.year,")"):e.value.title},null,8,ko),e.value.name_original?(l(),a("meta",{key:1,name:"original-title",content:e.value.name_original},null,8,yo)):u("",!0),t("div",fo,[t("div",go,[t("div",_o,[t("button",{class:U(["favorite-btn",{active:e.value.lists.isFavorite}]),onMouseenter:o[2]||(o[2]=m=>n("favorite")),onMouseleave:o[3]||(o[3]=m=>g.value=null),onClick:o[4]||(o[4]=m=>J(F(K).FAVORITE))},[t("span",bo,d(e.value.lists.isFavorite?"favorite":"favorite_border"),1)],34),A(t("div",ho,d("В избранное"),512),[[M,g.value==="favorite"]])]),t("div",wo,[t("button",{class:U(["watching-btn",{active:e.value.lists.isWatching}]),onMouseenter:o[5]||(o[5]=m=>n("watching")),onMouseleave:o[6]||(o[6]=m=>g.value=null),onClick:o[7]||(o[7]=m=>J(F(K).WATCHING))},[t("span",$o,d(e.value.lists.isWatching?"visibility":"visibility_off"),1)],34),A(t("div",Ao,d("Смотрю"),512),[[M,g.value==="watching"]])]),t("div",Mo,[t("button",{class:U(["later-btn",{active:e.value.lists.isLater}]),onMouseenter:o[8]||(o[8]=m=>n("later")),onMouseleave:o[9]||(o[9]=m=>g.value=null),onClick:o[10]||(o[10]=m=>J(F(K).LATER))},o[27]||(o[27]=[t("span",{class:"material-icons"},d("watch_later"),-1)]),34),A(t("div",Co,d("Смотреть позже"),512),[[M,g.value==="later"]])]),t("div",Eo,[t("button",{class:U(["completed-btn",{active:e.value.lists.isCompleted}]),onMouseenter:o[11]||(o[11]=m=>n("completed")),onMouseleave:o[12]||(o[12]=m=>g.value=null),onClick:o[13]||(o[13]=m=>J(F(K).COMPLETED))},[t("span",To,d(e.value.lists.isCompleted?"check_circle":"check_circle_outline"),1)],34),A(t("div",Po,d("Просмотрено"),512),[[M,g.value==="completed"]])]),t("div",So,[t("button",{class:U(["abandoned-btn",{active:e.value.lists.isAbandoned}]),onMouseenter:o[14]||(o[14]=m=>n("abandoned")),onMouseleave:o[15]||(o[15]=m=>g.value=null),onClick:o[16]||(o[16]=m=>J(F(K).ABANDONED))},[t("span",Ro,d((e.value.lists.isAbandoned,"not_interested")),1)],34),A(t("div",xo,d("Брошено"),512),[[M,g.value==="abandoned"]])])]),o[37]||(o[37]=t("h2",{class:"additional-info-title"},"Подробнее",-1)),t("div",Lo,[t("div",Ho,[t("ul",Io,[e.value.type&&F(Pe)[e.value.type]?(l(),a("li",Do,[o[28]||(o[28]=t("strong",null,"Тип:",-1)),x(" "+d(F(Pe)[e.value.type]),1)])):u("",!0),e.value.year?(l(),a("li",No,[o[29]||(o[29]=t("strong",null,"Год выпуска:",-1)),x(" "+d(e.value.year),1)])):u("",!0),e.value.title?(l(),a("li",Ko,[o[30]||(o[30]=t("strong",null,"Название:",-1)),x(" "+d(e.value.title),1)])):u("",!0),e.value.name_original?(l(),a("li",Uo,[o[31]||(o[31]=t("strong",null,"Оригинальное название:",-1)),x(" "+d(e.value.name_original),1)])):u("",!0),e.value.slogan?(l(),a("li",Oo,[o[32]||(o[32]=t("strong",null,"Слоган:",-1)),x(" "+d(e.value.slogan),1)])):u("",!0),e.value.production_companies?(l(),a("li",Vo,[o[33]||(o[33]=t("strong",null,"Продакшн:",-1)),x(" "+d(e.value.production_companies),1)])):u("",!0),(R=e.value.countries)!=null&&R.length?(l(),a("li",Bo,[o[34]||(o[34]=t("strong",null,"Страна производства:",-1)),x(" "+d(e.value.countries.map(m=>m.country).join(", ")),1)])):u("",!0),(L=e.value.genres)!=null&&L.length?(l(),a("li",qo,[o[35]||(o[35]=t("strong",null,"Жанры:",-1)),x(" "+d(e.value.genres.map(m=>m.genre).join(", ")),1)])):u("",!0),e.value.film_length?(l(),a("li",Yo,[o[36]||(o[36]=t("strong",null,"Продолжительность:",-1)),x(" "+d(V(e.value.film_length)),1)])):u("",!0)])])])]),t("div",zo,[e.value.description?(l(),a("p",Wo,d(e.value.description),1)):u("",!0)]),de.value.length&&F(D)?(l(),a("div",Go,[ae(qt,{videos:de.value,"active-video-index":z.value,onSelect:i.playTrailer},null,8,["videos","active-video-index","onSelect"])])):u("",!0),j.value.length?(l(),a("div",Fo,[o[38]||(o[38]=t("h2",null,"Сиквелы и приквелы",-1)),ae(F(Le),{"movies-list":j.value,loading:!1,"is-history":!1},null,8,["movies-list"])])):u("",!0),Q.value.length?(l(),a("div",Zo,[o[39]||(o[39]=t("h2",null,"Похожие",-1)),ae(F(Le),{"movies-list":Q.value,loading:!1,"is-history":!1},null,8,["movies-list"])])):u("",!0)])):u("",!0)])]),ae(Ue,{ref_key:"notificationRef",ref:W},null,512)],64)}}},ts=ye(jo,[["__scopeId","data-v-5676d014"]]);export{ts as default};
//# sourceMappingURL=MovieInfo-CX_pNdOu.js.map
