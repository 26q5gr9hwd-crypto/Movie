System.register(["./index-legacy-DCh-zRcD.js"],(function(e,r){"use strict";var t;return{setters:[e=>{t=e.ao}],execute:function(){e("u",(function(){var e=e=>{try{var r=new URL(e);return"cdn.7tv.app"===r.hostname&&"https:"===r.protocol||r.pathname.includes("/api/7tv")&&"https:"===r.protocol?`${t()}${r.pathname}${r.search}${r.hash}`:(console.warn("URL изображения отклонен:",{url:e,hostname:r.hostname,protocol:r.protocol,reason:"cdn.7tv.app"!==r.hostname?"неразрешенный домен":"неразрешенный протокол"}),!1)}catch(n){return console.warn("Недопустимый URL изображения:",e,"Ошибка:",n.message),!1}},r=e=>{var r=document.createElement("div");return r.textContent=e,r.innerHTML},n=t=>{if(!t)return"";var n=t;return n=(n=(n=(n=(n=(n=n.replace(/\[spoiler\]\s*\[\/spoiler\]/g,"")).replace(/\[img\]\s*\[\/img\]/g,"")).replace(/\[link=[^\]]+\]\s*\[\/link\]/g,"")).replace(/\[spoiler\]([^]*?)\[\/spoiler\]/g,((t,n,a,s)=>{var i=n.trim();if(!i)return"";var l=i.split(/(\[img\].*?\[\/img\]|\[link=.*?\[\/link\])/).filter(Boolean).map((t=>t.startsWith("[img]")?t.replace(/\[img\](.*?)\[\/img\]/g,((t,n)=>{var a=n.trim(),s=e(a);return s&&!1!==s?`<span class="spoiler-hidden-content"><img src="${r(s)}" alt="7TV emote" class="inline-emoji" loading="lazy" /></span>`:`[недопустимое изображение: ${r(a)}]`})):t.startsWith("[link=")?t.replace(/\[link=([^\]]+)\](.*?)\[\/link\]/g,((e,t,n)=>{var a=t.trim(),s=n.trim();return s?/^https?:\/\//.test(a)&&s?`<a href="${r(a)}" target="_blank" rel="noopener noreferrer" class="comment-link">${r(s)}</a>`:r(s||a):""})):r(t))).join(""),o=a>0?s[a-1]:" ",u=a+t.length<s.length?s[a+t.length]:" ";return`${o&&" "!==o&&"\n"!==o&&"\t"!==o?" ":""}<span class="spoiler-text" onclick="this.classList.toggle('revealed')" title="Нажмите, чтобы показать спойлер">${l}</span>${u&&" "!==u&&"\n"!==u&&"\t"!==u?" ":""}`}))).replace(/\[img\](.*?)\[\/img\]/g,((t,n)=>{var a=n.trim(),s=e(a);return s&&!1!==s?`<img src="${r(s)}" alt="7TV emote" class="inline-emoji" loading="lazy" />`:`[недопустимое изображение: ${r(a)}]`}))).replace(/\[link=([^\]]+)\](.*?)\[\/link\]/g,((e,t,n)=>{var a=t.trim(),s=n.trim();return s?/^https?:\/\//.test(a)&&s?`<a href="${r(a)}" target="_blank" rel="noopener noreferrer" class="comment-link">${r(s)}</a>`:r(s||a):""}))};return{formatContent:n,formatContentWithTruncation:e=>e?n(e):"",isValidImageUrl:e,escapeHtml:r}})),e("a",(e=>{if(!e)return"";var r=e.substring(0,4),t=e.substring(4,6),n=e.substring(6,8),a=e.substring(9,11),s=e.substring(11,13),i=e.substring(13,15);return new Date(Date.UTC(parseInt(r),parseInt(t)-1,parseInt(n),parseInt(a),parseInt(s),parseInt(i))).toLocaleDateString("ru-RU",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone})})),e("f",(e=>{if(!e)return"";var t=e.substring(0,4),o=e.substring(4,6),u=e.substring(6,8),c=e.substring(9,11),p=e.substring(11,13),m=e.substring(13,15),g=new Date(Date.UTC(parseInt(t),parseInt(o)-1,parseInt(u),parseInt(c),parseInt(p),parseInt(m))),h=new Date,d=Math.floor((h-g)/1e3);if(d<60)return"только что";var f=Math.floor(d/60);if(f<60)return`${f} ${r(f)} назад`;var $=Math.floor(f/60);if($<24)return`${$} ${n($)} назад`;var v=Math.floor($/24);if(v<7)return`${v} ${a(v)} назад`;var b=Math.floor(v/7);if(b<4)return`${b} ${s(b)} назад`;var k=Math.floor(v/30);if(k<12)return`${k} ${i(k)} назад`;var I=Math.floor(v/365);return`${I} ${l(I)} назад`}));var r=e=>e%10==1&&e%100!=11?"минуту":[2,3,4].includes(e%10)&&![12,13,14].includes(e%100)?"минуты":"минут",n=e=>e%10==1&&e%100!=11?"час":[2,3,4].includes(e%10)&&![12,13,14].includes(e%100)?"часа":"часов",a=e=>e%10==1&&e%100!=11?"день":[2,3,4].includes(e%10)&&![12,13,14].includes(e%100)?"дня":"дней",s=e=>e%10==1&&e%100!=11?"неделю":[2,3,4].includes(e%10)&&![12,13,14].includes(e%100)?"недели":"недель",i=e=>e%10==1&&e%100!=11?"месяц":[2,3,4].includes(e%10)&&![12,13,14].includes(e%100)?"месяца":"месяцев",l=e=>e%10==1&&e%100!=11?"год":[2,3,4].includes(e%10)&&![12,13,14].includes(e%100)?"года":"лет"}}}));
