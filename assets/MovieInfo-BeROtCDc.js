import{_ as Ce,r as k,c as T,b as i,d as l,e,s as L,t as c,K as X,g as d,L as Ae,n as A,q as Ot,u as Se,i as _t,N as bt,l as ie,o as Le,O as wt,x as ne,E as $t,f as te,P as Pe,m as C,Q as M,y as S,U as w,R as Kt,D as Re,S as ct,V as Ut,W as ht,X as Vt,Y as Bt,a as qt,Z as mt,$ as pt,a0 as Wt,a1 as Yt}from"./index-C5zyoMOs.js";import{S as At,_ as kt,a as ft,M as yt}from"./MovieList-BUaWjakw.js";import{N as Ct}from"./ToastMessage-C773JxB3.js";import{u as Ft,S as zt,a as Gt}from"./trailer-C2eDZi68.js";const le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVR4nO2ZQUoDMRSGR7eewHoFsVS0HkUUXNXqASqK2EURBPFIVRe6c+UN1CvUXWvbT4KvMAwzNnnJdCrmg1BKad7/v7y0b5IkiUQiCwGoAx3gQjEugZ0qxTeAIX6MKjMBnBOGS62AVWAPOHVYdlMu9YArYOhphLeBT+ALmOKGEd2QubaAK+B2zngFxt4GgDXgGZjgR8ch5oEkCi8DkvlnRcYLV0Apfqw10M7JvPkV6AN3FmVwK+WyZRnvMEe8ef/ibECyb2o+zRuwnpQAxeLNivQ0BvYyE46qEJ/8fK4ycJKp/X4V4n0MdDNfukkqEO9jwP1LDgD7BeKPgmgp04CL+KUz4Cp+qQxoxC+NAdsNm4c0hWkukkUa8BGfegiadbFDq3/2UAZ8xc+QVvzMtqcKYkBaZ5/MN5xEl2DgLGDZ1KswsC09FPJqXTZoNm5oA6kyMGI2FxqfkluJ0uMTDfhBXAHiHvCCWEL8/RLqlv1MPCf+TSZ+13WC7KnEfWlqcwAeU7GNjnbiQsG5UC1ZAEAt1UMhOpquk6zknMy9l20C2AA+MnEHRo9msuOCs9EH4Fp5TVQ0rqVs0plH4re02Qh1Oq1lCjypsp+5H3gKcD/gykTirqnFZ/ZDy+OGxpapzD+QePrM/2KkKfcGPcv7AdvRkz23G1x4JPIP+AY3r/ywUk/2JAAAAABJRU5ErkJggg==",Zt="/reyohoho/assets/icon-shikimori-DGvXK9Jc.svg",Te=f=>{const _=document.createElement("div");_.style.position="fixed",_.style.top="0",_.style.left="0",_.style.width="100%",_.style.height="100%",_.style.backgroundColor="rgba(0, 0, 0, 0.8)",_.style.color="white",_.style.display="flex",_.style.justifyContent="center",_.style.alignItems="center",_.style.fontSize="2rem",_.style.zIndex="99000",_.textContent=f,document.body.appendChild(_),setTimeout(()=>{document.body.removeChild(_)},2e3)},jt={class:"modal-content"},Qt={key:0},Xt={key:1},Jt={class:"players-list"},eo=["onClick"],to={key:0,class:"warning-icon material-icons",title:"Внимание!"},oo={key:0},so={key:0,class:"warning-icon material-icons",title:"Внимание!"},lo={key:1},no={key:0,class:"warning-icon material-icons",title:"Внимание!"},io=["onClick"],ao={key:0,class:"warning-icon material-icons",title:"Внимание!"},ro={__name:"PlayerModal",props:{players:{type:Array,required:!0},selectedPlayer:{type:Object,default:null}},emits:["close","select"],setup(f,{emit:_}){const x=f,P=_,I=k(null),F=T(()=>x.players.filter(n=>!H(n)&&!o(n))),y=T(()=>x.players.some(n=>H(n))),h=T(()=>x.players.some(n=>o(n))),H=n=>n.key.toUpperCase().includes("HDREZKA"),o=n=>n.key.toUpperCase().includes("KODIK"),b=n=>n.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"").trim(),U=n=>{P("select",n),P("close")},$=n=>x.selectedPlayer&&x.selectedPlayer.key===n.key,N=n=>{I.value=n},q=()=>{I.value=null},O=n=>{let v=x.players.filter(m=>n==="hdrezka"&&H(m)||n==="kodik"&&o(m));return n==="kodik"?v.sort((m,Y)=>b(m.translate).localeCompare(b(Y.translate))):v},g=n=>O(n).some(v=>v.warning);return(n,v)=>(l(),i("div",{class:"modal",onClick:v[3]||(v[3]=Ot(m=>n.$emit("close"),["self"]))},[e("div",jt,[e("button",{class:"close",onClick:v[0]||(v[0]=m=>n.$emit("close"))},"×"),I.value?(l(),i("h2",Xt,[e("button",{class:"back-btn",onClick:q},"← Назад"),L(" "+c(I.value==="hdrezka"?"ReYohoho - HDrezka":"Kodik"),1)])):(l(),i("h2",Qt,"Выберите плеер")),e("ul",Jt,[I.value?(l(!0),i(X,{key:1},Ae(O(I.value),m=>(l(),i("li",{key:m.key},[e("button",{class:A(["player-item",{active:$(m)}]),onClick:Y=>U(m)},[L(c(b(m.translate))+" ",1),m.warning?(l(),i("span",ao,"warning")):d("",!0)],10,io)]))),128)):(l(),i(X,{key:0},[(l(!0),i(X,null,Ae(F.value,m=>(l(),i("li",{key:m.key},[e("button",{class:A(["player-item",{active:$(m)}]),onClick:Y=>U(m)},[L(c(b(m.translate))+" ",1),m.warning?(l(),i("span",to,"warning")):d("",!0)],10,eo)]))),128)),y.value?(l(),i("li",oo,[e("button",{class:"group-item",onClick:v[1]||(v[1]=m=>N("hdrezka"))},[v[4]||(v[4]=e("span",{class:"material-icons group-icon"},"folder",-1)),v[5]||(v[5]=L(" ReYohoho - HDrezka ")),g("hdrezka")?(l(),i("span",so,"warning")):d("",!0)])])):d("",!0),h.value?(l(),i("li",lo,[e("button",{class:"group-item",onClick:v[2]||(v[2]=m=>N("kodik"))},[v[6]||(v[6]=e("span",{class:"material-icons group-icon"},"folder",-1)),v[7]||(v[7]=L(" Kodik ")),g("kodik")?(l(),i("span",no,"warning")):d("",!0)])])):d("",!0)],64))])])]))}},uo=Ce(ro,[["__scopeId","data-v-7e4f2528"]]),vo={class:"players-list"},co=["src"],mo={class:"controls"},po={key:0,class:"tooltip-container list-buttons-container"},ko={class:"material-icons"},fo={class:"list-button-item"},yo={class:"material-icons"},go={class:"list-button-item"},_o={class:"material-icons"},bo={class:"list-button-item"},wo={class:"list-button-item"},$o={class:"material-icons"},ho={class:"list-button-item"},Ao={class:"material-icons"},Co={key:1,class:"mobile-list-buttons"},Mo={class:"tooltip-container"},Io={class:"material-icons"},Eo={class:"custom-tooltip"},To={class:"tooltip-container"},Po={class:"material-icons"},Ro={class:"custom-tooltip"},So={class:"tooltip-container"},Lo={class:"custom-tooltip"},xo={class:"tooltip-container"},Do={class:"material-icons"},Ho={class:"custom-tooltip"},No={class:"tooltip-container"},Oo={class:"material-icons"},Ko={class:"custom-tooltip"},Uo={class:"tooltip-container"},Vo={class:"material-icons"},Bo={class:"tooltip-container"},qo={class:"tooltip-container"},Wo={class:"tooltip-container"},Yo={class:"tooltip-container"},Fo={class:"material-symbols-outlined"},zo={class:"custom-tooltip"},Go={class:"tooltip-container"},Zo={class:"current-ratio"},jo=["onClick"],Qo={key:0,class:"tooltip-container"},Xo={class:"custom-tooltip"},Jo={key:1,class:"tooltip-container"},es={class:"custom-tooltip"},ts={__name:"PlayerComponent",props:{kpId:String,movieInfo:{type:Object,default:()=>({})}},emits:["update:selectedPlayer","update:movieInfo"],setup(f,{emit:_}){const x=Se(),P=Ft(),I=_t(),F=bt(),y=k(F.params.kp_id),h=f,H=_,o=k([]),b=k(null),U=k(!0),$=k(!1),N=k(!1),q=k(null),O=k(null),g=k(!1),n=k(""),v=k(null),m=k(window.innerHeight*.9),Y=T(()=>"".concat(m.value,"px")),oe=T(()=>x.isMobile),R=T(()=>!!window.electronAPI),p=k(null),J=k(!1);let se=null;const z=k(null),r=a=>{p.value=a,J.value=!1,clearTimeout(se)},s=()=>{J.value||(se=setTimeout(()=>{p.value=null},300))},K=()=>{J.value=!0,clearTimeout(se)},G=()=>{J.value=!1,p.value=null},E=T({get:()=>P.aspectRatio,set:a=>P.updateAspectRatio(a)}),Q=T({get:()=>P.isCentered,set:a=>P.updateCentering(a)}),ae=T(()=>P.preferredPlayer),_e=k(0),ee=a=>a.toUpperCase(),V=()=>{if($.value||!O.value)return;const[a,t]=E.value.split(":").map(Number);m.value=window.innerHeight*.9,_e.value=Math.min(O.value.clientWidth*(t/a),m.value)},B=T(()=>{if($.value)return{};const[a,t]=E.value.split(":").map(Number),D=m.value*(a/t);return{width:"100%",maxWidth:"".concat(D,"px"),maxHeight:Y.value,margin:"0 auto",overflow:"hidden"}}),be=T(()=>{const[a,t]=E.value.split(":").map(Number);return{position:"relative",width:"100%",paddingTop:"".concat(t/a*100,"%")}}),Z=()=>{O.value&&setTimeout(()=>{ct(()=>{O.value.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},500)},Me=async()=>{try{n.value="",v.value=null;const a=await Kt(h.kpId);if(o.value=Object.entries(a).map(([t,D])=>({key:t.toUpperCase(),...D})),o.value.length>0){if(ae.value){const t=ee(ae.value),D=o.value.find(j=>ee(j.key)===t);b.value=D||o.value[0]}else b.value=o.value[0];H("update:selectedPlayer",b.value)}}catch(a){const{message:t,code:D}=Re(a);n.value=t,v.value=D,console.error("Ошибка при загрузке плееров:",a)}},Mt=()=>{g.value=!0},xe=()=>{g.value=!1},It=a=>{var t;if(((t=b.value)==null?void 0:t.key)===a.key){xe();return}b.value=a,U.value=!0,P.updatePreferredPlayer(ee(a.key)),H("update:selectedPlayer",a)},Et=()=>{R.value?window.electronAPI.sendHotKey("F2"):(Te("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},Tt=()=>{R.value?window.electronAPI.sendHotKey("F3"):(Te("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},Pt=()=>{R.value?window.electronAPI.sendHotKey("F4"):(Te("Доступно только в приложении ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},we=()=>{$.value=!$.value,$.value?(window.addEventListener("mousemove",Ie),document.addEventListener("keydown",Ee),document.body.classList.add("no-scroll")):(window.removeEventListener("mousemove",Ie),document.removeEventListener("keydown",Ee),document.body.classList.remove("no-scroll")),N.value=$.value,ct(()=>Z())},De=k(null),Ie=()=>{De.value=setTimeout(()=>{clearTimeout(De.value),N.value=!1},4e3),N.value=!0},$e=T(()=>x.dimmingEnabled),Rt=()=>{$.value||x.toggleDimming()},Ee=a=>{(a.key==="Escape"&&$.value||a.altKey&&a.keyCode===84)&&we()},He=a=>{E.value=a,setTimeout(()=>{Q.value&&Z()},310)},St=()=>{const a="reyohoho://#".concat(y.value);try{window.location.href=a}catch(t){console.error("Ошибка при открытии ссылки:",t)}},Lt=()=>{const a=window.location.href;navigator.clipboard.writeText(a).then(()=>{}),z.value.showNotification("Ссылка на фильм скопирована")},xt=()=>{U.value=!1};function Dt(a){return a.replace(/^REYOHOHO_PLAYER>HDREZKA>/,"").replace(/KODIK>/,"KODIK - ").trim()}ie(b,a=>{a&&(U.value=!0,P.updatePreferredPlayer(ee(a.key)),H("update:selectedPlayer",a))}),ie(()=>F.params.kp_id,async a=>{a&&a!==y.value&&(y.value=a,Q.value&&Z())},{immediate:!0});const he=["16:9","12:5","4:3"],Ht=()=>{const t=(he.indexOf(E.value)+1)%he.length;He(he[t])},Nt=a=>{var D,j,re,ue,ve,de,ce,me,pe,ke,fe,ye,ge;return(ge={[w.FAVORITE]:((j=(D=h.movieInfo)==null?void 0:D.lists)==null?void 0:j.isFavorite)||!1,[w.HISTORY]:((ue=(re=h.movieInfo)==null?void 0:re.lists)==null?void 0:ue.isHistory)||!1,[w.LATER]:((de=(ve=h.movieInfo)==null?void 0:ve.lists)==null?void 0:de.isLater)||!1,[w.COMPLETED]:((me=(ce=h.movieInfo)==null?void 0:ce.lists)==null?void 0:me.isCompleted)||!1,[w.ABANDONED]:((ke=(pe=h.movieInfo)==null?void 0:pe.lists)==null?void 0:ke.isAbandoned)||!1,[w.WATCHING]:((ye=(fe=h.movieInfo)==null?void 0:fe.lists)==null?void 0:ye.isWatching)||!1}[a])!=null?ge:!1},W=async a=>{if(!I.token){z.value.showNotification("Необходимо авторизоваться",5e3);return}try{const t={[w.FAVORITE]:"избранное",[w.HISTORY]:"историю",[w.LATER]:'список "Смотреть позже"',[w.COMPLETED]:'список "Просмотрено"',[w.ABANDONED]:'список "Брошено"',[w.WATCHING]:'список "Смотрю"'};Nt(a)?(await Ut(y.value,a),z.value.showNotification("Удалено из ".concat(t[a]))):(await ht(y.value,a),z.value.showNotification("Добавлено в ".concat(t[a])))}catch(t){const{message:D,code:j}=Re(t);z.value.showNotification("".concat(D," ").concat(j))}H("update:movieInfo")};return Le(()=>{U.value=!0,Me(),oe.value&&(E.value="4:3"),V(),window.addEventListener("resize",V),Q.value&&Z()}),wt(()=>{window.removeEventListener("resize",V),window.removeEventListener("mousemove",Ie),document.removeEventListener("keydown",Ee),document.body.classList.remove("no-scroll")}),(a,t)=>{var D,j,re,ue,ve,de,ce,me,pe,ke,fe,ye,ge,Ne,Oe,Ke,Ue,Ve,Be,qe,We,Ye,Fe,ze,Ge,Ze,je,Qe,Xe,Je,et,tt,ot,st,lt,nt,it,at,rt,ut,vt,dt;return n.value?(l(),ne($t,{key:0,message:n.value,code:v.value},null,8,["message","code"])):(l(),i(X,{key:1},[e("div",vo,[t[39]||(t[39]=e("span",null,"Плеер:",-1)),e("button",{class:"player-btn",onClick:Mt},c(b.value?Dt(b.value.translate).toUpperCase():"Загрузка плееров..."),1)]),g.value?(l(),ne(uo,{key:0,players:o.value,"selected-player":b.value,onClose:xe,onSelect:It},null,8,["players","selected-player"])):d("",!0),e("div",{ref_key:"containerRef",ref:O,class:A(["player-container",{"theater-mode":$.value}]),style:Pe($.value?{}:B.value)},[e("div",{class:"iframe-wrapper",style:Pe($.value?{}:be.value)},[C(e("iframe",{ref_key:"playerIframe",ref:q,src:(D=b.value)==null?void 0:D.iframe,frameborder:"0",allowfullscreen:"",webkitallowfullscreen:"",class:A(["responsive-iframe",{"theater-mode-unlock":N.value,"theater-mode-lock":$.value,dimmed:$e.value}]),onLoad:xt},null,42,co),[[M,!U.value&&((j=b.value)==null?void 0:j.iframe)]]),U.value?(l(),ne(At,{key:0})):d("",!0)],4),$.value?(l(),i("button",{key:0,class:A(["close-theater-btn",{visible:N.value}]),onClick:we}," ✖ ",2)):d("",!0)],6),e("div",mo,[oe.value?(l(),i("div",Co,[e("div",Mo,[e("button",{class:A(["favorite-btn",{active:(Ze=(Ge=f.movieInfo)==null?void 0:Ge.lists)==null?void 0:Ze.isFavorite}]),onMouseenter:t[7]||(t[7]=u=>r("favorite")),onMouseleave:t[8]||(t[8]=u=>p.value=null),onClick:t[9]||(t[9]=u=>W(S(w).FAVORITE))},[e("span",Io,c((Qe=(je=f.movieInfo)==null?void 0:je.lists)!=null&&Qe.isFavorite?"favorite":"favorite_border"),1)],34),C(e("div",Eo,c("В избранное"),512),[[M,p.value==="favorite"]])]),e("div",To,[e("button",{class:A(["watching-btn",{active:(Je=(Xe=f.movieInfo)==null?void 0:Xe.lists)==null?void 0:Je.isWatching}]),onMouseenter:t[10]||(t[10]=u=>r("watching")),onMouseleave:t[11]||(t[11]=u=>p.value=null),onClick:t[12]||(t[12]=u=>W(S(w).WATCHING))},[e("span",Po,c((tt=(et=f.movieInfo)==null?void 0:et.lists)!=null&&tt.isWatching?"visibility":"visibility_off"),1)],34),C(e("div",Ro,c("Смотрю"),512),[[M,p.value==="watching"]])]),e("div",So,[e("button",{class:A(["later-btn",{active:(st=(ot=f.movieInfo)==null?void 0:ot.lists)==null?void 0:st.isLater}]),onMouseenter:t[13]||(t[13]=u=>r("later")),onMouseleave:t[14]||(t[14]=u=>p.value=null),onClick:t[15]||(t[15]=u=>W(S(w).LATER))},t[45]||(t[45]=[e("span",{class:"material-icons"},"watch_later",-1)]),34),C(e("div",Lo,c("Смотреть позже"),512),[[M,p.value==="later"]])]),e("div",xo,[e("button",{class:A(["completed-btn",{active:(nt=(lt=f.movieInfo)==null?void 0:lt.lists)==null?void 0:nt.isCompleted}]),onMouseenter:t[16]||(t[16]=u=>r("completed")),onMouseleave:t[17]||(t[17]=u=>p.value=null),onClick:t[18]||(t[18]=u=>W(S(w).COMPLETED))},[e("span",Do,c((at=(it=f.movieInfo)==null?void 0:it.lists)!=null&&at.isCompleted?"check_circle":"check_circle_outline"),1)],34),C(e("div",Ho,c("Просмотрено"),512),[[M,p.value==="completed"]])]),e("div",No,[e("button",{class:A(["abandoned-btn",{active:(ut=(rt=f.movieInfo)==null?void 0:rt.lists)==null?void 0:ut.isAbandoned}]),onMouseenter:t[19]||(t[19]=u=>r("abandoned")),onMouseleave:t[20]||(t[20]=u=>p.value=null),onClick:t[21]||(t[21]=u=>W(S(w).ABANDONED))},[e("span",Oo,c(((dt=(vt=f.movieInfo)==null?void 0:vt.lists)!=null&&dt.isAbandoned,"not_interested")),1)],34),C(e("div",Ko,c("Брошено"),512),[[M,p.value==="abandoned"]])])])):(l(),i("div",po,[e("button",{class:A(["favorite-btn",{active:(ue=(re=f.movieInfo)==null?void 0:re.lists)==null?void 0:ue.isFavorite}]),onMouseenter:t[0]||(t[0]=u=>r("favorite")),onMouseleave:s,onClick:t[1]||(t[1]=u=>W(S(w).FAVORITE))},[e("span",ko,c((de=(ve=f.movieInfo)==null?void 0:ve.lists)!=null&&de.isFavorite?"favorite":"favorite_border"),1)],34),C(e("div",{class:"custom-tooltip advanced-tooltip list-buttons-dropdown",onMouseenter:K,onMouseleave:G},[e("div",fo,[e("button",{class:A(["favorite-btn",{active:(me=(ce=f.movieInfo)==null?void 0:ce.lists)==null?void 0:me.isFavorite}]),onClick:t[2]||(t[2]=u=>W(S(w).FAVORITE))},[e("span",yo,c((ke=(pe=f.movieInfo)==null?void 0:pe.lists)!=null&&ke.isFavorite?"favorite":"favorite_border"),1),t[40]||(t[40]=e("span",{class:"button-label"},"В избранное",-1))],2)]),e("div",go,[e("button",{class:A(["watching-btn",{active:(ye=(fe=f.movieInfo)==null?void 0:fe.lists)==null?void 0:ye.isWatching}]),onClick:t[3]||(t[3]=u=>W(S(w).WATCHING))},[e("span",_o,c((Ne=(ge=f.movieInfo)==null?void 0:ge.lists)!=null&&Ne.isWatching?"visibility":"visibility_off"),1),t[41]||(t[41]=e("span",{class:"button-label"},"Смотрю",-1))],2)]),e("div",bo,[e("button",{class:A(["later-btn",{active:(Ke=(Oe=f.movieInfo)==null?void 0:Oe.lists)==null?void 0:Ke.isLater}]),onClick:t[4]||(t[4]=u=>W(S(w).LATER))},t[42]||(t[42]=[e("span",{class:"material-icons"},"watch_later",-1),e("span",{class:"button-label"},"Смотреть позже",-1)]),2)]),e("div",wo,[e("button",{class:A(["completed-btn",{active:(Ve=(Ue=f.movieInfo)==null?void 0:Ue.lists)==null?void 0:Ve.isCompleted}]),onClick:t[5]||(t[5]=u=>W(S(w).COMPLETED))},[e("span",$o,c((qe=(Be=f.movieInfo)==null?void 0:Be.lists)!=null&&qe.isCompleted?"check_circle":"check_circle_outline"),1),t[43]||(t[43]=e("span",{class:"button-label"},"Просмотрено",-1))],2)]),e("div",ho,[e("button",{class:A(["abandoned-btn",{active:(Ye=(We=f.movieInfo)==null?void 0:We.lists)==null?void 0:Ye.isAbandoned}]),onClick:t[6]||(t[6]=u=>W(S(w).ABANDONED))},[e("span",Ao,c(((ze=(Fe=f.movieInfo)==null?void 0:Fe.lists)!=null&&ze.isAbandoned,"not_interested")),1),t[44]||(t[44]=e("span",{class:"button-label"},"Брошено",-1))],2)])],544),[[M,p.value==="favorite"]])])),oe.value?d("",!0):(l(),i(X,{key:2},[e("div",Uo,[e("button",{class:A(["dimming-btn",{active:$e.value}]),onMouseenter:t[22]||(t[22]=u=>r("dimming")),onMouseleave:t[23]||(t[23]=u=>p.value=null),onClick:Rt},[e("span",Vo,c($e.value?"light_mode":"dark_mode"),1)],34),C(e("div",{class:"custom-tooltip"},c($e.value?"Отключить затемнение":"Включить затемнение"),513),[[M,p.value==="dimming"]])]),e("div",Bo,[e("button",{class:A(["blur-btn",{"electron-only":!R.value}]),onMouseenter:t[24]||(t[24]=u=>r("blur")),onMouseleave:t[25]||(t[25]=u=>p.value=null),onClick:Et},t[46]||(t[46]=[e("span",{class:"material-icons"},"blur_on",-1)]),34),C(e("div",{class:"custom-tooltip"},c(R.value?"Блюр":"Блюр, функция доступна в приложении"),513),[[M,p.value==="blur"]])]),e("div",qo,[e("button",{class:A(["material-symbols-outlined",{"electron-only":!R.value}]),onMouseenter:t[26]||(t[26]=u=>r("compressor")),onMouseleave:t[27]||(t[27]=u=>p.value=null),onClick:Tt},t[47]||(t[47]=[e("span",{class:"material-icons"},"graphic_eq",-1)]),34),C(e("div",{class:"custom-tooltip"},c(R.value?"Компрессор":"Компрессор, функция доступна в приложении"),513),[[M,p.value==="compressor"]])]),e("div",Wo,[e("button",{class:A(["mirror-btn",{"electron-only":!R.value}]),onMouseenter:t[28]||(t[28]=u=>r("mirror")),onMouseleave:t[29]||(t[29]=u=>p.value=null),onClick:Pt},t[48]||(t[48]=[e("span",{class:"material-icons"},"flip",-1)]),34),C(e("div",{class:"custom-tooltip"},c(R.value?"Зеркало":"Зеркало, функция доступна в приложении"),513),[[M,p.value==="mirror"]])]),e("div",Yo,[e("button",{class:"theater-mode-btn",onMouseenter:t[30]||(t[30]=u=>r("theater")),onMouseleave:t[31]||(t[31]=u=>p.value=null),onClick:we},[e("span",Fo,c($.value?"fullscreen_exit":"aspect_ratio"),1)],32),C(e("div",zo,[L(c($.value?"Выйти из театрального режима":"Театральный режим")+" ",1),t[49]||(t[49]=e("span",{class:"shortcut-hint"},"Alt+T",-1))],512),[[M,p.value==="theater"]])]),e("div",Go,[e("button",{class:"aspect-ratio-dropdown-btn",onMouseenter:t[32]||(t[32]=u=>r("aspect_ratio")),onMouseleave:s,onClick:Ht},[e("span",Zo,c(E.value),1)],32),C(e("div",{class:"custom-tooltip advanced-tooltip aspect-ratio-dropdown",onMouseenter:K,onMouseleave:G},[(l(),i(X,null,Ae(he,u=>e("div",{key:u,class:A(["aspect-ratio-option",{active:E.value===u}]),onClick:nl=>He(u)},c(u),11,jo)),64))],544),[[M,p.value==="aspect_ratio"]])]),e("div",{class:"tooltip-container",onMouseenter:t[34]||(t[34]=u=>r("centering")),onMouseleave:s},[e("button",{class:"center-btn",onClick:Z},t[50]||(t[50]=[e("span",{class:"material-icons"},"center_focus_strong",-1)])),C(e("div",{class:"custom-tooltip advanced-tooltip",onMouseenter:K,onMouseleave:G},[t[51]||(t[51]=L(" Отцентрировать плеер ")),te(zt,{modelValue:Q.value,"onUpdate:modelValue":t[33]||(t[33]=u=>Q.value=u),title:"Автоцентрирование плеера"},null,8,["modelValue"]),t[52]||(t[52]=e("span",{class:"tooltip-title"},"Автоцентрирование плеера",-1))],544),[[M,p.value==="centering"]])],32),R.value?d("",!0):(l(),i("div",Qo,[e("button",{class:"app-link-btn",onMouseenter:t[35]||(t[35]=u=>r("app_link")),onMouseleave:t[36]||(t[36]=u=>p.value=null),onClick:St},t[53]||(t[53]=[e("span",{class:"material-icons"},"open_in_new",-1)]),32),C(e("div",Xo," Открыть в приложении ",512),[[M,p.value==="app_link"]])])),R.value?(l(),i("div",Jo,[e("button",{class:"copy-link-btn",onMouseenter:t[37]||(t[37]=u=>r("copy_link")),onMouseleave:t[38]||(t[38]=u=>p.value=null),onClick:Lt},t[54]||(t[54]=[e("span",{class:"material-icons"},"content_copy",-1)]),32),C(e("div",es," Скопировать ссылку ",512),[[M,p.value==="copy_link"]])])):d("",!0)],64))]),te(Ct,{ref_key:"notificationRef",ref:z},null,512)],64))}}},gt=Ce(ts,[["__scopeId","data-v-98011746"]]),os={key:0,class:"carousel-container"},ss={class:"carousel-wrapper"},ls=["onClick"],ns=["src","alt"],is={class:"video-name"},as={key:0,class:"video-player"},rs=["src"],us={__name:"TrailerCarousel",props:{videos:{type:Array,required:!0},activeVideoIndex:{type:Number,default:null}},emits:["select"],setup(f,{emit:_}){const x=Se(),P=T(()=>x.isMobile),I=f,F=_,y=k(I.activeVideoIndex),h=k(null),H=k(!1),o=k(!1),b=()=>{if(!h.value)return;const{scrollLeft:g,scrollWidth:n,clientWidth:v}=h.value;H.value=g>0,o.value=g<n-v-1},U=g=>{if(!h.value)return;const n=h.value.querySelector(".carousel-item");if(!n)return;const v=n.clientWidth+16;h.value.scrollBy({left:v*g,behavior:"smooth"})},$=g=>{y.value=g,F("select",I.videos[g])},N=()=>b(),q=k([]),O=async g=>{try{return(await fetch("https://img.youtube.com/vi/".concat(g,"/0.jpg"))).ok}catch(n){return!1}};return Le(async()=>{const g=I.videos.map(async v=>await O(v.videoId)?v:null),n=await Promise.all(g);q.value=n.filter(Boolean),b(),window.addEventListener("resize",N)}),ie(()=>I.videos,async g=>{const n=g.map(async m=>await O(m.videoId)?m:null),v=await Promise.all(n);q.value=v.filter(Boolean)}),ie(()=>I.activeVideoIndex,g=>{y.value=g}),wt(()=>{window.removeEventListener("resize",N)}),(g,n)=>q.value.length?(l(),i("div",os,[n[4]||(n[4]=e("h2",null,"Трейлеры (YouTube)",-1)),e("div",ss,[C(e("button",{class:"scroll-button left",onClick:n[0]||(n[0]=v=>U(-1))},n[2]||(n[2]=[e("span",{class:"material-symbols-outlined"},"arrow_back_ios",-1)]),512),[[M,!P.value&&H.value]]),e("div",{ref_key:"carousel",ref:h,class:"carousel",onScroll:b},[(l(!0),i(X,null,Ae(q.value,(v,m)=>(l(),i("div",{key:m,class:"carousel-item",onClick:Y=>$(m)},[e("img",{src:"https://img.youtube.com/vi/".concat(v.videoId,"/0.jpg"),alt:v.name},null,8,ns),e("div",is,c(v.name),1)],8,ls))),128))],544),C(e("button",{class:"scroll-button right",onClick:n[1]||(n[1]=v=>U(1))},n[3]||(n[3]=[e("span",{class:"material-symbols-outlined"},"arrow_forward_ios",-1)]),512),[[M,!P.value&&o.value]])]),y.value!==null?(l(),i("div",as,[e("iframe",{src:f.videos[y.value].iframeUrl,frameborder:"0",allowfullscreen:""},null,8,rs)])):d("",!0)])):d("",!0)}},vs=Ce(us,[["__scopeId","data-v-5d54158b"]]),ds={class:"movie-info"},cs={class:"content"},ms={key:0,class:"content-card"},ps={class:"movie-skeleton"},ks={class:"movie-skeleton__player"},fs={key:2,class:"content-card"},ys={key:3,class:"content-card"},gs={class:"content-header"},_s=["src"],bs={class:"content-title"},ws={key:0,class:"ratings-links"},$s={key:0},hs=["href"],As={key:0},Cs={key:1},Ms=["href"],Is={key:0},Es={key:2},Ts=["href"],Ps={key:0},Rs={key:3},Ss=["href"],Ls={key:0},xs={key:4},Ds=["href"],Hs={key:5},Ns=["href"],Os=["content"],Ks=["content"],Us={class:"additional-info"},Vs={class:"info-content"},Bs={class:"details-container"},qs={class:"info-list"},Ws={key:0},Ys={key:1},Fs={key:2},zs={key:3},Gs={key:4},Zs={key:5},js={key:6},Qs={key:7},Xs={key:8},Js={class:"content-info"},el={key:0,class:"content-description-text"},tl={key:2,class:"yt-video-container"},ol={key:3,class:"related-movies"},sl={key:4,class:"related-movies"},ll={__name:"MovieInfo",setup(f){const _=k(!0),x=Se(),P=_t(),I=Vt(),F=bt(),y=k(F.params.kp_id),h=k(""),H=k(null),o=k(null),b=Bt(),$=Gt().areTrailersActive,N=k(null),q=()=>{if(o.value){const r=o.value.name_ru||o.value.name_en||o.value.name_original||"Информация о фильме";document.title=r}},O=r=>(r||[]).map(s=>({kp_id:s.film_id,poster:s.poster_url_preview||s.poster_url,title:s.name_ru||s.name_en||s.name_original})),g=r=>{if(typeof r!="number")return;const s=Math.floor(r/60),K=r%60;return"".concat(s," ч. ").concat(K," мин.")},n=k(!1),v=k({top:"0px",left:"0px"}),m=r=>{n.value=!0,v.value={top:"".concat(r.pageY+10,"px"),left:"".concat(r.pageX-70,"px")}},Y=k(null),oe=async()=>{try{const r=[o.value.name_ru||o.value.name_en||o.value.name_original,...o.value.year?[o.value.year]:[],...o.value.film_length?[g(o.value.film_length)]:[]];await navigator.clipboard.writeText(r.join(", ")),Y.value.showNotification("Скопировано")}catch(r){console.error("Ошибка копирования:",r)}},R=async(r=!0)=>{var s,K,G,E,Q,ae,_e,ee;try{let V;if(y.value.startsWith("shiki")?V=await Wt(y.value):V=await Yt(y.value,P.token),Array.isArray(V)&&V.length===0)throw new Error("Данные не найдены. Пожалуйста, повторите поиск.");o.value=V,y.value.startsWith("shiki")?o.value={...o.value,title:o.value.name_ru||o.value.name_en,name_original:o.value.name_en,short_description:o.value.slogan}:o.value={...o.value,title:o.value.name_ru||o.value.name_en||o.value.name_original,kinopoisk_id:y.value},b.setHeaderContent({text:o.value.title,imageUrl:o.value.logo_url}),q();const B={kp_id:y.value,title:((s=o.value)==null?void 0:s.name_ru)||((K=o.value)==null?void 0:K.name_en)||((G=o.value)==null?void 0:G.name_original),poster:((E=o.value)==null?void 0:E.poster_url)||((Q=o.value)==null?void 0:Q.cover_url)||((ae=o.value)==null?void 0:ae.screenshots[0]),year:(_e=o.value)==null?void 0:_e.year,type:(ee=o.value)==null?void 0:ee.type};if(y.value.startsWith("shiki"))if(o.value.screenshots&&o.value.screenshots.length>0){const Z=Math.floor(Math.random()*o.value.screenshots.length),Me=o.value.screenshots[Z];I.updateMoviePoster(Me)}else B.poster&&I.updateMoviePoster(B.poster);else B.poster&&I.updateMoviePoster(B.poster);if(T(()=>x.isHistoryAllowed).value&&B.kp_id&&B.title&&r)if(P.token)try{await ht(B.kp_id,w.HISTORY)}catch(Z){console.error("Ошибка при добавлении в историю:",Z)}else x.addToHistory({...B})}catch(V){const{message:B,code:be}=Re(V);h.value=B,H.value=be,console.error("Ошибка при загрузке информации о фильмах:",V)}},p=T(()=>{var r,s;return console.log("Трейлеры:",(r=o.value)==null?void 0:r.videos),(s=o.value)==null?void 0:s.videos}),J=T(()=>{var r;return O((r=o.value)==null?void 0:r.sequels_and_prequels)}),se=T(()=>{var r;return O((r=o.value)==null?void 0:r.similars)}),z=r=>{if(r.altKey&&r.keyCode===84&&document.querySelector(".player-container")){const K=document.querySelector(".theater-mode-btn");K&&K.click()}};return Le(async()=>{await R(),_.value=!1,document.addEventListener("keydown",z)}),qt(async()=>{b.clearHeaderContent(),document.removeEventListener("keydown",z)}),ie(()=>F.params.kp_id,async r=>{r&&r!==y.value&&(b.clearHeaderContent(),y.value=r,N.value=null,await R(),_.value=!1)},{immediate:!0}),ie(o,()=>{q()},{deep:!0}),(r,s)=>{var K,G;return l(),i(X,null,[e("div",ds,[e("div",cs,[_.value?(l(),i("div",ms,[e("div",ps,[s[2]||(s[2]=mt('<div class="movie-skeleton__header" data-v-415195ce><div class="movie-skeleton__title" data-v-415195ce></div></div><div class="movie-skeleton__ratings" data-v-415195ce><div class="movie-skeleton__rating-item" data-v-415195ce></div><div class="movie-skeleton__rating-item" data-v-415195ce></div><div class="movie-skeleton__rating-item" data-v-415195ce></div></div>',2)),e("div",ks,[te(At)]),s[3]||(s[3]=mt('<div class="movie-skeleton__controls" data-v-415195ce><div class="movie-skeleton__control-btn" data-v-415195ce></div><div class="movie-skeleton__control-btn" data-v-415195ce></div><div class="movie-skeleton__control-btn" data-v-415195ce></div><div class="movie-skeleton__control-btn" data-v-415195ce></div><div class="movie-skeleton__control-btn" data-v-415195ce></div></div><div class="movie-skeleton__additional-info" data-v-415195ce><div class="movie-skeleton__section-title" data-v-415195ce></div><div class="movie-skeleton__info-list" data-v-415195ce><div class="movie-skeleton__info-item" data-v-415195ce></div><div class="movie-skeleton__info-item" data-v-415195ce></div><div class="movie-skeleton__info-item" data-v-415195ce></div><div class="movie-skeleton__info-item" data-v-415195ce></div><div class="movie-skeleton__info-item" data-v-415195ce></div></div></div><div class="movie-skeleton__description" data-v-415195ce><div class="movie-skeleton__description-line" data-v-415195ce></div><div class="movie-skeleton__description-line" data-v-415195ce></div><div class="movie-skeleton__description-line" data-v-415195ce></div><div class="movie-skeleton__description-line" data-v-415195ce></div></div>',3))])])):d("",!0),h.value?(l(),ne($t,{key:1,message:h.value,code:H.value},null,8,["message","code"])):d("",!0),h.value?(l(),i("div",fs,[(l(),ne(gt,{key:y.value,"kp-id":y.value,"movie-info":o.value,"onUpdate:movieInfo":R},null,8,["kp-id","movie-info"]))])):d("",!0),o.value?(l(),i("div",ys,[e("div",gs,[o.value.logo_url?(l(),i("div",{key:0,class:"content-logo",onMousemove:m,onMouseleave:s[0]||(s[0]=E=>n.value=!1),onClick:oe},[e("img",{src:o.value.logo_url,alt:"Логотип фильма",class:"content-logo"},null,8,_s)],32)):(l(),i("div",{key:1,onMousemove:m,onMouseleave:s[1]||(s[1]=E=>n.value=!1),onClick:oe},[e("h1",bs,c(o.value.title),1)],32)),C(e("div",{class:"title-copy-tooltip",style:Pe(v.value)}," Скопировать ",4),[[M,n.value]])]),o.value.kinopoisk_id||o.value.title||o.value.imdb_id||o.value.rating_imdb||o.value.shikimori_id?(l(),i("div",ws,[o.value.kinopoisk_id?(l(),i("div",$s,[e("a",{href:"https://www.kinopoisk.ru/film/".concat(o.value.kinopoisk_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[s[4]||(s[4]=e("img",{src:kt,alt:"КП",class:"rating-logo"},null,-1)),o.value.rating_kinopoisk?(l(),i("span",As,c(o.value.rating_kinopoisk)+"/10",1)):d("",!0),s[5]||(s[5]=e("img",{src:le,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,hs)])):d("",!0),!o.value.kinopoisk_id&&o.value.title?(l(),i("div",Cs,[e("a",{href:"https://www.kinopoisk.ru/index.php?kp_query=".concat(encodeURIComponent(o.value.title+(o.value.year?" "+o.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[s[6]||(s[6]=e("img",{src:kt,alt:"КП",class:"rating-logo"},null,-1)),o.value.rating_kinopoisk?(l(),i("span",Is,c(o.value.rating_kinopoisk)+"/10",1)):d("",!0),s[7]||(s[7]=e("img",{src:le,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Ms)])):d("",!0),o.value.imdb_id?(l(),i("div",Es,[e("a",{href:"https://www.imdb.com/title/".concat(o.value.imdb_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[s[8]||(s[8]=e("img",{src:ft,alt:"IMDb",class:"rating-logo"},null,-1)),o.value.rating_imdb?(l(),i("span",Ps,c(o.value.rating_imdb)+"/10",1)):d("",!0),s[9]||(s[9]=e("img",{src:le,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Ts)])):d("",!0),!o.value.imdb_id&&o.value.title?(l(),i("div",Rs,[e("a",{href:"https://www.imdb.com/find/?q=".concat(encodeURIComponent(o.value.title+(o.value.year?" "+o.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[s[10]||(s[10]=e("img",{src:ft,alt:"IMDb",class:"rating-logo"},null,-1)),o.value.rating_imdb?(l(),i("span",Ls,c(o.value.rating_imdb)+"/10",1)):d("",!0),s[11]||(s[11]=e("img",{src:le,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,Ss)])):d("",!0),o.value.shikimori_id?(l(),i("div",xs,[e("a",{href:"https://shikimori.one/animes/".concat(o.value.shikimori_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},s[12]||(s[12]=[e("img",{src:Zt,alt:"Shiki",class:"rating-logo"},null,-1),e("img",{src:le,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)]),8,Ds)])):d("",!0),o.value.imdb_id?(l(),i("div",Hs,[e("a",{href:"https://www.imdb.com/title/".concat(o.value.imdb_id,"/parentalguide"),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},s[13]||(s[13]=[e("span",null,"Parents Guide",-1),e("img",{src:le,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)]),8,Ns)])):d("",!0)])):d("",!0),(l(),ne(gt,{key:y.value,"kp-id":y.value,"movie-info":o.value,"onUpdate:movieInfo":R},null,8,["kp-id","movie-info"])),e("meta",{name:"title-and-year",content:o.value.type==="FILM"&&o.value.year?"".concat(o.value.title," (").concat(o.value.year,")"):o.value.title},null,8,Os),o.value.name_original?(l(),i("meta",{key:1,name:"original-title",content:o.value.name_original},null,8,Ks)):d("",!0),e("div",Us,[s[23]||(s[23]=e("h2",{class:"additional-info-title"},"Подробнее",-1)),e("div",Vs,[e("div",Bs,[e("ul",qs,[o.value.type&&S(pt)[o.value.type]?(l(),i("li",Ws,[s[14]||(s[14]=e("strong",null,"Тип:",-1)),L(" "+c(S(pt)[o.value.type]),1)])):d("",!0),o.value.year?(l(),i("li",Ys,[s[15]||(s[15]=e("strong",null,"Год выпуска:",-1)),L(" "+c(o.value.year),1)])):d("",!0),o.value.title?(l(),i("li",Fs,[s[16]||(s[16]=e("strong",null,"Название:",-1)),L(" "+c(o.value.title),1)])):d("",!0),o.value.name_original?(l(),i("li",zs,[s[17]||(s[17]=e("strong",null,"Оригинальное название:",-1)),L(" "+c(o.value.name_original),1)])):d("",!0),o.value.slogan?(l(),i("li",Gs,[s[18]||(s[18]=e("strong",null,"Слоган:",-1)),L(" "+c(o.value.slogan),1)])):d("",!0),o.value.production_companies?(l(),i("li",Zs,[s[19]||(s[19]=e("strong",null,"Продакшн:",-1)),L(" "+c(o.value.production_companies),1)])):d("",!0),(K=o.value.countries)!=null&&K.length?(l(),i("li",js,[s[20]||(s[20]=e("strong",null,"Страна производства:",-1)),L(" "+c(o.value.countries.map(E=>E.country).join(", ")),1)])):d("",!0),(G=o.value.genres)!=null&&G.length?(l(),i("li",Qs,[s[21]||(s[21]=e("strong",null,"Жанры:",-1)),L(" "+c(o.value.genres.map(E=>E.genre).join(", ")),1)])):d("",!0),o.value.film_length?(l(),i("li",Xs,[s[22]||(s[22]=e("strong",null,"Продолжительность:",-1)),L(" "+c(g(o.value.film_length)),1)])):d("",!0)])])])]),e("div",Js,[o.value.description?(l(),i("p",el,c(o.value.description),1)):d("",!0)]),p.value.length&&S($)?(l(),i("div",tl,[te(vs,{videos:p.value,"active-video-index":N.value,onSelect:r.playTrailer},null,8,["videos","active-video-index","onSelect"])])):d("",!0),J.value.length?(l(),i("div",ol,[s[24]||(s[24]=e("h2",null,"Сиквелы и приквелы",-1)),te(S(yt),{"movies-list":J.value,loading:!1,"is-history":!1},null,8,["movies-list"])])):d("",!0),se.value.length?(l(),i("div",sl,[s[25]||(s[25]=e("h2",null,"Похожие",-1)),te(S(yt),{"movies-list":se.value,loading:!1,"is-history":!1},null,8,["movies-list"])])):d("",!0)])):d("",!0)])]),te(Ct,{ref_key:"notificationRef",ref:Y},null,512)],64)}}},vl=Ce(ll,[["__scopeId","data-v-415195ce"]]);export{vl as default};
//# sourceMappingURL=MovieInfo-BeROtCDc.js.map
